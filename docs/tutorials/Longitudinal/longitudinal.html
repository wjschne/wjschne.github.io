<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W. Joel Schneider">
<meta name="dcterms.date" content="2025-03-11">
<meta name="description" content="W. Joel Schneider is a professor at Temple University.">

<title>W. Joel Schneider</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8a4124b41b31233c317a4382fed0f3b4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="W. Joel Schneider">
<meta property="og:description" content="Multilevel models about how and why variables change over time">
<meta property="og:image" content="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-plotmodel-1.png">
<meta property="og:site_name" content="W. Joel Schneider">
<meta property="og:image:height" content="1536">
<meta property="og:image:width" content="1536">
</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">W. Joel Schneider</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">R Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assessingpsyche.html"> 
<span class="menu-text">Assessment Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vita.html"> 
<span class="menu-text">Vita</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:schneider@temple.edu" rel="noreferrer noopener" target="_blank"> <i class="bi bi-envelope" role="img" aria-label="Email">
</i> 
<span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/wjschne" rel="noreferrer noopener" target="_blank"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Multilevel Modeling of Longitudinal Data in R</h1>
            <p class="subtitle lead">Advanced Data Analysis (EDUC 8825)</p>
                  <div>
        <div class="description">
          Multilevel models about how and why variables change over time
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 11, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hypothetical-longitudinal-study-of-reading-comprehension" id="toc-hypothetical-longitudinal-study-of-reading-comprehension" class="nav-link active" data-scroll-target="#hypothetical-longitudinal-study-of-reading-comprehension">Hypothetical Longitudinal Study of Reading Comprehension</a>
  <ul class="collapse">
  <li><a href="#level-1-measurement-occasion" id="toc-level-1-measurement-occasion" class="nav-link" data-scroll-target="#level-1-measurement-occasion">Level 1: Measurement Occasion</a></li>
  <li><a href="#level-2-person" id="toc-level-2-person" class="nav-link" data-scroll-target="#level-2-person">Level 2: Person</a>
  <ul class="collapse">
  <li><a href="#predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0" id="toc-predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0" class="nav-link" data-scroll-target="#predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0">Predicting the Random Intercept <span class="math inline">(b_{0i})</span>: <br> What Determines the Conditions at <em>T</em><sub>0</sub>?</a></li>
  <li><a href="#predicting-times-random-slope-what-determines-the-effect-of-time-grade" id="toc-predicting-times-random-slope-what-determines-the-effect-of-time-grade" class="nav-link" data-scroll-target="#predicting-times-random-slope-what-determines-the-effect-of-time-grade">Predicting Time’s Random Slope: <br> What determines the effect of time (Grade)?</a></li>
  <li><a href="#predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding" id="toc-predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding" class="nav-link" data-scroll-target="#predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding">Predicting Reading Decoding’s Random Slope: <br> What determines the effect of Reading Decoding?</a></li>
  <li><a href="#level-2-random-effects" id="toc-level-2-random-effects" class="nav-link" data-scroll-target="#level-2-random-effects">Level-2 Random Effects</a></li>
  </ul></li>
  <li><a href="#combined-equations" id="toc-combined-equations" class="nav-link" data-scroll-target="#combined-equations">Combined Equations</a></li>
  <li><a href="#simulate-longitudinal-data" id="toc-simulate-longitudinal-data" class="nav-link" data-scroll-target="#simulate-longitudinal-data">Simulate longitudinal data</a>
  <ul class="collapse">
  <li><a href="#simulate-level-2-data-person-level" id="toc-simulate-level-2-data-person-level" class="nav-link" data-scroll-target="#simulate-level-2-data-person-level">Simulate Level-2 Data (Person Level)</a></li>
  <li><a href="#simulate-level-1-data-occasion-level" id="toc-simulate-level-1-data-occasion-level" class="nav-link" data-scroll-target="#simulate-level-1-data-occasion-level">Simulate Level-1 Data (Occasion Level)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#complete-analysis-walkthrough" id="toc-complete-analysis-walkthrough" class="nav-link" data-scroll-target="#complete-analysis-walkthrough">Complete Analysis Walkthrough</a>
  <ul class="collapse">
  <li><a href="#model-building-plan" id="toc-model-building-plan" class="nav-link" data-scroll-target="#model-building-plan">Model Building Plan</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load Packages</a></li>
  <li><a href="#null-model" id="toc-null-model" class="nav-link" data-scroll-target="#null-model">Null Model</a></li>
  <li><a href="#linear-effect-of-time-grade" id="toc-linear-effect-of-time-grade" class="nav-link" data-scroll-target="#linear-effect-of-time-grade">Linear Effect of Time (Grade)</a></li>
  <li><a href="#quadratic-effect-of-time" id="toc-quadratic-effect-of-time" class="nav-link" data-scroll-target="#quadratic-effect-of-time">Quadratic effect of Time</a></li>
  <li><a href="#fixed-effect-of-reading-decoding-level-1-time-varying-covariate" id="toc-fixed-effect-of-reading-decoding-level-1-time-varying-covariate" class="nav-link" data-scroll-target="#fixed-effect-of-reading-decoding-level-1-time-varying-covariate">Fixed effect of reading decoding (level 1 time-varying covariate)</a></li>
  <li><a href="#level-1-interaction-effects" id="toc-level-1-interaction-effects" class="nav-link" data-scroll-target="#level-1-interaction-effects">Level-1 interaction effects</a></li>
  <li><a href="#level-2-covariate-working-memory" id="toc-level-2-covariate-working-memory" class="nav-link" data-scroll-target="#level-2-covariate-working-memory">Level-2 covariate: working memory</a></li>
  <li><a href="#level-1-random-slope-grade" id="toc-level-1-random-slope-grade" class="nav-link" data-scroll-target="#level-1-random-slope-grade">Level-1 random slope: Grade</a></li>
  <li><a href="#level-1-random-slope-reading_decoding" id="toc-level-1-random-slope-reading_decoding" class="nav-link" data-scroll-target="#level-1-random-slope-reading_decoding">Level-1 random slope: reading_decoding</a></li>
  <li><a href="#level-1-random-intercept-slope-correlations" id="toc-level-1-random-intercept-slope-correlations" class="nav-link" data-scroll-target="#level-1-random-intercept-slope-correlations">Level-1 random intercept-slope correlations</a></li>
  <li><a href="#cross-level-interaction-working-memory-grade" id="toc-cross-level-interaction-working-memory-grade" class="nav-link" data-scroll-target="#cross-level-interaction-working-memory-grade">Cross-level interaction: Working Memory × Grade</a></li>
  <li><a href="#cross-level-interaction-working-memory-reading-decoding" id="toc-cross-level-interaction-working-memory-reading-decoding" class="nav-link" data-scroll-target="#cross-level-interaction-working-memory-reading-decoding">Cross-level interaction: Working Memory × Reading Decoding</a></li>
  <li><a href="#final-model" id="toc-final-model" class="nav-link" data-scroll-target="#final-model">Final model</a></li>
  </ul></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a>
  <ul class="collapse">
  <li><a href="#load-data-and-packages" id="toc-load-data-and-packages" class="nav-link" data-scroll-target="#load-data-and-packages">Load Data and Packages</a></li>
  <li><a href="#fit-random-intercept-model" id="toc-fit-random-intercept-model" class="nav-link" data-scroll-target="#fit-random-intercept-model">Fit random intercept model</a>
  <ul class="collapse">
  <li><a href="#between-person-proportion-of-variance" id="toc-between-person-proportion-of-variance" class="nav-link" data-scroll-target="#between-person-proportion-of-variance">Between-Person Proportion of Variance</a></li>
  </ul></li>
  <li><a href="#lets-make-a-nice-table" id="toc-lets-make-a-nice-table" class="nav-link" data-scroll-target="#lets-make-a-nice-table">Let’s make a nice table</a></li>
  <li><a href="#fit-the-linear-effect-of-time-i.e.-week" id="toc-fit-the-linear-effect-of-time-i.e.-week" class="nav-link" data-scroll-target="#fit-the-linear-effect-of-time-i.e.-week">Fit the linear effect of time (i.e., <code>Week</code>)</a>
  <ul class="collapse">
  <li><a href="#plot-the-model-and-make-a-nice-table" id="toc-plot-the-model-and-make-a-nice-table" class="nav-link" data-scroll-target="#plot-the-model-and-make-a-nice-table">Plot the Model and Make a Nice Table</a></li>
  </ul></li>
  <li><a href="#add-the-quadratic-effect-of-week." id="toc-add-the-quadratic-effect-of-week." class="nav-link" data-scroll-target="#add-the-quadratic-effect-of-week.">Add the quadratic effect of <code>Week</code>.</a></li>
  <li><a href="#add-the-l1-time-covarying-predictor-meditation_hours-to-the-model" id="toc-add-the-l1-time-covarying-predictor-meditation_hours-to-the-model" class="nav-link" data-scroll-target="#add-the-l1-time-covarying-predictor-meditation_hours-to-the-model">Add the L1 time-covarying predictor, <code>meditation_hours</code> to the model</a></li>
  <li><a href="#add-the-predicted-interaction-of-week-and-meditation_hours." id="toc-add-the-predicted-interaction-of-week-and-meditation_hours." class="nav-link" data-scroll-target="#add-the-predicted-interaction-of-week-and-meditation_hours.">Add the predicted interaction of <code>Week</code> and <code>meditation_hours</code>.</a></li>
  <li><a href="#add-the-l2-predictor" id="toc-add-the-l2-predictor" class="nav-link" data-scroll-target="#add-the-l2-predictor">Add the L2 predictor</a>
  <ul class="collapse">
  <li><a href="#set-up-the-code" id="toc-set-up-the-code" class="nav-link" data-scroll-target="#set-up-the-code">Set up the Code</a></li>
  </ul></li>
  <li><a href="#add-random-slopes-for-level-1-predictors." id="toc-add-random-slopes-for-level-1-predictors." class="nav-link" data-scroll-target="#add-random-slopes-for-level-1-predictors.">Add random slopes for Level 1 predictors.</a></li>
  <li><a href="#add-hypothesized-interaction-terms" id="toc-add-hypothesized-interaction-terms" class="nav-link" data-scroll-target="#add-hypothesized-interaction-terms">Add hypothesized interaction terms</a></li>
  <li><a href="#add-2-way-interaction" id="toc-add-2-way-interaction" class="nav-link" data-scroll-target="#add-2-way-interaction">Add 2-way interaction</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>Longitudinal data analysis refers to the examination of how variables change over time, typically within individuals. Multilevel modeling allows us to study “unbalanced” longitudinal data in which not everyone has the same number of measurements.</p>
<p>In clustered data, the lowest level is typically a person, with higher levels referring to groups of people. With longitudinal data, the person is typically level 2, and level 1 is a measurement occasion associated with a specific instance in time.</p>
<p>With multilevel approaches to longitudinal data, data for each person fits on multiple rows with each measurement instance on its own row as seen in <a href="#tbl-data" class="quarto-xref">Table&nbsp;1</a>.</p>
<div id="tbl-data" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">person_id</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">x</th>
<th style="text-align: center;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Longitudinal data with multiple rows per person
</figcaption>
</figure>
</div>
<p>Specifying when the time variable equals 0 becomes increasingly important with complex longitudinal model because it influences the interpretation of other coefficients in the model. If there are interaction effects or polynomial effects, the lower-order effects refer to the effect of the variable when all other predictors are 0. Thus, we try to mark time such that <em>T</em><sub>0</sub> (when time = 0) is meaningful. For example, <em>T</em><sub>0</sub> is often simply the first measurement occasion. <em>T</em><sub>0</sub> could be the point at which an important event occurs, such as the onset of an intervention. In such cases, measurements before the intervention are marked as negative (<em>Time</em> = −3, −2, −1, 0, 1, 2, …).</p>
<p>Time does not have to be marked as integers, not everyone needs to be measured at the same times, and measurements do not necessarily need to occur at exactly <em>T</em><sub>0</sub>. For person 1, the measurements could be at <em>Time</em> = −2.1 minutes, +5.3 minutes, and +44.2 minutes. For person 2, the measurements could be at <em>Time</em> = −8.8 minutes, −6.0 minutes, +10.1 minutes, and +10.5 minutes.</p>
<section id="hypothetical-longitudinal-study-of-reading-comprehension" class="level1 page-columns page-full">
<h1>Hypothetical Longitudinal Study of Reading Comprehension</h1>
<p>Suppose we are measuring how schoolchildren’s reading comprehension changes over time. We believe that reading comprehension (understanding of the text’s meaning) is influenced by Reading Decoding skills (correct identification of words). If we measure Reading Decoding skill at each occasion, it is a time-varying covariate at level 1.</p>
<p>Suppose we believe that children’s working memory capacity also is an important influence on reading comprehension. If we only measure working memory capacity once (typically at the beginning of the study), working memory capacity is a person-level covariate at level 2. Of course, if we had measured working memory capacity at each measurement occasion, it would be an additional time-varying covariate at level 1.</p>
<p>For the sake of demonstration, I am going to present a model in which Working Memory Capacity not only influences the initial level of Reading Comprehension, but it also has every possible cross-level interaction effect. In a real analysis, we would only investigate such effects if we had good theoretical reasons for doing so. Testing for every possible effect just because we can will dramatically increase our risk of “finding” spurious effects.</p>
<section id="level-1-measurement-occasion" class="level2">
<h2 class="anchored" data-anchor-id="level-1-measurement-occasion">Level 1: Measurement Occasion</h2>
<p>Every time a person is measured, we will call this a <em>measurement occasion</em>. In longitudinal studies, each measurement occasion is placed in its own data row.</p>
<p><span class="math display">
\begin{align*}
Y_{ti}&amp;=b_{0i}+b_{1i}T_{ti}+b_{2i}RD_{ti}+e_{ti}\\
e_{ti}&amp;\sim\mathcal{N}(0, \tau_1^2)
\end{align*}
</span></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">Y_{ti}</span></td>
<td style="text-align: left;">The measure of Reading Comprehension for person <span class="math inline">i</span> at occasion (time) <span class="math inline">t</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">RD_{ti}</span></td>
<td style="text-align: left;">The measure of Reading Decoding at occasion <span class="math inline">t</span> for person <span class="math inline">i</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">T_{ti}</span></td>
<td style="text-align: left;">How much time has elapsed at occasion <span class="math inline">t</span> for person <span class="math inline">i</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">b_{0i}</span></td>
<td style="text-align: left;">The random intercept: The predicted Reading Comprehension for person <span class="math inline">i</span> at time 0 (<em>T</em><sub>0</sub>) if Reading Decoding = 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{1i}</span></td>
<td style="text-align: left;">The random slope of Time: The rate of increase in Reading Comprehension for person <span class="math inline">i</span> if Reading Decoding is held constant at 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">b_{2i}</span></td>
<td style="text-align: left;">The size of Reading Decoding’s association with Reading Comprehension for person <span class="math inline">i</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">e_{ti}</span></td>
<td style="text-align: left;">The deviation from expectations for Reading Comprehension at occasion <span class="math inline">t</span> for person <span class="math inline">i</span>. It represents the model’s failure to accurately predict Reading Comprehension at each measurement occasion.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\tau_1</span></td>
<td style="text-align: left;">The variance of <span class="math inline">e_{ti}</span></td>
</tr>
</tbody>
</table>
</section>
<section id="level-2-person" class="level2">
<h2 class="anchored" data-anchor-id="level-2-person">Level 2: Person</h2>
<section id="predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0" class="level3">
<h3 class="anchored" data-anchor-id="predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0">Predicting the Random Intercept <span class="math inline">(b_{0i})</span>: <br> What Determines the Conditions at <em>T</em><sub>0</sub>?</h3>
<p>If Time and Reading Decoding = 0, what determines our prediction of Reading Comprehension?</p>
<p><span class="math display">
b_{0i}=b_{00}+b_{01}WM_i+e_{0i}
</span></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{0i}</span></td>
<td style="text-align: left;">The random intercept: The predicted Reading Comprehension for person <span class="math inline">i</span> at time 0 (<em>T</em><sub>0</sub>) if Reading Decoding = 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">WM_i</span></td>
<td style="text-align: left;">The measurement of Working Memory Capacity for person <span class="math inline">i</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{00}</span></td>
<td style="text-align: left;">The predicted value of Reading Comprehension when Time, Reading Decoding, and Working Memory = 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">b_{01}</span></td>
<td style="text-align: left;">Working Memory’s association with Reading Comprehension at <em>T</em><sub>0</sub> when Reading Decoding is 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">e_{0i}</span></td>
<td style="text-align: left;">Person <span class="math inline">i</span>’s deviation from expectations for the random intercept. It represents the model’s failure to predict each person’s random intercept.</td>
</tr>
</tbody>
</table>
</section>
<section id="predicting-times-random-slope-what-determines-the-effect-of-time-grade" class="level3">
<h3 class="anchored" data-anchor-id="predicting-times-random-slope-what-determines-the-effect-of-time-grade">Predicting Time’s Random Slope: <br> What determines the effect of time (Grade)?</h3>
<p>Suppose we believe that Reading Comprehension will, on average, increase over time for everyone, but the rate of increase will be faster for children with greater working memory capacity.</p>
<p><span class="math display">
b_{1i}=b_{10}+b_{11}WM_i+e_{1i}
</span></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{1i}</span></td>
<td style="text-align: left;">The random slope of Time: The rate of increase in Reading Comprehension for person <span class="math inline">i</span> if Reading Decoding is held constant at 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">b_{10}</span></td>
<td style="text-align: left;">The rate at which Reading Comprehension increases for each unit of time if both Reading Decoding and Working Memory are held constant at 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{11}</span></td>
<td style="text-align: left;">Working Memory’s effect on the rate of Reading Comprehension’s change over time, after controlling for Reading Decoding (i.e., if Reading Decoding were held constant at 0). If positive, students with higher working memory should improve their Reading Comprehension ability faster than students with lower working memory.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">e_{1i}</span></td>
<td style="text-align: left;">Person <span class="math inline">i</span>’s the deviation from expectations for the random slope for time. It represents the model’s failure to predict each person’s rate of increase in Reading Comprehension over time (after controlling for Reading Decoding).</td>
</tr>
</tbody>
</table>
</section>
<section id="predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding" class="level3">
<h3 class="anchored" data-anchor-id="predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding">Predicting Reading Decoding’s Random Slope: <br> What determines the effect of Reading Decoding?</h3>
<p>Suppose that the effect of Reading Decoding on Reading Comprehension differs from person to person. Obviously, to comprehend text a person needs at least some ability to decode words. However, there is evidence that working memory helps a person make inferences in reading comprehension such that one can work around unfamiliar words and still derive meaning from the text. Thus, we might predict that higher Working Memory Capacity makes Reading Decoding a less important predictor of Reading Comprehension.</p>
<p><span class="math display">
b_{2i}=b_{20}+b_{21}WM_i+e_{2i}
</span></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{2i}</span></td>
<td style="text-align: left;">The size of Reading Decoding’s association with Reading Comprehension for person <span class="math inline">i</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">b_{20}</span></td>
<td style="text-align: left;">The size of the association of Reading Decoding and Reading Comprehension when Working Memory is 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">b_{21}</span></td>
<td style="text-align: left;">The interaction effect of Working Memory and Reading Decoding. It represents how much the effect of Reading Decoding on Reading Comprehension changes for each unit of increase in Working Memory.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">e_{2i}</span></td>
<td style="text-align: left;">Person <span class="math inline">i</span>’s the deviation from expectations for the random slope for Reading Decoding. It represents the model’s failure to predict the person-specific relationship between Reading Decoding and Reading Comprehension.</td>
</tr>
</tbody>
</table>
</section>
<section id="level-2-random-effects" class="level3">
<h3 class="anchored" data-anchor-id="level-2-random-effects">Level-2 Random Effects</h3>
<p>The error terms at level 2 (<span class="math inline">e_{0i}, e_{1i}, \&amp;~e_{2i}</span>) have variances, and possibly covariances.</p>
<p><span class="math display">
\begin{align*}
\boldsymbol{e}_2&amp;=
\begin{bmatrix}
e_{0i}\\
e_{1i}\\
e_{2i}
\end{bmatrix}\\
\boldsymbol{e}_2&amp;\sim\mathcal{N}\left(\boldsymbol{0},\boldsymbol{\tau}_2\right)\\
\boldsymbol{\tau}_2&amp;=
\begin{bmatrix}
\tau_{2.00}\\
\tau_{2.10} &amp; \tau_{2.11}\\
\tau_{2.20} &amp; \tau_{2.21} &amp; \tau_{2.22}
\end{bmatrix}
\end{align*}
</span></p>
</section>
</section>
<section id="combined-equations" class="level2">
<h2 class="anchored" data-anchor-id="combined-equations">Combined Equations</h2>
<p><span class="math display">
\begin{align}
Y_{ti}&amp;=
\underbrace{b_{00}+b_{01}WM_i+u_{0i}}_{b_{0i}~\text{(Random Intercept)}}\\
&amp;+(\underbrace{b_{10}+b_{11}WM_i+u_{1i}}_{b_{1i}~\text{(Random Slope for Time)}})T_{ti}\\
&amp;+(\underbrace{b_{20}+b_{21}WM_i+u_{2i}}_{b_{2i}~\text{(Random Slope for RD)}})RD_{ti}\\
&amp;+e_{ti}
\end{align}
</span></p>
<p>An equation aligned to the lmer formula:</p>
<p><span class="math display">
\begin{align}
Y_{ti}&amp;=b_{00}\\
&amp;+\underbrace{b_{01}WM_i+b_{10}T_{ti}+b_{20}RD_{ti}}_{\text{Simple Slopes (when other predictors = 0)}}\\
&amp;+\underbrace{b_{11}T_{ti}WM_i+b_{21}RD_{ti}WM_i}_{\text{Interactions}}\\
&amp;+\underbrace{e_{0i}+e_{1i}T_{ti}+e_{2i}RD_{ti}}_{\text{L2 Random Effects}}\\
&amp;+e_{ti}
\end{align}
</span></p>
<p>Here is the model as a <code>lmer</code> formula:</p>
<pre><code>reading_comprehension~1+
working_memory+time+reading_decoding+
time:working_memory+reading_decoding:working_memory+
(1+time+reading_decoding | person_id)</code></pre>
<p>A simplified version would look like this:</p>
<pre><code>reading_comprehension~
working_memory * time + 
working_memory * reading_decoding +
(time+reading_decoding | person_id)</code></pre>
</section>
<section id="simulate-longitudinal-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulate-longitudinal-data">Simulate longitudinal data</h2>
<p>I am going to simulate a longitudinal observational study of these three variables.</p>
<p>To make things simple, suppose that Reading Decoding also grows over time like so:</p>
<p><span class="math display">
RD_{ti}=6+2T_{ti}+.5WM_{ti}+e_{ti}\\
e\sim\mathcal{N}(0, 1^2)
</span></p>
<section id="simulate-level-2-data-person-level" class="level3">
<h3 class="anchored" data-anchor-id="simulate-level-2-data-person-level">Simulate Level-2 Data (Person Level)</h3>
<p>We begin at level 2 by setting the sample size, the fixed effects, the level-2 random effect covariance matrix <span class="math inline">(\boldsymbol{\tau})</span>, and</p>
<p>We can simulate Working Memory Capacity as a standard normal variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of occasions</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>n_occasions <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effects</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>b_00 <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="co"># Fixed intercept</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>b_01 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># simple main effect of working memory</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>b_10 <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># simple main effect of time (Grade)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>b_11 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># time * working memory interaction</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>b_20 <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># simple main effect of reading decoding</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>b_21 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9</span> <span class="co"># reading decoding * working memory interaction</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard deviations of level-2 random effects</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>e_sd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">e_0i =</span> <span class="dv">50</span>, <span class="co"># sd of random intercept</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">e_1i =</span> <span class="fl">1.7</span>, <span class="co"># sd of random slope for time</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">e_2i =</span> <span class="fl">1.8</span>) <span class="co"># sd of random slope for reading decoding</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlations among level-2 random effects</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>e_cor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>           <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>           <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  lavaan<span class="sc">::</span><span class="fu">lav_matrix_lower2full</span>(.)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># level-2 random effects covariance matrix</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>tau_2 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cor2cov</span>(<span class="at">R =</span> e_cor, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sds =</span> e_sd, </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">names</span>(e_sd))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate level-2 random effects</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>e_2 <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n_person, </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean =</span> <span class="fu">c</span>(<span class="at">e_0i =</span> <span class="dv">0</span>, <span class="at">e_1i =</span> <span class="dv">0</span>, <span class="at">e_2i =</span> <span class="dv">0</span>), </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sigma =</span> tau_2) <span class="sc">%&gt;%</span> </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate level-2 data and coefficients</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>d_level2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">person_id =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span>n_person),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_occasions =</span> n_occasions,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">working_memory =</span> <span class="fu">rnorm</span>(n_person)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(e_2) <span class="sc">%&gt;%</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0i =</span> b_00 <span class="sc">+</span> b_01 <span class="sc">*</span> working_memory <span class="sc">+</span> e_0i,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1i =</span> b_10 <span class="sc">+</span> b_11 <span class="sc">*</span> working_memory <span class="sc">+</span> e_1i,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_2i =</span> b_20 <span class="sc">+</span> b_21 <span class="sc">*</span> working_memory <span class="sc">+</span> e_2i)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>d_level2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 9
   person_id n_occasions working_memory   e_0i    e_1i    e_2i  b_0i  b_1i  b_2i
   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 1                   6        -1.22    41.7  -0.469  -0.639   89.5  43.4  8.46
 2 2                   6         1.20     4.37  3.83    1.50    76.3  59.8  8.43
 3 3                   6        -0.956   65.6   4.25    2.10   116.   49.5 11.0 
 4 4                   6        -0.746  -21.3  -1.69   -2.01    31.2  44.6  6.67
 5 5                   6        -1.64    -2.79  2.00    1.90    40.9  43.8 11.4 
 6 6                   6        -0.0452   2.88 -1.25    1.67    62.4  48.5  9.72
 7 7                   6        -0.933   83.4   0.951  -1.36   134.   46.3  7.48
 8 8                   6        -0.291   62.8   0.0654  0.341  120.   48.6  8.60
 9 9                   6         1.36    23.1  -0.727   0.0299  96.7  56.1  6.81
10 10                  6         0.311   35.2   1.65   -1.12    98.4  53.2  6.60
# ℹ 1,990 more rows</code></pre>
</div>
</div>
</section>
<section id="simulate-level-1-data-occasion-level" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="simulate-level-1-data-occasion-level">Simulate Level-1 Data (Occasion Level)</h3>
<p>Let’s say that our measurement of our level-1 variables occurs at the beginning of each Grade starting in Kindergarten (i.e., Grade 0) and continues every year until fifth grade. Our measurement of working memory capacity occurs once—at the beginning of Kindergarten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># level-1 sd</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tau_1 <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>d_level1 <span class="ot">&lt;-</span> d_level2 <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uncount</span>(n_occasions) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Grade =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="dv">1</span>, <span class="at">.by =</span> person_id) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">reading_decoding =</span> <span class="dv">6</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> Grade <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> working_memory <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>()),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">e_ti =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(tau_1)),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">reading_comprehension =</span> b_0i <span class="sc">+</span> b_1i <span class="sc">*</span> Grade <span class="sc">+</span> b_2i <span class="sc">*</span> reading_decoding <span class="sc">+</span> e_ti</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Grade, reading_comprehension) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person_id =</span> <span class="fu">fct_inorder</span>(person_id)) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(person_id, Grade)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>d_level1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,000 × 12
   person_id working_memory  e_0i  e_1i   e_2i   b_0i  b_1i  b_2i Grade
   &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     0
 2 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     1
 3 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     2
 4 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     3
 5 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     4
 6 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     5
 7 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     0
 8 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     1
 9 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     2
10 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     3
# ℹ 11,990 more rows
# ℹ 3 more variables: reading_decoding &lt;dbl&gt;, e_ti &lt;dbl&gt;,
#   reading_comprehension &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Notes on the code from above:</p>
<table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Code</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>uncount(n_occasions)</code></td>
<td style="text-align: left;">Make copies of each row in <code>d_level2</code> according to what value is in <code>n_occasions</code>, which in this case is 6 in every row. Thus, the 6 copies of each row <code>d_level2</code> are made.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>mutate(Grade = row_number() - 1), .by = person_id</code></td>
<td style="text-align: left;">Create a variable called <code>Grade</code> by taking the row number of each group defined by <code>person_id</code> and subtract 1. Because there are 6 rows per person, the values within each person will be 0, 1, 2, 3, 4, 5</td>
</tr>
</tbody>
</table>
<p>If the data were real, and I wanted to test the hypothesized model, I would run this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> working_memory  <span class="sc">+</span> reading_decoding<span class="sc">*</span>working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1 ) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * working_memory + reading_decoding *  
    working_memory + ((1 | person_id) + (0 + Grade | person_id) +  
    (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109220.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3829 -0.5871 -0.0044  0.5850  3.0921 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.172 49.600  
 person_id.1 Grade               2.241  1.497  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.953 14.932  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                Estimate Std. Error t value
(Intercept)                      60.7239     1.4854  40.880
Grade                            50.1376     0.3272 153.240
working_memory                   10.7375     1.4716   7.296
reading_decoding                  7.9683     0.1640  48.599
Grade:working_memory              5.5824     0.3233  17.265
working_memory:reading_decoding  -1.0912     0.1620  -6.734

Correlation of Fixed Effects:
            (Intr) Grade  wrkng_ rdng_d Grd:w_
Grade        0.587                            
workng_mmry  0.045  0.043                     
redng_dcdng -0.621 -0.932 -0.039              
Grd:wrkng_m  0.042 -0.010  0.584  0.012       
wrkng_mmr:_ -0.039  0.012 -0.619 -0.018 -0.931</code></pre>
</div>
</div>
<p><a href="#fig-plotmodel" class="quarto-xref">Figure&nbsp;1</a> plots the observed data, in which we can see that both reading decoding and reading comprehension increase across grade and that high working memory is associated with higher levels of the reading variables.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_level1, <span class="fu">aes</span>(reading_decoding, reading_comprehension, <span class="at">color =</span> working_memory)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Grade), <span class="at">as.table =</span> F, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="st">"Working</span><span class="sc">\n</span><span class="st">Memory</span><span class="sc">\n</span><span class="st">Capacity"</span>, <span class="at">mid =</span> <span class="st">"gray80"</span>, <span class="at">low =</span> <span class="st">"royalblue"</span>, <span class="at">high =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reading Decoding"</span>, <span class="at">y =</span> <span class="st">"Reading Comprehension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotmodel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-plotmodel-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plotmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Reading Decoding Predicting
</figcaption>
</figure>
</div>
</div>
</div>
<p>These effects might be easier to see in an animated plot like <a href="#fig-plotmodel2" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_level1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Grade =</span> <span class="fu">factor</span>(Grade)), <span class="fu">aes</span>(reading_decoding, reading_comprehension, <span class="at">color =</span> working_memory)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(rows = vars(Grade), as.table = F, labeller = label_both) +</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="st">"Working</span><span class="sc">\n</span><span class="st">Memory</span><span class="sc">\n</span><span class="st">Capacity"</span>, <span class="at">mid =</span> <span class="st">"gray80"</span>, <span class="at">low =</span> <span class="st">"royalblue"</span>, <span class="at">high =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Reading Decoding"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Reading Comprehension"</span>) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(Grade) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Grade: {closest_state}'</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotmodel2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotmodel2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-plotmodel2-1.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plotmodel2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Reading Decoding Predicting
</figcaption>
</figure>
</div>
</div>
</div>
<p>If you need to plot interaction effects, and you want to make your life much, much easier, use the <a href="https://strengejacke.github.io/sjPlot/articles/plot_interactions.html"><code>plot_model</code> function from the sjPlot package</a>.</p>
<p>In the <code>terms</code> parameter of the <code>plot_model</code> function, the first term is what goes on the x-axis. The second term is the moderator variable that shows up as lines with different colors. By default, it plots values at plus or minus 1 standard deviation, but you can specify any values you wish.</p>
<p>In <a href="#fig-wm" class="quarto-xref">Figure&nbsp;3</a>, it can be seen that reading decoding is related to reading comprehension but the strength of that relation depends on working memory. The effects of reading decoding are increasingly strong as working memory decreases.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple slopes of reading decoding at different levels of working memory (collapsing across grade)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_decoding"</span>, <span class="st">"working_memory [-1, 0, 1]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-wm" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-wm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-wm-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-wm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Effects of Reading Decoding Are Moderated by Working Memory
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another way to think about the interaction is to say that for poor decoders working memory strongly predicts reading comprehension. By contrast, for strong decoders, working memory is a weak predictor. In <a href="#fig-dc" class="quarto-xref">Figure&nbsp;4</a>, we are viewing the same interaction seen <a href="#fig-wm" class="quarto-xref">Figure&nbsp;3</a> but we have flipped the x-axis and the color-facet. There is no new information here, but it helps to see the finding from different vantage points.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple slopes of working memory at different levels of reading decoding (collapsing across grade)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"working_memory"</span>, <span class="st">"reading_decoding [0, 10, 20]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-dc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-dc-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The Effects of Working Memory Depend on Reading Decoding
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-gradedc" class="quarto-xref">Figure&nbsp;5</a>, we can view the simple slopes of reading decoding at different levels of grade (collapsing across working memory). Because the simple slopes are parallel, it appears that the effect of reading decoding is constant across grades.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_decoding"</span>, <span class="st">"Grade"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-gradedc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gradedc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-gradedc-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gradedc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: The Effects of Reading Decoding at Different Grades
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-gradewm" class="quarto-xref">Figure&nbsp;6</a>, we see that reading comprehension grows faster for students with higher working memory than for students with lower working memory.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Grade"</span>, <span class="st">"working_memory [-1, 0, 1]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-gradewm" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gradewm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-gradewm-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gradewm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: The Growth of Reading Comprehension Across Grade at Different Levels of Working Memory
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-dcwmgrade" class="quarto-xref">Figure&nbsp;7</a>, we see the effects of reading decoding, working memory, and grade simultaneously. It appears that reading decoding’s effect is stronger for students with lower working memory but that the effect of working memory becomes increasingly strong across grades.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show simple slopes of reading decoding at different levels of grade and working memory</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_decoding"</span>, <span class="st">"working_memory [-1, 0, 1]"</span>, <span class="st">"Grade [0:5]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-dcwmgrade" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dcwmgrade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-dcwmgrade-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dcwmgrade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: The Effect of Reading Decoding on Reading Comprehensionat Different Levels of Working Memory and Grade
</figcaption>
</figure>
</div>
</div>
</div>
<p>I can’t tell you how much trouble functions like <code>plot_model</code> will save you. I don’t care to admit how many hours of my life have been spent making interaction plots. Of course, ggplot2 made my coding experience much simpler than it used to to be. I mainly use sjPlot to make quick plots. If I needed to make a publication-ready plot, I would probably use code like <a href="#fig-pubworthy" class="quarto-xref">Figure&nbsp;8</a>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predicted values at each unique combination of predictor variables</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>d_predicted <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">Grade =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">working_memory =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">reading_decoding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">reading_comprehension =</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> ., <span class="at">re.form =</span> <span class="cn">NA</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">working_memory =</span> <span class="fu">factor</span>(working_memory,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"High (+1 SD)"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"Mean"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"Low (-1 SD)"</span>)))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_predicted,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> reading_decoding, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> reading_comprehension, </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> working_memory)) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> working_memory), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Grade), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">label_bquote</span>(<span class="at">cols =</span> Grade <span class="sc">~</span> .(Grade))) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Working Memory"</span>, </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick4"</span>, <span class="st">"gray30"</span>, <span class="st">"royalblue4"</span>)) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reading Decoding"</span>, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reading Comprehension"</span>) <span class="sc">+</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Predicted Values of Reading Comprehension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pubworthy" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pubworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-pubworthy-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pubworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: The Effects of Reading Decoding on Reading Comprehension by Working Memory Capacity Across Grades
</figcaption>
</figure>
</div>
</div>
</div>
<p>Also from the sjPlot package, an attractive table:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-fit" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.81&nbsp;–&nbsp;63.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.50&nbsp;–&nbsp;50.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.65&nbsp;–&nbsp;8.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.95</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.17</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Model Results
</figcaption>
</figure>
</div>
</div>
</section>
</section>
</section>
<section id="complete-analysis-walkthrough" class="level1 page-columns page-full">
<h1>Complete Analysis Walkthrough</h1>
<p>Okay, suppose that we had no idea how the simulated data were generated. Imagine that we are researchers who collected the data rather than the people who simulated it. However, we hypothesized the model with which the data were simulated. Of course, we can go straight to testing the hypothesized model, but generally we start with the null model and build from there.</p>
<section id="model-building-plan" class="level2">
<h2 class="anchored" data-anchor-id="model-building-plan">Model Building Plan</h2>
<p>The sequence of model building is the same but at every step, start with the time variable (Grade in this case). This sequence is a suggestion only.</p>
<ul>
<li>Null Model (Random Intercepts)</li>
<li>Level 1 Fixed Effects
<ul>
<li>Time (as many polynomial terms as you hypothesized you would need)
<ul>
<li>Linear (Time)</li>
<li>Quadratic (Time + Time ^ 2)</li>
<li>Cubic (Time + Time ^ 2 + Time ^ 3)</li>
<li>Quartic (Time + Time ^ 2 + Time ^ 3 + Time ^ 4)</li>
<li>You can keep going but consider alternatives to polynomials like <a href="https://people.maths.bris.ac.uk/~sw15190/mgcv/">Generalized Additive Mixed Models</a>.</li>
</ul></li>
<li>Other level-1 time-varying covariates</li>
<li>Interactions of time-varying covariates with Time</li>
<li>Interactions of time-varying covariates with each other</li>
</ul></li>
<li>Level-2 Fixed Effects
<ul>
<li>Main effects of level-2 covariates</li>
<li>Interactions among level-2 covariates</li>
</ul></li>
<li>Level 1 Random Slopes
<ul>
<li>Time’s random slope
<ul>
<li>Uncorrelated with random intercepts</li>
<li>Correlated with random intercepts</li>
</ul></li>
<li>Other level-1 random slopes
<ul>
<li>Uncorrelated with random intercepts</li>
<li>Correlated with random intercepts</li>
</ul></li>
<li>Interactions of random slopes
<ul>
<li>These models are pretty unlikely to converge, but it is up to you.</li>
</ul></li>
</ul></li>
<li>Cross-Level Interactions
<ul>
<li>Interaction of level-2 covariates with Time</li>
<li>Interaction of level-2 covariates with level-1 time-varying covariates</li>
</ul></li>
</ul>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="null-model" class="level2">
<h2 class="anchored" data-anchor-id="null-model">Null Model</h2>
<p>Let’s start where we always start, with no predictors except the random intercept variable. In this case it refers to the person-level intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit_null <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 150425.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.3787 -0.7944 -0.0162  0.7785  2.8396 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept)   630.6   25.11  
 Residual              15707.2  125.33  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
            Estimate Std. Error t value
(Intercept)  273.644      1.274   214.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">273.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">271.15&nbsp;–&nbsp;276.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">15707.18</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">630.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.039</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |    RMSE |   Sigma
---------------------------------------------------------------------------------------
1.504e+05 | 1.504e+05 | 1.505e+05 |      0.039 |      0.000 | 0.039 | 123.280 | 125.328</code></pre>
</div>
</div>
<p>Here we see that the R2-conditional is 0.04, which is the proportion of variance explained by the entire model. Because the model has only the random intercept as a predictor, it represents the proportion of variance explained by the random intercept (i.e., between-persons variance).</p>
</section>
<section id="linear-effect-of-time-grade" class="level2">
<h2 class="anchored" data-anchor-id="linear-effect-of-time-grade">Linear Effect of Time (Grade)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fit_time <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 113425.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3829 -0.6085 -0.0069  0.6017  3.6388 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3183.8   56.42   
 Residual               388.3   19.70   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
            Estimate Std. Error t value
(Intercept) 108.2498     1.3014   83.18
Grade        66.1577     0.1053  628.12

Correlation of Fixed Effects:
      (Intr)
Grade -0.202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">108.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">105.70&nbsp;–&nbsp;110.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">66.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">65.95&nbsp;–&nbsp;66.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">388.28</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3183.78</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.89</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.781 / 0.976</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.134e+05 | 1.134e+05 | 1.135e+05 |      0.976 |      0.781 | 0.891 | 18.023 | 19.705</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade (formula: reading_comprehension ~ 1
+ Grade). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.78. The model's intercept, corresponding to Grade = 0, is at 108.25 (95% CI
[105.70, 110.80], t(11996) = 83.18, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 66.16,
95% CI [65.95, 66.36], t(11996) = 628.12, p &lt; .001; Std. beta = 0.88, 95% CI
[0.88, 0.89])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>The effect of time (Grade) is very large. The R2_marginal is 0, which is the proportion of variance explained by all the fixed effects, which in this case is <code>Grade</code>.</p>
<p>It is easy to predict that <code>fit_time</code> will be a better model than <code>fit_null</code>, but let’s run the code anyway:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_null, fit_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_null: reading_comprehension ~ 1 + (1 | person_id)
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
         npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
fit_null    3 150434 150456 -75214   150428                        
fit_time    4 113433 113463 -56713   113425 37002  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_null, fit_time, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     |   Model | R2 (cond.) | R2 (marg.) |   ICC |    RMSE |   Sigma
------------------------------------------------------------------------
fit_time | lmerMod |      0.976 |      0.781 | 0.891 |  18.023 |  19.705
fit_null | lmerMod |      0.039 |      0.000 | 0.039 | 123.280 | 125.328

Name     | AIC weights | AICc weights | BIC weights | Performance-Score
-----------------------------------------------------------------------
fit_time |        1.00 |         1.00 |        1.00 |           100.00%
fit_null |    0.00e+00 |     0.00e+00 |    0.00e+00 |             0.00%</code></pre>
</div>
</div>
<p>As expected, the <code>fit_time</code> model fits better than the <code>fit_null</code> model.</p>
</section>
<section id="quadratic-effect-of-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="quadratic-effect-of-time">Quadratic effect of Time</h2>
<p>We did not have a hypothesis about whether time (Grade) would have a linear effect. Let’s see if we need a quadratic effect. We can construct a quadratic effect by using the <code>poly</code> function with a degree of 2. By default, it creates orthogonal polynomials (i.e., uncorrelated). Often raw polynomials are so highly correlated that they cannot be in the same regression formula. If you need raw polynomials (i.e., Grade and Grade squared), then specify <code>poly(Grade, 2, raw = T)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_time_quadratic <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">poly</span>(Grade, <span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_time_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + poly(Grade, 2) + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 113407.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3812 -0.6088 -0.0071  0.6023  3.6401 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3183.8   56.42   
 Residual               388.3   19.71   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                 Estimate Std. Error t value
(Intercept)       273.644      1.274 214.714
poly(Grade, 2)1 12376.970     19.706 628.087
poly(Grade, 2)2    -2.301     19.706  -0.117

Correlation of Fixed Effects:
            (Intr) p(G,2)1
ply(Grd,2)1 0.000         
ply(Grd,2)2 0.000  0.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_time_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">273.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">271.15&nbsp;–&nbsp;276.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade [1st degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12376.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12338.34&nbsp;–&nbsp;12415.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade [2nd degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-40.93&nbsp;–&nbsp;36.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.907</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">388.32</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3183.77</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.89</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.781 / 0.976</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_time_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.134e+05 | 1.134e+05 | 1.135e+05 |      0.976 |      0.781 | 0.891 | 18.023 | 19.706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_time_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade (formula: reading_comprehension ~ 1
+ poly(Grade, 2)). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.78. The model's intercept, corresponding to Grade = 0, is at 273.64 (95% CI
[271.15, 276.14], t(11995) = 214.71, p &lt; .001). Within this model:

  - The effect of Grade [1st degree] is statistically significant and positive
(beta = 12376.97, 95% CI [12338.34, 12415.60], t(11995) = 628.09, p &lt; .001;
Std. beta = 96.83, 95% CI [96.53, 97.13])
  - The effect of Grade [2nd degree] is statistically non-significant and
negative (beta = -2.30, 95% CI [-40.93, 36.33], t(11995) = -0.12, p = 0.907;
Std. beta = -0.02, 95% CI [-0.32, 0.28])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare linear and quadratic models</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_time, fit_time_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
fit_time_quadratic: reading_comprehension ~ 1 + poly(Grade, 2) + (1 | person_id)
                   npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_time              4 113433 113463 -56713   113425                     
fit_time_quadratic    5 113435 113472 -56713   113425 0.0136  1      0.907</code></pre>
</div>
</div>
<p>No effect! We could add a third-order polynomial (i.e., the effect of Grade to the third power), but we did not hypothesize such an effect. Let’s stick with the linear effect of time.</p>
<p>If we plot our data, we get this:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_level1, <span class="fu">aes</span>(Grade, reading_comprehension, <span class="at">color =</span> person_id)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> person_id), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plottime" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plottime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-plottime-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plottime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Linear Effects of Time on Reading Comprehension
</figcaption>
</figure>
</div>
</div>
</div>
<p>It looks like the effect of time really is linear.</p>
</section>
<section id="fixed-effect-of-reading-decoding-level-1-time-varying-covariate" class="level2">
<h2 class="anchored" data-anchor-id="fixed-effect-of-reading-decoding-level-1-time-varying-covariate">Fixed effect of reading decoding (level 1 time-varying covariate)</h2>
<p>Unsurprisingly, reading decoding is a predictor of reading comprehension:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_decoding <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111582.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3167 -0.6144 -0.0032  0.6033  3.5148 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3044     55.18   
 Residual               326     18.05   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                 Estimate Std. Error t value
(Intercept)       59.7447     1.6669   35.84
Grade             50.0036     0.3731  134.03
reading_decoding   8.0665     0.1800   44.83

Correlation of Fixed Effects:
            (Intr) Grade 
Grade        0.590       
redng_dcdng -0.649 -0.966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">59.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">56.48&nbsp;–&nbsp;63.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.27&nbsp;–&nbsp;50.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">8.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.71&nbsp;–&nbsp;8.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325.96</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3044.37</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.792 / 0.980</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.116e+05 | 1.116e+05 | 1.116e+05 |      0.980 |      0.792 | 0.903 | 16.509 | 18.054</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade + reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 59.74 (95% CI
[56.48, 63.01], t(11995) = 35.84, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 50.00,
95% CI [49.27, 50.73], t(11995) = 134.03, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 8.07, 95% CI [7.71, 8.42], t(11995) = 44.82, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with linear effect of time</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_time, fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
fit_decoding: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
             npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_time        4 113433 113463 -56713   113425                         
fit_decoding    5 111590 111627 -55790   111580 1844.9  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_time, fit_decoding, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name         |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
--------------------------------------------------------------------------
fit_decoding | lmerMod |      0.980 |      0.792 | 0.903 | 16.509 | 18.054
fit_time     | lmerMod |      0.976 |      0.781 | 0.891 | 18.023 | 19.705

Name         | AIC weights | AICc weights | BIC weights | Performance-Score
---------------------------------------------------------------------------
fit_decoding |        1.00 |         1.00 |        1.00 |           100.00%
fit_time     |    0.00e+00 |     0.00e+00 |    0.00e+00 |             0.00%</code></pre>
</div>
</div>
<p>The <em>t</em> value of the fixed effect of reading_decoding is huge. It is significant. The model comparisons with <code>fit_time</code> suggests that <code>fit_decoding</code> is clearly preferred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade + reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 59.74 (95% CI
[56.48, 63.01], t(11995) = 35.84, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 50.00,
95% CI [49.27, 50.73], t(11995) = 134.03, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 8.07, 95% CI [7.71, 8.42], t(11995) = 44.82, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_decoding, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_decoding"</span>, <span class="st">"Grade [0:5]"</span>),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"The Effect of Reading Decoding on Reading Comprehension</span><span class="sc">\n</span><span class="st"> at Different Grades"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="longitudinal_files/figure-html/plotfit_decoding-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="level-1-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="level-1-interaction-effects">Level-1 interaction effects</h2>
<p>Let’s see if the effect of reading decoding depends on Grade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fit_decoding_x_Grade <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_decoding_x_Grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111552.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3295 -0.6159  0.0036  0.6114  3.4131 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3044.3   55.18   
 Residual               324.9   18.02   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            63.70831    1.79477  35.497
Grade                  47.97522    0.50605  94.803
reading_decoding        7.61071    0.19540  38.950
Grade:reading_decoding  0.18358    0.03099   5.924

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d
Grade        0.150              
redng_dcdng -0.700 -0.387       
Grd:rdng_dc  0.372 -0.677 -0.393</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_decoding_x_Grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">63.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.19&nbsp;–&nbsp;67.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">47.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">46.98&nbsp;–&nbsp;48.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.23&nbsp;–&nbsp;7.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12&nbsp;–&nbsp;0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">324.86</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3044.29</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.792 / 0.980</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_decoding_x_Grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.116e+05 | 1.116e+05 | 1.116e+05 |      0.980 |      0.792 | 0.904 | 16.480 | 18.024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_decoding_x_Grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade * reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 63.71 (95% CI
[60.19, 67.23], t(11994) = 35.50, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 47.98,
95% CI [46.98, 48.97], t(11994) = 94.80, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.61, 95% CI [7.23, 7.99], t(11994) = 38.95, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.18, 95% CI [0.12, 0.24], t(11994) = 5.92, p &lt; .001; Std.
beta = 8.83e-03, 95% CI [5.91e-03, 0.01])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_decoding, fit_decoding_x_Grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_decoding: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
fit_decoding_x_Grade: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
                     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_decoding            5 111590 111627 -55790   111580                     
fit_decoding_x_Grade    6 111557 111602 -55773   111545 35.044  1  3.224e-09
                        
fit_decoding            
fit_decoding_x_Grade ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_decoding, fit_decoding_x_Grade, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                 |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE
-------------------------------------------------------------------------
fit_decoding_x_Grade | lmerMod |      0.980 |      0.792 | 0.904 | 16.480
fit_decoding         | lmerMod |      0.980 |      0.792 | 0.903 | 16.509

Name                 |  Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------------------
fit_decoding_x_Grade | 18.024 |       1.000 |        1.000 |       1.000 |           100.00%
fit_decoding         | 18.054 |    6.68e-08 |     6.68e-08 |    2.69e-06 |             0.00%</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_decoding_x_Grade, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Grade [0:5]"</span>, <span class="st">"reading_decoding"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="longitudinal_files/figure-html/plotfit_decoding_x_Grade-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>So the interaction effect is present, but tiny.</p>
</section>
<section id="level-2-covariate-working-memory" class="level2">
<h2 class="anchored" data-anchor-id="level-2-covariate-working-memory">Level-2 covariate: working memory</h2>
<p>As seen below, the effect of working memory is statistically significant, meaning that students with higher working memory tend to have better reading comprehension.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>fit_working <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111443

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3005 -0.6165  0.0010  0.6123  3.4503 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 2884.8   53.71   
 Residual               324.8   18.02   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            64.19123    1.77295  36.206
Grade                  48.24408    0.50670  95.212
reading_decoding        7.47852    0.19581  38.193
working_memory         12.67919    1.20755  10.500
Grade:reading_decoding  0.18332    0.03099   5.916

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.153                     
redng_dcdng -0.709 -0.389              
workng_mmry  0.029  0.054 -0.068       
Grd:rdng_dc  0.377 -0.676 -0.392 -0.001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">64.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72&nbsp;–&nbsp;67.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">47.25&nbsp;–&nbsp;49.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.09&nbsp;–&nbsp;7.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.31&nbsp;–&nbsp;15.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12&nbsp;–&nbsp;0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">324.84</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2884.79</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.803 / 0.980</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.115e+05 | 1.115e+05 | 1.115e+05 |      0.980 |      0.803 | 0.899 | 16.481 | 18.023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.80. The model's intercept, corresponding to Grade = 0, reading_decoding = 0
and working_memory = 0, is at 64.19 (95% CI [60.72, 67.67], t(11993) = 36.21, p
&lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 48.24,
95% CI [47.25, 49.24], t(11993) = 95.21, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.48, 95% CI [7.09, 7.86], t(11993) = 38.19, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 12.68, 95% CI [10.31, 15.05], t(11993) = 10.50, p &lt; .001; Std. beta = 0.10,
95% CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.18, 95% CI [0.12, 0.24], t(11993) = 5.92, p &lt; .001; Std.
beta = 8.81e-03, 95% CI [5.89e-03, 0.01])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_decoding_x_Grade, fit_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_decoding_x_Grade: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
fit_working: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + (1 | person_id)
                     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_decoding_x_Grade    6 111557 111602 -55773   111545                     
fit_working             7 111452 111504 -55719   111438 107.46  1  &lt; 2.2e-16
                        
fit_decoding_x_Grade    
fit_working          ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_decoding_x_Grade, fit_working, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                 |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE
-------------------------------------------------------------------------
fit_working          | lmerMod |      0.980 |      0.803 | 0.899 | 16.481
fit_decoding_x_Grade | lmerMod |      0.980 |      0.792 | 0.904 | 16.480

Name                 |  Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------------------
fit_working          | 18.023 |        1.00 |         1.00 |        1.00 |            75.00%
fit_decoding_x_Grade | 18.024 |    1.26e-23 |     1.26e-23 |    5.06e-22 |            25.00%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_working, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"working_memory [-2, 2]"</span>, <span class="st">"reading_decoding"</span>, <span class="st">"Grade [0:5]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="longitudinal_files/figure-html/fit_working-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="level-1-random-slope-grade" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-slope-grade">Level-1 random slope: Grade</h2>
<p>As seen below, letting the slope of Grade be random improves the fit of the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fit_grade_random_uncorrelated <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_grade_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    ((1 | person_id) + (0 + Grade | person_id))
   Data: d_level1

REML criterion at convergence: 110049.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2898 -0.5710 -0.0043  0.5689  3.2100 

Random effects:
 Groups      Name        Variance Std.Dev.
 person_id   (Intercept) 2647.26  51.452  
 person_id.1 Grade         28.63   5.351  
 Residual                 226.98  15.066  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            61.32490    1.62690  37.694
Grade                  49.44598    0.46061 107.350
reading_decoding        7.84505    0.17440  44.983
working_memory          6.84561    1.16575   5.872
Grade:reading_decoding  0.06248    0.02639   2.368

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.179                     
redng_dcdng -0.683 -0.418              
workng_mmry  0.029  0.036 -0.070       
Grd:rdng_dc  0.346 -0.637 -0.370  0.018</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_grade_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">61.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">58.14&nbsp;–&nbsp;64.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.54&nbsp;–&nbsp;50.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.50&nbsp;–&nbsp;8.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">6.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.56&nbsp;–&nbsp;9.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.018</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">226.98</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2647.26</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">28.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.818 / 0.986</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_grade_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.101e+05 | 1.101e+05 | 1.101e+05 |      0.986 |      0.818 | 0.921 | 12.811 | 15.066</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_grade_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effects (formula:
list(~1 | person_id, ~0 + Grade | person_id)). The model's total explanatory
power is substantial (conditional R2 = 0.99) and the part related to the fixed
effects alone (marginal R2) is of 0.82. The model's intercept, corresponding to
Grade = 0, reading_decoding = 0 and working_memory = 0, is at 61.32 (95% CI
[58.14, 64.51], t(11992) = 37.69, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 49.45,
95% CI [48.54, 50.35], t(11992) = 107.35, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.85, 95% CI [7.50, 8.19], t(11992) = 44.98, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 6.85, 95% CI [4.56, 9.13], t(11992) = 5.87, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.06, 95% CI [0.01, 0.11], t(11992) = 2.37, p = 0.018; Std.
beta = 3.13e-03, 95% CI [6.33e-04, 5.62e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_working, fit_grade_random_uncorrelated, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_working: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + (1 | person_id)
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
                              npar    AIC    BIC logLik deviance  Chisq Df
fit_working                      7 111457 111509 -55721   111443          
fit_grade_random_uncorrelated    8 110066 110125 -55025   110050 1393.2  1
                              Pr(&gt;Chisq)    
fit_working                                 
fit_grade_random_uncorrelated  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_working, fit_grade_random_uncorrelated, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                          |   Model | R2 (cond.) | R2 (marg.) |   ICC
-------------------------------------------------------------------------
fit_grade_random_uncorrelated | lmerMod |      0.986 |      0.818 | 0.921
fit_working                   | lmerMod |      0.980 |      0.803 | 0.899

Name                          |   RMSE |  Sigma | AIC weights | AICc weights
----------------------------------------------------------------------------
fit_grade_random_uncorrelated | 12.811 | 15.066 |        1.00 |         1.00
fit_working                   | 16.481 | 18.023 |   8.74e-303 |    8.75e-303

Name                          | BIC weights | Performance-Score
---------------------------------------------------------------
fit_grade_random_uncorrelated |        1.00 |           100.00%
fit_working                   |   3.52e-301 |             0.00%</code></pre>
</div>
</div>
</section>
<section id="level-1-random-slope-reading_decoding" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-slope-reading_decoding">Level-1 random slope: reading_decoding</h2>
<p>We run into a model convergence problem when we add the random slope for reading decoding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>fit_decoding_random_uncorrelated <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can try a different optimizer to see if that helps. The <code>lmer</code> function’s previous default optimizer (<code>Nelder_Mead</code>) sometimes finds a good solution when the current default optimizer (<code>bobyqa</code>) does not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>fit_decoding_random_uncorrelated <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1, <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer=</span><span class="st">"Nelder_Mead"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It worked!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_decoding_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding |  
        person_id))
   Data: d_level1
Control: lmerControl(optimizer = "Nelder_Mead")

REML criterion at convergence: 110004.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2379 -0.5687 -0.0066  0.5675  3.1103 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2495.324 49.953  
 person_id.1 Grade              17.901  4.231  
 person_id.2 reading_decoding    2.558  1.599  
 Residual                      225.299 15.010  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            61.16775    1.60592  38.089
Grade                  49.37052    0.45458 108.607
reading_decoding        7.85081    0.17819  44.059
working_memory          4.80887    1.15773   4.154
Grade:reading_decoding  0.06668    0.02645   2.521

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.182                     
redng_dcdng -0.680 -0.413              
workng_mmry  0.034  0.032 -0.071       
Grd:rdng_dc  0.352 -0.647 -0.363  0.025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_decoding_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">61.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">58.02&nbsp;–&nbsp;64.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.48&nbsp;–&nbsp;50.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.50&nbsp;–&nbsp;8.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.54&nbsp;–&nbsp;7.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.012</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">225.30</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2495.32</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">17.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.56</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.826 / 0.986</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_decoding_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.100e+05 | 1.100e+05 | 1.101e+05 |      0.986 |      0.826 | 0.917 | 12.747 | 15.010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_decoding_random_uncorrelated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and Nelder-Mead optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effects (formula:
list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to Grade = 0, reading_decoding = 0
and working_memory = 0, is at 61.17 (95% CI [58.02, 64.32], t(11991) = 38.09, p
&lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 49.37,
95% CI [48.48, 50.26], t(11991) = 108.61, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.85, 95% CI [7.50, 8.20], t(11991) = 44.06, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 4.81, 95% CI [2.54, 7.08], t(11991) = 4.15, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.07, 95% CI [0.01, 0.12], t(11991) = 2.52, p = 0.012; Std.
beta = 3.28e-03, 95% CI [7.88e-04, 5.78e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_grade_random_uncorrelated, fit_decoding_random_uncorrelated, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
fit_decoding_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                                 npar    AIC    BIC logLik deviance  Chisq Df
fit_grade_random_uncorrelated       8 110066 110125 -55025   110050          
fit_decoding_random_uncorrelated    9 110023 110089 -55002   110005 44.976  1
                                 Pr(&gt;Chisq)    
fit_grade_random_uncorrelated                  
fit_decoding_random_uncorrelated  1.995e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_grade_random_uncorrelated, fit_decoding_random_uncorrelated, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                             |   Model | R2 (cond.) | R2 (marg.) |   ICC
----------------------------------------------------------------------------
fit_decoding_random_uncorrelated | lmerMod |      0.986 |      0.826 | 0.917
fit_grade_random_uncorrelated    | lmerMod |      0.986 |      0.818 | 0.921

Name                             |   RMSE |  Sigma | AIC weights | AICc weights
-------------------------------------------------------------------------------
fit_decoding_random_uncorrelated | 12.747 | 15.010 |       1.000 |        1.000
fit_grade_random_uncorrelated    | 12.811 | 15.066 |    4.66e-10 |     4.67e-10

Name                             | BIC weights | Performance-Score
------------------------------------------------------------------
fit_decoding_random_uncorrelated |       1.000 |            75.00%
fit_grade_random_uncorrelated    |    1.88e-08 |            25.00%</code></pre>
</div>
</div>
</section>
<section id="level-1-random-intercept-slope-correlations" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-intercept-slope-correlations">Level-1 random intercept-slope correlations</h2>
<p>Do the intercepts and slopes correlate?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>fit_correlated_intercept_slopes <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">|</span> person_id), <span class="at">data =</span> d_level1 <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(reading_decoding, working_memory), scale, <span class="at">center =</span> T, <span class="at">scale =</span> F), <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer=</span><span class="st">"Nelder_Mead"</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_correlated_intercept_slopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    (1 + Grade + reading_decoding | person_id)
   Data: d_level1 %&gt;% mutate_at(vars(reading_decoding, working_memory),  
    scale, center = T, scale = F)
Control: lmerControl(optimizer = "Nelder_Mead")

REML criterion at convergence: 109996.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2902 -0.5690 -0.0060  0.5652  3.1303 

Random effects:
 Groups    Name             Variance Std.Dev. Corr       
 person_id (Intercept)      2979.649 54.586              
           Grade              32.179  5.673   -0.13      
           reading_decoding    4.533  2.129    0.43 -0.47
 Residual                    223.467 14.949              
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                        Estimate Std. Error t value
(Intercept)            147.91594    1.49422   98.99
Grade                   50.09898    0.35818  139.87
reading_decoding         7.85703    0.18135   43.33
working_memory           4.07157    1.15659    3.52
Grade:reading_decoding   0.06527    0.02642    2.47

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade       -0.562                     
redng_dcdng  0.615 -0.855              
workng_mmry -0.036  0.062 -0.071       
Grd:rdng_dc -0.099 -0.007 -0.357  0.028</code></pre>
</div>
</div>
<p>The model did not converge. I checked various solutions (different optimizers, more iterations, centering variables), but none worked for me. Do the slopes and intercepts correlate? From various attempts, the answer seems to be that they do not, but it is hard to be sure. The random slopes for reading decoding and Grade might be negatively correlated, but I am reluctant to trust the results of a non-convergent model, especially when I have no theoretical reason to expect such a correlation. Therefore, I am going to go with the uncorrelated slopes and intercepts model.</p>
</section>
<section id="cross-level-interaction-working-memory-grade" class="level2">
<h2 class="anchored" data-anchor-id="cross-level-interaction-working-memory-grade">Cross-level interaction: Working Memory × Grade</h2>
<p>As seen below, working memory has a positive interaction with Grade, meaning that the growth of reading comprehension (i.e., the effect of Grade) is faster with students with higher working memory capacity.</p>
<p>Note that the cross-level interaction is significant—and the level-1 interaction between Reading Decoding and Grade is no longer significant. What happened? Usually we would have to be pretty clever to figure out the reason, but we happen to know how the data were simulated: Working Memory and Grade really do interact, and Reading Decoding and Grade really do not. However, Working Memory and Grade are correlated (i.e., Working Memory increases over time). When Grade was not allowed to interact with Working Memory, Reading Decoding interacted with Grade, a correlate of Working Memory. Now that the true interaction has been included in the model, the false interaction is no longer significant. We can leave it in for now, but we can get rid of it at the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>fit_wm_x_grade <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> working_memory <span class="sc">*</span> Grade <span class="sc">+</span> Grade <span class="sc">*</span> reading_decoding <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wm_x_grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * Grade + Grade *  
    reading_decoding + ((1 | person_id) + (0 + Grade | person_id) +  
    (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109269.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4081 -0.5853 -0.0036  0.5802  3.0518 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2459.903 49.597  
 person_id.1 Grade               1.746  1.321  
 person_id.2 reading_decoding    3.629  1.905  
 Residual                      224.121 14.971  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                        Estimate Std. Error t value
(Intercept)            60.470968   1.589967  38.033
working_memory          4.623729   1.157350   3.995
Grade                  50.095459   0.440333 113.767
reading_decoding        7.932988   0.176734  44.887
working_memory:Grade    3.554948   0.118362  30.035
Grade:reading_decoding  0.006277   0.026503   0.237

Correlation of Fixed Effects:
            (Intr) wrkng_ Grade  rdng_d wrk_:G
workng_mmry  0.034                            
Grade        0.171  0.030                     
redng_dcdng -0.672 -0.069 -0.400              
wrkng_mmr:G -0.024  0.028  0.078  0.030       
Grd:rdng_dc  0.356  0.026 -0.669 -0.367 -0.112
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00396576 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_wm_x_grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.35&nbsp;–&nbsp;63.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.36&nbsp;–&nbsp;6.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.23&nbsp;–&nbsp;50.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.59&nbsp;–&nbsp;8.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.32&nbsp;–&nbsp;3.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.813</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">224.12</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2459.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1.75</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_wm_x_grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.093e+05 | 1.093e+05 | 1.094e+05 |      0.986 |      0.831 | 0.916 | 12.932 | 14.971</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_wm_x_grade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, Grade and
reading_decoding (formula: reading_comprehension ~ 1 + working_memory * Grade +
Grade * reading_decoding). The model included person_id as random effects
(formula: list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to working_memory = 0, Grade = 0 and
reading_decoding = 0, is at 60.47 (95% CI [57.35, 63.59], t(11990) = 38.03, p &lt;
.001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 4.62, 95% CI [2.36, 6.89], t(11990) = 4.00, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade is statistically significant and positive (beta = 50.10,
95% CI [49.23, 50.96], t(11990) = 113.77, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.93, 95% CI [7.59, 8.28], t(11990) = 44.89, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 3.55, 95% CI [3.32, 3.79], t(11990) = 30.03, p &lt; .001; Std.
beta = 0.05, 95% CI [0.04, 0.05])
  - The effect of Grade × reading decoding is statistically non-significant and
positive (beta = 6.28e-03, 95% CI [-0.05, 0.06], t(11990) = 0.24, p = 0.813;
Std. beta = 4.20e-04, 95% CI [-2.08e-03, 2.92e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_grade_random_uncorrelated, fit_wm_x_grade, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
fit_wm_x_grade: reading_comprehension ~ 1 + working_memory * Grade + Grade * reading_decoding + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                              npar    AIC    BIC logLik deviance Chisq Df
fit_grade_random_uncorrelated    8 110066 110125 -55025   110050         
fit_wm_x_grade                  10 109289 109363 -54635   109269 780.7  2
                              Pr(&gt;Chisq)    
fit_grade_random_uncorrelated               
fit_wm_x_grade                 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_grade_random_uncorrelated, fit_wm_x_grade, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                          |   Model | R2 (cond.) | R2 (marg.) |   ICC
-------------------------------------------------------------------------
fit_wm_x_grade                | lmerMod |      0.986 |      0.831 | 0.916
fit_grade_random_uncorrelated | lmerMod |      0.986 |      0.818 | 0.921

Name                          |   RMSE |  Sigma | AIC weights | AICc weights
----------------------------------------------------------------------------
fit_wm_x_grade                | 12.932 | 14.971 |        1.00 |         1.00
fit_grade_random_uncorrelated | 12.811 | 15.066 |   5.33e-170 |    5.35e-170

Name                          | BIC weights | Performance-Score
---------------------------------------------------------------
fit_wm_x_grade                |        1.00 |            75.00%
fit_grade_random_uncorrelated |   8.66e-167 |            25.00%</code></pre>
</div>
</div>
</section>
<section id="cross-level-interaction-working-memory-reading-decoding" class="level2">
<h2 class="anchored" data-anchor-id="cross-level-interaction-working-memory-reading-decoding">Cross-level interaction: Working Memory × Reading Decoding</h2>
<p>The interaction of working memory and reading decoding is negative, meaning that reading decoding is a weaker predictor of reading comprehension among students with higher working memory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>fit_wm_x_decoding <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> working_memory <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">*</span> Grade  <span class="sc">+</span>  reading_decoding<span class="sc">*</span>Grade <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wm_x_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * reading_decoding +  
    working_memory * Grade + reading_decoding * Grade + ((1 |  
    person_id) + (0 + Grade | person_id) + (0 + reading_decoding |  
    person_id))
   Data: d_level1

REML criterion at convergence: 109225.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3824 -0.5867 -0.0049  0.5853  3.0929 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.171 49.600  
 person_id.1 Grade               2.239  1.496  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.981 14.933  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                 Estimate Std. Error t value
(Intercept)                     60.789650   1.588845  38.260
working_memory                  10.738982   1.471720   7.297
reading_decoding                 7.960728   0.176274  45.161
Grade                           50.103391   0.439645 113.963
working_memory:reading_decoding -1.090817   0.162071  -6.730
working_memory:Grade             5.580178   0.323878  17.229
reading_decoding:Grade           0.003082   0.026438   0.117

Correlation of Fixed Effects:
            (Intr) wrkng_ rdng_d Grade  wrk_:_ wrk_:G
workng_mmry  0.045                                   
redng_dcdng -0.670 -0.040                            
Grade        0.171  0.026 -0.400                     
wrkng_mmr:_ -0.030 -0.618 -0.023 -0.003              
wrkng_mmr:G  0.019  0.583  0.032  0.031 -0.931       
rdng_dcdn:G  0.355  0.009 -0.367 -0.668  0.018 -0.058</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_wm_x_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.68&nbsp;–&nbsp;63.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.62&nbsp;–&nbsp;8.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.24&nbsp;–&nbsp;50.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05&nbsp;–&nbsp;0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.907</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.98</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.17</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_wm_x_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.092e+05 | 1.092e+05 | 1.093e+05 |      0.986 |      0.831 | 0.917 | 12.892 | 14.933</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_wm_x_decoding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, reading_decoding and
Grade (formula: reading_comprehension ~ 1 + working_memory * reading_decoding +
working_memory * Grade + reading_decoding * Grade). The model included
person_id as random effects (formula: list(~1 | person_id, ~0 + Grade |
person_id, ~0 + reading_decoding | person_id)). The model's total explanatory
power is substantial (conditional R2 = 0.99) and the part related to the fixed
effects alone (marginal R2) is of 0.83. The model's intercept, corresponding to
working_memory = 0, reading_decoding = 0 and Grade = 0, is at 60.79 (95% CI
[57.68, 63.90], t(11989) = 38.26, p &lt; .001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 10.74, 95% CI [7.85, 13.62], t(11989) = 7.30, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.96, 95% CI [7.62, 8.31], t(11989) = 45.16, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of Grade is statistically significant and positive (beta = 50.10,
95% CI [49.24, 50.97], t(11989) = 113.96, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of working memory × reading decoding is statistically significant
and negative (beta = -1.09, 95% CI [-1.41, -0.77], t(11989) = -6.73, p &lt; .001;
Std. beta = -0.03, 95% CI [-0.04, -0.02])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 5.58, 95% CI [4.95, 6.22], t(11989) = 17.23, p &lt; .001; Std.
beta = 0.08, 95% CI [0.07, 0.08])
  - The effect of reading decoding × Grade is statistically non-significant and
positive (beta = 3.08e-03, 95% CI [-0.05, 0.05], t(11989) = 0.12, p = 0.907;
Std. beta = 2.63e-04, 95% CI [-2.23e-03, 2.76e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_wm_x_grade, fit_wm_x_decoding, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_wm_x_grade: reading_comprehension ~ 1 + working_memory * Grade + Grade * reading_decoding + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
fit_wm_x_decoding: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + reading_decoding * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                  npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_wm_x_grade      10 109289 109363 -54635   109269                         
fit_wm_x_decoding   11 109248 109329 -54613   109226 43.292  1  4.714e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_wm_x_grade, fit_wm_x_decoding, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------
fit_wm_x_decoding | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.933
fit_wm_x_grade    | lmerMod |      0.986 |      0.831 | 0.916 | 12.932 | 14.971

Name              | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------
fit_wm_x_decoding |       1.000 |        1.000 |       1.000 |            87.50%
fit_wm_x_grade    |    4.36e-10 |     4.37e-10 |    1.76e-08 |            12.50%</code></pre>
</div>
</div>
</section>
<section id="final-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="final-model">Final model</h2>
<p>Let’s remove the now non-significant level-1 interaction, which brings us to the true model we simulated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>fit_final <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_comprehension <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> working_memory <span class="sc">*</span> reading_decoding <span class="sc">+</span> working_memory <span class="sc">*</span> Grade <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> Grade <span class="sc">+</span> reading_decoding <span class="sc">||</span> person_id), <span class="at">data =</span> d_level1)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * reading_decoding +  
    working_memory * Grade + ((1 | person_id) + (0 + Grade |  
    person_id) + (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109220.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3828 -0.5871 -0.0044  0.5850  3.0921 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.165 49.600  
 person_id.1 Grade               2.241  1.497  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.953 14.932  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                Estimate Std. Error t value
(Intercept)                      60.7239     1.4854  40.880
working_memory                   10.7375     1.4716   7.296
reading_decoding                  7.9683     0.1640  48.599
Grade                            50.1376     0.3272 153.240
working_memory:reading_decoding  -1.0912     0.1620  -6.734
working_memory:Grade              5.5824     0.3233  17.265

Correlation of Fixed Effects:
            (Intr) wrkng_ rdng_d Grade  wrk_:_
workng_mmry  0.045                            
redng_dcdng -0.621 -0.039                     
Grade        0.587  0.043 -0.932              
wrkng_mmr:_ -0.039 -0.619 -0.018  0.012       
wrkng_mmr:G  0.042  0.584  0.012 -0.010 -0.931</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.81&nbsp;–&nbsp;63.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.65&nbsp;–&nbsp;8.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.50&nbsp;–&nbsp;50.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.95</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.16</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.092e+05 | 1.092e+05 | 1.093e+05 |      0.986 |      0.831 | 0.917 | 12.892 | 14.932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, reading_decoding and
Grade (formula: reading_comprehension ~ 1 + working_memory * reading_decoding +
working_memory * Grade). The model included person_id as random effects
(formula: list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to working_memory = 0,
reading_decoding = 0 and Grade = 0, is at 60.72 (95% CI [57.81, 63.64],
t(11990) = 40.88, p &lt; .001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 10.74, 95% CI [7.85, 13.62], t(11990) = 7.30, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.97, 95% CI [7.65, 8.29], t(11990) = 48.60, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of Grade is statistically significant and positive (beta = 50.14,
95% CI [49.50, 50.78], t(11990) = 153.24, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of working memory × reading decoding is statistically significant
and negative (beta = -1.09, 95% CI [-1.41, -0.77], t(11990) = -6.73, p &lt; .001;
Std. beta = -0.03, 95% CI [-0.04, -0.02])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 5.58, 95% CI [4.95, 6.22], t(11990) = 17.27, p &lt; .001; Std.
beta = 0.08, 95% CI [0.07, 0.08])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_wm_x_decoding, fit_final, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_final: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
fit_wm_x_decoding: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + reading_decoding * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                  npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)
fit_final           10 109240 109314 -54610   109220                    
fit_wm_x_decoding   11 109248 109329 -54613   109226     0  1          1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fit_wm_x_decoding, fit_final, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------
fit_final         | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.932
fit_wm_x_decoding | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.933

Name              | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------
fit_final         |       0.730 |        0.730 |       0.991 |           100.00%
fit_wm_x_decoding |       0.270 |        0.270 |       0.009 |             0.00%</code></pre>
</div>
</div>
<p>In this plot, we can see that Reading Decoding’s effect is steeper for individuals with lower working memory:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_final, </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_decoding"</span>, <span class="st">"working_memory [-1, 0, 1]"</span>, <span class="st">"Grade [0:5]"</span>),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"The Effect of Reading Decoding on Reading Comprehension</span><span class="sc">\n</span><span class="st"> at Different Levels of Working Memory and Grade"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="longitudinal_files/figure-html/fit_finalplot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>An alternate view of the same model suggests that the effect of working memory on reading comprehension is minimal in Kindergarten (Grade 0) and 1st grade when the focus is more on reading letters, single words, and very short sentences. However as the focus moves to longer, more complex sentences and paragraphs, the effect of Working Memory on Reading Comprehension increases.</p>
<div class="cell page-columns page-full" data-preview-image="true">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_final, </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"working_memory [-2, 2]"</span>, <span class="st">"reading_decoding [5, 10, 15]"</span>, <span class="st">"Grade [0:5]"</span>),</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"The Effect of Working Memory on Reading Comprehension</span><span class="sc">\n</span><span class="st"> at Different Levels of Reading Decoding and Grade"</span>) <span class="sc">+</span> </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">16</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">"Reading</span><span class="sc">\n</span><span class="st">Decoding"</span>, <span class="at">begin =</span> .<span class="dv">2</span>, <span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Working Memory"</span>, <span class="at">y =</span> <span class="st">"Reading Comprehension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotwmbygradefinal" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" width="768">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotwmbygradefinal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-plotwmbygradefinal-1.png" id="fig-plotwmbygradefinal" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-plotwmbygradefinal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another view of the same model suggests that students with higher Working Memory have faster Reading Comprehension growth rates, even after controlling for Reading Decoding.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_final, </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Grade [0:5]"</span>, <span class="st">"working_memory [-1, 0, 1]"</span>, <span class="st">"reading_decoding [5, 10, 15]"</span>),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"The Effect of Working Memory on Reading Comprehension</span><span class="sc">\n</span><span class="st"> at Different Levels of Reading Decoding and Grade"</span>) <span class="sc">+</span> </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">16</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">"Working</span><span class="sc">\n</span><span class="st">Memory"</span>, <span class="at">begin =</span> .<span class="dv">2</span>, <span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Grade"</span>, <span class="at">y =</span> <span class="st">"Reading Comprehension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotwmbygradefinal2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" width="768">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotwmbygradefinal2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-plotwmbygradefinal2-1.png" id="fig-plotwmbygradefinal2" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-plotwmbygradefinal2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Reflect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reflect
</div>
</div>
<div class="callout-body-container callout-body">
<p>How this method could be used in your own research?</p>
</div>
</div>
</section>
</section>
<section id="exercise" class="level1 page-columns page-full">
<h1>Exercise</h1>
<p>Imagine that <em>n</em> = 1000 participants with anxiety disorders were in a 10-week study of meditation’s effect on reducing anxiety over time. Each participant was assigned to a student therapist who taught the meditation techniques to the participants. Transcriptions of the instruction session were rated for levels of therapist support.</p>
<p>Variables:</p>
<ul>
<li><code>person_id</code>: The identifier for each person</li>
<li><code>Week</code> : The week on which data were collected, starting with Week 0 and ending on Week 4.</li>
<li><code>Anxiety</code>: The overall level of Anxiety participants reported for the Week (level 1).</li>
<li><code>therapist_support</code> A person-level (level 2) rating of overall therapist support.</li>
<li><code>minutes_meditating</code> The total hours spent meditating each week.</li>
</ul>
<p>Predictions:</p>
<ul>
<li>The more time spent each week in meditation, the more anxiety will reduce over time. Note that this is <strong>NOT</strong> a prediction that the simple effect of meditation will be positive. It is instead a prediction that meditation will interact (negatively) with the time variable <code>Week</code>.</li>
<li>The therapist’s overall level of support is predicted to interact with time (i.e., <code>Week</code>) such that participants with more supportive therapists will improve more quickly than participants with less support therapists.</li>
<li>The therapist’s overall level of support is predicted to increase the potency of meditation’s effect over time. That is, a negative value is predicted for the 3-way interaction between therapist support, minutes meditated, and time (<code>Week</code>).</li>
</ul>
<section id="load-data-and-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-data-and-packages">Load Data and Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://github.com/wjschne/EDUC5529/raw/master/hw7_meditation.csv"</span>, </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">person_id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">Week =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">Anxiety =</span> <span class="fu">col_double</span>(),</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">meditation_hours =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">therapist_support =</span> <span class="fu">col_double</span>())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fit-random-intercept-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-random-intercept-model">Fit random intercept model</h2>
<p>Try setting up the code yourself. Call the model <code>fit_0</code></p>
<p>Run the <code>summary</code> function and the <code>model_performance</code> function on the model.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>fit_0 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_0)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="between-person-proportion-of-variance" class="level3">
<h3 class="anchored" data-anchor-id="between-person-proportion-of-variance">Between-Person Proportion of Variance</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Where would you look in the output for <code>summary(fit_0)</code> to find the average level of Anxiety across the entire data set?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>In model <code>fit_0</code>, what proportion of variance in Anxiety is between persons?</p>
</div>
</div>
</section>
</section>
<section id="lets-make-a-nice-table" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lets-make-a-nice-table">Let’s make a nice table</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-fit0" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fit0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Anxiety</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">65.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">64.62&nbsp;–&nbsp;65.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">69.71</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">30.32</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.30</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.303</td>
</tr>

</tbody></table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fit0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Null Model Results
</figcaption>
</figure>
</div>
</div>
</section>
<section id="fit-the-linear-effect-of-time-i.e.-week" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fit-the-linear-effect-of-time-i.e.-week">Fit the linear effect of time (i.e., <code>Week</code>)</h2>
<p>Estimate the linear effect of <code>Week</code>. Try setting up the code yourself. Call the model <code>fit_week</code></p>
<p>Run <code>summary</code>, <code>model_performance</code>, and <code>report</code> on the model.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Click to see code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>fit_week <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Week <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_week)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_week)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let’s compare the fit of both models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_0, fit_week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_0: Anxiety ~ 1 + (1 | person_id)
fit_week: Anxiety ~ 1 + Week + (1 | person_id)
         npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_0       3 79664 79686 -39829    79658                         
fit_week    4 77765 77794 -38878    77757 1901.6  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_0, fit_week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
------------------------------------------------------------------------
fit_0    | lmerMod | 79664.4 (&lt;.001) | 79664.4 (&lt;.001) | 79686.3 (&lt;.001)
fit_week | lmerMod | 77764.8 (&gt;.999) | 77764.8 (&gt;.999) | 77794.0 (&gt;.999)

Name     | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
----------------------------------------------------------
fit_0    |      0.303 |      0.000 | 0.303 | 8.029 | 8.349
fit_week |      0.424 |      0.110 | 0.353 | 7.290 | 7.592</code></pre>
</div>
</div>
<p>By every criterion, <code>fit_week</code> fits better than <code>fit_0</code>. Thus, there is a significant association with <code>Week</code> and <code>Anxiety</code>. Because the slope of <code>Week</code> is negative, people’s anxiety decreased over time by about -1.05 points per week.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>In model <code>fit_week</code>, what proportion of variance in Anxiety is explained by <code>Week</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Look at the R2_marginal column in the <code>performance::model_performance(fit_week)</code> output.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 4">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the output of <code>summary(fit_week)</code>, where would you look to see how much anxiety is changing from week to week, on average?</p>
</div>
</div>
<section id="plot-the-model-and-make-a-nice-table" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="plot-the-model-and-make-a-nice-table">Plot the Model and Make a Nice Table</h3>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_week, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Week"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fitweek" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-fitweek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-fitweek-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fitweek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Predicted Effects of Week
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit_0, fit_week, <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"Null Model"</span>, <span class="st">"Week"</span>), <span class="at">show.ci =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-fitweek" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fitweek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Null Model</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Week</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">65.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">70.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Week</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="5" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">69.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">57.64</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">30.32 <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">31.42 <sub>person_id</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.35</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">1000 <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">1000 <sub>person_id</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">11000</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">11000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.000 / 0.303</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.110 / 0.424</td>
</tr>

</tbody></table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fitweek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: The Linear Effect of Week
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="add-the-quadratic-effect-of-week." class="level2">
<h2 class="anchored" data-anchor-id="add-the-quadratic-effect-of-week.">Add the quadratic effect of <code>Week</code>.</h2>
<p>We did not predict non-linear effects of time, but it is good idea to check. Usually you include enough polynomial degrees to be consistent with your models. If you have no prediction, add them one at a time, but be conservative in doing so.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>fit_week_2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">poly</span>(Week, <span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_week_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Anxiety ~ 1 + poly(Week, 2) + (1 | person_id)
   Data: d

REML criterion at convergence: 77745.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.9612 -0.4497  0.1040  0.6023  2.8793 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 31.42    5.605   
 Residual              57.64    7.592   
Number of obs: 11000, groups:  person_id, 1000

Fixed effects:
                Estimate Std. Error t value
(Intercept)      65.0000     0.1915 339.502
poly(Week, 2)1 -347.4464     7.5924 -45.763
poly(Week, 2)2   -6.9694     7.5924  -0.918

Correlation of Fixed Effects:
            (Intr) p(W,2)1
poly(Wk,2)1 0.000         
poly(Wk,2)2 0.000  0.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_week, fit_week_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_week: Anxiety ~ 1 + Week + (1 | person_id)
fit_week_2: Anxiety ~ 1 + poly(Week, 2) + (1 | person_id)
           npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_week      4 77765 77794 -38878    77757                     
fit_week_2    5 77766 77802 -38878    77756 0.8428  1     0.3586</code></pre>
</div>
</div>
<p>Here we see that the quadratic effect of <code>Week</code> is not significant, so we need not continue adding polynomial degrees. If we did, it would look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>fit_week_3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">poly</span>(Week, <span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_week_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Anxiety ~ 1 + poly(Week, 3) + (1 | person_id)
   Data: d

REML criterion at convergence: 77737.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.9654 -0.4497  0.1032  0.6000  2.8946 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 31.42    5.605   
 Residual              57.64    7.592   
Number of obs: 11000, groups:  person_id, 1000

Fixed effects:
                Estimate Std. Error t value
(Intercept)      65.0000     0.1915 339.502
poly(Week, 3)1 -347.4464     7.5920 -45.765
poly(Week, 3)2   -6.9694     7.5920  -0.918
poly(Week, 3)3  -10.3752     7.5920  -1.367

Correlation of Fixed Effects:
            (Intr) p(W,3)1 p(W,3)2
poly(Wk,3)1 0.000                 
poly(Wk,3)2 0.000  0.000          
poly(Wk,3)3 0.000  0.000   0.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_week, fit_week_2, fit_week_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_week: Anxiety ~ 1 + Week + (1 | person_id)
fit_week_2: Anxiety ~ 1 + poly(Week, 2) + (1 | person_id)
fit_week_3: Anxiety ~ 1 + poly(Week, 3) + (1 | person_id)
           npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_week      4 77765 77794 -38878    77757                     
fit_week_2    5 77766 77802 -38878    77756 0.8428  1     0.3586
fit_week_3    6 77766 77810 -38877    77754 1.8679  1     0.1717</code></pre>
</div>
</div>
<p>Given the lack of polynomial effects, we will stick with just the linear effect in <code>fit_week</code>.</p>
</section>
<section id="add-the-l1-time-covarying-predictor-meditation_hours-to-the-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="add-the-l1-time-covarying-predictor-meditation_hours-to-the-model">Add the L1 time-covarying predictor, <code>meditation_hours</code> to the model</h2>
<p>Try setting up the code yourself. Call the model <code>fit_meditation</code></p>
<p>Run <code>summary</code>, <code>model_performance</code>, and <code>report</code> on the model. Compare <code>fit_meditation</code> with the previous model, <code>fit_week</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>fit_meditation <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Week <span class="sc">+</span> meditation_hours <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_meditation)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_meditation)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_meditation)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_week, fit_meditation)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_week, fit_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>When you the output, you will see that the effect of <code>meditation_hours</code> is significant. From the <code>report</code> function, the standardized beta (the effect if all variables were standardized) for <code>meditation_hours</code> is larger than the effect of <code>Week</code>. Theoretically, this result makes sense. Anxiety should decrease because of the intervention, not just because of time passing. Still, the effect of <code>Week</code> is significant, perhaps because of therapist contact and/or regression to the mean.</p>
<p>Nice plot and table:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_meditation, </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Week"</span>, <span class="st">"meditation_hours [0, 5, 10]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-meditation" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-meditation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-meditation-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-meditation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: The Predicted Effects of Week by Meditation Hours
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-mediation" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-mediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Anxiety</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">76.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">76.57&nbsp;–&nbsp;77.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Week</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09&nbsp;–&nbsp;-1.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">meditation hours</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.12&nbsp;–&nbsp;-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">20.60</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">29.20</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.59</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.497 / 0.792</td>
</tr>

</tbody></table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-mediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Model for the Combined Effects of Week and Meditation
</figcaption>
</figure>
</div>
</div>
</section>
<section id="add-the-predicted-interaction-of-week-and-meditation_hours." class="level2">
<h2 class="anchored" data-anchor-id="add-the-predicted-interaction-of-week-and-meditation_hours.">Add the predicted interaction of <code>Week</code> and <code>meditation_hours</code>.</h2>
<p>Call the model <code>fit_week_x_meditation</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>fit_week_x_meditation <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Week <span class="sc">*</span> meditation_hours <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Anxiety ~ 1 + Week * meditation_hours + (1 | person_id)
   Data: d

REML criterion at convergence: 61358.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.0746 -0.6355  0.0015  0.6369  4.4524 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 29.50    5.431   
 Residual              11.36    3.370   
Number of obs: 11000, groups:  person_id, 1000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)           71.866534   0.194086 370.281
Week                  -0.041797   0.015228  -2.745
meditation_hours      -0.267135   0.011141 -23.978
Week:meditation_hours -0.170020   0.001884 -90.265

Correlation of Fixed Effects:
            (Intr) Week   mdttn_
Week        -0.392              
medittn_hrs -0.348  0.626       
Wk:mdttn_hr  0.290 -0.745 -0.836</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
61370.252 | 61370.260 | 61414.086 |      0.885 |      0.588 | 0.722 | 3.219 | 3.370</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict Anxiety with Week and meditation_hours (formula: Anxiety ~ 1 + Week
* meditation_hours). The model included person_id as random effect (formula: ~1
| person_id). The model's total explanatory power is substantial (conditional
R2 = 0.89) and the part related to the fixed effects alone (marginal R2) is of
0.59. The model's intercept, corresponding to Week = 0 and meditation_hours =
0, is at 71.87 (95% CI [71.49, 72.25], t(10994) = 370.28, p &lt; .001). Within
this model:

  - The effect of Week is statistically significant and negative (beta = -0.04,
95% CI [-0.07, -0.01], t(10994) = -2.74, p = 0.006; Std. beta = -0.33, 95% CI
[-0.34, -0.33])
  - The effect of meditation hours is statistically significant and negative
(beta = -0.27, 95% CI [-0.29, -0.25], t(10994) = -23.98, p &lt; .001; Std. beta =
-0.62, 95% CI [-0.63, -0.62])
  - The effect of Week × meditation hours is statistically significant and
negative (beta = -0.17, 95% CI [-0.17, -0.17], t(10994) = -90.26, p &lt; .001;
Std. beta = -0.30, 95% CI [-0.31, -0.29])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_meditation, fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_meditation: Anxiety ~ 1 + Week + meditation_hours + (1 | person_id)
fit_week_x_meditation: Anxiety ~ 1 + Week * meditation_hours + (1 | person_id)
                      npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_meditation           5 67309 67345 -33649    67299                         
fit_week_x_meditation    6 61342 61386 -30665    61330 5968.7  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_meditation, fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                  |   Model |   AIC (weights) |  AICc (weights)
-------------------------------------------------------------------
fit_meditation        | lmerMod | 67308.9 (&lt;.001) | 67308.9 (&lt;.001)
fit_week_x_meditation | lmerMod | 61342.2 (&gt;.999) | 61342.2 (&gt;.999)

Name                  |   BIC (weights) | R2 (cond.) | R2 (marg.) |   ICC
-------------------------------------------------------------------------
fit_meditation        | 67345.4 (&lt;.001) |      0.792 |      0.497 | 0.586
fit_week_x_meditation | 61386.0 (&gt;.999) |      0.885 |      0.588 | 0.722

Name                  |  RMSE | Sigma
-------------------------------------
fit_meditation        | 4.340 | 4.538
fit_week_x_meditation | 3.219 | 3.370</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_week_x_meditation, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Week"</span>, <span class="st">"meditation_hours [0, 5, 10]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="longitudinal_files/figure-html/fitweekbymeditation-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit_week_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Anxiety</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">71.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">71.49&nbsp;–&nbsp;72.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Week</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.006</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">meditation hours</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.29&nbsp;–&nbsp;-0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Week × meditation hours</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.17&nbsp;–&nbsp;-0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">11.36</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">29.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.72</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.588 / 0.885</td>
</tr>

</tbody></table>
</div>
</div>
<p>We see that the hypothesized interaction is significant, meaning that the effect of <code>Week</code> depends on <code>meditation_hours</code>. In the plot, you can see that the reduction of Anxiety over time is larger for people who meditation more.</p>
<p>Note that in the output the fixed effects of <code>Week</code> and <code>meditation_hours</code> are simple slopes. They tell us what the slope of the variable is when the other predictors in the interaction are 0. For statistical significance of simple slopes, you can look in the output of <code>report</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 5">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 5
</div>
</div>
<div class="callout-body-container callout-body">
<p>In model <code>fit_week_x_meditation</code>, when <code>meditation_hours</code> is 0, is the slope of <code>Week</code> statistically significant?</p>
</div>
</div>
</section>
<section id="add-the-l2-predictor" class="level2">
<h2 class="anchored" data-anchor-id="add-the-l2-predictor">Add the L2 predictor</h2>
<p>Add <code>therapist_support</code> to the previous model. Call the model <code>fit_support</code>. Run <code>summary</code>, <code>model_performance</code>, and <code>report</code> on the model. Compare <code>fit_support</code> with the previous model, <code>fit_meditation</code>.</p>
<section id="set-up-the-code" class="level3 tabset tabset-fade tabset-pills">
<h3 class="tabset tabset-fade tabset-pills anchored" data-anchor-id="set-up-the-code">Set up the Code</h3>
<p>Try setting up the code yourself.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>fit_support <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> Week <span class="sc">*</span> meditation_hours <span class="sc">+</span> therapist_support <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_support)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_support)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_support)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_meditation, fit_support)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_meditation, fit_support, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>After running the code, you can see that the therapist support is associated with lower levels of anxiety.</p>
</section>
</section>
<section id="add-random-slopes-for-level-1-predictors." class="level2">
<h2 class="anchored" data-anchor-id="add-random-slopes-for-level-1-predictors.">Add random slopes for Level 1 predictors.</h2>
<p>In general, be conservative about adding random slopes to your model. They often cause convergence problems and long computation times.</p>
<p>Let’s see if we need <code>Week</code> to have a random slope.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>fit_week_random <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> Week <span class="sc">*</span> meditation_hours <span class="sc">+</span> therapist_support <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Week <span class="sc">||</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_week_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Anxiety ~ Week * meditation_hours + therapist_support + ((1 |  
    person_id) + (0 + Week | person_id))
   Data: d

REML criterion at convergence: 61325.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.0529 -0.6342  0.0016  0.6357  4.4314 

Random effects:
 Groups      Name        Variance  Std.Dev.
 person_id   (Intercept) 28.414902 5.33056 
 person_id.1 Week         0.005105 0.07145 
 Residual                11.303273 3.36203 
Number of obs: 11000, groups:  person_id, 1000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)           71.847112   0.191278 375.616
Week                  -0.041067   0.015396  -2.667
meditation_hours      -0.265533   0.011158 -23.797
therapist_support     -1.011291   0.173201  -5.839
Week:meditation_hours -0.170138   0.001888 -90.134

Correlation of Fixed Effects:
            (Intr) Week   mdttn_ thrps_
Week        -0.394                     
medittn_hrs -0.354  0.621              
thrpst_sppr  0.016 -0.004 -0.022       
Wk:mdttn_hr  0.295 -0.738 -0.836  0.004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_week_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
61341.222 | 61341.235 | 61399.668 |      0.888 |      0.607 | 0.715 | 3.203 | 3.362</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_support, fit_week_random, <span class="at">refit =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_support: Anxiety ~ Week * meditation_hours + therapist_support + (1 | person_id)
fit_week_random: Anxiety ~ Week * meditation_hours + therapist_support + ((1 | person_id) + (0 + Week | person_id))
                npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_support        7 61340 61392 -30663    61326                     
fit_week_random    8 61341 61400 -30663    61325 1.2712  1     0.2595</code></pre>
</div>
</div>
<p>There is not a significant effect here. Note the use of <code>refit = FALSE</code> in the <code>anova</code> function. This is good practice when comparing models that differ only in their random effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>fit_meditation_random <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> Week <span class="sc">*</span> meditation_hours <span class="sc">+</span> therapist_support <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> meditation_hours <span class="sc">||</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_meditation_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Anxiety ~ Week * meditation_hours + therapist_support + ((1 |  
    person_id) + (0 + meditation_hours | person_id))
   Data: d

REML criterion at convergence: 61323.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.0732 -0.6349  0.0008  0.6351  4.4356 

Random effects:
 Groups      Name             Variance  Std.Dev.
 person_id   (Intercept)      28.580662 5.34609 
 person_id.1 meditation_hours  0.002205 0.04696 
 Residual                     11.287908 3.35975 
Number of obs: 11000, groups:  person_id, 1000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)           71.847721   0.191808 374.581
Week                  -0.041972   0.015251  -2.752
meditation_hours      -0.265514   0.011376 -23.339
therapist_support     -0.999116   0.173555  -5.757
Week:meditation_hours -0.169966   0.001904 -89.250

Correlation of Fixed Effects:
            (Intr) Week   mdttn_ thrps_
Week        -0.398                     
medittn_hrs -0.350  0.621              
thrpst_sppr  0.016 -0.002 -0.019       
Wk:mdttn_hr  0.295 -0.746 -0.829  0.002
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00610441 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_meditation_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
61339.774 | 61339.787 | 61398.220 |      0.888 |      0.605 | 0.717 | 3.200 | 3.360</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_support, fit_meditation_random, <span class="at">refit =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_support: Anxiety ~ Week * meditation_hours + therapist_support + (1 | person_id)
fit_meditation_random: Anxiety ~ Week * meditation_hours + therapist_support + ((1 | person_id) + (0 + meditation_hours | person_id))
                      npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)  
fit_support              7 61340 61392 -30663    61326                       
fit_meditation_random    8 61340 61398 -30662    61324 2.7192  1    0.09915 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Again, no significant effect here. We are not really sure, however, because the model did not converge. However, we did not predict a random slope, so to be conservative, we revert back to <code>fit_support</code> as our comparison model.</p>
</section>
<section id="add-hypothesized-interaction-terms" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="add-hypothesized-interaction-terms">Add hypothesized interaction terms</h2>
<p>We hypothesized a 3-way interaction of <code>Week</code>, <code>meditation_hours</code>, and <code>therapist_support</code>. Add it to the <code>fit_support</code> model.</p>
<p>Try setting up the code yourself. Call the model <code>fit_3_way_interaction</code>.</p>
<p>Pretend that the warning (<code>boundary (singular) fit: see ?isSingular</code>) is not there.</p>
<p>Run <code>summary</code>, <code>model_performance</code>, and <code>report</code> on the model.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>fit_3_way_interaction <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> Week <span class="sc">*</span> meditation_hours <span class="sc">*</span> therapist_support <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_3_way_interaction)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_3_way_interaction)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_3_way_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let’s compare the fit of both models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_support, fit_3_way_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
fit_support: Anxiety ~ Week * meditation_hours + therapist_support + (1 | person_id)
fit_3_way_interaction: Anxiety ~ Week * meditation_hours * therapist_support + (1 | person_id)
                      npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_support              7 61311 61362 -30648    61297                         
fit_3_way_interaction   10 61296 61369 -30638    61276 20.502  3  0.0001336 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_support, fit_3_way_interaction, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                  |   Model | R2 (cond.) | R2 (marg.) |   ICC |  RMSE
-------------------------------------------------------------------------
fit_3_way_interaction | lmerMod |      0.888 |      0.606 | 0.715 | 3.216
fit_support           | lmerMod |      0.888 |      0.605 | 0.715 | 3.219

Name                  | Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------------------
fit_3_way_interaction | 3.368 |       0.999 |        0.999 |       0.024 |            87.50%
fit_support           | 3.370 |    7.09e-04 |     7.12e-04 |       0.976 |            12.50%</code></pre>
</div>
</div>
<p>The results of the <code>anova</code> model comparison is significant, but we can see that the three-way interaction is not. Let’s plot the model and see what is going on.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit_3_way_interaction, </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Week"</span>, <span class="st">"meditation_hours [0, 5, 10]"</span>, <span class="st">"therapist_support [-1, 0, 1]"</span>)) <span class="sc">+</span> </span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-3interaction" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-3interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal_files/figure-html/fig-3interaction-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-3interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Interaction of Week, Meditation, and Therapist Support
</figcaption>
</figure>
</div>
</div>
</div>
<p>From the plot and the summary output, the significant effect appears to be in the 2-way interaction of <code>meditation_hours</code> and <code>therapist_support</code>. You cannot be sure about that until you run the model.</p>
</section>
<section id="add-2-way-interaction" class="level2">
<h2 class="anchored" data-anchor-id="add-2-way-interaction">Add 2-way interaction</h2>
<p>Add the interaction of <code>therapist_support</code> and <code>meditation_hours</code>to the <code>fit_support</code> model</p>
<p>Try setting up the code yourself. Call the model <code>fit_support_x_meditation</code>.</p>
<p>Run <code>summary</code>, <code>model_performance</code>, and <code>report</code> on the model.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hint (Click)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (Click)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>fit_support_x_meditation <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Anxiety <span class="sc">~</span> Week <span class="sc">*</span> meditation_hours <span class="sc">+</span> meditation_hours <span class="sc">*</span> therapist_support <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> person_id), <span class="at">data =</span> d)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_support_x_meditation)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(fit_support_x_meditation)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_support_x_meditation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Question 6">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the <code>fit_support_x_meditation</code> model, is the interaction of <code>meditation_hours</code> and <code>therapist_support</code> significant?</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/wjschne\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>