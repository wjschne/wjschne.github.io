<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.3">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W. Joel Schneider">
<meta name="dcterms.date" content="2025-02-06">
<meta name="description" content="W. Joel Schneider is a professor at Temple University.">

<title>W. Joel Schneider</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-81b5c3e63835cfde897ecd3d35a35a41.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8324e2080287992c21ba0f6d539105a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="W. Joel Schneider">
<meta property="og:description" content="Advanced Data Analysis (EDUC 8825)">
<meta property="og:image" content="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-crosslevel-1.png">
<meta property="og:site_name" content="W. Joel Schneider">
<meta property="og:image:height" content="1536">
<meta property="og:image:width" content="1536">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">W. Joel Schneider</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">R Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assessingpsyche.html"> 
<span class="menu-text">Assessment Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vita.html"> 
<span class="menu-text">Vita</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:schneider@temple.edu" rel="noreferrer noopener" target="_blank"> <i class="bi bi-envelope" role="img" aria-label="Email">
</i> 
<span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/wjschne" rel="noreferrer noopener" target="_blank"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Random Slopes</h1>
            <p class="subtitle lead">Advanced Data Analysis (EDUC 8825)</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>W. Joel Schneider </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data Description</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import data</a></li>
  <li><a href="#analysis-plan" id="toc-analysis-plan" class="nav-link" data-scroll-target="#analysis-plan">Analysis Plan</a></li>
  <li><a href="#predicting-time-1-reading" id="toc-predicting-time-1-reading" class="nav-link" data-scroll-target="#predicting-time-1-reading">Predicting Time 1 Reading</a>
  <ul class="collapse">
  <li><a href="#reading1-model-0-random-intercepts" id="toc-reading1-model-0-random-intercepts" class="nav-link" data-scroll-target="#reading1-model-0-random-intercepts">Reading<sub>1</sub> Model 0: Random Intercepts</a>
  <ul class="collapse">
  <li><a href="#model-0-equations" id="toc-model-0-equations" class="nav-link" data-scroll-target="#model-0-equations">Model 0 Equations</a></li>
  <li><a href="#model-0-fully-annotated" id="toc-model-0-fully-annotated" class="nav-link" data-scroll-target="#model-0-fully-annotated">Model 0 Fully Annotated</a></li>
  <li><a href="#model-0-path-diagram" id="toc-model-0-path-diagram" class="nav-link" data-scroll-target="#model-0-path-diagram">Model 0 Path Diagram</a></li>
  </ul></li>
  <li><a href="#reading1-model-0-in-r" id="toc-reading1-model-0-in-r" class="nav-link" data-scroll-target="#reading1-model-0-in-r">Reading<sub>1</sub> Model 0 in R</a>
  <ul class="collapse">
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions">Check Assumptions</a></li>
  <li><a href="#evaluate-model" id="toc-evaluate-model" class="nav-link" data-scroll-target="#evaluate-model">Evaluate Model</a></li>
  </ul></li>
  <li><a href="#reading1-model-1-l2-covariate" id="toc-reading1-model-1-l2-covariate" class="nav-link" data-scroll-target="#reading1-model-1-l2-covariate">Reading<sub>1</sub> Model 1: L2 Covariate</a>
  <ul class="collapse">
  <li><a href="#exploratory-plot-for-reading1" id="toc-exploratory-plot-for-reading1" class="nav-link" data-scroll-target="#exploratory-plot-for-reading1">Exploratory Plot for Reading<sub>1</sub></a></li>
  <li><a href="#model-summary" id="toc-model-summary" class="nav-link" data-scroll-target="#model-summary">Model Summary</a></li>
  <li><a href="#compare-model-fit" id="toc-compare-model-fit" class="nav-link" data-scroll-target="#compare-model-fit">Compare model fit</a></li>
  <li><a href="#nested-or-non-nested" id="toc-nested-or-non-nested" class="nav-link" data-scroll-target="#nested-or-non-nested">Nested or Non-Nested?</a></li>
  <li><a href="#check-conditional-intraclass-correlation-coefficient-and-variance-explained" id="toc-check-conditional-intraclass-correlation-coefficient-and-variance-explained" class="nav-link" data-scroll-target="#check-conditional-intraclass-correlation-coefficient-and-variance-explained">Check Conditional intraclass correlation coefficient and variance explained</a></li>
  </ul></li>
  <li><a href="#formal-plot-for-reading1-model-1" id="toc-formal-plot-for-reading1-model-1" class="nav-link" data-scroll-target="#formal-plot-for-reading1-model-1">Formal plot for Reading<sub>1</sub> Model 1</a></li>
  <li><a href="#overall-interpretation" id="toc-overall-interpretation" class="nav-link" data-scroll-target="#overall-interpretation">Overall interpretation</a></li>
  </ul></li>
  <li><a href="#predicting-time-2-reading" id="toc-predicting-time-2-reading" class="nav-link" data-scroll-target="#predicting-time-2-reading">Predicting Time 2 Reading</a>
  <ul class="collapse">
  <li><a href="#reading-2-model-0-random-intercepts" id="toc-reading-2-model-0-random-intercepts" class="nav-link" data-scroll-target="#reading-2-model-0-random-intercepts">Reading 2 Model 0: Random Intercepts</a>
  <ul class="collapse">
  <li><a href="#check-model-assumptions" id="toc-check-model-assumptions" class="nav-link" data-scroll-target="#check-model-assumptions">Check model assumptions</a></li>
  <li><a href="#check-intraclass-correlation-coefficient" id="toc-check-intraclass-correlation-coefficient" class="nav-link" data-scroll-target="#check-intraclass-correlation-coefficient">Check Intraclass correlation coefficient</a></li>
  <li><a href="#variance-explained" id="toc-variance-explained" class="nav-link" data-scroll-target="#variance-explained">Variance Explained</a></li>
  </ul></li>
  <li><a href="#reading-2-model-1-level-1-fixed-effects-reading1" id="toc-reading-2-model-1-level-1-fixed-effects-reading1" class="nav-link" data-scroll-target="#reading-2-model-1-level-1-fixed-effects-reading1">Reading 2 Model 1: Level-1 Fixed Effects (Reading<sub>1</sub>)</a>
  <ul class="collapse">
  <li><a href="#exploratory-plot-for-reading1-predicting-reading2" id="toc-exploratory-plot-for-reading1-predicting-reading2" class="nav-link" data-scroll-target="#exploratory-plot-for-reading1-predicting-reading2">Exploratory Plot for Reading<sub>1</sub> predicting Reading<sub>2</sub></a></li>
  <li><a href="#model-summary-1" id="toc-model-summary-1" class="nav-link" data-scroll-target="#model-summary-1">Model Summary</a></li>
  <li><a href="#compare-model-fit-1" id="toc-compare-model-fit-1" class="nav-link" data-scroll-target="#compare-model-fit-1">Compare model fit</a></li>
  <li><a href="#check-the-variance-explained" id="toc-check-the-variance-explained" class="nav-link" data-scroll-target="#check-the-variance-explained">Check the variance explained</a></li>
  <li><a href="#formal-plot-for-model-1" id="toc-formal-plot-for-model-1" class="nav-link" data-scroll-target="#formal-plot-for-model-1">Formal plot for model 1</a></li>
  </ul></li>
  <li><a href="#reading-2-model-2-level-2-fixed-effects" id="toc-reading-2-model-2-level-2-fixed-effects" class="nav-link" data-scroll-target="#reading-2-model-2-level-2-fixed-effects">Reading 2 Model 2: Level-2 Fixed Effects</a></li>
  <li><a href="#reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts" id="toc-reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts" class="nav-link" data-scroll-target="#reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts">Reading 2 Model 3 = Model 2 + Random slopes uncorrelated with random intercepts</a></li>
  <li><a href="#reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts" id="toc-reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts" class="nav-link" data-scroll-target="#reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts">Reading 2 Model 4 = Model 3 + Random slopes correlated with random intercepts</a></li>
  <li><a href="#reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses" id="toc-reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses" class="nav-link" data-scroll-target="#reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses">Reading 2 Model 5 = Model 4 + Cross-Level Interaction of Reading<sub>1</sub> and School SES</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>This is a long tutorial. Don’t let that scare you. Once understood, the analyses themselves do not take that much time or effort to complete. My goal here is to give you a sense of your options when conducting analyses like these.</p>
<section id="load-packages" class="level1">
<h1>Load packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Data wrangling and visualization</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># Multilevel modeling</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># Model information</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats) <span class="co"># Model information and visualization</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># Model plots and tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-description" class="level1 page-columns page-full">
<h1>Data Description</h1>
<p>Suppose that statewide reforms in reading instruction appear to be successful in improving reading test scores, particularly in low-SES schools. We are not going to do a longitudinal analysis just yet. Here we are going to concentrate on understanding the relationships among reading scores and socioeconomic status.</p>
<div class="cell page-columns page-full">
<div id="tbl-data" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="aoqvxcpyta" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aoqvxcpyta table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aoqvxcpyta thead, #aoqvxcpyta tbody, #aoqvxcpyta tfoot, #aoqvxcpyta tr, #aoqvxcpyta td, #aoqvxcpyta th {
  border-style: none;
}

#aoqvxcpyta p {
  margin: 0;
  padding: 0;
}

#aoqvxcpyta .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aoqvxcpyta .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aoqvxcpyta .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aoqvxcpyta .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aoqvxcpyta .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aoqvxcpyta .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aoqvxcpyta .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aoqvxcpyta .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aoqvxcpyta .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aoqvxcpyta .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aoqvxcpyta .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aoqvxcpyta .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aoqvxcpyta .gt_spanner_row {
  border-bottom-style: hidden;
}

#aoqvxcpyta .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aoqvxcpyta .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aoqvxcpyta .gt_from_md > :first-child {
  margin-top: 0;
}

#aoqvxcpyta .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aoqvxcpyta .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aoqvxcpyta .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aoqvxcpyta .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aoqvxcpyta .gt_row_group_first td {
  border-top-width: 2px;
}

#aoqvxcpyta .gt_row_group_first th {
  border-top-width: 2px;
}

#aoqvxcpyta .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoqvxcpyta .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aoqvxcpyta .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aoqvxcpyta .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aoqvxcpyta .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoqvxcpyta .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aoqvxcpyta .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aoqvxcpyta .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aoqvxcpyta .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aoqvxcpyta .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aoqvxcpyta .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoqvxcpyta .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aoqvxcpyta .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoqvxcpyta .gt_left {
  text-align: left;
}

#aoqvxcpyta .gt_center {
  text-align: center;
}

#aoqvxcpyta .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aoqvxcpyta .gt_font_normal {
  font-weight: normal;
}

#aoqvxcpyta .gt_font_bold {
  font-weight: bold;
}

#aoqvxcpyta .gt_font_italic {
  font-style: italic;
}

#aoqvxcpyta .gt_super {
  font-size: 65%;
}

#aoqvxcpyta .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aoqvxcpyta .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aoqvxcpyta .gt_indent_1 {
  text-indent: 5px;
}

#aoqvxcpyta .gt_indent_2 {
  text-indent: 10px;
}

#aoqvxcpyta .gt_indent_3 {
  text-indent: 15px;
}

#aoqvxcpyta .gt_indent_4 {
  text-indent: 20px;
}

#aoqvxcpyta .gt_indent_5 {
  text-indent: 25px;
}

#aoqvxcpyta .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aoqvxcpyta div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Variable">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+c2Nob29sX2lkPC9jb2RlPg=="><span class="gt_from_md"><code>school_id</code></span></span></td>
<td headers="Description" class="gt_row gt_left">A code for the school</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+cmVhZGluZ18xPC9jb2RlPg=="><span class="gt_from_md"><code>reading_1</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each student’s reading test score in z-score units last year before the reform.</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+cmVhZGluZ18yPC9jb2RlPg=="><span class="gt_from_md"><code>reading_2</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each student’s reading test score in z-score units this year after the reform.</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+c2Nob29sX3NlczwvY29kZT4="><span class="gt_from_md"><code>school_ses</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each school’s average level of socioeconomic status, measured in z-score units</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Reading Scores Data Set Description
</figcaption>
</figure>
</div>
</div>
</section>
<section id="import-data" class="level1">
<h1>Import data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://github.com/wjschne/EDUC5529/raw/master/dhw4.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_id =</span> <span class="fu">factor</span>(school_id) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fct_reorder</span>(school_ses, mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 18257 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): school_id, reading_1, reading_2, school_ses

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Note that we have reordered the <code>school_id</code> factor by the <code>school_ses</code> variable. Doing so will make plotting the effects of SES easier.</p>
<p>Let’s view our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  school_id reading_1 reading_2 school_ses
  &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 1            -0.935     0.307     -0.704
2 1            -0.972     0.640     -0.704
3 1            -1.39      0.535     -0.704
4 1            -0.742     0.260     -0.704
5 1            -1.38      0.174     -0.704
6 1             0.461     1.11      -0.704</code></pre>
</div>
</div>
</section>
<section id="analysis-plan" class="level1">
<h1>Analysis Plan</h1>
<ul>
<li>Modeling Sequence for Time 1 Reading
<ol start="0" type="1">
<li>Random Intercepts</li>
<li>Mean SES Fixed Effect</li>
</ol></li>
<li>Modeling Sequence for Time 2 Reading
<ol start="0" type="1">
<li>Random Intercepts</li>
<li>Time 1 Reading Fixed Effect</li>
<li>Mean SES Fixed Effect</li>
<li>Random Slopes for Time 1 Reading</li>
<li>Correlation between Random Slopes and Intercepts</li>
<li>Time 1 Reading and Mean SES Interaction</li>
</ol></li>
</ul>
<p>Why is the modeling sequence so much more complicated for Reading at Time 2 comparing the modeling sequence for Reading at Time 1? Reading at Time 1 can only have a Level-2 covariate, which does not allow for random slopes. The introduction of a Level-1 covariate for Reading at Time 2 allows for the possibility of random slopes and correlations between slopes and intercepts. Having both a level-1 and level-2 predictor allows for cross-level interaction effects. That is, the effect of a level-1 predictor might depend on the value of a level-2 predictor.</p>
<p>Amazingly enough, this would be considered a fairly simple analysis plan. It seems like a lot, but when there are many predictors, the number of analysis options increases exponentially. In general, I endorse the following sequence:</p>
<ol type="1">
<li>Random Intercepts</li>
<li>Level 1 fixed effects</li>
<li>Level 1 interaction effects</li>
<li>Level 2 fixed effects</li>
<li>Level 2 interaction effects</li>
<li>Level 1 random slopes</li>
<li>Correlations between slopes and intercepts</li>
<li>Interactions between level 1 and level 2 variables (cross-level interactions)</li>
</ol>
<p>This sequence is not sacred. If you have good reasons to alter it, you may do so without raising any eyebrows.</p>
</section>
<section id="predicting-time-1-reading" class="level1 page-columns page-full">
<h1>Predicting Time 1 Reading</h1>
<p>If we want to understand how reading at time 1 (reading<sub>1</sub>) affects reading at time 2 (reading<sub>2</sub>), it can be helpful to model reading<sub>1</sub> first. For example, we might find that after controlling for reading<sub>1</sub>, socioeconomic status (SES) has a direct effect on reading<sub>2</sub>. If we do not model reading<sub>1</sub>, we might not realize that much of SES’s effect on reading is obscured because it also has indirect effects via reading<sub>1</sub>.</p>
<section id="reading1-model-0-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-0-random-intercepts">Reading<sub>1</sub> Model 0: Random Intercepts</h2>
<p>First we start modeling reading<sub>1</sub> with our multilevel “null” model: random intercepts. We will the model equations, then a table with a description of all symbols, then a visual representation fo the model in the form of a path diagram.</p>
<section id="model-0-equations" class="level3">
<h3 class="anchored" data-anchor-id="model-0-equations">Model 0 Equations</h3>
<p><span class="math display">\[
\begin{aligned}
\textbf{Level 1:}\\
Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\
e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+u_{0j}\\
u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00})\\
\textbf{Combined:}\\
Reading_{ij1} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij}
\end{aligned}
\]</span></p>
</section>
<section id="model-0-fully-annotated" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-0-fully-annotated">Model 0 Fully Annotated</h3>
<p><a href="#tbl-read1" class="quarto-xref">Table&nbsp;2</a> explains the meaning of the symbols in the Model 0 equations. The symbols I do not explain repeatedly are <span class="math inline">\(\sim\)</span> (“is distributed as.”) and <span class="math inline">\(\mathcal{N}\)</span> (normal disbribution). Thus, <span class="math inline">\(X\sim\mathcal{N}(\mu, \sigma^2)\)</span> means <span class="math inline">\(X\)</span> is a normally distributed random variable with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij1}$"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 1"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the classroom mean for class $j$"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the overall classroom mean for Time 1 Reading"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{aligned}</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 2}</span><span class="sc">\\\\</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{0j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{00}+u_{0j}</span><span class="sc">\\\\</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="st">  u_{0j}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">tau_{00})</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">end{aligned}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 1}</span><span class="sc">\\\\</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij1} &amp;= </span><span class="sc">\\</span><span class="st">beta_{0j}+e_{ij}</span><span class="sc">\\\\</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">sigma_e^2)</span><span class="sc">\\</span><span class="st">end{align*}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">textbf{Combined Model}</span><span class="sc">\\\\</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij1} &amp;= </span><span class="sc">\\</span><span class="st">underbrace{</span><span class="sc">\\</span><span class="st">gamma_{00}+u_{0j}}_{</span><span class="sc">\\</span><span class="st">beta_{0j}}+e_{ij}</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">end{align*}$$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fwsjqdoumf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fwsjqdoumf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fwsjqdoumf thead, #fwsjqdoumf tbody, #fwsjqdoumf tfoot, #fwsjqdoumf tr, #fwsjqdoumf td, #fwsjqdoumf th {
  border-style: none;
}

#fwsjqdoumf p {
  margin: 0;
  padding: 0;
}

#fwsjqdoumf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fwsjqdoumf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fwsjqdoumf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fwsjqdoumf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fwsjqdoumf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fwsjqdoumf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fwsjqdoumf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fwsjqdoumf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fwsjqdoumf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fwsjqdoumf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fwsjqdoumf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fwsjqdoumf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fwsjqdoumf .gt_spanner_row {
  border-bottom-style: hidden;
}

#fwsjqdoumf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fwsjqdoumf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fwsjqdoumf .gt_from_md > :first-child {
  margin-top: 0;
}

#fwsjqdoumf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fwsjqdoumf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fwsjqdoumf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fwsjqdoumf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fwsjqdoumf .gt_row_group_first td {
  border-top-width: 2px;
}

#fwsjqdoumf .gt_row_group_first th {
  border-top-width: 2px;
}

#fwsjqdoumf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fwsjqdoumf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fwsjqdoumf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fwsjqdoumf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fwsjqdoumf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fwsjqdoumf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fwsjqdoumf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fwsjqdoumf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fwsjqdoumf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fwsjqdoumf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fwsjqdoumf .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fwsjqdoumf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fwsjqdoumf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fwsjqdoumf .gt_left {
  text-align: left;
}

#fwsjqdoumf .gt_center {
  text-align: center;
}

#fwsjqdoumf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fwsjqdoumf .gt_font_normal {
  font-weight: normal;
}

#fwsjqdoumf .gt_font_bold {
  font-weight: bold;
}

#fwsjqdoumf .gt_font_italic {
  font-style: italic;
}

#fwsjqdoumf .gt_super {
  font-size: 65%;
}

#fwsjqdoumf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fwsjqdoumf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fwsjqdoumf .gt_indent_1 {
  text-indent: 5px;
}

#fwsjqdoumf .gt_indent_2 {
  text-indent: 10px;
}

#fwsjqdoumf .gt_indent_3 {
  text-indent: 15px;
}

#fwsjqdoumf .gt_indent_4 {
  text-indent: 20px;
}

#fwsjqdoumf .gt_indent_5 {
  text-indent: 25px;
}

#fwsjqdoumf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fwsjqdoumf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoxfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajF9XCk="><span class="gt_from_md">\(Reading_{ij1}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMQ=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 1</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIGNsYXNzcm9vbSBtZWFuIGZvciBjbGFzcyBcKGpcKQ=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgb3ZlcmFsbCBjbGFzc3Jvb20gbWVhbiBmb3IgVGltZSAxIFJlYWRpbmc="><span class="gt_from_md">Fixed Intercept. In this model, it is the overall classroom mean for Time 1 Reading</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMX0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K3VfezBqfX1fe1xiZXRhX3swan19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij1} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Random Intercepts Model for Reading at Time 1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="model-0-path-diagram" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-0-path-diagram">Model 0 Path Diagram</h3>
<p>Sometimes equations can be overwhelming, especially for complex models. It can help to visualize a model as a path diagram like <a href="#fig-read1" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>myfont <span class="ot">&lt;-</span> <span class="st">"Roboto Condensed"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggdiagram is an experimental package that can be installed </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("wjschne/ggdiagram")</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>my_intercept <span class="ot">&lt;-</span> <span class="fu">redefault</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  ob_ngon,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> .<span class="dv">7</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"1~1~"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex_radius =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"mm"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>my_path <span class="ot">&lt;-</span> <span class="fu">redefault</span>(connect, <span class="at">resect =</span> <span class="dv">2</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>my_error <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_circle, <span class="at">radius =</span> .<span class="dv">5</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>my_error_variance <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_variance,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">resect =</span> <span class="dv">1</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> .<span class="dv">4</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> <span class="dv">60</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">looseness =</span> <span class="fl">1.5</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="st">"right"</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>my_error_variance_label <span class="ot">&lt;-</span> <span class="fu">redefault</span>(</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  ob_latex,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">tex =</span> r<span class="st">"(</span><span class="sc">\t</span><span class="st">ext{</span><span class="sc">\e</span><span class="st">mph{σ}}^{</span><span class="sc">\t</span><span class="st">ext{2}}_{\mkern-1.5mu</span><span class="sc">\t</span><span class="st">ext{</span><span class="sc">\e</span><span class="st">mph{e}}})"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> .<span class="dv">3</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> myfont,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"sigma_e_2"</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">force_recompile =</span> F,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">delete_files =</span> F</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>my_path_label <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_label,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">13</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">position =</span> .<span class="dv">45</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.padding =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>my_coefficient <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_circle, <span class="at">radius =</span> .<span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"white"</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>my_residual <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_circle, <span class="at">radius =</span> .<span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"white"</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>my_residual_label <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_label, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>my_residual_variance <span class="ot">&lt;-</span> <span class="fu">redefault</span>(</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  ob_variance,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">resect =</span> <span class="dv">1</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">linewidth =</span> .<span class="dv">4</span>,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="dv">60</span>,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">looseness =</span> <span class="dv">2</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">where =</span> <span class="st">"right"</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>my_residual_variance_label <span class="ot">&lt;-</span> <span class="fu">redefault</span>(</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  ob_label,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">13</span>,</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.padding =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> .<span class="dv">5</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>my_observed <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_ellipse, <span class="at">m1 =</span> <span class="dv">20</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>my_observed_label <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_label, <span class="at">size =</span> <span class="dv">22</span>, <span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>my_observed_l2 <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_ellipse, <span class="at">m1 =</span> <span class="dv">20</span>, <span class="at">a =</span> .<span class="dv">7</span>, <span class="at">b =</span> .<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p_read1 <span class="ot">&lt;-</span> <span class="fu">ggdiagram</span>(myfont, <span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  {read_1 <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(<span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*Reading*~*1ij*~"</span>))} <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  {i_1 <span class="ot">&lt;-</span> <span class="fu">my_intercept</span>(<span class="at">label =</span> <span class="st">"1~1~"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(read_1, <span class="st">"left"</span>, <span class="dv">3</span>)} <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  {i12read1 <span class="ot">&lt;-</span> <span class="fu">my_path</span>(i_1, read_1)} <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  {b_0j <span class="ot">&lt;-</span> <span class="fu">my_coefficient</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> <span class="fu">midpoint</span>(i12read1),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"*&amp;beta;*~0*j*~"</span>)} <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  {i_2 <span class="ot">&lt;-</span> <span class="fu">my_intercept</span>(<span class="at">label =</span> <span class="st">"1~2~"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(b_0j, <span class="st">"above"</span>, <span class="fl">1.3</span>)} <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  {i12read1 <span class="ot">&lt;-</span> <span class="fu">my_path</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>      i_2,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      b_0j,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">my_path_label</span>(<span class="st">"*&amp;gamma;*~00~"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    )} <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  {e <span class="ot">&lt;-</span> <span class="fu">my_error</span>(<span class="at">label =</span> <span class="st">"*e*~*ij*~"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(read_1, <span class="st">"right"</span>, .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(e, read_1) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  {e_var <span class="ot">&lt;-</span> <span class="fu">my_error_variance</span>(e)} <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  {u_0j <span class="ot">&lt;-</span> <span class="fu">my_residual</span>(<span class="at">label =</span> <span class="fu">my_residual_label</span>(<span class="st">"*u*~0*j*~"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(b_0j, <span class="st">"below"</span>, .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_residual_variance</span>(</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    u_0j,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"below"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_residual_variance_label</span>(<span class="st">"*&amp;tau;*~00~"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(u_0j, b_0j) <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_error_variance_label</span>(<span class="at">center =</span> e_var<span class="sc">@</span><span class="fu">midpoint</span>())</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>p_read1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read1-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Path Diagram for Reading Time 1 Random Intercepts Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Path models have these characteristics:</p>
<ul>
<li>Observed variables are squares/rectangles.</li>
<li>Latent variables and residuals are circles/ellipses.</li>
<li>Regression coefficients are single-headed arrows leading from predictor to outcome.</li>
<li>Covariances are double-headed arrows between two variables.</li>
<li>Variances are double-headed arrows leading back to the same variable.</li>
<li>Intercepts/means are triangles with a “1” as a label.</li>
<li>Random coefficients are circles that lie on a path.</li>
</ul>
<p>The idea of representing random coefficients as latent variables (circles) on paths was proposed by <span class="citation" data-cites="curran2007">Curran &amp; Bauer (<a href="#ref-curran2007" role="doc-biblioref">2007</a>)</span>.</p>
</section>
</section>
<section id="reading1-model-0-in-r" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-0-in-r">Reading<sub>1</sub> Model 0 in R</h2>
<p>The <code>lmer</code> function from the lme4 package <span class="citation" data-cites="lme4">(<a href="#ref-lme4" role="doc-biblioref">Bates et al., 2015</a>)</span> specifies model formulas with fixed effects listed in the same way as in the <code>lm</code> function (ordinary least squares linear model) and random effects listed inside parentheses, with the grouping variable listed after a post symbol (<code>|</code>). Consider this model:</p>
<p><code>Y ~ 1 + X + (1 + X | group)</code></p>
<div id="fig-annotated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="annotatedequation.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Annotated formula for <code>lmer</code> models
</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m_read_1_0 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_id), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The fixed intercept is optional, but I like to include it for clarity. Omitting the fixed intercept looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(reading_1 <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> school_id), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div><p>In R, an outcome variable is placed on the left hand side of the tilde <code>~</code>. The first <code>1</code> means to specify an overall fixed intercept. The parentheses indicate a random effect. The <code>1</code> inside the parentheses means that a random intercept should be specified by the grouping variable, <code>school_id</code>.</p>
<p>Now we can use various tools to inspect the overall results</p>
<section id="check-assumptions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="check-assumptions">Check Assumptions</h3>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m_read_1_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-m10check" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-m10check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-m10check-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-m10check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Check assumptions for reading time 1 null model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nothing in the diagnostic plots in <a href="#fig-m10check" class="quarto-xref">Figure&nbsp;3</a> raises concerns.</p>
</section>
<section id="evaluate-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="evaluate-model">Evaluate Model</h3>
<p>As always, we can get a quick summary of the model like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_1_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_1 ~ 1 + (1 | school_id)
   Data: d

REML criterion at convergence: 33352

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.649 -0.673  0.005  0.668  4.035 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.655    0.809   
 Residual              0.337    0.580   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.00464    0.04695    -0.1</code></pre>
</div>
</div>
<p>An overall automated report:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m_read_1_0) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a constant (intercept-only) linear mixed model (estimated using REML
and nloptwrap optimizer) to predict reading_1 (formula: reading_1 ~ 1). The
model included school_id as random effect (formula: ~1 | school_id). The
model's intercept is at -4.64e-03 (95% CI [-0.10, 0.09], t(18254) = -0.10, p =
0.921).

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>There is not much to comment on here because this model does not attempt to explain anything. It will be a basis of comparison for the next model.</p>
<p>We can get a quick look at some performance metrics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m_read_1_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
33358.049 | 33358.051 | 33381.486 |      0.660 |      0.000 | 0.660 | 0.576 | 0.580</code></pre>
</div>
</div>
<p>The ICC for this model suggests that schools are highly segregated by reading ability. That is, variation by classroom accounts for 66% of the variance in reading<sub>1</sub>.</p>
<p>The <code>sjPlot:tab_model</code> function can produce a table that is very close to publication-ready:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m_read_1_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-m10table" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-m10table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.10&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.921</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.65</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.66</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.660</td>
</tr>

</tbody></table>

</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-m10table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Model summary for reading time 1 null model
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="reading1-model-1-l2-covariate" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-1-l2-covariate">Reading<sub>1</sub> Model 1: L2 Covariate</h2>
<p>This model builds upon the previous model by adding the classroom’s average socioeconomic status (SES) variable as a covariate. Because average SES varies by classroom instead of by individual, it is a level-2 covariate. It can be thought of as a predictor of the random intercept. Because the random intercept represents the classroom mean, the level 2 equation in this model is sometimes revered to as a <em>means-as-outcomes</em> model.</p>
<p>Note that SES’s coefficient is <em>γ</em><sub>01</sub>. The subscript of coefficient, 01, has a 0 in the first position, which tells us that this is a predictor of the random intercept (<em>β</em><sub>0<em>j</em></sub>). The 1 in the second position in the subscript tell us that this is the first predictor of the <em>β</em><sub>0<em>j</em></sub>.</p>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\
u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00})\\
\textbf{Combined:}\\
Reading_{ij1} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij1}$"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{01}$"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 1"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the classroom mean for class $j$"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is predicted classroom mean for Reading~1~ when SES is 0."</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Effect for SES. It represents the predicted increase in the classroom mean for Reading~1~ when SES increases by 1."</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{aligned}</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 2}</span><span class="sc">\\\\</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{0j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{00}+</span><span class="sc">\\</span><span class="st">gamma_{01}SES_j+u_{0j}</span><span class="sc">\\\\</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="st">  u_{0j}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">tau_{00})</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">end{aligned}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 1}</span><span class="sc">\\\\</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij1} &amp;= </span><span class="sc">\\</span><span class="st">beta_{0j}+e_{ij}</span><span class="sc">\\\\</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">sigma_e^2)</span><span class="sc">\\</span><span class="st">end{align*}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">textbf{Combined Model}</span><span class="sc">\\\\</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij1} &amp;= </span><span class="sc">\\</span><span class="st">underbrace{</span><span class="sc">\\</span><span class="st">gamma_{00}+</span><span class="sc">\\</span><span class="st">gamma_{01}SES_j+u_{0j}}_{</span><span class="sc">\\</span><span class="st">beta_{0j}}+e_{ij}</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">end{align*}$$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="kfdleatilz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#kfdleatilz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kfdleatilz thead, #kfdleatilz tbody, #kfdleatilz tfoot, #kfdleatilz tr, #kfdleatilz td, #kfdleatilz th {
  border-style: none;
}

#kfdleatilz p {
  margin: 0;
  padding: 0;
}

#kfdleatilz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kfdleatilz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kfdleatilz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kfdleatilz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kfdleatilz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kfdleatilz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kfdleatilz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kfdleatilz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kfdleatilz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kfdleatilz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kfdleatilz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kfdleatilz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kfdleatilz .gt_spanner_row {
  border-bottom-style: hidden;
}

#kfdleatilz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kfdleatilz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kfdleatilz .gt_from_md > :first-child {
  margin-top: 0;
}

#kfdleatilz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kfdleatilz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kfdleatilz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kfdleatilz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kfdleatilz .gt_row_group_first td {
  border-top-width: 2px;
}

#kfdleatilz .gt_row_group_first th {
  border-top-width: 2px;
}

#kfdleatilz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kfdleatilz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kfdleatilz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kfdleatilz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kfdleatilz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kfdleatilz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kfdleatilz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kfdleatilz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kfdleatilz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kfdleatilz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kfdleatilz .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kfdleatilz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kfdleatilz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kfdleatilz .gt_left {
  text-align: left;
}

#kfdleatilz .gt_center {
  text-align: center;
}

#kfdleatilz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kfdleatilz .gt_font_normal {
  font-weight: normal;
}

#kfdleatilz .gt_font_bold {
  font-weight: bold;
}

#kfdleatilz .gt_font_italic {
  font-style: italic;
}

#kfdleatilz .gt_super {
  font-size: 65%;
}

#kfdleatilz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kfdleatilz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kfdleatilz .gt_indent_1 {
  text-indent: 5px;
}

#kfdleatilz .gt_indent_2 {
  text-indent: 10px;
}

#kfdleatilz .gt_indent_3 {
  text-indent: 15px;
}

#kfdleatilz .gt_indent_4 {
  text-indent: 20px;
}

#kfdleatilz .gt_indent_5 {
  text-indent: 25px;
}

#kfdleatilz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kfdleatilz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoxfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajF9XCk="><span class="gt_from_md">\(Reading_{ij1}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMQ=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 1</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIGNsYXNzcm9vbSBtZWFuIGZvciBjbGFzcyBcKGpcKQ=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIHVfezBqfSZhbXA7XHNpbSBcbWF0aGNhbHtOfSgwLFx0YXVfezAwfSkgXGVuZHthbGlnbmVkfSQk"><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyBwcmVkaWN0ZWQgY2xhc3Nyb29tIG1lYW4gZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4gd2hlbiBTRVMgaXMgMC4="><span class="gt_from_md">Fixed Intercept. In this model, it is predicted classroom mean for Reading<sub>1</sub> when SES is 0.</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgRWZmZWN0IGZvciBTRVMuIEl0IHJlcHJlc2VudHMgdGhlIHByZWRpY3RlZCBpbmNyZWFzZSBpbiB0aGUgY2xhc3Nyb29tIG1lYW4gZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4gd2hlbiBTRVMgaW5jcmVhc2VzIGJ5IDEu"><span class="gt_from_md">Fixed Effect for SES. It represents the predicted increase in the classroom mean for Reading<sub>1</sub> when SES increases by 1.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMX0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2ordV97MGp9fV97XGJldGFfezBqfX0rZV97aWp9IFxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij1} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
<div class="quarto-table-caption margin-caption"><p>Reading Time 1 Model 1: Model 0 + Level 2 SES</p></div></div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p_read1 <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  {SES <span class="ot">&lt;-</span> <span class="fu">my_observed_l2</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> i_2 <span class="sc">%-|%</span> i_1,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*SES*~*j*~"</span>, <span class="at">vjust =</span> .<span class="dv">6</span>))} <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(SES<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"southeast"</span>), </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>          b_0j, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">my_path_label</span>(<span class="st">"*&amp;gamma;*~01~"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read1L2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read1L2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Reading Time 1 Model 0 + Level 2 SES
</figcaption>
</figure>
</div>
</div>
</div>
<section id="exploratory-plot-for-reading1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="exploratory-plot-for-reading1">Exploratory Plot for Reading<sub>1</sub></h3>
<p>It helps to get a rough plot to see what is happening. Let’s create and informal plot of <code>school_ses</code> with <code>reading_1</code>. We display individual reading scores as little points and the means for each school with big dots and error bars.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(school_ses, reading_1, <span class="at">color =</span> school_id)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"School SES"</span>, <span class="at">y =</span> <span class="st">"Reading at Time 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-m10plot" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-m10plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-m10plot-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-m10plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Mean SES predicting reading time 1
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-m10plot" class="quarto-xref">Figure&nbsp;5</a> we see that <code>school_ses</code> and <code>reading_1</code> are correlated. Why are all the data in columns? Because <code>school_ses</code> is the mean SES for each school. Every child in the same school has the same <code>school_ses</code>.</p>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">Model Summary</h3>
<p>We can create the model from scratch:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m_read_1_1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_1 <span class="sc">~</span> school_ses <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_id), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternately, we can update the previous model, which is usually safer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_read_1_1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m_read_1_0, . <span class="sc">~</span> . <span class="sc">+</span> school_ses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model can be summarized in many ways:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_1 ~ (1 | school_id) + school_ses
   Data: d

REML criterion at convergence: 33175

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.661 -0.674  0.006  0.665  4.032 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.354    0.595   
 Residual              0.337    0.580   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.00475    0.03467   -0.14
school_ses   0.54917    0.03472   15.82

Correlation of Fixed Effects:
           (Intr)
school_ses 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.891</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.35</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.51</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.307 / 0.662</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
33182.831 | 33182.833 | 33214.080 |      0.662 |      0.307 | 0.513 | 0.576 | 0.580</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |        95% CI | t(18253) |      p
--------------------------------------------------------------------
(Intercept) |   -4.75e-03 | 0.03 | [-0.07, 0.06] |    -0.14 | 0.891 
school ses  |        0.55 | 0.03 | [ 0.48, 0.62] |    15.82 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.59
SD (Residual)             |        0.58</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_1 with school_ses (formula: reading_1 ~ school_ses). The
model included school_id as random effect (formula: ~1 | school_id). The
model's total explanatory power is substantial (conditional R2 = 0.66) and the
part related to the fixed effects alone (marginal R2) is of 0.31. The model's
intercept, corresponding to school_ses = 0, is at -4.75e-03 (95% CI [-0.07,
0.06], t(18253) = -0.14, p = 0.891). Within this model:

  - The effect of school ses is statistically significant and positive (beta =
0.55, 95% CI [0.48, 0.62], t(18253) = 15.82, p &lt; .001; Std. beta = 0.55, 95% CI
[0.48, 0.62])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>The slope for school_ses is statistically significant and explains significant variance in <code>reading_1</code>.</p>
</section>
<section id="compare-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="compare-model-fit">Compare model fit</h3>
<p>We have many options for comparing models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |              m_read_1_0 |              m_read_1_1
----------------------------------------------------------------
(Intercept)  | -4.64e-03 (-0.10, 0.09) | -4.75e-03 (-0.07, 0.06)
school ses   |                         |      0.55 ( 0.48, 0.62)
----------------------------------------------------------------
Observations |                   18257 |                   18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.10&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.921</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.891</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.65 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.35 <sub>school_id</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.66</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.51</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.660</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.307 / 0.662</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_1_0: reading_1 ~ 1 + (1 | school_id)
m_read_1_1: reading_1 ~ (1 | school_id) + school_ses
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_1_0    3 33354 33377 -16674    33348                        
m_read_1_1    4 33173 33204 -16583    33165   183  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_1_0 | lmerMod | 33353.8 (&lt;.001) | 33353.8 (&lt;.001) | 33377.2 (&lt;.001)
m_read_1_1 | lmerMod | 33173.1 (&gt;.999) | 33173.1 (&gt;.999) | 33204.3 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_1_0 |      0.660 |      0.000 | 0.660 | 0.576 | 0.580
m_read_1_1 |      0.662 |      0.307 | 0.513 | 0.576 | 0.580</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_1_0 | lmerMod |       
m_read_1_1 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lmerTest<span class="sc">::</span><span class="fu">ranova</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
reading_1 ~ school_ses + (1 | school_id)
                npar logLik   AIC   LRT Df Pr(&gt;Chisq)    
&lt;none&gt;             4 -16587 33183                        
(1 | school_id)    3 -22333 44673 11492  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Using <code>school_ses</code> as an L2 covariate, Model 1 fits significantly better than Model 0.</p>
<p>When in doubt, the <code>anova</code> results are the most common way of comparing models. The comparison only works if you are comparing nested models with exactly the same data. The <code>anova</code> function will warn you if you add a predictor with missing data that causes the comparison to be misleading.</p>
<p>The AIC weights are probably your next best option, especially for comparing non-nested models. Here, our models are nested.</p>
</section>
<section id="nested-or-non-nested" class="level3">
<h3 class="anchored" data-anchor-id="nested-or-non-nested">Nested or Non-Nested?</h3>
<p>If you create one model from another by adding one or more features, the models are <em>nested</em>. If you create one model from another by adding some features AND removing other features, the models are <em>non-nested</em>.</p>
<section id="nested-models" class="level4">
<h4 class="anchored" data-anchor-id="nested-models">Nested Models</h4>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ A + B</code></p>
<p>These models are nested because we added predictor <code>B</code> to the first model.</p>
<p>These models are also nested because we are adding a random intercept:</p>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ A + (1 | id)</code></p>
<p>Nested models can differ by more than one feature. For example, the following models are nested because we add predictor <code>B</code> and the random slope for <code>A</code>:</p>
<p>Model 1: <code>Y ~ A + (1 | id)</code><br>
Model 2: <code>Y ~ A + B + (1 + A | id)</code></p>
</section>
<section id="non-nested-models" class="level4">
<h4 class="anchored" data-anchor-id="non-nested-models">Non-nested Models</h4>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ B</code></p>
<p>These models are non-nested because we add predictor <code>B</code> AND remove predictor <code>A</code>.</p>
<p>Model 1: <code>Y ~ A + (1 + A | id)</code><br>
Model 2: <code>Y ~ A + B + (1 | id)</code></p>
<p>These models are non-nested because we add predictor <code>B</code> but remove the random slopes for <code>A</code></p>
</section>
</section>
<section id="check-conditional-intraclass-correlation-coefficient-and-variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="check-conditional-intraclass-correlation-coefficient-and-variance-explained">Check Conditional intraclass correlation coefficient and variance explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">icc</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.513
  Unadjusted ICC: 0.355</code></pre>
</div>
</div>
<p>It looks like the conditional ICC is much lower than before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.662
     Marginal R2: 0.307</code></pre>
</div>
</div>
<p>It looks like the school SES explained a lot of variance.</p>
<p>How much does the level-2 random intercept variance <span class="math inline">\((\tau_{00})\)</span> shrink when we compare the two models we have run so far:</p>
<p><span class="math display">\[
\Delta R_2^2 = \frac{\tau_{00_0}-\tau_{00_1}}{\tau_{00_0}}
\]</span></p>
<p>We can also see how much variance was reduced in the level-1 residuals. The level-1 variance reduction is calculated like so:</p>
<p><span class="math display">\[
\Delta R_1^2 = \frac{\sigma_0^2-\sigma_1^2}{\sigma_0^2}
\]</span></p>
<p>I do not want to perform this calculation by hand, so I will make a function that automates the process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate variance reduction for levels 1 and 2</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>variance_reduction <span class="ot">&lt;-</span> <span class="cf">function</span>(m1, m2) {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  tau_00_1 <span class="ot">&lt;-</span> <span class="fu">get_variance_random</span>(m1)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  tau_00_2 <span class="ot">&lt;-</span> <span class="fu">get_variance_random</span>(m2)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  level2_reduction <span class="ot">&lt;-</span> (tau_00_1 <span class="sc">-</span> tau_00_2) <span class="sc">/</span> tau_00_1</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  sigma_1 <span class="ot">&lt;-</span> <span class="fu">get_sigma</span>(m1)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  sigma_2 <span class="ot">&lt;-</span> <span class="fu">get_sigma</span>(m2)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  level1_reduction <span class="ot">&lt;-</span> (sigma_1 <span class="sc">-</span> sigma_2) <span class="sc">/</span> sigma_1</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_1_variance =</span> <span class="fu">c</span>(sigma_1, tau_00_1),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_2_variance =</span> <span class="fu">c</span>(sigma_2, tau_00_2),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance_reduction =</span> <span class="fu">c</span>(level1_reduction, level2_reduction)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">variance_reduction</span>(m_read_1_0, m_read_1_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  level model_1_variance model_2_variance variance_reduction
  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;
1     1            0.580            0.580        -0.00000574
2     2            0.655            0.354         0.459     </code></pre>
</div>
</div>
<p>It looks like school SES explained a good bit of the level-2 intercept variability.</p>
<p>Because the school SES variable is a level-2 covariate, it cannot reduce level-1 residual variance.</p>
</section>
</section>
<section id="formal-plot-for-reading1-model-1" class="level2">
<h2 class="anchored" data-anchor-id="formal-plot-for-reading1-model-1">Formal plot for Reading<sub>1</sub> Model 1</h2>
<p>The <code>sjPlot::plot_model</code> function is a quick and easy way to create models of fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m_read_1_1, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"school_ses"</span>) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/m11plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overall-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="overall-interpretation">Overall interpretation</h2>
<p>It appears that schools vary greatly by their average <code>reading_1</code> scores. Almost half of this variability is explained by the school’s average SES, which is positively associated with <code>reading_1</code>.</p>
</section>
</section>
<section id="predicting-time-2-reading" class="level1 page-columns page-full">
<h1>Predicting Time 2 Reading</h1>
<p>Now we turn our attention to the reading comprehension at Time 2 variable, <code>reading_2</code>. We start with random intercepts and, as needed, add level 1 fixed effects, level 2 fixed effects, random slopes, and cross-level interaction effects.</p>
<section id="reading-2-model-0-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-0-random-intercepts">Reading 2 Model 0: Random Intercepts</h2>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+u_{0j}\\
u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00})\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the overall classroom mean for Time 2 Reading"</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>),</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{aligned}</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 2}</span><span class="sc">\\\\</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{0j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{00}+u_{0j}</span><span class="sc">\\\\</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="st">  u_{0j}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">tau_{00})</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">end{aligned}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 1}</span><span class="sc">\\\\</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\\</span><span class="st">beta_{0j}+e_{ij}</span><span class="sc">\\\\</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">sigma_e^2)</span><span class="sc">\\</span><span class="st">end{align*}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">textbf{Combined Model}</span><span class="sc">\\\\</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\\</span><span class="st">underbrace{</span><span class="sc">\\</span><span class="st">gamma_{00}+u_{0j}}_{</span><span class="sc">\\</span><span class="st">beta_{0j}}+e_{ij}</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span><span class="st">end{align*}$$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read2" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="oanqdmlwzk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oanqdmlwzk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oanqdmlwzk thead, #oanqdmlwzk tbody, #oanqdmlwzk tfoot, #oanqdmlwzk tr, #oanqdmlwzk td, #oanqdmlwzk th {
  border-style: none;
}

#oanqdmlwzk p {
  margin: 0;
  padding: 0;
}

#oanqdmlwzk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oanqdmlwzk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oanqdmlwzk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oanqdmlwzk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oanqdmlwzk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oanqdmlwzk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oanqdmlwzk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oanqdmlwzk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oanqdmlwzk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oanqdmlwzk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oanqdmlwzk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oanqdmlwzk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oanqdmlwzk .gt_spanner_row {
  border-bottom-style: hidden;
}

#oanqdmlwzk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oanqdmlwzk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oanqdmlwzk .gt_from_md > :first-child {
  margin-top: 0;
}

#oanqdmlwzk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oanqdmlwzk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oanqdmlwzk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oanqdmlwzk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oanqdmlwzk .gt_row_group_first td {
  border-top-width: 2px;
}

#oanqdmlwzk .gt_row_group_first th {
  border-top-width: 2px;
}

#oanqdmlwzk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oanqdmlwzk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oanqdmlwzk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oanqdmlwzk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oanqdmlwzk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oanqdmlwzk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oanqdmlwzk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oanqdmlwzk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oanqdmlwzk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oanqdmlwzk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oanqdmlwzk .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oanqdmlwzk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oanqdmlwzk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oanqdmlwzk .gt_left {
  text-align: left;
}

#oanqdmlwzk .gt_center {
  text-align: center;
}

#oanqdmlwzk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oanqdmlwzk .gt_font_normal {
  font-weight: normal;
}

#oanqdmlwzk .gt_font_bold {
  font-weight: bold;
}

#oanqdmlwzk .gt_font_italic {
  font-style: italic;
}

#oanqdmlwzk .gt_super {
  font-size: 65%;
}

#oanqdmlwzk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oanqdmlwzk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oanqdmlwzk .gt_indent_1 {
  text-indent: 5px;
}

#oanqdmlwzk .gt_indent_2 {
  text-indent: 10px;
}

#oanqdmlwzk .gt_indent_3 {
  text-indent: 15px;
}

#oanqdmlwzk .gt_indent_4 {
  text-indent: 20px;
}

#oanqdmlwzk .gt_indent_5 {
  text-indent: 25px;
}

#oanqdmlwzk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oanqdmlwzk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwp"><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgb3ZlcmFsbCBjbGFzc3Jvb20gbWVhbiBmb3IgVGltZSAyIFJlYWRpbmc="><span class="gt_from_md">Fixed Intercept. In this model, it is the overall classroom mean for Time 2 Reading</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K3VfezBqfX1fe1xiZXRhX3swan19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Reading at Time 2 Model 0: Random Intercepts
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>p_read1 <span class="sc">+</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_observed</span>(<span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*Reading*~*2ij*~"</span>),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">center =</span> read_1<span class="sc">@</span>center, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Path Diagram for Reading Time 2 Random Intercepts Model
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m_read_2_0 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_id), d)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ 1 + (1 | school_id)
   Data: d

REML criterion at convergence: 22814

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.076 -0.644  0.003  0.642  4.417 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.800    0.895   
 Residual              0.187    0.432   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.9891     0.0518    19.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.19</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.80</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.81</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.811</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
22819.501 | 22819.502 | 22842.937 |      0.811 |      0.000 | 0.811 | 0.428 | 0.432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |       95% CI | t(18254) |      p
-------------------------------------------------------------------
(Intercept) |        0.99 | 0.05 | [0.89, 1.09] |    19.11 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.89
SD (Residual)             |        0.43</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a constant (intercept-only) linear mixed model (estimated using REML
and nloptwrap optimizer) to predict reading_2 (formula: reading_2 ~ 1). The
model included school_id as random effect (formula: ~1 | school_id). The
model's intercept is at 0.99 (95% CI [0.89, 1.09], t(18254) = 19.11, p &lt; .001).

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<section id="check-model-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="check-model-assumptions">Check model assumptions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/m20check-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>All is well.</p>
</section>
<section id="check-intraclass-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="check-intraclass-correlation-coefficient">Check Intraclass correlation coefficient</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">icc</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.811
  Unadjusted ICC: 0.811</code></pre>
</div>
</div>
<p>The ICC for this model suggests that schools are highly segregated by reading ability. Because there are no fixed effects in the random intercepts model, the adjusted and conditional ICC are the same.</p>
</section>
<section id="variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="variance-explained">Variance Explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(m_read_2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.811
     Marginal R2: 0.000</code></pre>
</div>
</div>
<p>The conditional <span class="math inline">\(R^2\)</span> tells us the proportion of variance in the outcome variable explained by the grouping structure (i.e., the fact that each class has its own intercept) and the fixed effects. Because random intercepts models have no fixed effects, the conditional <span class="math inline">\(R^2\)</span> and the ICC are the same.</p>
<p>The marginal <span class="math inline">\(R^2\)</span> tells us the proportion of variance in the outcome variable explained by the fixed effects. For random intercepts models, the marginal <span class="math inline">\(R^2\)</span> is 0 because there are no fixed effects.</p>
</section>
</section>
<section id="reading-2-model-1-level-1-fixed-effects-reading1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-1-level-1-fixed-effects-reading1">Reading 2 Model 1: Level-1 Fixed Effects (Reading<sub>1</sub>)</h2>
<p>In the prediction of <code>reading_2</code>, we have an important level-1 covariate—<code>reading_1</code>.</p>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+u_{0j}\\
\beta_{1j}&amp;=\gamma_{10}\\
u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00})\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\
&amp;\text{Fixed vs. Random Effects}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{L2 Random}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{10}$"</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when reading~1~ is 0."</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope for reading~1~ for class $j$. In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: $</span><span class="sc">\\</span><span class="st">beta_{1j} = </span><span class="sc">\\</span><span class="st">gamma_{10}$."</span>,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading~1~ is zero."</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for reading~1~. When reading~1~ increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>),</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{aligned}</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 2}</span><span class="sc">\\\\</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{0j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{00}+u_{0j}</span><span class="sc">\\\\</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{1j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{10}</span><span class="sc">\\\\</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="st">  u_{0j}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">tau_{00})</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">end{aligned}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 1}</span><span class="sc">\\\\</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\\</span><span class="st">beta_{0j}+</span><span class="sc">\\</span><span class="st">beta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc">\\\\</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">sigma_e^2)</span><span class="sc">\\</span><span class="st">end{align*}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">extbf{Combined:}</span><span class="sc">\\</span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{</span><span class="sc">\b</span><span class="st">eta_{0j}}+\underbrace{\gamma_{10}}_{</span><span class="sc">\b</span><span class="st">eta_{1j}}Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;</span><span class="sc">\t</span><span class="st">ext{Fixed vs. Random Effects}</span><span class="sc">\\</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{10}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Fixed}}+\underbrace{u_{0j}}_{</span><span class="sc">\t</span><span class="st">ext{L2 Random}}+e_{ij}</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read2L1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rpwfksrwkl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rpwfksrwkl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rpwfksrwkl thead, #rpwfksrwkl tbody, #rpwfksrwkl tfoot, #rpwfksrwkl tr, #rpwfksrwkl td, #rpwfksrwkl th {
  border-style: none;
}

#rpwfksrwkl p {
  margin: 0;
  padding: 0;
}

#rpwfksrwkl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rpwfksrwkl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rpwfksrwkl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rpwfksrwkl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rpwfksrwkl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rpwfksrwkl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rpwfksrwkl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rpwfksrwkl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rpwfksrwkl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rpwfksrwkl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rpwfksrwkl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rpwfksrwkl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rpwfksrwkl .gt_spanner_row {
  border-bottom-style: hidden;
}

#rpwfksrwkl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rpwfksrwkl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rpwfksrwkl .gt_from_md > :first-child {
  margin-top: 0;
}

#rpwfksrwkl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rpwfksrwkl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rpwfksrwkl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rpwfksrwkl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rpwfksrwkl .gt_row_group_first td {
  border-top-width: 2px;
}

#rpwfksrwkl .gt_row_group_first th {
  border-top-width: 2px;
}

#rpwfksrwkl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rpwfksrwkl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rpwfksrwkl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rpwfksrwkl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rpwfksrwkl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rpwfksrwkl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rpwfksrwkl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rpwfksrwkl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rpwfksrwkl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rpwfksrwkl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rpwfksrwkl .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rpwfksrwkl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rpwfksrwkl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rpwfksrwkl .gt_left {
  text-align: left;
}

#rpwfksrwkl .gt_center {
  text-align: center;
}

#rpwfksrwkl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rpwfksrwkl .gt_font_normal {
  font-weight: normal;
}

#rpwfksrwkl .gt_font_bold {
  font-weight: bold;
}

#rpwfksrwkl .gt_font_italic {
  font-style: italic;
}

#rpwfksrwkl .gt_super {
  font-size: 65%;
}

#rpwfksrwkl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rpwfksrwkl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rpwfksrwkl .gt_indent_1 {
  text-indent: 5px;
}

#rpwfksrwkl .gt_indent_2 {
  text-indent: 10px;
}

#rpwfksrwkl .gt_indent_3 {
  text-indent: 15px;
}

#rpwfksrwkl .gt_indent_4 {
  text-indent: 20px;
}

#rpwfksrwkl .gt_indent_5 {
  text-indent: 25px;
}

#rpwfksrwkl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rpwfksrwkl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLiBJbiB0aGlzIG1vZGVsLCBob3dldmVyLCB0aGVyZSBhcmUgbm8gcmFuZG9tIHNsb3Blcy4gVGh1cywgdGhlIHNsb3BlIGZvciBldmVyeSBjbGFzc3Jvb20gaXMgdGhlIHNhbWU6IFwoXGJldGFfezFqfSA9IFxnYW1tYV97MTB9XCku"><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\). In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: \(\beta_{1j} = \gamma_{10}\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCBcYmV0YV97MWp9JmFtcDs9XGdhbW1hX3sxMH1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgcmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for reading<sub>1</sub>. When reading<sub>1</sub> increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfSt1X3swan19X3tcYmV0YV97MGp9fStcdW5kZXJicmFjZXtcZ2FtbWFfezEwfX1fe1xiZXRhX3sxan19UmVhZGluZ197aWoxfStlX3tpan1cXCAmYW1wO1x0ZXh0e0ZpeGVkIHZzLiBSYW5kb20gRWZmZWN0c31cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezEwfVJlYWRpbmdfe2lqMX19X3tcdGV4dHtGaXhlZH19K1x1bmRlcmJyYWNle3VfezBqfX1fe1x0ZXh0e0wyIFJhbmRvbX19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{L2 Random}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Reading at Time 2 Model 1: Model 0 + L1 Covariate (Reading<sub>1</sub>)
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>p_read2L1 <span class="ot">&lt;-</span> <span class="fu">ggdiagram</span>(myfont, <span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  {read_2 <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*Reading*~*2ij*~"</span>))} <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  {read_1 <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*Reading*~*1ij*~"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(read_2, <span class="st">"left"</span>, <span class="dv">5</span>)} <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  {i_1 <span class="ot">&lt;-</span> <span class="fu">my_intercept</span>(<span class="at">label =</span> <span class="st">"1~1~"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(read_1, <span class="st">"above"</span>, <span class="fl">2.9</span>)} <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  {i12read2 <span class="ot">&lt;-</span> <span class="fu">my_path</span>(i_1, read_2)} <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  {r1r2 <span class="ot">&lt;-</span> <span class="fu">my_path</span>(read_1, read_2)} <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  {b_0j <span class="ot">&lt;-</span> <span class="fu">my_coefficient</span>(</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">center =</span> <span class="fu">midpoint</span>(i12read2, <span class="at">position =</span> .<span class="dv">25</span>),</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"*&amp;beta;*~0*j*~"</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    )} <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  {b_1j <span class="ot">&lt;-</span> <span class="fu">my_coefficient</span>(</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">center =</span> <span class="fu">midpoint</span>(r1r2, <span class="at">position =</span> .<span class="dv">65</span>),</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"*&amp;beta;*~1*j*~"</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    )} <span class="sc">+</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  {i_2 <span class="ot">&lt;-</span> <span class="fu">my_intercept</span>(</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"1~2~"</span>, </span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> <span class="fu">intersection</span>(</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rotate</span>(i12read2<span class="sc">@</span>line, </span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">theta =</span> <span class="fu">turn</span>(<span class="sc">-</span>.<span class="dv">25</span>), </span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">origin =</span> b_0j<span class="sc">@</span>center),</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ob_line</span>(<span class="at">xintercept =</span> b_1j<span class="sc">@</span>center<span class="sc">@</span>x)))} <span class="sc">+</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  {i22b0j <span class="ot">&lt;-</span> <span class="fu">my_path</span>(</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>      i_2,</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>      b_0j,</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">my_path_label</span>(</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*&amp;gamma;*~00~"</span>)</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  )} <span class="sc">+</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  {i22b1j <span class="ot">&lt;-</span> <span class="fu">my_path</span>(</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>      i_2,</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>      b_1j,</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">my_path_label</span>(</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"*&amp;gamma;*~10~"</span>)</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    )} <span class="sc">+</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  {e <span class="ot">&lt;-</span> <span class="fu">my_error</span>(<span class="at">label =</span> <span class="st">"*e*~*ij*~"</span>, <span class="at">radius =</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(read_2, <span class="st">"right"</span>, .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(e, read_2) <span class="sc">+</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>  {e_var <span class="ot">&lt;-</span> <span class="fu">my_error_variance</span>(e)} <span class="sc">+</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>  {u_0j <span class="ot">&lt;-</span> <span class="fu">my_residual</span>(<span class="at">label =</span> <span class="fu">my_residual_label</span>(<span class="st">"*u*~0*j*~"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(b_0j, i12read2<span class="sc">@</span>line<span class="sc">@</span>angle <span class="sc">-</span> <span class="fu">turn</span>(.<span class="dv">25</span>), .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_residual_variance</span>(</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>    u_0j,</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>    i12read2<span class="sc">@</span>line<span class="sc">@</span>angle <span class="sc">-</span> <span class="fu">turn</span>(.<span class="dv">25</span>),</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_residual_variance_label</span>(</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">"*&amp;tau;*~00~"</span>)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(u_0j, b_0j) <span class="sc">+</span></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_error_variance_label</span>(<span class="at">center =</span> e_var<span class="sc">@</span><span class="fu">midpoint</span>()) </span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>p_read2L1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read2L1-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Reading Time 2 Random Intercepts Model + Level 1 Covariate
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that <span class="math inline">\(\beta_{1j}\)</span> could have been random, but it is equal to the constant <span class="math inline">\(\gamma_{10}\)</span> in this model.</p>
<section id="exploratory-plot-for-reading1-predicting-reading2" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-plot-for-reading1-predicting-reading2">Exploratory Plot for Reading<sub>1</sub> predicting Reading<sub>2</sub></h3>
<p>It helps to get an exploratory plot to see what is happening. This is not the model 1 plot. I am letting the data speak.</p>
<p>The schools with the lighter (yellower) regression lines have higher SES.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(reading_1, reading_2, <span class="at">color =</span> school_ses)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> school_ses, <span class="at">group =</span> school_id),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="st">"School</span><span class="sc">\n</span><span class="st">SES"</span>) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reading (Time 1)"</span>, <span class="at">y =</span> <span class="st">"Reading (Time 2)"</span>, <span class="at">caption =</span> <span class="st">""</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/reading2plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Interesting…</p>
<p>To my eye, it looks like <code>reading_1</code> and <code>reading_2</code> are correlated, but less so in schools with high SES.</p>
<p>Let’s model it formally. First, we add the L1 covariate <code>reading_1</code> to our model.</p>
</section>
<section id="model-summary-1" class="level3">
<h3 class="anchored" data-anchor-id="model-summary-1">Model Summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>m_read_2_1 <span class="ot">&lt;-</span> <span class="fu">update</span>(m_read_2_0, . <span class="sc">~</span> . <span class="sc">+</span> reading_1)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ (1 | school_id) + reading_1
   Data: d

REML criterion at convergence: 15765

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.959 -0.670  0.005  0.673  4.094 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.549    0.741   
 Residual              0.127    0.356   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.99108    0.04287    23.1
reading_1    0.42342    0.00456    92.8

Correlation of Fixed Effects:
          (Intr)
reading_1 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_2 with reading_1 (formula: reading_2 ~ reading_1). The model
included school_id as random effect (formula: ~1 | school_id). The model's
total explanatory power is substantial (conditional R2 = 0.85) and the part
related to the fixed effects alone (marginal R2) is of 0.21. The model's
intercept, corresponding to reading_1 = 0, is at 0.99 (95% CI [0.91, 1.08],
t(18253) = 23.12, p &lt; .001). Within this model:

  - The effect of reading 1 is statistically significant and positive (beta =
0.42, 95% CI [0.41, 0.43], t(18253) = 92.82, p &lt; .001; Std. beta = 0.42, 95% CI
[0.41, 0.43])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
15773.337 | 15773.339 | 15804.586 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI | t(18253) |      p
-----------------------------------------------------------------------
(Intercept) |        0.99 |     0.04 | [0.91, 1.08] |    23.12 | &lt; .001
reading 1   |        0.42 | 4.56e-03 | [0.41, 0.43] |    92.82 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.74
SD (Residual)             |        0.36</code></pre>
</div>
</div>
<p>Clearly, <code>reading_1</code> is a significant covariate.</p>
</section>
<section id="compare-model-fit-1" class="level3">
<h3 class="anchored" data-anchor-id="compare-model-fit-1">Compare model fit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m_read_2_0, m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_0 |        m_read_2_1
----------------------------------------------------
(Intercept)  | 0.99 (0.89, 1.09) | 0.99 (0.91, 1.08)
reading 1    |                   | 0.42 (0.41, 0.43)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m_read_2_0, m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_0 | lmerMod | 22815.4 (&lt;.001) | 22815.4 (&lt;.001) | 22838.9 (&lt;.001)
m_read_2_1 | lmerMod | 15759.9 (&gt;.999) | 15759.9 (&gt;.999) | 15791.2 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_0 |      0.811 |      0.000 | 0.811 | 0.428 | 0.432
m_read_2_1 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_likelihoodratio</span>(m_read_2_0, m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name       |   Model | df | df_diff |    Chi2 |      p
------------------------------------------------------
m_read_2_0 | lmerMod |  3 |         |         |       
m_read_2_1 | lmerMod |  4 |       1 | 7057.48 | &lt; .001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(m_read_2_0, m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_0 | lmerMod |       
m_read_2_1 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<p>Using reading_1 as an L1 covariate, the model fits significantly better.</p>
</section>
<section id="check-the-variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="check-the-variance-explained">Check the variance explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.852
     Marginal R2: 0.210</code></pre>
</div>
</div>
<p>In this model, the <code>reading_1</code> covariate explained 0.21 of variance in <code>reading_2</code>.</p>
<p>We can also see how much variance was reduced in the levels 1 and 2 residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">variance_reduction</span>(m_read_2_0, m_read_2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  level model_1_variance model_2_variance variance_reduction
  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;
1     1            0.432            0.356              0.176
2     2            0.800            0.549              0.314</code></pre>
</div>
</div>
<p>It looks like <code>reading_1</code> explained substantial amounts of variance in residuals at both levels.</p>
</section>
<section id="formal-plot-for-model-1" class="level3">
<h3 class="anchored" data-anchor-id="formal-plot-for-model-1">Formal plot for model 1</h3>
<p>Quick plot of fixed effects only:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m_read_2_1, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"reading_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/m21plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>To see all the data with the separate regression lines:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">augment</span>(m_read_2_1) <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(reading_1, reading_2, <span class="at">color =</span> school_id)) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fixed), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/m21plotfull-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Note that all the regression lines are parallel. Why? Because we did not allow them to differ.</p>
</section>
</section>
<section id="reading-2-model-2-level-2-fixed-effects" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-2-level-2-fixed-effects">Reading 2 Model 2: Level-2 Fixed Effects</h2>
<p>Let’s add <code>school_ses</code> as a level-2 covariate. In essence, we are trying to explain why the L2 random intercept <span class="math inline">\((\beta_{0j})\)</span> differs from school to school: <span class="math inline">\(\beta_{0j}=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\)</span></p>
<p>Here is the complete model:</p>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\
\beta_{1j}&amp;=\gamma_{10}\\
u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00})\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{Random}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{01}$"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{10}$"</span>,</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when reading~1~ is 0."</span>,</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope for reading~1~ for class $j$. In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: $</span><span class="sc">\\</span><span class="st">beta_{1j} = </span><span class="sc">\\</span><span class="st">gamma_{10}$."</span>,</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading~1~ is zero."</span>,</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for SES. When SES increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for reading~1~. When reading~1~ increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~ when SES is zero."</span>,</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>),</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{aligned}</span></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 2}</span><span class="sc">\\\\</span></span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{0j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{00}+</span><span class="sc">\\</span><span class="st">gamma_{01}SES_j+u_{0j}</span><span class="sc">\\\\</span></span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">beta_{1j}&amp;=</span><span class="sc">\\</span><span class="st">gamma_{10}</span><span class="sc">\\\\</span></span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a><span class="st">  u_{0j}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">tau_{00})</span></span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">end{aligned}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{align*}</span></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\\</span><span class="st">textbf{Level 1}</span><span class="sc">\\\\</span></span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\\</span><span class="st">beta_{0j}+</span><span class="sc">\\</span><span class="st">beta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc">\\\\</span></span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;</span><span class="sc">\\</span><span class="st">sim </span><span class="sc">\\</span><span class="st">mathcal{N}(0,</span><span class="sc">\\</span><span class="st">sigma_e^2)</span><span class="sc">\\</span><span class="st">end{align*}$$"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">extbf{Combined:}</span><span class="sc">\\</span></span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc">\b</span><span class="st">eta_{0j}}+\underbrace{\gamma_{10}}_{</span><span class="sc">\b</span><span class="st">eta_{1j}}Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;</span><span class="sc">\t</span><span class="st">ext{Fixed vs. Random Effects}</span><span class="sc">\\</span></span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Fixed}}+\underbrace{u_{0j}}_{</span><span class="sc">\t</span><span class="st">ext{L2 Random}}+e_{ij}</span></span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read2L1L1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bvplaheiar" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bvplaheiar table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bvplaheiar thead, #bvplaheiar tbody, #bvplaheiar tfoot, #bvplaheiar tr, #bvplaheiar td, #bvplaheiar th {
  border-style: none;
}

#bvplaheiar p {
  margin: 0;
  padding: 0;
}

#bvplaheiar .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bvplaheiar .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bvplaheiar .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bvplaheiar .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bvplaheiar .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bvplaheiar .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvplaheiar .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bvplaheiar .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bvplaheiar .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bvplaheiar .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bvplaheiar .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bvplaheiar .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bvplaheiar .gt_spanner_row {
  border-bottom-style: hidden;
}

#bvplaheiar .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bvplaheiar .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bvplaheiar .gt_from_md > :first-child {
  margin-top: 0;
}

#bvplaheiar .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bvplaheiar .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bvplaheiar .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bvplaheiar .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bvplaheiar .gt_row_group_first td {
  border-top-width: 2px;
}

#bvplaheiar .gt_row_group_first th {
  border-top-width: 2px;
}

#bvplaheiar .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvplaheiar .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bvplaheiar .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bvplaheiar .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvplaheiar .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvplaheiar .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bvplaheiar .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bvplaheiar .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bvplaheiar .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvplaheiar .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bvplaheiar .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvplaheiar .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bvplaheiar .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvplaheiar .gt_left {
  text-align: left;
}

#bvplaheiar .gt_center {
  text-align: center;
}

#bvplaheiar .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bvplaheiar .gt_font_normal {
  font-weight: normal;
}

#bvplaheiar .gt_font_bold {
  font-weight: bold;
}

#bvplaheiar .gt_font_italic {
  font-style: italic;
}

#bvplaheiar .gt_super {
  font-size: 65%;
}

#bvplaheiar .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bvplaheiar .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bvplaheiar .gt_indent_1 {
  text-indent: 5px;
}

#bvplaheiar .gt_indent_2 {
  text-indent: 10px;
}

#bvplaheiar .gt_indent_3 {
  text-indent: 15px;
}

#bvplaheiar .gt_indent_4 {
  text-indent: 20px;
}

#bvplaheiar .gt_indent_5 {
  text-indent: 25px;
}

#bvplaheiar .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bvplaheiar div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLiBJbiB0aGlzIG1vZGVsLCBob3dldmVyLCB0aGVyZSBhcmUgbm8gcmFuZG9tIHNsb3Blcy4gVGh1cywgdGhlIHNsb3BlIGZvciBldmVyeSBjbGFzc3Jvb20gaXMgdGhlIHNhbWU6IFwoXGJldGFfezFqfSA9IFxnYW1tYV97MTB9XCku"><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\). In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: \(\beta_{1j} = \gamma_{10}\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfVxcIHVfezBqfSZhbXA7XHNpbSBcbWF0aGNhbHtOfSgwLFx0YXVfezAwfSkgXGVuZHthbGlnbmVkfSQk"><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIHJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgcmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for reading<sub>1</sub>. When reading<sub>1</sub> increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+IHdoZW4gU0VTIGlzIHplcm8u"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub> when SES is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19K1x1bmRlcmJyYWNle1xnYW1tYV97MTB9fV97XGJldGFfezFqfX1SZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWR9fStcdW5kZXJicmFjZXt1X3swan19X3tcdGV4dHtMMiBSYW5kb219fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{L2 Random}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Reading at Time 2 Model 1: Model 1 + L2 Covariate (SES)
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>p_read2L1L2 <span class="ot">&lt;-</span> p_read2L1 <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  {SES <span class="ot">&lt;-</span> <span class="fu">my_observed_l2</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> b_0j <span class="sc">%-|%</span> read_2,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_observed_label</span>(<span class="st">"*SES*~*j*~"</span>, <span class="at">vjust =</span> .<span class="dv">6</span>))} <span class="sc">+</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(SES, b_0j, <span class="at">label =</span> <span class="fu">my_path_label</span>(<span class="st">"*&amp;gamma;*~01~"</span>, <span class="at">position =</span> .<span class="dv">4</span>))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>p_read2L1L2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read2L1L2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Reading Time 2 Model with Level 1 and Level 2 Covariates
</figcaption>
</figure>
</div>
</div>
</div>
<p>Creating the entire model from scratch:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>m_read_2_2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> school_ses <span class="sc">+</span> reading_1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_id), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, updating from a previous model is generally safer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>m_read_2_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m_read_2_1, . <span class="sc">~</span> . <span class="sc">+</span> school_ses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ (1 | school_id) + reading_1 + school_ses
   Data: d

REML criterion at convergence: 15496

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.933 -0.667  0.005  0.673  4.072 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.218    0.467   
 Residual              0.127    0.356   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.99104    0.02709    36.6
reading_1    0.41722    0.00456    91.6
school_ses   0.57772    0.02725    21.2

Correlation of Fixed Effects:
           (Intr) rdng_1
reading_1   0.001       
school_ses  0.000 -0.092</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
15506.071 | 15506.075 | 15545.133 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI | t(18252) |      p
-----------------------------------------------------------------------
(Intercept) |        0.99 |     0.03 | [0.94, 1.04] |    36.58 | &lt; .001
reading 1   |        0.42 | 4.56e-03 | [0.41, 0.43] |    91.58 | &lt; .001
school ses  |        0.58 |     0.03 | [0.52, 0.63] |    21.20 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.47
SD (Residual)             |        0.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_2 with reading_1 and school_ses (formula: reading_2 ~
reading_1 + school_ses). The model included school_id as random effect
(formula: ~1 | school_id). The model's total explanatory power is substantial
(conditional R2 = 0.89) and the part related to the fixed effects alone
(marginal R2) is of 0.70. The model's intercept, corresponding to reading_1 = 0
and school_ses = 0, is at 0.99 (95% CI [0.94, 1.04], t(18252) = 36.58, p &lt;
.001). Within this model:

  - The effect of reading 1 is statistically significant and positive (beta =
0.42, 95% CI [0.41, 0.43], t(18252) = 91.58, p &lt; .001; Std. beta = 0.42, 95% CI
[0.41, 0.43])
  - The effect of school ses is statistically significant and positive (beta =
0.58, 95% CI [0.52, 0.63], t(18252) = 21.20, p &lt; .001; Std. beta = 0.58, 95% CI
[0.53, 0.64])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Compare <code>m_read_2_1</code> and <code>m_read_2_2</code> with the <code>anova</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m_read_2_1, m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_1 |        m_read_2_2
----------------------------------------------------
(Intercept)  | 0.99 (0.91, 1.08) | 0.99 (0.94, 1.04)
reading 1    | 0.42 (0.41, 0.43) | 0.42 (0.41, 0.43)
school ses   |                   | 0.58 (0.52, 0.63)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_read_2_1, m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_2_1: reading_2 ~ (1 | school_id) + reading_1
m_read_2_2: reading_2 ~ (1 | school_id) + reading_1 + school_ses
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_2_1    4 15760 15791  -7876    15752                        
m_read_2_2    5 15486 15525  -7738    15476   276  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m_read_2_1, m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_1 | lmerMod | 15759.9 (&lt;.001) | 15759.9 (&lt;.001) | 15791.2 (&lt;.001)
m_read_2_2 | lmerMod | 15486.4 (&gt;.999) | 15486.4 (&gt;.999) | 15525.4 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_1 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356
m_read_2_2 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(m_read_2_1, m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_1 | lmerMod |       
m_read_2_2 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<p>A quick plot of the model’s fixed effects form the <a href="http://www.strengejacke.de/sjPlot/index.html">sjPlot package</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m_read_2_2, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_1"</span>, <span class="st">"school_ses"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="random_slopes_files/figure-html/m22plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The first term (<code>reading_1</code>) is on the x-axis. The second term (<code>school_ses</code>) is plotted at its mean and plus or minus 1 standard deviation.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is <code>school_ses</code> a significant predictor?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Comparing Models 1 and 2, by how much did <code>school_ses</code> reduce L2 variability?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use the <code>variance_reduction</code> function defined earlier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">variance_reduction</span>(m_read_2_1, m_read_2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts">Reading 2 Model 3 = Model 2 + Random slopes uncorrelated with random intercepts</h2>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\
\beta_{1j}&amp;=\gamma_{10}+u_{1j}\\
\boldsymbol{u}&amp;=\begin{bmatrix}
u_{0j}\\
u_{1j}
\end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix}
0\\
0
\end{bmatrix}
\begin{matrix}
\\
,
\end{matrix}
\begin{bmatrix}
\tau_{00} &amp;\\
0 &amp; \tau_{11}
\end{bmatrix}\right)\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij}
\end{align}
\]</span></p>
<p>In the equations above, how can you tell that the slopes and intercepts are uncorrelated? Look at the <em>tau</em> matrix:</p>
<p><span class="math display">\[
\boldsymbol{\tau}=\begin{bmatrix}\tau_{00}&amp;\\ 0 &amp; \tau_{11}\end{bmatrix}
\]</span></p>
<p>Here we see that the lower right corner, the covariance between <span class="math inline">\(u_{0j}\)</span> and <span class="math inline">\(u_{1j}\)</span>, <span class="math inline">\(\tau_{10}\)</span>, is zero. Because the matrix is symmetric, I omitted the 0 in the upper right position.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{01}$"</span>,</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{10}$"</span>,</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{u}$"</span>,</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{1j}$"</span>,</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span>,</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{11}$"</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vector of L2 residuals"</span>,</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$."</span>,</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random slope $</span><span class="sc">\\</span><span class="st">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>,</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{1j}$"</span>),</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{aligned}</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 2}</span><span class="sc">\\</span></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc">\\</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{1j}&amp;=\gamma_{10}</span><span class="sc">\\</span></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">oldsymbol{u}&amp;=</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a><span class="st">u_{0j}</span><span class="sc">\\</span></span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a><span class="st">u_{1j}</span></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a><span class="st">0</span><span class="sc">\\</span></span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span></span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{matrix}</span></span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a><span class="st">,</span></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{matrix}</span></span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">au_{00} &amp;</span><span class="sc">\\</span></span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a><span class="st">0 &amp; </span><span class="sc">\t</span><span class="st">au_{11}</span></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span><span class="sc">\r</span><span class="st">ight)</span></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\e</span><span class="st">nd{aligned}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 1}</span><span class="sc">\\</span></span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\b</span><span class="st">eta_{0j}+</span><span class="sc">\b</span><span class="st">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">extbf{Combined:}</span><span class="sc">\\</span></span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc">\b</span><span class="st">eta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{</span><span class="sc">\b</span><span class="st">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;</span><span class="sc">\t</span><span class="st">ext{Fixed vs. Random Effects}</span><span class="sc">\\</span></span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Random Effects}}+e_{ij}</span></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read2L1L1uncorrelated" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="yqdzckdkqu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yqdzckdkqu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yqdzckdkqu thead, #yqdzckdkqu tbody, #yqdzckdkqu tfoot, #yqdzckdkqu tr, #yqdzckdkqu td, #yqdzckdkqu th {
  border-style: none;
}

#yqdzckdkqu p {
  margin: 0;
  padding: 0;
}

#yqdzckdkqu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yqdzckdkqu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yqdzckdkqu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yqdzckdkqu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yqdzckdkqu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqdzckdkqu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqdzckdkqu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqdzckdkqu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yqdzckdkqu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yqdzckdkqu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yqdzckdkqu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yqdzckdkqu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yqdzckdkqu .gt_spanner_row {
  border-bottom-style: hidden;
}

#yqdzckdkqu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yqdzckdkqu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yqdzckdkqu .gt_from_md > :first-child {
  margin-top: 0;
}

#yqdzckdkqu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yqdzckdkqu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yqdzckdkqu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yqdzckdkqu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yqdzckdkqu .gt_row_group_first td {
  border-top-width: 2px;
}

#yqdzckdkqu .gt_row_group_first th {
  border-top-width: 2px;
}

#yqdzckdkqu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqdzckdkqu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yqdzckdkqu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yqdzckdkqu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqdzckdkqu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqdzckdkqu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yqdzckdkqu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yqdzckdkqu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yqdzckdkqu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqdzckdkqu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqdzckdkqu .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqdzckdkqu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqdzckdkqu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqdzckdkqu .gt_left {
  text-align: left;
}

#yqdzckdkqu .gt_center {
  text-align: center;
}

#yqdzckdkqu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yqdzckdkqu .gt_font_normal {
  font-weight: normal;
}

#yqdzckdkqu .gt_font_bold {
  font-weight: bold;
}

#yqdzckdkqu .gt_font_italic {
  font-style: italic;
}

#yqdzckdkqu .gt_super {
  font-size: 65%;
}

#yqdzckdkqu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yqdzckdkqu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yqdzckdkqu .gt_indent_1 {
  text-indent: 5px;
}

#yqdzckdkqu .gt_indent_2 {
  text-indent: 10px;
}

#yqdzckdkqu .gt_indent_3 {
  text-indent: 15px;
}

#yqdzckdkqu .gt_indent_4 {
  text-indent: 20px;
}

#yqdzckdkqu .gt_indent_5 {
  text-indent: 25px;
}

#yqdzckdkqu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yqdzckdkqu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="8" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfVxcIFxib2xkc3ltYm9se3V9JmFtcDs9XGJlZ2lue2JtYXRyaXh9IHVfezBqfVxcIHVfezFqfSBcZW5ke2JtYXRyaXh9XHNpbSBcbWF0aGNhbHtOfVxsZWZ0KFxiZWdpbntibWF0cml4fSAwXFwgMCBcZW5ke2JtYXRyaXh9ClxiZWdpbnttYXRyaXh9IFxcICwgXGVuZHttYXRyaXh9ClxiZWdpbntibWF0cml4fSBcdGF1X3swMH0gJmFtcDtcXCAwICZhbXA7IFx0YXVfezExfSBcZW5ke2JtYXRyaXh9XHJpZ2h0KSBcZW5ke2FsaWduZWR9JCQ="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ 0 &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHt1fVwp"><span class="gt_from_md">\(\boldsymbol{u}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmVjdG9yIG9mIEwyIHJlc2lkdWFscw=="><span class="gt_from_md">Vector of L2 residuals</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfSt1X3sxan19X3tcYmV0YV97MWp9fSlSZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7UmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Reading at Time 2 Model 1: Model 2 + Random Slopes for Reading<sub>1</sub>
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>p_read2L1L2uncorrelated <span class="ot">&lt;-</span> p_read2L1L2 <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  {u_1j <span class="ot">&lt;-</span> <span class="fu">my_residual</span>(<span class="at">label =</span> <span class="fu">my_residual_label</span>(<span class="st">"*u*~1*j*~"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(b_1j, i12read2<span class="sc">@</span>line<span class="sc">@</span>angle <span class="sc">-</span> <span class="fu">turn</span>(.<span class="dv">25</span>), .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_residual_variance</span>(</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    u_1j,</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    i12read2<span class="sc">@</span>line<span class="sc">@</span>angle <span class="sc">-</span> <span class="fu">turn</span>(.<span class="dv">25</span>),</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_residual_variance_label</span>(</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"*&amp;tau;*~11~"</span>)) <span class="sc">+</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(u_1j, b_1j) </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>p_read2L1L2uncorrelated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2uncorrelated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read2L1L2uncorrelated-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Reading Time 2 Model with Level 1 and Level 2 Covariates with Uncorrelated Random Intercepts and Random Slopes
</figcaption>
</figure>
</div>
</div>
</div>
<p>To specify a model in which <code>reading_1</code> has random slopes uncorrelated with random intercepts requires some knowledge of lme4’s formula syntax. If <span class="math inline">\(X\)</span> is L1, and <span class="math inline">\(A\)</span> is L2, <span class="math inline">\(X\)</span> has random slopes uncorrelated with random intercepts if</p>
<p><code>Y ~ 1 + X + A + (1 + X || cluster_id)</code></p>
<p>Note the double bar (<code>||</code>). It means uncorrelated slopes. A single bar would be correlated slopes.</p>
<p>Another way to specify uncorrelated slopes would be to add the intercept and the slopes separately:</p>
<p><code>Y ~ 1 + X + A + (1 | cluster_id) + (0 + X | cluster_id)</code></p>
<p>Note the use of the <code>0</code> to indicate no intercept.</p>
<p>Here we specify Model 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>m_read_2_3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(reading_2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> school_ses <span class="sc">+</span> reading_1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> reading_1 <span class="sc">||</span> school_id), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ 1 + school_ses + reading_1 + ((1 | school_id) + (0 +  
    reading_1 | school_id))
   Data: d

REML criterion at convergence: 13910

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.922 -0.669  0.009  0.665  3.985 

Random effects:
 Groups      Name        Variance Std.Dev.
 school_id   (Intercept) 0.1845   0.430   
 school_id.1 reading_1   0.0433   0.208   
 Residual                0.1124   0.335   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)   1.0122     0.0252    40.2
school_ses    0.5785     0.0254    22.8
reading_1     0.4212     0.0129    32.6

Correlation of Fixed Effects:
           (Intr) schl_s
school_ses  0.000       
reading_1   0.000 -0.034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96&nbsp;–&nbsp;1.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading 1</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.40&nbsp;–&nbsp;0.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.11</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.18</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>school_id.reading_1</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.62</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.728 / 0.897</td>
</tr>

</tbody></table>

</div>
</div>
<p>Let’s compare the models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_read_2_2, m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_2_2: reading_2 ~ (1 | school_id) + reading_1 + school_ses
m_read_2_3: reading_2 ~ 1 + school_ses + reading_1 + ((1 | school_id) + (0 + reading_1 | school_id))
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_2_2    5 15486 15525  -7738    15476                        
m_read_2_3    6 13905 13951  -6946    13893  1584  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_models</span>(m_read_2_2, m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_2 |        m_read_2_3
----------------------------------------------------
(Intercept)  | 0.99 (0.94, 1.04) | 1.01 (0.96, 1.06)
reading 1    | 0.42 (0.41, 0.43) | 0.42 (0.40, 0.45)
school ses   | 0.58 (0.52, 0.63) | 0.58 (0.53, 0.63)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m_read_2_2, m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;1.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96&nbsp;–&nbsp;1.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading 1</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.41&nbsp;–&nbsp;0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.40&nbsp;–&nbsp;0.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.11</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.22 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.18 <sub>school_id</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04 <sub>school_id.reading_1</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.62</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.696 / 0.888</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.728 / 0.897</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m_read_2_2, m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_2 | lmerMod | 15486.4 (&lt;.001) | 15486.4 (&lt;.001) | 15525.4 (&lt;.001)
m_read_2_3 | lmerMod | 13904.5 (&gt;.999) | 13904.5 (&gt;.999) | 13951.4 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_2 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356
m_read_2_3 |      0.897 |      0.728 | 0.621 | 0.330 | 0.335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_performance</span>(m_read_2_2, m_read_2_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_2 | lmerMod |       
m_read_2_3 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Does Model 3 fit better than Model 2?</p>
</div>
</div>
</section>
<section id="reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts">Reading 2 Model 4 = Model 3 + Random slopes correlated with random intercepts</h2>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\
\beta_{1j}&amp;=\gamma_{10}+u_{1j}\\
\boldsymbol{u}&amp;=\begin{bmatrix}
u_{0j}\\
u_{1j}
\end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix}
0\\
0
\end{bmatrix}
\begin{matrix}
\\
,
\end{matrix}
\begin{bmatrix}
\tau_{00} &amp; \\
\tau_{10} &amp; \tau_{11}
\end{bmatrix}\right)\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{01}$"</span>,</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{10}$"</span>,</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{1j}$"</span>,</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span>,</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{11}$"</span>,</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{10}$"</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$."</span>,</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random slope $</span><span class="sc">\\</span><span class="st">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>,</span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{1j}$"</span>,</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Covariance of $u_{0j}$ and $u_{1j}$"</span>),</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{aligned}</span></span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 2}</span><span class="sc">\\</span></span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc">\\</span></span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{1j}&amp;=\gamma_{10}+u_{1j}</span><span class="sc">\\</span></span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">oldsymbol{u}&amp;=</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a><span class="st">u_{0j}</span><span class="sc">\\</span></span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a><span class="st">u_{1j}</span></span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a><span class="st">0</span><span class="sc">\\</span></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span></span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{matrix}</span></span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a><span class="st">,</span></span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{matrix}</span></span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">au_{00} &amp;</span><span class="sc">\\</span></span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">au_{10} &amp; </span><span class="sc">\t</span><span class="st">au_{11}</span></span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span><span class="sc">\r</span><span class="st">ight)</span></span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\e</span><span class="st">nd{aligned}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 1}</span><span class="sc">\\</span></span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\b</span><span class="st">eta_{0j}+</span><span class="sc">\b</span><span class="st">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">extbf{Combined:}</span><span class="sc">\\</span></span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc">\b</span><span class="st">eta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{</span><span class="sc">\b</span><span class="st">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;</span><span class="sc">\t</span><span class="st">ext{Fixed vs. Random Effects}</span><span class="sc">\\</span></span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Random Effects}}+e_{ij}</span></span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-read2L1L1correlated" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="nlkguimqmb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nlkguimqmb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nlkguimqmb thead, #nlkguimqmb tbody, #nlkguimqmb tfoot, #nlkguimqmb tr, #nlkguimqmb td, #nlkguimqmb th {
  border-style: none;
}

#nlkguimqmb p {
  margin: 0;
  padding: 0;
}

#nlkguimqmb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nlkguimqmb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nlkguimqmb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nlkguimqmb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nlkguimqmb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nlkguimqmb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nlkguimqmb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nlkguimqmb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nlkguimqmb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nlkguimqmb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nlkguimqmb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nlkguimqmb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nlkguimqmb .gt_spanner_row {
  border-bottom-style: hidden;
}

#nlkguimqmb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nlkguimqmb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nlkguimqmb .gt_from_md > :first-child {
  margin-top: 0;
}

#nlkguimqmb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nlkguimqmb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nlkguimqmb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nlkguimqmb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nlkguimqmb .gt_row_group_first td {
  border-top-width: 2px;
}

#nlkguimqmb .gt_row_group_first th {
  border-top-width: 2px;
}

#nlkguimqmb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nlkguimqmb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nlkguimqmb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nlkguimqmb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nlkguimqmb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nlkguimqmb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nlkguimqmb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nlkguimqmb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nlkguimqmb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nlkguimqmb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nlkguimqmb .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nlkguimqmb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nlkguimqmb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nlkguimqmb .gt_left {
  text-align: left;
}

#nlkguimqmb .gt_center {
  text-align: center;
}

#nlkguimqmb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nlkguimqmb .gt_font_normal {
  font-weight: normal;
}

#nlkguimqmb .gt_font_bold {
  font-weight: bold;
}

#nlkguimqmb .gt_font_italic {
  font-style: italic;
}

#nlkguimqmb .gt_super {
  font-size: 65%;
}

#nlkguimqmb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nlkguimqmb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nlkguimqmb .gt_indent_1 {
  text-indent: 5px;
}

#nlkguimqmb .gt_indent_2 {
  text-indent: 10px;
}

#nlkguimqmb .gt_indent_3 {
  text-indent: 15px;
}

#nlkguimqmb .gt_indent_4 {
  text-indent: 20px;
}

#nlkguimqmb .gt_indent_5 {
  text-indent: 25px;
}

#nlkguimqmb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nlkguimqmb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="8" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfSt1X3sxan1cXCBcYm9sZHN5bWJvbHt1fSZhbXA7PVxiZWdpbntibWF0cml4fSB1X3swan1cXCB1X3sxan0gXGVuZHtibWF0cml4fVxzaW0gXG1hdGhjYWx7Tn1cbGVmdChcYmVnaW57Ym1hdHJpeH0gMFxcIDAgXGVuZHtibWF0cml4fQpcYmVnaW57bWF0cml4fSBcXCAsIFxlbmR7bWF0cml4fQpcYmVnaW57Ym1hdHJpeH0gXHRhdV97MDB9ICZhbXA7XFwgXHRhdV97MTB9ICZhbXA7IFx0YXVfezExfSBcZW5ke2JtYXRyaXh9XHJpZ2h0KSBcZW5ke2FsaWduZWR9JCQ="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}+u_{1j}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ \tau_{10} &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMH1cKQ=="><span class="gt_from_md">\(\tau_{10}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiBcKHVfezBqfVwpIGFuZCBcKHVfezFqfVwp"><span class="gt_from_md">Covariance of \(u_{0j}\) and \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfSt1X3sxan19X3tcYmV0YV97MWp9fSlSZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7UmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Reading at Time 2 Model 1: Model 3 + correlation between random intercepts and random slopes
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>p_read_2L1L2correlated <span class="ot">&lt;-</span> p_read2L1L2uncorrelated <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    u_0j<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"east"</span>),</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    u_1j<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"north"</span>),</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">my_path_label</span>(<span class="st">"&amp;tau;~10~"</span>, <span class="at">position =</span> .<span class="dv">5</span>),</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">length_head =</span> <span class="dv">5</span>,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">length_fins =</span> <span class="dv">5</span>,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">5</span>, </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">looseness =</span> <span class="dv">1</span>,</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">bend =</span> <span class="sc">-</span><span class="dv">6</span>,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">resect =</span> <span class="dv">1</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>p_read_2L1L2correlated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2correlated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-read2L1L2correlated-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Reading Time 2 Model with Level 1 and Level 2 Covariates with Correlated Random Intercepts and Random Slopes
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make a model in which <code>reading_1</code> has random slopes correlated with random intercepts.</p>
<p>Call your model <code>m_read_2_4</code>.</p>
<p>Does Model 4 fit better than Model 3?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If X is L1 and A is L2, X has random slopes correlated with random intercepts if</p>
<p><code>Y ~ 1 + X + A + (1 + X | cluster_id )</code></p>
<p>Note the single bar (<code>|</code>).</p>
</div>
</div>
</div>
</section>
<section id="reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses">Reading 2 Model 5 = Model 4 + Cross-Level Interaction of Reading<sub>1</sub> and School SES</h2>
<p>An interaction effect (i.e., a moderator effect) is when the effect of one variable depends on the other variable. For example, impulsivity predicts a wide range of negative life outcomes, but its effect is worse when the person is violent. That is impulsive violent people have worse outcomes than non-impulsive violent people or non-violent impulsive people.</p>
<p>Interactions can occur within level (e.g,. between two level-1 variables) or across levels (e.g., between a level-1 variable and a level-2 variable). Here we want to test the cross-level interaction between Reading<sub>1</sub> and classroom SES.</p>
<p>Interaction effects involve multiplicative relationships among variables. Thus the interaction between A and B would be specified like so:</p>
<p><code>Y ~ A * B</code></p>
<p>Technically, the <code>*</code> operator in a formula includes all lower-order effects among the variables multiplied (i.e., the simple slopes for A and B in addition to the interaction of A and B). Expanded, <code>A * B</code> becomes <code>A + B + A:B</code>. In this context, the <code>:</code> is just the multiplicative term. With three variables, <code>A*B*C</code> becomes <code>A + B + C + A:B + A:C + B:C + A:B:C</code>. If we wanted just the simple slopes and two-way interactions, we could specify <code>A + B + C + A:B + A:C + B:C</code> or <code>A*B - A:B:C</code>.</p>
<p><span class="math display">\[
\begin{align}
\textbf{Level 1:}\\
Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\
e&amp;\sim \mathcal{N}(0,\sigma_e^2)\\
\textbf{Level 2:}\\
\beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\
\beta_{1j}&amp;=\gamma_{10}+\gamma_{11}SES_j+u_{1j}\\
\boldsymbol{u}&amp;=\begin{bmatrix}
u_{0j}\\
u_{1j}
\end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix}
0\\
0
\end{bmatrix}
\begin{matrix}
\\
,
\end{matrix}
\begin{bmatrix}
\tau_{00} &amp; \\
\tau_{10} &amp; \tau_{11}
\end{bmatrix}\right)\\
\textbf{Combined:}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+\gamma_{11}SES_j+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\
&amp;\text{Fixed vs. Random Effects}\\
Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+(\gamma_{10}+\gamma_{11}SES_j)Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{L2 Random Effects}}+e_{ij}
\end{align}
\]</span></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Symbol =</span> <span class="fu">c</span>(</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$Reading_{ij2}$"</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{0j}$"</span>,</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$e_{ij}$"</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_e^2$"</span>,</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{00}$"</span>,</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{01}$"</span>,</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{10}$"</span>,</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">gamma_{11}$"</span>,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{0j}$"</span>,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$u_{1j}$"</span>,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{00}$"</span>,</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{11}$"</span>,</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$</span><span class="sc">\\</span><span class="st">tau_{10}$"</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $e_{ij}$"</span>,</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fixed cross-level interaction effect of Reading~1~ and SES. When SES increases by 1, the fixed slope for Reading~1~ increates by this amount."</span>,</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random intercept $</span><span class="sc">\\</span><span class="st">beta_{0j}$."</span>,</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School-level (L2) residual for the random slope $</span><span class="sc">\\</span><span class="st">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{0j}$"</span>,</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variance of $u_{1j}$"</span>,</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Covariance of $u_{0j}$ and $u_{1j}$"</span>),</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">paste0</span>(<span class="st">"Level "</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"level"</span>, <span class="at">row_group_as_column =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="dv">20</span>,</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnotes.font.size =</span> <span class="dv">16</span>, <span class="at">table.border.bottom.color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_width</span>(Symbol <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">15</span>), level <span class="sc">~</span> <span class="fu">pct</span>(<span class="dv">23</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{aligned}</span></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 2}</span><span class="sc">\\</span></span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc">\\</span></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">eta_{1j}&amp;=\gamma_{10}+\gamma_{11}SES_j+u_{1j}</span><span class="sc">\\</span></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\b</span><span class="st">oldsymbol{u}&amp;=</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a><span class="st">u_{0j}</span><span class="sc">\\</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a><span class="st">u_{1j}</span></span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a><span class="st">0</span><span class="sc">\\</span></span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{matrix}</span></span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a><span class="st">,</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{matrix}</span></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="st">egin{bmatrix}</span></span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">au_{00} &amp;</span><span class="sc">\\</span></span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">au_{10} &amp; </span><span class="sc">\t</span><span class="st">au_{11}</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{bmatrix}</span><span class="sc">\r</span><span class="st">ight)</span></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\e</span><span class="st">nd{aligned}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 2"</span>, <span class="at">id =</span> <span class="st">"l2"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a><span class="st">  </span><span class="sc">\t</span><span class="st">extbf{Level 1}</span><span class="sc">\\</span></span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= </span><span class="sc">\b</span><span class="st">eta_{0j}+</span><span class="sc">\b</span><span class="st">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a><span class="st">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>), <span class="at">rows =</span> level <span class="sc">==</span> <span class="st">"Level 1"</span>, <span class="at">id =</span> <span class="st">"l1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="st">"level"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(r<span class="st">"($$</span><span class="sc">\b</span><span class="st">egin{align*}</span></span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="st">extbf{Combined:}</span><span class="sc">\\</span></span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc">\b</span><span class="st">eta_{0j}}+(\underbrace{\gamma_{10}+\gamma_{11}SES_j+u_{1j}}_{</span><span class="sc">\b</span><span class="st">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc">\\</span></span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;</span><span class="sc">\t</span><span class="st">ext{Fixed vs. Random Effects}</span><span class="sc">\\</span></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a><span class="st">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+(\gamma_{10}+\gamma_{11}SES_j)Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc">\t</span><span class="st">ext{L2 Random Effects}}+e_{ij}</span></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="st">nd{align*}$$)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">tab_stubhead</span>(<span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-crosslevel" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="tgjmgcmhrl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tgjmgcmhrl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tgjmgcmhrl thead, #tgjmgcmhrl tbody, #tgjmgcmhrl tfoot, #tgjmgcmhrl tr, #tgjmgcmhrl td, #tgjmgcmhrl th {
  border-style: none;
}

#tgjmgcmhrl p {
  margin: 0;
  padding: 0;
}

#tgjmgcmhrl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tgjmgcmhrl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tgjmgcmhrl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tgjmgcmhrl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tgjmgcmhrl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tgjmgcmhrl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgjmgcmhrl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tgjmgcmhrl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tgjmgcmhrl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tgjmgcmhrl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tgjmgcmhrl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tgjmgcmhrl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tgjmgcmhrl .gt_spanner_row {
  border-bottom-style: hidden;
}

#tgjmgcmhrl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tgjmgcmhrl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tgjmgcmhrl .gt_from_md > :first-child {
  margin-top: 0;
}

#tgjmgcmhrl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tgjmgcmhrl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tgjmgcmhrl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tgjmgcmhrl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tgjmgcmhrl .gt_row_group_first td {
  border-top-width: 2px;
}

#tgjmgcmhrl .gt_row_group_first th {
  border-top-width: 2px;
}

#tgjmgcmhrl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgjmgcmhrl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tgjmgcmhrl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tgjmgcmhrl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgjmgcmhrl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgjmgcmhrl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tgjmgcmhrl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tgjmgcmhrl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tgjmgcmhrl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgjmgcmhrl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgjmgcmhrl .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgjmgcmhrl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgjmgcmhrl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgjmgcmhrl .gt_left {
  text-align: left;
}

#tgjmgcmhrl .gt_center {
  text-align: center;
}

#tgjmgcmhrl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tgjmgcmhrl .gt_font_normal {
  font-weight: normal;
}

#tgjmgcmhrl .gt_font_bold {
  font-weight: bold;
}

#tgjmgcmhrl .gt_font_italic {
  font-style: italic;
}

#tgjmgcmhrl .gt_super {
  font-size: 65%;
}

#tgjmgcmhrl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tgjmgcmhrl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tgjmgcmhrl .gt_indent_1 {
  text-indent: 5px;
}

#tgjmgcmhrl .gt_indent_2 {
  text-indent: 10px;
}

#tgjmgcmhrl .gt_indent_3 {
  text-indent: 15px;
}

#tgjmgcmhrl .gt_indent_4 {
  text-indent: 20px;
}

#tgjmgcmhrl .gt_indent_5 {
  text-indent: 25px;
}

#tgjmgcmhrl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tgjmgcmhrl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="9" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfStcZ2FtbWFfezExfVNFU19qK3VfezFqfVxcIFxib2xkc3ltYm9se3V9JmFtcDs9XGJlZ2lue2JtYXRyaXh9IHVfezBqfVxcIHVfezFqfSBcZW5ke2JtYXRyaXh9XHNpbSBcbWF0aGNhbHtOfVxsZWZ0KFxiZWdpbntibWF0cml4fSAwXFwgMCBcZW5ke2JtYXRyaXh9ClxiZWdpbnttYXRyaXh9IFxcICwgXGVuZHttYXRyaXh9ClxiZWdpbntibWF0cml4fSBcdGF1X3swMH0gJmFtcDtcXCBcdGF1X3sxMH0gJmFtcDsgXHRhdV97MTF9IFxlbmR7Ym1hdHJpeH1ccmlnaHQpIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}+\gamma_{11}SES_j+u_{1j}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ \tau_{10} &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezExfVwp"><span class="gt_from_md">\(\gamma_{11}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgY3Jvc3MtbGV2ZWwgaW50ZXJhY3Rpb24gZWZmZWN0IG9mIFJlYWRpbmc8c3ViPjE8L3N1Yj4gYW5kIFNFUy4gV2hlbiBTRVMgaW5jcmVhc2VzIGJ5IDEsIHRoZSBmaXhlZCBzbG9wZSBmb3IgUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed cross-level interaction effect of Reading<sub>1</sub> and SES. When SES increases by 1, the fixed slope for Reading<sub>1</sub> increates by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_14 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMH1cKQ=="><span class="gt_from_md">\(\tau_{10}\)</span></span></td>
<td headers="l2 Symbol_14 Meaning" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiBcKHVfezBqfVwpIGFuZCBcKHVfezFqfVwp"><span class="gt_from_md">Covariance of \(u_{0j}\) and \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfStcZ2FtbWFfezExfVNFU19qK3VfezFqfX1fe1xiZXRhX3sxan19KVJlYWRpbmdfe2lqMX0rZV97aWp9XFwgJmFtcDtcdGV4dHtGaXhlZCB2cy4gUmFuZG9tIEVmZmVjdHN9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXHVuZGVyYnJhY2V7XGdhbW1hX3swMH0rXGdhbW1hX3swMX1TRVNfaisoXGdhbW1hX3sxMH0rXGdhbW1hX3sxMX1TRVNfailSZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7TDIgUmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+\gamma_{11}SES_j+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+(\gamma_{10}+\gamma_{11}SES_j)Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{L2 Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Reading at Time 2 Model 1: Model 4 + Cross-level Interaction of Reading_1 and School SES
</figcaption>
</figure>
</div>
</div>
<div class="cell preview-image page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>p_read_2L1L2correlated <span class="sc">+</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_path</span>(SES, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>          b_1j, </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">my_path_label</span>(<span class="st">"*&amp;gamma;*~*11*~"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-crosslevel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="random_slopes_files/figure-html/fig-crosslevel-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Reading Time 2 Model with Cross-Level Interaction of SES and Reading<sub>1</sub>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 5
</div>
</div>
<div class="callout-body-container callout-body">
<p>Specify a model in which <code>reading_1</code> and <code>school_ses</code> interact.</p>
<p>Call your model <code>m_read_2_5</code></p>
<p>Does Model 5 fit better than Model 4?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If X is L1 and A is L2, the cross-level interaction is specified like so:</p>
<p><code>Y ~ 1 + X * A + (1 + X | cluster_id )</code></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compared to Model 0, by how much is level-2 variance reduced by model 5?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For this question and the next, use the <code>variance_reduction</code> function created earlier.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compared to Model 0, by how much is level-1 variance reduced by model 5?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 8
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is your overall interpretation of these data?</p>
</div>
</div>
<p>Run this code to see some plots that might aid your interpretation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effects only</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m_read_2_5,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pred"</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"reading_1"</span>, <span class="st">"school_ses [-2, -1, 0, 1, 2]"</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects only</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(m_read_2_5) <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(reading_1, reading_2, <span class="at">color =</span> school_ses)) <span class="sc">+</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">group =</span> school_id), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-lme4" class="csl-entry" role="listitem">
Bates, D., Machler, M., Bolker, B., &amp; Walker, S. (2015). <em>Fitting linear mixed-effects models using <span></span>lme4<span></span></em>. <em>67</em>. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>
</div>
<div id="ref-curran2007" class="csl-entry" role="listitem">
Curran, P. J., &amp; Bauer, D. J. (2007). Building path diagrams for multilevel models. <em>Psychological Methods</em>, <em>12</em>(3), 283–297. <a href="https://doi.org/10.1037/1082-989x.12.3.283">https://doi.org/10.1037/1082-989x.12.3.283</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/wjschne\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>