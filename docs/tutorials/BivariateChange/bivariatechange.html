<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.18">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W. Joel Schneider">
<meta name="dcterms.date" content="2025-03-26">
<meta name="description" content="W. Joel Schneider is a professor at Temple University.">

<title>W. Joel Schneider</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f98ea211b99fe8356d6469e598480a52.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6bc76ec001b999024a5f23b612cb6a6c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="W. Joel Schneider">
<meta property="og:description" content="How two variables influence each other over time">
<meta property="og:image" content="https://wjschne.github.io/tutorials/BivariateChange/bivariatechange_files/figure-html/fig-crosslag-1.png">
<meta property="og:site_name" content="W. Joel Schneider">
<meta property="og:image:height" content="1536">
<meta property="og:image:width" content="1536">
</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">W. Joel Schneider</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">R Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assessingpsyche.html"> 
<span class="menu-text">Assessment Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vita.html"> 
<span class="menu-text">Vita</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:schneider@temple.edu" rel="noreferrer noopener" target="_blank"> <i class="bi bi-envelope" role="img" aria-label="Email">
</i> 
<span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/wjschne" rel="noreferrer noopener" target="_blank"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Bivariate Change Models</h1>
            <p class="subtitle lead">Advanced Data Analysis (EDUC 8825)</p>
                  <div>
        <div class="description">
          How two variables influence each other over time
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 26, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cross-lag-panel-models-clpm" id="toc-cross-lag-panel-models-clpm" class="nav-link active" data-scroll-target="#cross-lag-panel-models-clpm">Cross-Lag Panel Models (CLPM)</a>
  <ul class="collapse">
  <li><a href="#automating-repetitive-lavaan-models" id="toc-automating-repetitive-lavaan-models" class="nav-link" data-scroll-target="#automating-repetitive-lavaan-models">Automating repetitive lavaan models</a></li>
  <li><a href="#pasting-text-together-with-paste0" id="toc-pasting-text-together-with-paste0" class="nav-link" data-scroll-target="#pasting-text-together-with-paste0">Pasting text together with <code>paste0</code></a></li>
  <li><a href="#pasting-repetitive-code" id="toc-pasting-repetitive-code" class="nav-link" data-scroll-target="#pasting-repetitive-code">Pasting repetitive code</a></li>
  </ul></li>
  <li><a href="#the-glue-function-an-alternative-to-paste0" id="toc-the-glue-function-an-alternative-to-paste0" class="nav-link" data-scroll-target="#the-glue-function-an-alternative-to-paste0">The <code>glue</code> function: An alternative to <code>paste0</code></a>
  <ul class="collapse">
  <li><a href="#specifying-the-clpm-model" id="toc-specifying-the-clpm-model" class="nav-link" data-scroll-target="#specifying-the-clpm-model">Specifying the CLPM Model</a></li>
  </ul></li>
  <li><a href="#simulating-data-based-on-the-clpm" id="toc-simulating-data-based-on-the-clpm" class="nav-link" data-scroll-target="#simulating-data-based-on-the-clpm">Simulating data based on the CLPM</a></li>
  <li><a href="#why-the-clpm-is-probably-not-your-model" id="toc-why-the-clpm-is-probably-not-your-model" class="nav-link" data-scroll-target="#why-the-clpm-is-probably-not-your-model">Why the CLPM is probably not your model</a></li>
  <li><a href="#random-intercept-cross-lag-panel-models" id="toc-random-intercept-cross-lag-panel-models" class="nav-link" data-scroll-target="#random-intercept-cross-lag-panel-models">Random Intercept Cross-Lag Panel Models</a>
  <ul class="collapse">
  <li><a href="#structured-residuals" id="toc-structured-residuals" class="nav-link" data-scroll-target="#structured-residuals">Structured Residuals</a></li>
  </ul></li>
  <li><a href="#latent-growth-with-structured-residuals" id="toc-latent-growth-with-structured-residuals" class="nav-link" data-scroll-target="#latent-growth-with-structured-residuals">Latent Growth With Structured Residuals</a></li>
  <li><a href="#excercise" id="toc-excercise" class="nav-link" data-scroll-target="#excercise">Excercise</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>To investigate causal relations, experiments with manipulated variables are the most straightforward and persuasive forms of evidence we have. Unfortunately, there are a lot of interesting variables that are hard to manipulate experimentally. To investigate what they cause and what causes such variables, longitudinal studies are among the most useful forms of evidence we have.</p>
<p>For example, reading comprehension and vocabulary have a reciprocally causal relationship <span class="citation" data-cites="quinnDevelopmentalRelationsVocabulary2015 killinglyReciprocalRelationshipsReading2025">(<a href="#ref-killinglyReciprocalRelationshipsReading2025" role="doc-biblioref">Killingly et al., 2025</a>; <a href="#ref-quinnDevelopmentalRelationsVocabulary2015" role="doc-biblioref">Quinn et al., 2015</a>)</span>. That is, if you have a good vocabulary, it is easier for you to comprehend text. If it is easy for you to comprehend text, you will likely expand your vocabulary.</p>
<div class="no-row-height column-margin column-container"><div id="ref-killinglyReciprocalRelationshipsReading2025" class="csl-entry" role="listitem">
Killingly, C., Graham, L. J., Tancredi, H., &amp; Snow, P. (2025). Reciprocal relationships among reading and vocabulary over time: A longitudinal study from grade 1 to 5. <em>Reading and Writing</em>, <em>38</em>(3), 605–625. <a href="https://doi.org/10.1007/s11145-024-10522-x">https://doi.org/10.1007/s11145-024-10522-x</a>
</div><div id="ref-quinnDevelopmentalRelationsVocabulary2015" class="csl-entry" role="listitem">
Quinn, J. M., Wagner, R. K., Petscher, Y., &amp; Lopez, D. (2015). Developmental relations between vocabulary knowledge and reading comprehension: <span>A</span> latent change score modeling study. <em>Child Development</em>, <em>86</em>(1), 159–175. <a href="https://doi.org/10.1111/cdev.12292">https://doi.org/10.1111/cdev.12292</a>
</div></div><p>Unfortunately, many of our initial methods of understanding longitudinal relationships can generate misleading findings.</p>
<section id="cross-lag-panel-models-clpm" class="level1 page-columns page-full">
<h1>Cross-Lag Panel Models (CLPM)</h1>
<p>One intuitively simple model is the cross-lagged panel model, as shown with four time periods in <a href="#fig-crosslag" class="quarto-xref">Figure&nbsp;1</a>. The cross-lag panel model has two series of variables, <em>X</em> and <em>Y</em>. The paths within each series (<em>X</em><sub>1</sub> to <em>X</em><sub>2</sub> to <em>X</em><sub>3</sub> to <em>X</em><sub>4</sub> and <em>Y</em><sub>1</sub> to <em>Y</em><sub>2</sub> to <em>Y</em><sub>3</sub> to <em>Y</em><sub>4</sub>) are called <em>auto-regressive paths</em>, meaning that each variable is predicting itself across time.</p>
<p>Each variable also influences the other at a subsequent time. These paths crossing from one series to the other are called <em>cross lags</em>.</p>
<p>In addition to the cross lags and autoregressive paths, the series have <em>correlated errors</em>, which allow variables measured at the same time to have additional reasons to correlate.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_observed <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_ellipse, <span class="at">m1 =</span> <span class="dv">15</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>my_connect <span class="ot">&lt;-</span> <span class="fu">redefault</span>(connect, <span class="at">resect =</span> <span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>my_error <span class="ot">&lt;-</span> <span class="fu">redefault</span>(ob_circle, <span class="at">radius =</span> .<span class="dv">35</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>my_font <span class="ot">&lt;-</span> <span class="st">"Roboto Condensed"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>my_sep <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdiagram</span>(<span class="at">font_family =</span> my_font, <span class="at">font_size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  {x <span class="ot">&lt;-</span> <span class="fu">my_observed</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ob_array</span>(k, <span class="at">sep =</span> my_sep, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">where =</span> <span class="st">"south"</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*X*~"</span> , <span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>))} <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  {y <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*Y*~"</span> ,<span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x, <span class="st">"right"</span>, <span class="at">sep =</span> my_sep)} <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  {e_x <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"right"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  {e_y <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(y[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"left"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(x[<span class="sc">-</span>k], x[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="st">"*b*~*XX*~"</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(x[<span class="sc">-</span>k], y[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="st">"*b*~*XY*~"</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">12</span>, <span class="at">position =</span> .<span class="dv">27</span>)) <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(y[<span class="sc">-</span>k], x[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="st">"*b*~*YX*~"</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">12</span>, <span class="at">position =</span> .<span class="dv">27</span>)) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(y[<span class="sc">-</span>k], y[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="st">"*b*~*YY*~"</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                              <span class="at">angle =</span> <span class="dv">0</span>, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(e_x, x[<span class="sc">-</span><span class="dv">1</span>], <span class="at">length_head =</span> <span class="dv">5</span>, <span class="at">resect =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect</span>(e_y, y[<span class="sc">-</span><span class="dv">1</span>], <span class="at">length_head =</span> <span class="dv">5</span>, <span class="at">resect =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  {tau_x1y1 <span class="ot">&lt;-</span> <span class="fu">ob_covariance</span>(x[<span class="dv">1</span>], y[<span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau_{X_1Y_1}"</span>, tau_x1y1<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> <span class="fl">1.35</span>, <span class="at">delete_files =</span> F, <span class="at">force_recompile =</span> F) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  {tau_xy <span class="ot">&lt;-</span> <span class="fu">ob_covariance</span>(e_y, e_x, </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">resect =</span> <span class="dv">1</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_head =</span> <span class="dv">4</span>, </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_fins =</span> <span class="dv">4</span>, </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.3</span>)} <span class="sc">+</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau_{xy}"</span>, tau_xy<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> .<span class="dv">95</span>, <span class="at">delete_files =</span> F, <span class="at">force_recompile =</span> T) <span class="sc">+</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  {tau_x2 <span class="ot">&lt;-</span> <span class="fu">ob_variance</span>(x[<span class="dv">1</span>], </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_head =</span> <span class="dv">5</span>, </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_fins =</span> <span class="dv">5</span>, </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">resect =</span> <span class="dv">1</span>, </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">bend =</span> <span class="sc">-</span><span class="dv">10</span>, </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">theta =</span> <span class="fu">degree</span>(<span class="dv">65</span>), </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>              <span class="at">looseness =</span> <span class="fl">1.1</span>)} <span class="sc">+</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau^2_{X_1}"</span>, tau_x2<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> .<span class="dv">85</span>, <span class="at">delete_files =</span> F, <span class="at">force_recompile =</span> F) <span class="sc">+</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  {tau_y2 <span class="ot">&lt;-</span> <span class="fu">ob_variance</span>(y[<span class="dv">1</span>], </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_head =</span> <span class="dv">5</span>, </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_fins =</span> <span class="dv">5</span>, </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">resect =</span> <span class="dv">1</span>, </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">bend =</span> <span class="fu">degree</span>(<span class="sc">-</span><span class="dv">10</span>), </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">theta =</span> <span class="fu">degree</span>(<span class="dv">65</span>), </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>              <span class="at">looseness =</span> <span class="fl">1.1</span>)} <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau^2_{Y_1}"</span>, tau_y2<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> .<span class="dv">85</span>, <span class="at">delete_files =</span> F, <span class="at">force_recompile =</span> F) <span class="sc">+</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  {tau_ex2 <span class="ot">&lt;-</span> <span class="fu">ob_variance</span>(e_x, </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_head =</span> <span class="dv">5</span>, </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_fins =</span> <span class="dv">5</span>, </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">resect =</span> <span class="dv">1</span>, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>              <span class="co"># bend = degree(-90), </span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>              <span class="at">theta =</span> <span class="fu">degree</span>(<span class="dv">90</span>), </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">looseness =</span> <span class="fl">3.5</span>)} <span class="sc">+</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau^2_{X}"</span>, tau_ex2<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> .<span class="dv">75</span>, <span class="at">force_recompile =</span> F, <span class="at">delete_files =</span> F) <span class="sc">+</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  {tau_ey2 <span class="ot">&lt;-</span> <span class="fu">ob_variance</span>(e_y, </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_head =</span> <span class="dv">5</span>, </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">length_fins =</span> <span class="dv">5</span>, </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>              <span class="at">resect =</span> <span class="dv">1</span>, </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>              <span class="co"># bend = degree(-90), </span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>              <span class="at">theta =</span> <span class="fu">degree</span>(<span class="dv">90</span>), </span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>              <span class="at">looseness =</span> <span class="fl">3.5</span>)} <span class="sc">+</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_latex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">tau^2_{Y}"</span>, tau_ey2<span class="sc">@</span><span class="fu">midpoint</span>(), <span class="at">width =</span> .<span class="dv">75</span>, <span class="at">delete_files =</span> F, <span class="at">force_recompile =</span> F) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-crosslag" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-crosslag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-crosslag-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-crosslag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The Cross-Lag Panel Model
</figcaption>
</figure>
</div>
</div>
</div>
<section id="automating-repetitive-lavaan-models" class="level2">
<h2 class="anchored" data-anchor-id="automating-repetitive-lavaan-models">Automating repetitive lavaan models</h2>
<p>Unfortunately, lavaan models can become quite large. In most lavaan models, we do not need to name the parameters. However, if we are specifying parameters are constrained to equal each other, we need to name our parameters. <strong>Any parameter with the same name is constrained to be equal.</strong></p>
<p>To specify the model with lavaan syntax, one could do it by hand like so:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Covariances</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="st">x1 ~~ tau_x1 * x1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="st">y1 ~~ tau_y1 * y1 + tau_x1y1 * x1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">x2 ~~ tau_xx * x2 + tau_xy * y2 </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">x3 ~~ tau_xx * x3 + tau_xy * y3</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">x4 ~~ tau_xx * x4 + tau_xy * y4</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">y2 ~~ tau_yy * y2 </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">y3 ~~ tau_yy * y3</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="st">y4 ~~ tau_yy * y4</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="st"># Regressions with intercepts</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">x1 ~ b_x01 * 1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="st">x2 ~ b_x02 * 1 + b_xx * x1 + b_yx * y1</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">x3 ~ b_x03 * 1 + b_xx * x2 + b_yx * y2</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="st">x4 ~ b_x04 * 1 + b_xx * x3 + b_yx * y3</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">y1 ~ b_y01 * 1</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">y2 ~ b_y02 * 1 + b_yy * y1 + b_xy * x1</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">y3 ~ b_y03 * 1 + b_yy * y2 + b_xy * x2</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">y4 ~ b_y04 * 1 + b_yy * y3 + b_xy * x3</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The benefits of this approach are that the code is easier to create and to understand. With only 4 waves of data, this model does not seem so difficult to specify by hand.</p>
<p>The liabilities of this approach are that it is error prone and increasingly tedious for large models. We are better off using <code>paste0</code> or <code>glue</code> from the glue package to automate model production.</p>
</section>
<section id="pasting-text-together-with-paste0" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="pasting-text-together-with-paste0">Pasting text together with <code>paste0</code></h2>

<div class="no-row-height column-margin column-container"><div class="">
<p>The <code>paste0</code> function is a special variant of the <code>paste</code> function that has 0 separation between the pasted elements. By default, <code>paste</code> separates the elements with spaces:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A B C"</code></pre>
</div>
</div>
<p>You can put anything between the elements with the <code>sep</code> parameter:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="at">sep =</span> <span class="st">","</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A,B,C"</code></pre>
</div>
</div>
</div></div><p>The <code>paste0</code> function pastes text together. For example,</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ABC"</code></pre>
</div>
</div>
<p>If you use a vector, <code>paste0</code> will paste multiple strings:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"A"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A1" "A2" "A3"</code></pre>
</div>
</div>
<p>We can “collapse” the vector strings into a single string separated by the newline symbol <code>\n</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"A"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>A1
A2
A3</code></pre>
</div>
</div>
</section>
<section id="pasting-repetitive-code" class="level2">
<h2 class="anchored" data-anchor-id="pasting-repetitive-code">Pasting repetitive code</h2>
<p>Suppose we have 8 waves of data. We need to set the variances of the x series.</p>
<p>This is what we need:</p>
<pre><code>x1 ~~ tau_x1 * x1 
x2 ~~ tau_xx * x2 
x3 ~~ tau_xx * x3 
x4 ~~ tau_xx * x4 
x5 ~~ tau_xx * x5 
x6 ~~ tau_xx * x6
x7 ~~ tau_xx * x7 
x8 ~~ tau_xx * x8 
 </code></pre>
<p>We see that each line is very similar. We need to create vectors for the parts that change: the numbers 1 to 8 and the variance parameters (<code>tau_x1</code> and <code>tau_xx</code>). The numbers 1 to 8 are easy to make with the <code>:</code> operator.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
</div>
<p>Alternately, we could use the <code>seq</code> function to make a sequence:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
</div>
<p>However, we do not want our code to be tied specifically to the number 8. We want any number of waves. We define a variable <code>k</code> for the number of waves and make a sequence</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span>k</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, k)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or omit the start value</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(k)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
</div>
<p>The variance parameters are all the same except for <code>x1</code>. So we need a vector that is one value for the first element and repeated <code>k - 1</code> times for the remaining elements. The <code>rep</code> function repeats elements as many times as you specify:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="st">"tau_xx"</span>, k <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx"</code></pre>
</div>
</div>
<p>Putting the first and remaining elements together:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>v_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_x1"</span>, <span class="fu">rep</span>(<span class="st">"tau_xx"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>v_x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tau_x1" "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx" "tau_xx"</code></pre>
</div>
</div>
<p>Now we are ready to paste the entire line of code:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make string</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>var_x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="st">" ~~ "</span>, v_x, <span class="st">" * x"</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Output string </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(var_x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>x1 ~~ tau_x1 * x1
x2 ~~ tau_xx * x2
x3 ~~ tau_xx * x3
x4 ~~ tau_xx * x4
x5 ~~ tau_xx * x5
x6 ~~ tau_xx * x6
x7 ~~ tau_xx * x7
x8 ~~ tau_xx * x8</code></pre>
</div>
</div>
</section>
</section>
<section id="the-glue-function-an-alternative-to-paste0" class="level1">
<h1>The <code>glue</code> function: An alternative to <code>paste0</code></h1>
<p>Many people find the <code>glue</code> function from the glue package easier to read than the <code>paste0</code> function. Put everything inside a single string, with R code enclosed in curly braces:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>var_x <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"x{1:k} ~~ {v_x} * x{1:k}"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The <code>glue_collapse</code> function is useful to see the output of <code>glue</code> as one string:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue_collapse</span>(var_x, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>x1 ~~ tau_x1 * x1
x2 ~~ tau_xx * x2
x3 ~~ tau_xx * x3
x4 ~~ tau_xx * x4
x5 ~~ tau_xx * x5
x6 ~~ tau_xx * x6
x7 ~~ tau_xx * x7
x8 ~~ tau_xx * x8</code></pre>
</div>
</div>
<section id="specifying-the-clpm-model" class="level2">
<h2 class="anchored" data-anchor-id="specifying-the-clpm-model">Specifying the CLPM Model</h2>
<p>To specify <a href="#fig-crosslag" class="quarto-xref">Figure&nbsp;1</a> with automated lavaan syntax</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of waves</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 2 to k</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>s2k <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, k)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 1 to k - 1</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>s1k1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># variance symbols for x</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>v_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_x1"</span>, <span class="fu">rep</span>(<span class="st">"tau_xx"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># variance symbols for y</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>v_y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_y1"</span>, <span class="fu">rep</span>(<span class="st">"tau_yy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance symbols xy</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>cov_xy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_x1y1"</span>, <span class="fu">rep</span>(<span class="st">"tau_xy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with comments added</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>m_clpm <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Regressions"</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{s2k} ~ b_xx * x{s1k1} + b_yx * y{s1k1}"</span>),</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{s2k} ~ b_yy * y{s1k1} + b_xy * x{s1k1}"</span>) ,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Variances"</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~~ {v_x} * x{1:k}"</span>),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~~ {v_y} * y{1:k}"</span>),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Covariances"</span>,</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~~ {cov_xy} * y{1:k}"</span>),</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Intercepts"</span>,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~ b_x0{1:k} * 1"</span>),</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~ b_y0{1:k} * 1"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>m_clpm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Regressions
x2 ~ b_xx * x1 + b_yx * y1
x3 ~ b_xx * x2 + b_yx * y2
x4 ~ b_xx * x3 + b_yx * y3
y2 ~ b_yy * y1 + b_xy * x1
y3 ~ b_yy * y2 + b_xy * x2
y4 ~ b_yy * y3 + b_xy * x3
# Variances
x1 ~~ tau_x1 * x1
x2 ~~ tau_xx * x2
x3 ~~ tau_xx * x3
x4 ~~ tau_xx * x4
y1 ~~ tau_y1 * y1
y2 ~~ tau_yy * y2
y3 ~~ tau_yy * y3
y4 ~~ tau_yy * y4
# Covariances
x1 ~~ tau_x1y1 * y1
x2 ~~ tau_xy * y2
x3 ~~ tau_xy * y3
x4 ~~ tau_xy * y4
# Intercepts
x1 ~ b_x01 * 1
x2 ~ b_x02 * 1
x3 ~ b_x03 * 1
x4 ~ b_x04 * 1
y1 ~ b_y01 * 1
y2 ~ b_y02 * 1
y3 ~ b_y03 * 1
y4 ~ b_y04 * 1</code></pre>
</div>
</div>
</section>
</section>
<section id="simulating-data-based-on-the-clpm" class="level1 page-columns page-full">
<h1>Simulating data based on the CLPM</h1>
<p>To simulate data, we need to replace the parameter labels in the model with specific values. Doing so by hand is no fun, and it is easy to mess things up when playing with different values. I recommend placing parameter labels programmatically with a named vector and a custom function.</p>
<p>Here is a named vector of parameter values:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>my_parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_xx =</span> .<span class="dv">4</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_yy =</span> .<span class="dv">5</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_x1y1 =</span> .<span class="dv">4</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_xy =</span> .<span class="dv">2</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_x1 =</span> <span class="dv">1</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_y1 =</span> <span class="dv">1</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xx =</span> .<span class="dv">7</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yy =</span> .<span class="dv">6</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xy =</span> <span class="dv">0</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yx =</span> <span class="fl">0.3</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>I have made a custom function <code>replace_parameters</code>to replace parameter labels. I have also made a custom function <code>plot_cor</code> to plot correlation matrices.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>replace_parameters <span class="ot">&lt;-</span> <span class="cf">function</span>(model, params) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make sure replacements are whole words</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(params) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">b"</span>, <span class="fu">names</span>(params), <span class="st">"</span><span class="sc">\\</span><span class="st">b"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to strings but retain names</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(params, as.character)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># replace all strings</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(model, p)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>plot_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">font_size =</span> <span class="dv">16</span>) {</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(d) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    corrr<span class="sc">::</span><span class="fu">as_cordf</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    corrr<span class="sc">::</span><span class="fu">stretch</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(y)) <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> r)) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ggdiagram<span class="sc">::</span><span class="fu">round_probability</span>(r)), </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> font_size <span class="sc">*</span> .<span class="dv">8</span>, </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">size.unit =</span> <span class="st">"pt"</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="cn">NULL</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">low =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">high =</span> <span class="st">"orchid4"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">2</span>),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> \(x) ggdiagram<span class="sc">::</span><span class="fu">round_probability</span>(x, <span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>()) <span class="sc">+</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>()) <span class="sc">+</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> font_size) <span class="sc">+</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"null"</span>), </span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>), </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text.position =</span> <span class="st">"left"</span>)</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let’s make a model to simulate values:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m_clpm_sim <span class="ot">&lt;-</span> m_clpm <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_parameters</span>(my_parameters) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>m_clpm_sim</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Regressions
x2 ~ 0.7 * x1 + 0.3 * y1
x3 ~ 0.7 * x2 + 0.3 * y2
x4 ~ 0.7 * x3 + 0.3 * y3
y2 ~ 0.6 * y1 + 0 * x1
y3 ~ 0.6 * y2 + 0 * x2
y4 ~ 0.6 * y3 + 0 * x3
# Variances
x1 ~~ 1 * x1
x2 ~~ 0.4 * x2
x3 ~~ 0.4 * x3
x4 ~~ 0.4 * x4
y1 ~~ 1 * y1
y2 ~~ 0.5 * y2
y3 ~~ 0.5 * y3
y4 ~~ 0.5 * y4
# Covariances
x1 ~~ 0.4 * y1
x2 ~~ 0.2 * y2
x3 ~~ 0.2 * y3
x4 ~~ 0.2 * y4
# Intercepts
x1 ~ b_x01 * 1
x2 ~ b_x02 * 1
x3 ~ b_x03 * 1
x4 ~ b_x04 * 1
y1 ~ b_y01 * 1
y2 ~ b_y02 * 1
y3 ~ b_y03 * 1
y4 ~ b_y04 * 1</code></pre>
</div>
</div>
<p>Let’s make data that conforms to this model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>d_clpm <span class="ot">&lt;-</span> <span class="fu">simulateData</span>(<span class="at">model =</span> m_clpm_sim, <span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_clpm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x2         x3         x4         y2         y3         y4         x1
1  0.1216537 -0.2619177  0.1367773  0.5668824  1.4040416  0.1222878 -0.1743599
2 -0.8586605 -1.2073190 -1.9587255 -1.4891127 -0.7730368 -1.8336580  0.6147530
3  1.1973754  1.6207579  2.4214323  0.9126255  0.6491281  0.7660641  0.3416975
4 -0.3381759 -0.5865429 -0.2810832 -0.6039896 -1.0346298 -0.4615432 -0.3066060
5  0.9128507  0.6352567  1.3006448  0.5790674  0.7791130  0.1838290  0.4109004
6 -1.5623715 -2.1726694 -1.8069801  0.4013958 -0.2789933 -0.5074396 -0.6631663
           y1
1 -0.03351154
2 -0.12960376
3 -0.28229122
4 -1.10591473
5  0.77335220
6  0.02972531</code></pre>
</div>
</div>
<p><a href="#fig-clpmsim" class="quarto-xref">Figure&nbsp;2</a> displays the correlations among the variables we have simulated. Notice that adjacent variables are more highly correlated than variables separated by time.</p>
<div class="cell page-columns page-full">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cor</span>(d_clpm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-clpmsim" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" width="100%">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-clpmsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-clpmsim-1.png" id="fig-clpmsim" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-clpmsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we test the free-parameter model on the simulated data, we can see that the estimates are close to the specified population parameters, which increases our confidence that the simulation is correct.</p>
<div class="cell page-columns page-full">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fit_clpm <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> m_clpm, <span class="at">data =</span> d_clpm) </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>my_metrics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>, <span class="st">"p_Chi2"</span>, <span class="st">"RMSEA"</span>, <span class="st">"GFI"</span>, <span class="st">"NNFI"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit_clpm, <span class="at">metrics =</span> my_metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped small">

<thead>
<tr class="header">
<th style="text-align: left;">Chi2(26)</th>
<th style="text-align: center;">p (Chi2)</th>
<th style="text-align: center;">RMSEA</th>
<th style="text-align: center;">GFI</th>
<th style="text-align: center;">NNFI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21.97</td>
<td style="text-align: center;">0.690</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.99</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Indices of model performance</div></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit_clpm, <span class="at">component =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped small">

<thead>
<tr class="header">
<th style="text-align: left;">Link</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x2 ~ x1 (b_xx)</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.67, 0.72)</td>
<td style="text-align: center;">55.07</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x2 ~ y1 (b_yx)</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.26, 0.32)</td>
<td style="text-align: center;">19.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x3 ~ x2 (b_xx)</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.67, 0.72)</td>
<td style="text-align: center;">55.07</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3 ~ y2 (b_yx)</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.26, 0.32)</td>
<td style="text-align: center;">19.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x4 ~ x3 (b_xx)</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.67, 0.72)</td>
<td style="text-align: center;">55.07</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x4 ~ y3 (b_yx)</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.26, 0.32)</td>
<td style="text-align: center;">19.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y2 ~ y1 (b_yy)</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.57, 0.64)</td>
<td style="text-align: center;">37.46</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2 ~ x1 (b_xy)</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(-0.04, 0.02)</td>
<td style="text-align: center;">-0.86</td>
<td style="text-align: center;">0.388</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y3 ~ y2 (b_yy)</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.57, 0.64)</td>
<td style="text-align: center;">37.46</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">y3 ~ x2 (b_xy)</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(-0.04, 0.02)</td>
<td style="text-align: center;">-0.86</td>
<td style="text-align: center;">0.388</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y4 ~ y3 (b_yy)</td>
<td style="text-align: center;">0.61</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.57, 0.64)</td>
<td style="text-align: center;">37.46</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">y4 ~ x3 (b_xy)</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(-0.04, 0.02)</td>
<td style="text-align: center;">-0.86</td>
<td style="text-align: center;">0.388</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption"># Regression</div><table class="table table-sm table-striped small">
<caption># Variance</caption>
<colgroup>
<col style="width: 27%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 21%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Link</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x1 ~~ x1 (tau_x1)</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">(0.95, 1.13)</td>
<td style="text-align: center;">22.36</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x2 ~~ x2 (tau_xx)</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.39, 0.43)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x3 ~~ x3 (tau_xx)</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.39, 0.43)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x4 ~~ x4 (tau_xx)</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.39, 0.43)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y1 ~~ y1 (tau_y1)</td>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">(0.87, 1.03)</td>
<td style="text-align: center;">22.36</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2 ~~ y2 (tau_yy)</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.48, 0.54)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y3 ~~ y3 (tau_yy)</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.48, 0.54)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">y4 ~~ y4 (tau_yy)</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.48, 0.54)</td>
<td style="text-align: center;">38.73</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
<table class="table table-sm table-striped small">
<caption># Correlation</caption>
<colgroup>
<col style="width: 27%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Link</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x1 ~~ y1 (tau_x1y1)</td>
<td style="text-align: center;">0.43</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(0.36, 0.49)</td>
<td style="text-align: center;">12.46</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x2 ~~ y2 (tau_xy)</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">9.13e-03</td>
<td style="text-align: center;">(0.18, 0.22)</td>
<td style="text-align: center;">21.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x3 ~~ y3 (tau_xy)</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">9.13e-03</td>
<td style="text-align: center;">(0.18, 0.22)</td>
<td style="text-align: center;">21.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">x4 ~~ y4 (tau_xy)</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">9.13e-03</td>
<td style="text-align: center;">(0.18, 0.22)</td>
<td style="text-align: center;">21.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
<table class="table table-sm table-striped small">
<caption># Mean</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 28%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Link</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x1 ~1 (b_x01)</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(-0.02, 0.11)</td>
<td style="text-align: center;">1.43</td>
<td style="text-align: center;">0.152</td>
</tr>
<tr class="even">
<td style="text-align: left;">x2 ~1 (b_x02)</td>
<td style="text-align: center;">2.22e-03</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.04, 0.04)</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.913</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x3 ~1 (b_x03)</td>
<td style="text-align: center;">-0.03</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.07, 9.60e-03)</td>
<td style="text-align: center;">-1.49</td>
<td style="text-align: center;">0.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">x4 ~1 (b_x04)</td>
<td style="text-align: center;">-9.16e-04</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.04, 0.04)</td>
<td style="text-align: center;">-0.05</td>
<td style="text-align: center;">0.964</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y1 ~1 (b_y01)</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(-0.03, 0.09)</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">0.361</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2 ~1 (b_y02)</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.03, 0.06)</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: center;">0.604</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y3 ~1 (b_y03)</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.06, 0.02)</td>
<td style="text-align: center;">-0.91</td>
<td style="text-align: center;">0.360</td>
</tr>
<tr class="even">
<td style="text-align: left;">y4 ~1 (b_y04)</td>
<td style="text-align: center;">-9.64e-03</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.05, 0.03)</td>
<td style="text-align: center;">-0.43</td>
<td style="text-align: center;">0.669</td>
</tr>
</tbody>
</table>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># my fork of Jason Tsukahara's semoutput:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("wjschne/semoutput")</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>semoutput<span class="sc">::</span><span class="fu">sem_tables</span>(fit_clpm, <span class="at">intercepts =</span> T)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="dehaqujqbu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dehaqujqbu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dehaqujqbu thead, #dehaqujqbu tbody, #dehaqujqbu tfoot, #dehaqujqbu tr, #dehaqujqbu td, #dehaqujqbu th {
  border-style: none;
}

#dehaqujqbu p {
  margin: 0;
  padding: 0;
}

#dehaqujqbu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dehaqujqbu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dehaqujqbu .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: bolder;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dehaqujqbu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 9px;
  padding-bottom: 11px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dehaqujqbu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dehaqujqbu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#dehaqujqbu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dehaqujqbu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 15px;
  padding-right: 15px;
  overflow-x: hidden;
}

#dehaqujqbu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dehaqujqbu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dehaqujqbu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dehaqujqbu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dehaqujqbu .gt_spanner_row {
  border-bottom-style: hidden;
}

#dehaqujqbu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dehaqujqbu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dehaqujqbu .gt_from_md > :first-child {
  margin-top: 0;
}

#dehaqujqbu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dehaqujqbu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dehaqujqbu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
}

#dehaqujqbu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
  vertical-align: top;
}

#dehaqujqbu .gt_row_group_first td {
  border-top-width: 2px;
}

#dehaqujqbu .gt_row_group_first th {
  border-top-width: 2px;
}

#dehaqujqbu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#dehaqujqbu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dehaqujqbu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dehaqujqbu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dehaqujqbu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#dehaqujqbu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dehaqujqbu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dehaqujqbu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dehaqujqbu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dehaqujqbu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dehaqujqbu .gt_footnote {
  margin: 0px;
  font-size: 14px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#dehaqujqbu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dehaqujqbu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#dehaqujqbu .gt_left {
  text-align: left;
}

#dehaqujqbu .gt_center {
  text-align: center;
}

#dehaqujqbu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dehaqujqbu .gt_font_normal {
  font-weight: normal;
}

#dehaqujqbu .gt_font_bold {
  font-weight: bold;
}

#dehaqujqbu .gt_font_italic {
  font-style: italic;
}

#dehaqujqbu .gt_super {
  font-size: 65%;
}

#dehaqujqbu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dehaqujqbu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dehaqujqbu .gt_indent_1 {
  text-indent: 5px;
}

#dehaqujqbu .gt_indent_2 {
  text-indent: 10px;
}

#dehaqujqbu .gt_indent_3 {
  text-indent: 15px;
}

#dehaqujqbu .gt_indent_4 {
  text-indent: 20px;
}

#dehaqujqbu .gt_indent_5 {
  text-indent: 25px;
}

#dehaqujqbu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dehaqujqbu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Model Significance</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="N">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="Chi_Square">χ<sup>2</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="p">p</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="N" class="gt_row gt_right">1000&nbsp;</td>
<td headers="Chi_Square" class="gt_row gt_right">21.972</td>
<td headers="df" class="gt_row gt_right">26&nbsp;</td>
<td headers="p" class="gt_row gt_right">0.690</td></tr>
  </tbody>
  
  
</table>
</div>
<div id="hjkgzuoiai" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hjkgzuoiai table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hjkgzuoiai thead, #hjkgzuoiai tbody, #hjkgzuoiai tfoot, #hjkgzuoiai tr, #hjkgzuoiai td, #hjkgzuoiai th {
  border-style: none;
}

#hjkgzuoiai p {
  margin: 0;
  padding: 0;
}

#hjkgzuoiai .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hjkgzuoiai .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hjkgzuoiai .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: bolder;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hjkgzuoiai .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 9px;
  padding-bottom: 11px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hjkgzuoiai .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hjkgzuoiai .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#hjkgzuoiai .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hjkgzuoiai .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 15px;
  padding-right: 15px;
  overflow-x: hidden;
}

#hjkgzuoiai .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hjkgzuoiai .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hjkgzuoiai .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hjkgzuoiai .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hjkgzuoiai .gt_spanner_row {
  border-bottom-style: hidden;
}

#hjkgzuoiai .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hjkgzuoiai .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hjkgzuoiai .gt_from_md > :first-child {
  margin-top: 0;
}

#hjkgzuoiai .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hjkgzuoiai .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hjkgzuoiai .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
}

#hjkgzuoiai .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
  vertical-align: top;
}

#hjkgzuoiai .gt_row_group_first td {
  border-top-width: 2px;
}

#hjkgzuoiai .gt_row_group_first th {
  border-top-width: 2px;
}

#hjkgzuoiai .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#hjkgzuoiai .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hjkgzuoiai .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hjkgzuoiai .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hjkgzuoiai .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#hjkgzuoiai .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hjkgzuoiai .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hjkgzuoiai .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hjkgzuoiai .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hjkgzuoiai .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hjkgzuoiai .gt_footnote {
  margin: 0px;
  font-size: 14px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#hjkgzuoiai .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hjkgzuoiai .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#hjkgzuoiai .gt_left {
  text-align: left;
}

#hjkgzuoiai .gt_center {
  text-align: center;
}

#hjkgzuoiai .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hjkgzuoiai .gt_font_normal {
  font-weight: normal;
}

#hjkgzuoiai .gt_font_bold {
  font-weight: bold;
}

#hjkgzuoiai .gt_font_italic {
  font-style: italic;
}

#hjkgzuoiai .gt_super {
  font-size: 65%;
}

#hjkgzuoiai .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hjkgzuoiai .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hjkgzuoiai .gt_indent_1 {
  text-indent: 5px;
}

#hjkgzuoiai .gt_indent_2 {
  text-indent: 10px;
}

#hjkgzuoiai .gt_indent_3 {
  text-indent: 15px;
}

#hjkgzuoiai .gt_indent_4 {
  text-indent: 20px;
}

#hjkgzuoiai .gt_indent_5 {
  text-indent: 25px;
}

#hjkgzuoiai .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hjkgzuoiai div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Model Fit</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="CFI">CFI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="RMSEA">RMSEA</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="RMSEA_Lower">90% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="TLI">TLI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="SRMR">SRMR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="AIC">AIC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="BIC">BIC</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CFI" class="gt_row gt_right">1.000</td>
<td headers="RMSEA" class="gt_row gt_right">0.000</td>
<td headers="RMSEA_Lower" class="gt_row gt_right">0.000&nbsp;—&nbsp;0.020</td>
<td headers="TLI" class="gt_row gt_right">1.001</td>
<td headers="SRMR" class="gt_row gt_right">0.017</td>
<td headers="AIC" class="gt_row gt_right">17206.124</td>
<td headers="BIC" class="gt_row gt_right">17294.464</td></tr>
  </tbody>
  
  
</table>
</div>
<div id="ulfkopjlyj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ulfkopjlyj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulfkopjlyj thead, #ulfkopjlyj tbody, #ulfkopjlyj tfoot, #ulfkopjlyj tr, #ulfkopjlyj td, #ulfkopjlyj th {
  border-style: none;
}

#ulfkopjlyj p {
  margin: 0;
  padding: 0;
}

#ulfkopjlyj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulfkopjlyj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulfkopjlyj .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: bolder;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulfkopjlyj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 9px;
  padding-bottom: 11px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulfkopjlyj .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulfkopjlyj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#ulfkopjlyj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulfkopjlyj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 15px;
  padding-right: 15px;
  overflow-x: hidden;
}

#ulfkopjlyj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulfkopjlyj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulfkopjlyj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulfkopjlyj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulfkopjlyj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulfkopjlyj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulfkopjlyj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulfkopjlyj .gt_from_md > :first-child {
  margin-top: 0;
}

#ulfkopjlyj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulfkopjlyj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulfkopjlyj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
}

#ulfkopjlyj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
  vertical-align: top;
}

#ulfkopjlyj .gt_row_group_first td {
  border-top-width: 2px;
}

#ulfkopjlyj .gt_row_group_first th {
  border-top-width: 2px;
}

#ulfkopjlyj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#ulfkopjlyj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulfkopjlyj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulfkopjlyj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulfkopjlyj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#ulfkopjlyj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulfkopjlyj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulfkopjlyj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ulfkopjlyj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulfkopjlyj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulfkopjlyj .gt_footnote {
  margin: 0px;
  font-size: 14px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#ulfkopjlyj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulfkopjlyj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#ulfkopjlyj .gt_left {
  text-align: left;
}

#ulfkopjlyj .gt_center {
  text-align: center;
}

#ulfkopjlyj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulfkopjlyj .gt_font_normal {
  font-weight: normal;
}

#ulfkopjlyj .gt_font_bold {
  font-weight: bold;
}

#ulfkopjlyj .gt_font_italic {
  font-style: italic;
}

#ulfkopjlyj .gt_super {
  font-size: 65%;
}

#ulfkopjlyj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulfkopjlyj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulfkopjlyj .gt_indent_1 {
  text-indent: 5px;
}

#ulfkopjlyj .gt_indent_2 {
  text-indent: 10px;
}

#ulfkopjlyj .gt_indent_3 {
  text-indent: 15px;
}

#ulfkopjlyj .gt_indent_4 {
  text-indent: 20px;
}

#ulfkopjlyj .gt_indent_5 {
  text-indent: 25px;
}

#ulfkopjlyj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ulfkopjlyj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Regression Paths</td>
    </tr>
    
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="text-align: center;" scope="col" id="rhs">Predictor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="text-align: center;" scope="col" id="lhs">DV</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="6" scope="colgroup" id="Standardized">
        <div class="gt_column_spanner">Standardized</div>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="est.std">β</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="ci.lower_std">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="stars">sig</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="se">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="z">z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="pvalue">p</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rhs" class="gt_row gt_left">x1</td>
<td headers="lhs" class="gt_row gt_left">x2</td>
<td headers="est.std" class="gt_row gt_right"> 0.658</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.635&nbsp;—&nbsp;0.682</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.012</td>
<td headers="z" class="gt_row gt_right">54.798</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y1</td>
<td headers="lhs" class="gt_row gt_left">x2</td>
<td headers="est.std" class="gt_row gt_right"> 0.259</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.232&nbsp;—&nbsp;0.286</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.014</td>
<td headers="z" class="gt_row gt_right">18.804</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">x2</td>
<td headers="lhs" class="gt_row gt_left">x3</td>
<td headers="est.std" class="gt_row gt_right"> 0.669</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.647&nbsp;—&nbsp;0.692</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.011</td>
<td headers="z" class="gt_row gt_right">58.688</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y2</td>
<td headers="lhs" class="gt_row gt_left">x3</td>
<td headers="est.std" class="gt_row gt_right"> 0.236</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.212&nbsp;—&nbsp;0.260</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.012</td>
<td headers="z" class="gt_row gt_right">18.905</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">x3</td>
<td headers="lhs" class="gt_row gt_left">x4</td>
<td headers="est.std" class="gt_row gt_right"> 0.681</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.659&nbsp;—&nbsp;0.704</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.011</td>
<td headers="z" class="gt_row gt_right">59.909</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y3</td>
<td headers="lhs" class="gt_row gt_left">x4</td>
<td headers="est.std" class="gt_row gt_right"> 0.226</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.203&nbsp;—&nbsp;0.250</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.012</td>
<td headers="z" class="gt_row gt_right">18.804</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">x1</td>
<td headers="lhs" class="gt_row gt_left">y2</td>
<td headers="est.std" class="gt_row gt_right">−0.013</td>
<td headers="ci.lower_std" class="gt_row gt_right">−0.044&nbsp;—&nbsp;0.017</td>
<td headers="stars" class="gt_row gt_right"></td>
<td headers="se" class="gt_row gt_right">0.016</td>
<td headers="z" class="gt_row gt_right">−0.864</td>
<td headers="pvalue" class="gt_row gt_right">0.387</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y1</td>
<td headers="lhs" class="gt_row gt_left">y2</td>
<td headers="est.std" class="gt_row gt_right"> 0.640</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.610&nbsp;—&nbsp;0.670</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.015</td>
<td headers="z" class="gt_row gt_right">41.812</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">x2</td>
<td headers="lhs" class="gt_row gt_left">y3</td>
<td headers="est.std" class="gt_row gt_right">−0.015</td>
<td headers="ci.lower_std" class="gt_row gt_right">−0.047&nbsp;—&nbsp;0.018</td>
<td headers="stars" class="gt_row gt_right"></td>
<td headers="se" class="gt_row gt_right">0.017</td>
<td headers="z" class="gt_row gt_right">−0.865</td>
<td headers="pvalue" class="gt_row gt_right">0.387</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y2</td>
<td headers="lhs" class="gt_row gt_left">y3</td>
<td headers="est.std" class="gt_row gt_right"> 0.620</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.589&nbsp;—&nbsp;0.651</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.016</td>
<td headers="z" class="gt_row gt_right">38.928</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">x3</td>
<td headers="lhs" class="gt_row gt_left">y4</td>
<td headers="est.std" class="gt_row gt_right">−0.015</td>
<td headers="ci.lower_std" class="gt_row gt_right">−0.050&nbsp;—&nbsp;0.019</td>
<td headers="stars" class="gt_row gt_right"></td>
<td headers="se" class="gt_row gt_right">0.018</td>
<td headers="z" class="gt_row gt_right">−0.866</td>
<td headers="pvalue" class="gt_row gt_right">0.386</td></tr>
    <tr><td headers="rhs" class="gt_row gt_left">y3</td>
<td headers="lhs" class="gt_row gt_left">y4</td>
<td headers="est.std" class="gt_row gt_right"> 0.612</td>
<td headers="ci.lower_std" class="gt_row gt_right"> 0.580&nbsp;—&nbsp;0.644</td>
<td headers="stars" class="gt_row gt_right">***</td>
<td headers="se" class="gt_row gt_right">0.016</td>
<td headers="z" class="gt_row gt_right">37.455</td>
<td headers="pvalue" class="gt_row gt_right">0.000</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="8"> * p &lt; .05; ** p &lt; .01; *** p &lt; .001</td>
    </tr>
  </tfoot>
</table>
</div>
<div id="ycdyibenml" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ycdyibenml table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ycdyibenml thead, #ycdyibenml tbody, #ycdyibenml tfoot, #ycdyibenml tr, #ycdyibenml td, #ycdyibenml th {
  border-style: none;
}

#ycdyibenml p {
  margin: 0;
  padding: 0;
}

#ycdyibenml .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ycdyibenml .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ycdyibenml .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: bolder;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ycdyibenml .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 9px;
  padding-bottom: 11px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ycdyibenml .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ycdyibenml .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#ycdyibenml .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ycdyibenml .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 15px;
  padding-right: 15px;
  overflow-x: hidden;
}

#ycdyibenml .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ycdyibenml .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ycdyibenml .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ycdyibenml .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ycdyibenml .gt_spanner_row {
  border-bottom-style: hidden;
}

#ycdyibenml .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ycdyibenml .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ycdyibenml .gt_from_md > :first-child {
  margin-top: 0;
}

#ycdyibenml .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ycdyibenml .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ycdyibenml .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
}

#ycdyibenml .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 15px;
  padding-right: 15px;
  vertical-align: top;
}

#ycdyibenml .gt_row_group_first td {
  border-top-width: 2px;
}

#ycdyibenml .gt_row_group_first th {
  border-top-width: 2px;
}

#ycdyibenml .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#ycdyibenml .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ycdyibenml .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ycdyibenml .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ycdyibenml .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
}

#ycdyibenml .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ycdyibenml .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 15px;
  padding-right: 15px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ycdyibenml .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ycdyibenml .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ycdyibenml .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ycdyibenml .gt_footnote {
  margin: 0px;
  font-size: 14px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#ycdyibenml .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ycdyibenml .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 15px;
  padding-right: 15px;
}

#ycdyibenml .gt_left {
  text-align: left;
}

#ycdyibenml .gt_center {
  text-align: center;
}

#ycdyibenml .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ycdyibenml .gt_font_normal {
  font-weight: normal;
}

#ycdyibenml .gt_font_bold {
  font-weight: bold;
}

#ycdyibenml .gt_font_italic {
  font-style: italic;
}

#ycdyibenml .gt_super {
  font-size: 65%;
}

#ycdyibenml .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ycdyibenml .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ycdyibenml .gt_indent_1 {
  text-indent: 5px;
}

#ycdyibenml .gt_indent_2 {
  text-indent: 10px;
}

#ycdyibenml .gt_indent_3 {
  text-indent: 15px;
}

#ycdyibenml .gt_indent_4 {
  text-indent: 20px;
}

#ycdyibenml .gt_indent_5 {
  text-indent: 25px;
}

#ycdyibenml .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ycdyibenml div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Variable Intercepts</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="lhs">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="label">label</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="est">Intercept</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="se">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="z">z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="pvalue">p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="ci.lower">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="stars">sig</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="lhs" class="gt_row gt_left">x1</td>
<td headers="label" class="gt_row gt_left">b_x01</td>
<td headers="est" class="gt_row gt_right"> 0.046</td>
<td headers="se" class="gt_row gt_right">0.032</td>
<td headers="z" class="gt_row gt_right"> 1.432</td>
<td headers="pvalue" class="gt_row gt_right">0.152</td>
<td headers="ci.lower" class="gt_row gt_right">−0.017&nbsp;—&nbsp;0.110</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">x2</td>
<td headers="label" class="gt_row gt_left">b_x02</td>
<td headers="est" class="gt_row gt_right"> 0.002</td>
<td headers="se" class="gt_row gt_right">0.020</td>
<td headers="z" class="gt_row gt_right"> 0.110</td>
<td headers="pvalue" class="gt_row gt_right">0.913</td>
<td headers="ci.lower" class="gt_row gt_right">−0.038&nbsp;—&nbsp;0.042</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">x3</td>
<td headers="label" class="gt_row gt_left">b_x03</td>
<td headers="est" class="gt_row gt_right">−0.030</td>
<td headers="se" class="gt_row gt_right">0.020</td>
<td headers="z" class="gt_row gt_right">−1.487</td>
<td headers="pvalue" class="gt_row gt_right">0.137</td>
<td headers="ci.lower" class="gt_row gt_right">−0.070&nbsp;—&nbsp;0.010</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">x4</td>
<td headers="label" class="gt_row gt_left">b_x04</td>
<td headers="est" class="gt_row gt_right">−0.001</td>
<td headers="se" class="gt_row gt_right">0.020</td>
<td headers="z" class="gt_row gt_right">−0.045</td>
<td headers="pvalue" class="gt_row gt_right">0.964</td>
<td headers="ci.lower" class="gt_row gt_right">−0.041&nbsp;—&nbsp;0.039</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">y1</td>
<td headers="label" class="gt_row gt_left">b_y01</td>
<td headers="est" class="gt_row gt_right"> 0.028</td>
<td headers="se" class="gt_row gt_right">0.031</td>
<td headers="z" class="gt_row gt_right"> 0.913</td>
<td headers="pvalue" class="gt_row gt_right">0.361</td>
<td headers="ci.lower" class="gt_row gt_right">−0.032&nbsp;—&nbsp;0.089</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">y2</td>
<td headers="label" class="gt_row gt_left">b_y02</td>
<td headers="est" class="gt_row gt_right"> 0.012</td>
<td headers="se" class="gt_row gt_right">0.023</td>
<td headers="z" class="gt_row gt_right"> 0.519</td>
<td headers="pvalue" class="gt_row gt_right">0.604</td>
<td headers="ci.lower" class="gt_row gt_right">−0.033&nbsp;—&nbsp;0.056</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">y3</td>
<td headers="label" class="gt_row gt_left">b_y03</td>
<td headers="est" class="gt_row gt_right">−0.021</td>
<td headers="se" class="gt_row gt_right">0.023</td>
<td headers="z" class="gt_row gt_right">−0.915</td>
<td headers="pvalue" class="gt_row gt_right">0.360</td>
<td headers="ci.lower" class="gt_row gt_right">−0.065&nbsp;—&nbsp;0.024</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
    <tr><td headers="lhs" class="gt_row gt_left">y4</td>
<td headers="label" class="gt_row gt_left">b_y04</td>
<td headers="est" class="gt_row gt_right">−0.010</td>
<td headers="se" class="gt_row gt_right">0.023</td>
<td headers="z" class="gt_row gt_right">−0.427</td>
<td headers="pvalue" class="gt_row gt_right">0.669</td>
<td headers="ci.lower" class="gt_row gt_right">−0.054&nbsp;—&nbsp;0.035</td>
<td headers="stars" class="gt_row gt_right"></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="8"> * p &lt; .05; ** p &lt; .01; *** p &lt; .001</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="why-the-clpm-is-probably-not-your-model" class="level1 page-columns page-full">
<h1>Why the CLPM is probably not your model</h1>
<p>There is nothing inherently wrong with the cross-lag panel model—if it describes how a set of phenomena works, it is the model to use. However, the cross-lag panel model has a set of assumptions and implications that are not always apparent to the researcher, and it can give misleading results under situations that arise frequently. The cross-lag panel model assumes that the only source of stability across time is the influence of the immediate past. It may not be obvious that this restriction implies that the long-term stability of every variable eventually becomes 0.</p>
<p>For example, in <a href="#fig-crosslag" class="quarto-xref">Figure&nbsp;1</a>, <em>X</em><sub>3</sub> has been influenced by the time 2 variables <em>X</em><sub>2</sub> and <em>Y</em><sub>2</sub> only—and the only connection to the time 1 variables <em>X</em><sub>1</sub> and <em>Y</em><sub>1</sub> is through the time 2 variables. Many variables do not operate like this. The past certainly influences the future, but some variables are influenced by traits that have long-term influences that affect scores at every time point more or less equally. The personality trait of extroversion is not merely affected by the recent past but by longstanding habits, temperament, and genetic factors <span class="citation" data-cites="kandlerHowGeneticEnvironmental2021">(<a href="#ref-kandlerHowGeneticEnvironmental2021" role="doc-biblioref">Kandler et al., 2021</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-kandlerHowGeneticEnvironmental2021" class="csl-entry" role="listitem">
Kandler, C., Bratko, D., Butković, A., Hlupić, T. V., Tybur, J. M., Wesseldijk, L. W., De Vries, R. E., Jern, P., &amp; Lewis, G. J. (2021). How genetic and environmental variance in personality traits shift across the life span: <span>Evidence</span> from a cross-national twin study. <em>Journal of Personality and Social Psychology</em>, <em>121</em>(5), 1079–1094. <a href="https://doi.org/10.1037/pspp0000366">https://doi.org/10.1037/pspp0000366</a>
</div></div><p>The cross-lag panel model, given enough measurements, implies that the long-term stability of every variable eventually goes to 0. That is, the correlation between the first and last measurement of any variable will approach 0, given a sufficient number of measurements. Why? Because the standardized paths are less than one, and multiplying across many such paths has an asymptote at 0.</p>
<p>Trait-like variables, by contrast, have long-term stability coefficients that never approach 0. The cross-lag panel model attempts to account for the increased correlations across time by inflating the cross-lag effects. Thus, for trait-like variables, the model is likely to imply cross-lag effects that do not exist <span class="citation" data-cites="lucasWhyCrosslaggedPanel2023">(<a href="#ref-lucasWhyCrosslaggedPanel2023" role="doc-biblioref">Lucas, 2023</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-lucasWhyCrosslaggedPanel2023" class="csl-entry" role="listitem">
Lucas, R. E. (2023). Why the cross-lagged panel model is almost never the right choice. <em>Advances in Methods and Practices in Psychological Science</em>, <em>6</em>(1), 25152459231158378. <a href="https://doi.org/10.1177/25152459231158378">https://doi.org/10.1177/25152459231158378</a>
</div></div></section>
<section id="random-intercept-cross-lag-panel-models" class="level1 page-columns page-full">
<h1>Random Intercept Cross-Lag Panel Models</h1>
<p>Adding random intercepts to the cross-lag panel model allows for long-term stability of variable series. The random intercepts <em>i</em><sub><em>X</em></sub> and <em>i</em><sub><em>X</em></sub> act as trait-like influences on each variable series. <a href="#fig-ricrosslag" class="quarto-xref">Figure&nbsp;3</a> might look much more complicated than <a href="#fig-crosslag" class="quarto-xref">Figure&nbsp;1</a>, but the residuals between series <em>X</em> and <em>Y</em> in <a href="#fig-ricrosslag" class="quarto-xref">Figure&nbsp;3</a> are configured exactly like the cross-lag panel in <a href="#fig-crosslag" class="quarto-xref">Figure&nbsp;1</a>. That is, the autoregressive and cross-lag effects connect the residuals rather than the observed variables. The advantage of this model is that it fully separates between-person differences and within-person change <span class="citation" data-cites="hamakerCritiqueCrosslaggedPanel2015">(<a href="#ref-hamakerCritiqueCrosslaggedPanel2015" role="doc-biblioref">Hamaker et al., 2015</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-hamakerCritiqueCrosslaggedPanel2015" class="csl-entry" role="listitem">
Hamaker, E. L., Kuiper, R. M., &amp; Grasman, R. P. P. P. (2015). A critique of the cross-lagged panel model. <em>Psychological Methods</em>, <em>20</em>(1), 102–116. <a href="https://doi.org/10.1037/a0038889">https://doi.org/10.1037/a0038889</a>
</div></div><div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>my_connect2 <span class="ot">&lt;-</span> <span class="fu">redefault</span>(connect, <span class="at">length_head =</span> <span class="dv">5</span>, <span class="at">resect =</span> <span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdiagram</span>(<span class="at">font_family =</span> my_font, <span class="at">font_size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  {x <span class="ot">&lt;-</span> <span class="fu">my_observed</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ob_array</span>(k,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep =</span> <span class="fl">2.5</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">where =</span> <span class="st">"south"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*X*~"</span> , <span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>))} <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  {y <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*Y*~"</span> ,<span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x, <span class="st">"right"</span>, <span class="at">sep =</span> <span class="dv">7</span>)} <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  {e_x <span class="ot">&lt;-</span> <span class="fu">my_error</span>(</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> .<span class="dv">5</span>, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="fu">paste0</span>(<span class="st">"*e*~*X*"</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>), </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x, <span class="st">"right"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  {e_y <span class="ot">&lt;-</span> <span class="fu">my_error</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> .<span class="dv">5</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ob_label</span>(<span class="fu">paste0</span>(<span class="st">"*e*~*Y*"</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>), </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(y, <span class="st">"left"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  {ee_x <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(e_x[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"right"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  {ee_y <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(e_y[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"left"</span>, <span class="at">sep =</span> .<span class="dv">6</span>)} <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  {lxx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_x[<span class="sc">-</span>k], e_x[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~XX~*"</span>, lxx<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  {lxy <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_x[<span class="sc">-</span>k], e_y[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~XY~*"</span>, lxy<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">27</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  {lyx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_y[<span class="sc">-</span>k], e_x[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~YX~*"</span>, lyx<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">27</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  {lyy <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_y[<span class="sc">-</span>k], e_y[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span> </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~YY~*"</span>, lyy<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(e_x, x) <span class="sc">+</span> </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(e_y, y) <span class="sc">+</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(ee_x, e_x[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(ee_y, e_y[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(e_x[<span class="dv">1</span>], e_y[<span class="dv">1</span>]) <span class="sc">+</span> </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(ee_y, ee_x, </span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">resect =</span> <span class="dv">1</span>,</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_head =</span> <span class="dv">4</span>, </span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_fins =</span> <span class="dv">4</span>, </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  {ix <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*i*~*X*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"left"</span>), <span class="st">"left"</span>, <span class="at">sep =</span> <span class="fl">1.5</span>)} <span class="sc">+</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  {iy <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*i*~*Y*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(y<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"right"</span>), <span class="st">"right"</span>, <span class="at">sep =</span> <span class="fl">1.5</span>)} <span class="sc">+</span> </span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  {lx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(ix, x<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="fu">seq</span>(<span class="dv">225</span>,<span class="dv">135</span>,<span class="at">length.out =</span> k))))} <span class="sc">+</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  {ly <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(iy, y<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">45</span>,<span class="dv">45</span>,<span class="at">length.out =</span> k))))} <span class="sc">+</span> </span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"1"</span>, <span class="at">center =</span> lx<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(lx[<span class="dv">2</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>)<span class="sc">@</span>x), <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"1"</span>, <span class="at">center =</span> ly<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(ly[<span class="dv">2</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>)<span class="sc">@</span>x), <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(ix<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"north"</span>), iy<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"north"</span>), </span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.5</span>, </span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="dv">45</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-ricrosslag" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-ricrosslag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-ricrosslag-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ricrosslag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Cross-Lag Panel Model with Random Intercepts
</figcaption>
</figure>
</div>
</div>
</div>
<p>We need to create latent intercepts for the X and Y series. Here is the syntax we need to define the latent variable <em>I~X</em>:</p>
<pre><code>i_x =~ 1 * x1 + 1 * x2 + 1 * x3 + 1 * x4</code></pre>
<p>If you would rather get that with code instead of typing:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"i_x =~ "</span>, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">glue_collapse</span>(<span class="fu">glue</span>(<span class="st">"1 * x{1:k}"</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">" + "</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>i_x =~ 1 * x1 + 1 * x2 + 1 * x3 + 1 * x4</code></pre>
</div>
</div>
<p>That’s even more typing! I do not want to type that kind of thing for every latent variable.</p>
<p>How about making a custom <code>make_latent</code> function instead?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>make_latent <span class="ot">&lt;-</span> <span class="cf">function</span>(latent, indicator, <span class="at">sep =</span> <span class="st">" + "</span>) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    latent, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">" =~ "</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    glue<span class="sc">::</span><span class="fu">glue_collapse</span>(glue<span class="sc">::</span><span class="fu">glue</span>(indicator), <span class="at">sep =</span> sep))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Less typing!</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">make_latent</span>(<span class="at">latent =</span> <span class="st">"i_x"</span>, <span class="at">indicator =</span> <span class="st">"1 * x{1:k}"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>i_x =~ 1 * x1 + 1 * x2 + 1 * x3 + 1 * x4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Even less typing!</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make_latent</span>(<span class="st">"i_y"</span>, <span class="st">"1 * y{1:k}"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>i_y =~ 1 * y1 + 1 * y2 + 1 * y3 + 1 * y4</code></pre>
</div>
</div>
<section id="structured-residuals" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="structured-residuals">Structured Residuals</h2>
<p>In <a href="#fig-ricrosslag" class="quarto-xref">Figure&nbsp;3</a>, the residuals for <em>X</em><sub>2</sub> to <em>X</em><sub>4</sub> are <em>structured residuals</em> because they have residuals themselves. Technically, structured residuals are not really residuals, but latent variables with loadings of 1.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_x{1:k} =~ 1 * x{1:k}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_x1 =~ 1 * x1
e_x2 =~ 1 * x2
e_x3 =~ 1 * x3
e_x4 =~ 1 * x4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_y{1:k} =~ 1 * y{1:k}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_y1 =~ 1 * y1
e_y2 =~ 1 * y2
e_y3 =~ 1 * y3
e_y4 =~ 1 * y4</code></pre>
</div>
</div>
<p>To make the structured residuals behave like residuals, we need to set the actual residuals of the observed variables to have 0 variance:</p>
<p><code>\{r\} #| label:\1 glue("x{1:k} ~~ 0 * x{1:k}")  glue("y{1:k} ~~ 0 * y{1:k}")</code></p>
<p>We also need to label the latent variance and covariance parameters such that the first one is different from the others, which are set equal:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>var_ex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ex1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exx"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>var_ey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ey1"</span>, <span class="fu">rep</span>(<span class="st">"tau_eyy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>cov_exy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_exy1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {var_ex} * e_x{1:k}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_x1 ~~ tau_ex1 * e_x1
e_x2 ~~ tau_exx * e_x2
e_x3 ~~ tau_exx * e_x3
e_x4 ~~ tau_exx * e_x4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_y{1:k} ~~ {var_ey} * e_y{1:k}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_y1 ~~ tau_ey1 * e_y1
e_y2 ~~ tau_eyy * e_y2
e_y3 ~~ tau_eyy * e_y3
e_y4 ~~ tau_eyy * e_y4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {cov_exy} * e_y{1:k}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_x1 ~~ tau_exy1 * e_y1
e_x2 ~~ tau_exy * e_y2
e_x3 ~~ tau_exy * e_y3
e_x4 ~~ tau_exy * e_y4</code></pre>
</div>
</div>
<p>The regression syntax is similar to the CLPM syntax except that the predictors and outcomes are between the structured residuals instead of the observed variables.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_x{s2k} ~ b_xx * x{s1k1} + b_yx * e_y{s1k1}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_x2 ~ b_xx * x1 + b_yx * e_y1
e_x3 ~ b_xx * x2 + b_yx * e_y2
e_x4 ~ b_xx * x3 + b_yx * e_y3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"e_y{s2k} ~ b_yy * y{s1k1} + b_xy * e_x{s1k1}"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>e_y2 ~ b_yy * y1 + b_xy * e_x1
e_y3 ~ b_yy * y2 + b_xy * e_x2
e_y4 ~ b_yy * y3 + b_xy * e_x3</code></pre>
</div>
</div>
<p>The latent random intercepts need intercepts (weird but true):</p>
<pre><code>i_x ~ b_ix_0 * 1
i_y ~ b_iy_0 * 1</code></pre>
<p>Finally, the latent random intercepts need variances and a covariance:</p>
<pre><code>i_x ~~ tau_ix * i_x + tau_ixiy * i_y
i_y ~~ tau_iy * i_y </code></pre>
<p>Putting it all together for the RI-CLPM:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of waves</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 2 to k</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>s2k <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, k)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 1 to k - 1</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>s1k1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual variances and covariances</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>var_ex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ex1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exx"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>var_ey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ey1"</span>, <span class="fu">rep</span>(<span class="st">"tau_eyy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>cov_exy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_exy1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>m_riclpm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"# Latent intercepts"</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"i_x"</span>, <span class="st">"1 * x{1:k}"</span>),</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"i_y"</span>, <span class="st">"1 * y{1:k}"</span>),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residuals"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} =~ 1 * x{1:k}"</span>), </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{1:k} =~ 1 * y{1:k}"</span>),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Set observed residuals to 0"</span>,</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~~ 0 * x{1:k}"</span>), </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~~ 0 * y{1:k}"</span>),</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residual Variances and Covariances"</span>,</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {var_ex} * e_x{1:k}"</span>),</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{1:k} ~~ {var_ey} * e_y{1:k}"</span>), </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {cov_exy} * e_y{1:k}"</span>),</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residual Regressions"</span>,</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{s2k} ~ b_xx * e_x{s1k1} + b_yx * e_y{s1k1}"</span>),</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{s2k} ~ b_yy * e_y{s1k1} + b_xy * e_x{s1k1}"</span>),</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Observed Intercepts set to 0"</span>,</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~ 0 * 1"</span>), </span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~ 0 * 1"</span>), </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Intercept Intercepts"</span>,</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_x ~ b_ix_0 * 1"</span>,</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_y ~ b_iy_0 * 1"</span>,</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Intecept Variances and Covariance"</span>,</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_x ~~ tau_ix * i_x + tau_ixiy * i_y"</span>,</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_y ~~ tau_iy * i_y"</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>m_riclpm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Latent intercepts
i_x =~ 1 * x1 + 1 * x2 + 1 * x3 + 1 * x4
i_y =~ 1 * y1 + 1 * y2 + 1 * y3 + 1 * y4
# Structured Residuals
e_x1 =~ 1 * x1
e_x2 =~ 1 * x2
e_x3 =~ 1 * x3
e_x4 =~ 1 * x4
e_y1 =~ 1 * y1
e_y2 =~ 1 * y2
e_y3 =~ 1 * y3
e_y4 =~ 1 * y4
# Set observed residuals to 0
x1 ~~ 0 * x1
x2 ~~ 0 * x2
x3 ~~ 0 * x3
x4 ~~ 0 * x4
y1 ~~ 0 * y1
y2 ~~ 0 * y2
y3 ~~ 0 * y3
y4 ~~ 0 * y4
# Structured Residual Variances and Covariances
e_x1 ~~ tau_ex1 * e_x1
e_x2 ~~ tau_exx * e_x2
e_x3 ~~ tau_exx * e_x3
e_x4 ~~ tau_exx * e_x4
e_y1 ~~ tau_ey1 * e_y1
e_y2 ~~ tau_eyy * e_y2
e_y3 ~~ tau_eyy * e_y3
e_y4 ~~ tau_eyy * e_y4
e_x1 ~~ tau_exy1 * e_y1
e_x2 ~~ tau_exy * e_y2
e_x3 ~~ tau_exy * e_y3
e_x4 ~~ tau_exy * e_y4
# Structured Residual Regressions
e_x2 ~ b_xx * e_x1 + b_yx * e_y1
e_x3 ~ b_xx * e_x2 + b_yx * e_y2
e_x4 ~ b_xx * e_x3 + b_yx * e_y3
e_y2 ~ b_yy * e_y1 + b_xy * e_x1
e_y3 ~ b_yy * e_y2 + b_xy * e_x2
e_y4 ~ b_yy * e_y3 + b_xy * e_x3
# Observed Intercepts set to 0
x1 ~ 0 * 1
x2 ~ 0 * 1
x3 ~ 0 * 1
x4 ~ 0 * 1
y1 ~ 0 * 1
y2 ~ 0 * 1
y3 ~ 0 * 1
y4 ~ 0 * 1
# Random Intercept Intercepts
i_x ~ b_ix_0 * 1
i_y ~ b_iy_0 * 1
# Random Intecept Variances and Covariance
i_x ~~ tau_ix * i_x + tau_ixiy * i_y
i_y ~~ tau_iy * i_y</code></pre>
</div>
</div>
<p>Here we set the parameters for data simulation:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>params_riclpm <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ex1 =</span> <span class="dv">1</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ey1 =</span> <span class="dv">1</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exy1 =</span> .<span class="dv">4</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exx =</span> .<span class="dv">4</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_eyy =</span> .<span class="dv">5</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exy =</span> .<span class="dv">2</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ix =</span> <span class="fl">0.75</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_iy =</span> <span class="fl">0.75</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ixiy =</span> .<span class="dv">25</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xx =</span> .<span class="dv">5</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yy =</span> .<span class="dv">4</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xy =</span> .<span class="dv">3</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yx =</span> <span class="dv">0</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_ix_0 =</span> <span class="dv">0</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_iy_0 =</span> <span class="dv">0</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>d_riclpm <span class="ot">&lt;-</span> <span class="fu">replace_parameters</span>(<span class="at">model =</span> m_riclpm, </span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">params =</span> params_riclpm) <span class="sc">%&gt;%</span> </span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulateData</span>(<span class="at">sample.nobs =</span> <span class="dv">1000</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In <a href="#fig-riclpmcor" class="quarto-xref">Figure&nbsp;4</a>, we can see the correlations among the variables created with the RI-CLPM.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cor</span>(d_riclpm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-riclpmcor" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-riclpmcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-riclpmcor-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-riclpmcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Correlation of X and Y in RI-CLPM
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-riclpmchange" class="quarto-xref">Figure&nbsp;5</a>, we see that the RI-CLPM creates data that stays at the same overall level across time. There is no growth.</p>
<div class="cell page-columns page-full" data-preview-image="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>d_riclpm <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v =</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> v) <span class="sc">%&gt;%</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(id), x, <span class="at">.fun =</span> mean)) <span class="sc">%&gt;%</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> id), <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, .<span class="dv">75</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ease_aes</span>(<span class="st">'cubic-in-out'</span>) <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_wake</span>(<span class="at">wake_length =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">vjust =</span> .<span class="dv">5</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Time {closest_state}'</span>, <span class="at">x =</span> <span class="st">'X'</span>, <span class="at">y =</span> <span class="st">'Y'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-riclpmchange" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-riclpmchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-riclpmchange-1.gif" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-riclpmchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Changes in X and Y over Time in RI-CLPM
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-riclpmstability" class="quarto-xref">Figure&nbsp;6</a> show the distributions over time in the RI-CLPM. It is evident that the model does not allow for change over time (by design). If we expect growth, we need a model that allows for growth.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>d_riclpm <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v =</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>() <span class="sc">%&gt;%</span> <span class="fu">factor</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(id), value, <span class="at">.fun =</span> mean)) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"gray95"</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id, <span class="at">color =</span> id), <span class="at">linewidth =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(v)) <span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">24</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">vjust =</span> .<span class="dv">5</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">"Time"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-riclpmstability" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-riclpmstability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-riclpmstability-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-riclpmstability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Distribution of X and Y over Time in RI-CLPM
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we did not know how the data were generated, we could evaluate the model with the RI-CLPM.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sem</span>(<span class="at">model =</span> m_riclpm, <span class="at">data =</span> d_riclpm, <span class="at">auto.cov.lv.x =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">component =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Loading

Link       | Coefficient |   SE |       95% CI |      p
-------------------------------------------------------
i_x =~ x1  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x3  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x4  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y1  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y3  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y4  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x1 =~ x1 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x2 =~ x2 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x3 =~ x3 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x4 =~ x4 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y1 =~ y1 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y2 =~ y2 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y3 =~ y3 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y4 =~ y4 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001

# Variance

Link                   | Coefficient |   SE |       95% CI |     z |      p
---------------------------------------------------------------------------
x1 ~~ x1               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x2 ~~ x2               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x3 ~~ x3               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x4 ~~ x4               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y1 ~~ y1               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y2 ~~ y2               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y3 ~~ y3               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y4 ~~ y4               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
e_x1 ~~ e_x1 (tau_ex1) |        1.05 | 0.07 | [0.91, 1.20] | 14.43 | &lt; .001
e_x2 ~~ e_x2 (tau_exx) |        0.39 | 0.02 | [0.36, 0.42] | 25.35 | &lt; .001
e_x3 ~~ e_x3 (tau_exx) |        0.39 | 0.02 | [0.36, 0.42] | 25.35 | &lt; .001
e_x4 ~~ e_x4 (tau_exx) |        0.39 | 0.02 | [0.36, 0.42] | 25.35 | &lt; .001
e_y1 ~~ e_y1 (tau_ey1) |        1.07 | 0.08 | [0.91, 1.23] | 13.09 | &lt; .001
e_y2 ~~ e_y2 (tau_eyy) |        0.51 | 0.02 | [0.47, 0.55] | 26.52 | &lt; .001
e_y3 ~~ e_y3 (tau_eyy) |        0.51 | 0.02 | [0.47, 0.55] | 26.52 | &lt; .001
e_y4 ~~ e_y4 (tau_eyy) |        0.51 | 0.02 | [0.47, 0.55] | 26.52 | &lt; .001
i_x ~~ i_x (tau_ix)    |        0.84 | 0.06 | [0.72, 0.97] | 13.17 | &lt; .001
i_y ~~ i_y (tau_iy)    |        0.62 | 0.08 | [0.47, 0.77] |  8.08 | &lt; .001

# Correlation

Link                    | Coefficient |   SE |       95% CI |     z |      p
----------------------------------------------------------------------------
e_x1 ~~ e_y1 (tau_exy1) |        0.44 | 0.06 | [0.32, 0.56] |  7.06 | &lt; .001
e_x2 ~~ e_y2 (tau_exy)  |        0.20 | 0.01 | [0.17, 0.22] | 14.95 | &lt; .001
e_x3 ~~ e_y3 (tau_exy)  |        0.20 | 0.01 | [0.17, 0.22] | 14.95 | &lt; .001
e_x4 ~~ e_y4 (tau_exy)  |        0.20 | 0.01 | [0.17, 0.22] | 14.95 | &lt; .001
i_x ~~ i_y (tau_ixiy)   |        0.24 | 0.06 | [0.12, 0.35] |  4.11 | &lt; .001

# Regression

Link               | Coefficient |   SE |        95% CI |     z |      p
------------------------------------------------------------------------
e_x2 ~ e_x1 (b_xx) |        0.48 | 0.03 | [ 0.42, 0.54] | 15.48 | &lt; .001
e_x2 ~ e_y1 (b_yx) |    5.75e-03 | 0.03 | [-0.04, 0.06] |  0.23 | 0.819 
e_x3 ~ e_x2 (b_xx) |        0.48 | 0.03 | [ 0.42, 0.54] | 15.48 | &lt; .001
e_x3 ~ e_y2 (b_yx) |    5.75e-03 | 0.03 | [-0.04, 0.06] |  0.23 | 0.819 
e_x4 ~ e_x3 (b_xx) |        0.48 | 0.03 | [ 0.42, 0.54] | 15.48 | &lt; .001
e_x4 ~ e_y3 (b_yx) |    5.75e-03 | 0.03 | [-0.04, 0.06] |  0.23 | 0.819 
e_y2 ~ e_y1 (b_yy) |        0.40 | 0.03 | [ 0.33, 0.47] | 11.71 | &lt; .001
e_y2 ~ e_x1 (b_xy) |        0.33 | 0.03 | [ 0.28, 0.39] | 11.63 | &lt; .001
e_y3 ~ e_y2 (b_yy) |        0.40 | 0.03 | [ 0.33, 0.47] | 11.71 | &lt; .001
e_y3 ~ e_x2 (b_xy) |        0.33 | 0.03 | [ 0.28, 0.39] | 11.63 | &lt; .001
e_y4 ~ e_y3 (b_yy) |        0.40 | 0.03 | [ 0.33, 0.47] | 11.71 | &lt; .001
e_y4 ~ e_x3 (b_xy) |        0.33 | 0.03 | [ 0.28, 0.39] | 11.63 | &lt; .001

# Mean

Link             | Coefficient |   SE |        95% CI |    z |      p
---------------------------------------------------------------------
x1 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
x2 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
x3 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
x4 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
y1 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
y2 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
y3 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
y4 ~1            |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
i_x ~1  (b_ix_0) |        0.02 | 0.03 | [-0.05, 0.09] | 0.54 | 0.586 
i_y ~1  (b_iy_0) |        0.02 | 0.03 | [-0.04, 0.09] | 0.71 | 0.476 
e_x1 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_x2 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_x3 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_x4 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_y1 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_y2 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_y3 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001
e_y4 ~1          |        0.00 | 0.00 | [ 0.00, 0.00] |      | &lt; .001</code></pre>
</div>
</div>
</section>
</section>
<section id="latent-growth-with-structured-residuals" class="level1 page-columns page-full">
<h1>Latent Growth With Structured Residuals</h1>
<p>Here we combine bivariate latent growth models with the cross-lagged panel model <span class="citation" data-cites="curranSeparationBetweenpersonWithinperson2014">(<a href="#ref-curranSeparationBetweenpersonWithinperson2014" role="doc-biblioref">Curran et al., 2014</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-curranSeparationBetweenpersonWithinperson2014" class="csl-entry" role="listitem">
Curran, P. J., Howard, A. L., Bainter, S. A., Lane, S. T., &amp; McGinley, J. S. (2014). The separation of between-person and within-person components of individual change over time: <span>A</span> latent curve model with structured residuals. <em>Journal of Consulting and Clinical Psychology</em>, <em>82</em>(5), 879–894. <a href="https://doi.org/10.1037/a0035297">https://doi.org/10.1037/a0035297</a>
</div></div><div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdiagram</span>(<span class="at">font_family =</span> my_font, <span class="at">font_size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  {x <span class="ot">&lt;-</span> <span class="fu">my_observed</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ob_array</span>(k,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">sep =</span> <span class="fl">2.5</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">where =</span> <span class="st">"south"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*X*~"</span> , <span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>))} <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  {y <span class="ot">&lt;-</span> <span class="fu">my_observed</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"*Y*~"</span> ,<span class="dv">1</span><span class="sc">:</span>k, <span class="st">"~"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x, <span class="st">"right"</span>, <span class="at">sep =</span> <span class="dv">7</span>)} <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  {e_x <span class="ot">&lt;-</span> <span class="fu">my_error</span>(<span class="at">radius =</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">place</span>(x, <span class="st">"right"</span>, <span class="at">sep =</span> .<span class="dv">5</span>)} <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  {e_y <span class="ot">&lt;-</span> <span class="fu">my_error</span>(<span class="at">radius =</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">place</span>(y, <span class="st">"left"</span>, <span class="at">sep =</span> .<span class="dv">5</span>)} <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  {ee_x <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(e_x[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"right"</span>, <span class="at">sep =</span> .<span class="dv">5</span>)} <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  {ee_y <span class="ot">&lt;-</span> <span class="fu">my_error</span>() <span class="sc">%&gt;%</span> <span class="fu">place</span>(e_y[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"left"</span>, <span class="at">sep =</span> .<span class="dv">5</span>)} <span class="sc">+</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  {lxx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_x[<span class="sc">-</span>k], e_x[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~XX~*"</span>, lxx<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  {lxy <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_x[<span class="sc">-</span>k], e_y[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~XY~*"</span>, lxy<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">27</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  {lyx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_y[<span class="sc">-</span>k], e_x[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~YX~*"</span>, lyx<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">27</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  {lyy <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(e_y[<span class="sc">-</span>k], e_y[<span class="sc">-</span><span class="dv">1</span>])} <span class="sc">+</span> </span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"*b~YY~*"</span>, lyy<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">47</span>), <span class="at">size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(e_x, x) <span class="sc">+</span> </span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(e_y, y) <span class="sc">+</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(ee_x, e_x[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_connect2</span>(ee_y, e_y[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(e_x[<span class="dv">1</span>], e_y[<span class="dv">1</span>]) <span class="sc">+</span> </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(ee_y, ee_x, </span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">resect =</span> <span class="dv">1</span>,</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_head =</span> <span class="dv">4</span>, </span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">length_fins =</span> <span class="dv">4</span>, </span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  {ix <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*i*~*X*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x[<span class="dv">2</span>]<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"left"</span>), <span class="st">"left"</span>, <span class="at">sep =</span> <span class="fl">2.5</span>)} <span class="sc">+</span></span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>  {iy <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*i*~*Y*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(y[<span class="dv">2</span>]<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"right"</span>), <span class="st">"right"</span>, <span class="at">sep =</span> <span class="fl">2.5</span>)} <span class="sc">+</span> </span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>  {sx <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*s*~*X*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(x[<span class="dv">3</span>]<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"left"</span>), <span class="st">"left"</span>, <span class="at">sep =</span> <span class="fl">2.5</span>)} <span class="sc">+</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>  {sy <span class="ot">&lt;-</span> <span class="fu">ob_circle</span>(<span class="at">label =</span> <span class="st">"*s*~*Y*~"</span>, <span class="at">radius =</span> <span class="fu">sqrt</span>(<span class="dv">4</span> <span class="sc">/</span> pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">place</span>(y[<span class="dv">3</span>]<span class="sc">@</span>bounding_box<span class="sc">@</span><span class="fu">point_at</span>(<span class="st">"right"</span>), <span class="st">"right"</span>, <span class="at">sep =</span> <span class="fl">2.5</span>)} <span class="sc">+</span> </span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>  {lx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(ix, x<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">175</span>)))} <span class="sc">+</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>  {ly <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(iy, y<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">5</span>)))} <span class="sc">+</span> </span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"1"</span>,</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">center =</span> lx<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(lx[<span class="dv">2</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">66</span>)<span class="sc">@</span>x),</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="st">"1"</span>,</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">center =</span> ly<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(ly[<span class="dv">2</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">66</span>)<span class="sc">@</span>x),</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>  {lsx <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(sx, x<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">185</span>)))} <span class="sc">+</span></span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a>  {lsy <span class="ot">&lt;-</span> <span class="fu">my_connect</span>(sy, y<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="sc">-</span><span class="dv">5</span>)))} <span class="sc">+</span> </span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">center =</span> lsx<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(lsx[<span class="dv">3</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">66</span>)<span class="sc">@</span>x),</span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_label</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">center =</span> lsy<span class="sc">@</span>line<span class="sc">@</span><span class="fu">point_at_x</span>(lsy[<span class="dv">3</span>]<span class="sc">@</span><span class="fu">midpoint</span>(.<span class="dv">66</span>)<span class="sc">@</span>x),</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(ix<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">80</span>)), </span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a>                iy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">100</span>)), </span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.1</span>, </span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(ix<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">95</span>)), </span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a>                sy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">55</span>)), </span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.5</span>, </span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(sy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">260</span>)), </span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a>                sx<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">280</span>)), </span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.1</span>, </span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(sy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">285</span>)), </span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a>                ix<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">235</span>)), </span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">looseness =</span> <span class="fl">1.5</span>, </span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(iy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="sc">-</span><span class="dv">70</span>)), </span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>                sy<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">70</span>)), </span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="fu">degree</span>(<span class="sc">-</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ob_covariance</span>(sx<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="dv">110</span>)), </span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>                ix<span class="sc">@</span><span class="fu">point_at</span>(<span class="fu">degree</span>(<span class="sc">-</span><span class="dv">110</span>)), </span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>                <span class="at">bend =</span> <span class="fu">degree</span>(<span class="sc">-</span><span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-lgsr" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lgsr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-lgsr-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lgsr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: The Latent Growth Model with Structured Residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p>The Latent Growth with Structured Residuals Model is exactly the same as the RI-CLPM but it adds growth in the form of random latent slopes, <em>s<sub>X</sub></em> and <em>s<sub>Y</sub></em> and the covariances among the random latent slopes and random latent intercepts.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of waves</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 2 to k</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>s2k <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, k)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from 1 to k - 1</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>s1k1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual variances and covariances</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>var_ex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ex1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exx"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>var_ey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_ey1"</span>, <span class="fu">rep</span>(<span class="st">"tau_eyy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>cov_exy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tau_exy1"</span>, <span class="fu">rep</span>(<span class="st">"tau_exy"</span>, k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>m_lgsr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"# Random Latent Intercepts"</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"i_x"</span>, <span class="st">"1 * x{1:k}"</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"i_y"</span>, <span class="st">"1 * y{1:k}"</span>),</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Latent Slopes"</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"s_x"</span>, <span class="st">"{seq(0,k-1)} * x{1:k}"</span>),</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_latent</span>(<span class="st">"s_y"</span>, <span class="st">"{seq(0,k-1)} * y{1:k}"</span>),</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residuals"</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} =~ 1 * x{1:k}"</span>), </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{1:k} =~ 1 * y{1:k}"</span>),</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Set observed residuals to 0"</span>,</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~~ 0 * x{1:k}"</span>), </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~~ 0 * y{1:k}"</span>),</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residual Variances and Covariances"</span>,</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {var_ex} * e_x{1:k}"</span>),</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{1:k} ~~ {var_ey} * e_y{1:k}"</span>), </span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{1:k} ~~ {cov_exy} * e_y{1:k}"</span>),</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Structured Residual Regressions"</span>,</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_x{s2k} ~ b_xx * x{s1k1} + b_yx * e_y{s1k1}"</span>),</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"e_y{s2k} ~ b_yy * y{s1k1} + b_xy * e_x{s1k1}"</span>),</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Observed Intercepts"</span>,</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"x{1:k} ~ 0 * 1"</span>), </span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">"y{1:k} ~ 0 * 1"</span>), </span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Intercept Intercepts"</span>,</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_x ~ b_ix_0 * 1"</span>,</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_y ~ b_iy_0 * 1"</span>,</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Slope Intercepts"</span>,</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"s_x ~ b_sx_0 * 1"</span>,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"s_y ~ b_sy_0 * 1"</span>,</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# Random Intecept Variances and Covariance"</span>,</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_x ~~ tau_ix * i_x + tau_ixiy * i_y + tau_ixsx * s_x + tau_ixsy * s_y"</span>,</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i_y ~~ tau_iy * i_y + tau_iysx * s_x + tau_iysy * s_y"</span>, </span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">"s_x ~~ tau_sx * s_x + tau_sxsy * s_y"</span>,</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"s_y ~~ tau_sy * s_y"</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>m_lgsr</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Random Latent Intercepts
i_x =~ 1 * x1 + 1 * x2 + 1 * x3 + 1 * x4
i_y =~ 1 * y1 + 1 * y2 + 1 * y3 + 1 * y4
# Random Latent Slopes
s_x =~ 0 * x1 + 1 * x2 + 2 * x3 + 3 * x4
s_y =~ 0 * y1 + 1 * y2 + 2 * y3 + 3 * y4
# Structured Residuals
e_x1 =~ 1 * x1
e_x2 =~ 1 * x2
e_x3 =~ 1 * x3
e_x4 =~ 1 * x4
e_y1 =~ 1 * y1
e_y2 =~ 1 * y2
e_y3 =~ 1 * y3
e_y4 =~ 1 * y4
# Set observed residuals to 0
x1 ~~ 0 * x1
x2 ~~ 0 * x2
x3 ~~ 0 * x3
x4 ~~ 0 * x4
y1 ~~ 0 * y1
y2 ~~ 0 * y2
y3 ~~ 0 * y3
y4 ~~ 0 * y4
# Structured Residual Variances and Covariances
e_x1 ~~ tau_ex1 * e_x1
e_x2 ~~ tau_exx * e_x2
e_x3 ~~ tau_exx * e_x3
e_x4 ~~ tau_exx * e_x4
e_y1 ~~ tau_ey1 * e_y1
e_y2 ~~ tau_eyy * e_y2
e_y3 ~~ tau_eyy * e_y3
e_y4 ~~ tau_eyy * e_y4
e_x1 ~~ tau_exy1 * e_y1
e_x2 ~~ tau_exy * e_y2
e_x3 ~~ tau_exy * e_y3
e_x4 ~~ tau_exy * e_y4
# Structured Residual Regressions
e_x2 ~ b_xx * x1 + b_yx * e_y1
e_x3 ~ b_xx * x2 + b_yx * e_y2
e_x4 ~ b_xx * x3 + b_yx * e_y3
e_y2 ~ b_yy * y1 + b_xy * e_x1
e_y3 ~ b_yy * y2 + b_xy * e_x2
e_y4 ~ b_yy * y3 + b_xy * e_x3
# Observed Intercepts
x1 ~ 0 * 1
x2 ~ 0 * 1
x3 ~ 0 * 1
x4 ~ 0 * 1
y1 ~ 0 * 1
y2 ~ 0 * 1
y3 ~ 0 * 1
y4 ~ 0 * 1
# Random Intercept Intercepts
i_x ~ b_ix_0 * 1
i_y ~ b_iy_0 * 1
# Random Slope Intercepts
s_x ~ b_sx_0 * 1
s_y ~ b_sy_0 * 1
# Random Intecept Variances and Covariance
i_x ~~ tau_ix * i_x + tau_ixiy * i_y + tau_ixsx * s_x + tau_ixsy * s_y
i_y ~~ tau_iy * i_y + tau_iysx * s_x + tau_iysy * s_y
s_x ~~ tau_sx * s_x + tau_sxsy * s_y
s_y ~~ tau_sy * s_y</code></pre>
</div>
</div>
<p>Let’s make the random slope for X be negative (<code>b_sx_0 = -.25</code>), on average, and the random slope for Y be positive (<code>b_sy_0 = .5</code>), on average.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>params_lgsr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ex1 =</span> <span class="dv">1</span>,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ey1 =</span> <span class="dv">1</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exy1 =</span> .<span class="dv">4</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exx =</span> .<span class="dv">4</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_eyy =</span> .<span class="dv">5</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_exy =</span> .<span class="dv">2</span>,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ix =</span> <span class="fl">0.5</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_iy =</span> <span class="fl">0.6</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_sx =</span> <span class="fl">0.1</span>,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_sy =</span> <span class="fl">0.2</span>,</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ixiy =</span> .<span class="dv">3</span>,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ixsy =</span> <span class="dv">0</span>,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_ixsx =</span> .<span class="dv">03</span>,</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_iysx =</span> <span class="dv">0</span>,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_iysy =</span> <span class="sc">-</span>.<span class="dv">02</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau_sxsy =</span> <span class="fl">0.01</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xx =</span> .<span class="dv">4</span>,</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yy =</span> .<span class="dv">3</span>,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_xy =</span> .<span class="dv">1</span>,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_yx =</span> <span class="dv">0</span>,</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_ix_0 =</span> <span class="dv">0</span>,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_iy_0 =</span> <span class="dv">0</span>,</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_sx_0 =</span> <span class="sc">-</span>.<span class="dv">25</span>,</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">b_sy_0 =</span> .<span class="dv">5</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>d_lgsr <span class="ot">&lt;-</span> <span class="fu">replace_parameters</span>(<span class="at">model =</span> m_lgsr, </span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">params =</span> params_lgsr) <span class="sc">%&gt;%</span> </span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_collapse</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulateData</span>(<span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>fit_lgsr <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> m_lgsr, <span class="at">data =</span> d_lgsr, <span class="at">auto.cov.lv.x =</span> F)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>All the variables are still positively correlated:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cor</span>(d_lgsr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-lgsrcor" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lgsrcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-lgsrcor-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lgsrcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Correlation of X and Y in LGSR Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>But, over time, X decreases, and Y increases.</p>
<div class="cell page-columns page-full" data-preview-image="true">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>d_lgsr <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v =</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>,<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> v) <span class="sc">%&gt;%</span> </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(id), x, <span class="at">.fun =</span> mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> id), <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(time, .<span class="dv">75</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ease_aes</span>(<span class="st">'cubic-in-out'</span>) <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_wake</span>(<span class="at">wake_length =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust=</span>.<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Time {closest_state}'</span>, <span class="at">x =</span> <span class="st">'X'</span>, <span class="at">y =</span> <span class="st">'Y'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-lgsrchange" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lgsrchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-lgsrchange-1.gif" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lgsrchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Changes in X and Y over Time in LGSR Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>See the slopes for the two variables:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>d_lgsr <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v =</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>,<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>() <span class="sc">%&gt;%</span> <span class="fu">factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(id), value, <span class="at">.fun =</span> mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, value)) <span class="sc">+</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"gray95"</span>) <span class="sc">+</span> </span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id, <span class="at">color =</span> id), <span class="at">size =</span> .<span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.integer</span>(time)), <span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(v)) <span class="sc">+</span> </span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">24</span>, <span class="at">base_family =</span> <span class="st">"Roboto Condensed"</span>) <span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">"Time"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-lgsrstability" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lgsrstability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="bivariatechange_files/figure-html/fig-lgsrstability-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lgsrstability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Distribution of X and Y over Time in LGSR Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Testing the model</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sem</span>(<span class="at">model =</span> m_lgsr, <span class="at">data =</span> d_lgsr, <span class="at">auto.cov.lv.x =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">component =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Loading

Link       | Coefficient |   SE |       95% CI |      p
-------------------------------------------------------
i_x =~ x1  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x3  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_x =~ x4  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y1  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y3  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
i_y =~ y4  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
s_x =~ x1  |        0.00 | 0.00 | [0.00, 0.00] | &lt; .001
s_x =~ x2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
s_x =~ x3  |        2.00 | 0.00 | [2.00, 2.00] | &lt; .001
s_x =~ x4  |        3.00 | 0.00 | [3.00, 3.00] | &lt; .001
s_y =~ y1  |        0.00 | 0.00 | [0.00, 0.00] | &lt; .001
s_y =~ y2  |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
s_y =~ y3  |        2.00 | 0.00 | [2.00, 2.00] | &lt; .001
s_y =~ y4  |        3.00 | 0.00 | [3.00, 3.00] | &lt; .001
e_x1 =~ x1 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x2 =~ x2 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x3 =~ x3 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_x4 =~ x4 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y1 =~ y1 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y2 =~ y2 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y3 =~ y3 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001
e_y4 =~ y4 |        1.00 | 0.00 | [1.00, 1.00] | &lt; .001

# Variance

Link                   | Coefficient |   SE |       95% CI |     z |      p
---------------------------------------------------------------------------
x1 ~~ x1               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x2 ~~ x2               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x3 ~~ x3               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
x4 ~~ x4               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y1 ~~ y1               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y2 ~~ y2               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y3 ~~ y3               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
y4 ~~ y4               |        0.00 | 0.00 | [0.00, 0.00] |       | &lt; .001
e_x1 ~~ e_x1 (tau_ex1) |        1.20 | 0.15 | [0.91, 1.50] |  7.93 | &lt; .001
e_x2 ~~ e_x2 (tau_exx) |        0.43 | 0.05 | [0.33, 0.52] |  8.83 | &lt; .001
e_x3 ~~ e_x3 (tau_exx) |        0.43 | 0.05 | [0.33, 0.52] |  8.83 | &lt; .001
e_x4 ~~ e_x4 (tau_exx) |        0.43 | 0.05 | [0.33, 0.52] |  8.83 | &lt; .001
e_y1 ~~ e_y1 (tau_ey1) |        0.92 | 0.11 | [0.70, 1.14] |  8.25 | &lt; .001
e_y2 ~~ e_y2 (tau_eyy) |        0.44 | 0.03 | [0.39, 0.49] | 17.43 | &lt; .001
e_y3 ~~ e_y3 (tau_eyy) |        0.44 | 0.03 | [0.39, 0.49] | 17.43 | &lt; .001
e_y4 ~~ e_y4 (tau_eyy) |        0.44 | 0.03 | [0.39, 0.49] | 17.43 | &lt; .001
i_x ~~ i_x (tau_ix)    |        0.30 | 0.13 | [0.04, 0.56] |  2.27 | 0.023 
i_y ~~ i_y (tau_iy)    |        0.69 | 0.11 | [0.48, 0.91] |  6.35 | &lt; .001
s_x ~~ s_x (tau_sx)    |        0.07 | 0.03 | [0.01, 0.14] |  2.21 | 0.027 
s_y ~~ s_y (tau_sy)    |        0.27 | 0.03 | [0.20, 0.34] |  8.11 | &lt; .001

# Correlation

Link                    | Coefficient |   SE |         95% CI |     z |      p
------------------------------------------------------------------------------
e_x1 ~~ e_y1 (tau_exy1) |        0.45 | 0.11 | [ 0.24,  0.66] |  4.23 | &lt; .001
e_x2 ~~ e_y2 (tau_exy)  |        0.16 | 0.03 | [ 0.10,  0.23] |  4.82 | &lt; .001
e_x3 ~~ e_y3 (tau_exy)  |        0.16 | 0.03 | [ 0.10,  0.23] |  4.82 | &lt; .001
e_x4 ~~ e_y4 (tau_exy)  |        0.16 | 0.03 | [ 0.10,  0.23] |  4.82 | &lt; .001
i_x ~~ i_y (tau_ixiy)   |        0.27 | 0.09 | [ 0.09,  0.45] |  2.96 | 0.003 
i_x ~~ s_x (tau_ixsx)   |        0.04 | 0.03 | [-0.01,  0.09] |  1.51 | 0.132 
i_x ~~ s_y (tau_ixsy)   |    5.96e-03 | 0.03 | [-0.05,  0.06] |  0.22 | 0.824 
i_y ~~ s_x (tau_iysx)   |       -0.02 | 0.03 | [-0.08,  0.03] | -0.85 | 0.395 
i_y ~~ s_y (tau_iysy)   |       -0.06 | 0.03 | [-0.13,  0.00] | -1.98 | 0.047 
s_x ~~ s_y (tau_sxsy)   |        0.03 | 0.02 | [-0.01,  0.06] |  1.47 | 0.142 

# Regression

Link               | Coefficient |   SE |        95% CI |     z |      p
------------------------------------------------------------------------
e_x2 ~ x1 (b_xx)   |        0.53 | 0.08 | [ 0.37, 0.70] |  6.32 | &lt; .001
e_x2 ~ e_y1 (b_yx) |       -0.07 | 0.06 | [-0.19, 0.05] | -1.21 | 0.228 
e_x3 ~ x2 (b_xx)   |        0.53 | 0.08 | [ 0.37, 0.70] |  6.32 | &lt; .001
e_x3 ~ e_y2 (b_yx) |       -0.07 | 0.06 | [-0.19, 0.05] | -1.21 | 0.228 
e_x4 ~ x3 (b_xx)   |        0.53 | 0.08 | [ 0.37, 0.70] |  6.32 | &lt; .001
e_x4 ~ e_y3 (b_yx) |       -0.07 | 0.06 | [-0.19, 0.05] | -1.21 | 0.228 
e_y2 ~ y1 (b_yy)   |        0.24 | 0.04 | [ 0.15, 0.32] |  5.29 | &lt; .001
e_y2 ~ e_x1 (b_xy) |        0.13 | 0.06 | [ 0.01, 0.25] |  2.19 | 0.028 
e_y3 ~ y2 (b_yy)   |        0.24 | 0.04 | [ 0.15, 0.32] |  5.29 | &lt; .001
e_y3 ~ e_x2 (b_xy) |        0.13 | 0.06 | [ 0.01, 0.25] |  2.19 | 0.028 
e_y4 ~ y3 (b_yy)   |        0.24 | 0.04 | [ 0.15, 0.32] |  5.29 | &lt; .001
e_y4 ~ e_x3 (b_xy) |        0.13 | 0.06 | [ 0.01, 0.25] |  2.19 | 0.028 

# Mean

Link             | Coefficient |   SE |         95% CI |     z |      p
-----------------------------------------------------------------------
x1 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
x2 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
x3 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
x4 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
y1 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
y2 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
y3 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
y4 ~1            |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
i_x ~1  (b_ix_0) |       -0.09 | 0.03 | [-0.15, -0.03] | -2.97 | 0.003 
i_y ~1  (b_iy_0) |        0.01 | 0.04 | [-0.06,  0.09] |  0.41 | 0.685 
s_x ~1  (b_sx_0) |       -0.19 | 0.03 | [-0.24, -0.14] | -7.60 | &lt; .001
s_y ~1  (b_sy_0) |        0.52 | 0.03 | [ 0.47,  0.58] | 18.11 | &lt; .001
e_x1 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_x2 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_x3 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_x4 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_y1 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_y2 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_y3 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001
e_y4 ~1          |        0.00 | 0.00 | [ 0.00,  0.00] |       | &lt; .001</code></pre>
</div>
</div>
<p>In this model x influences y (<code>b_xy</code> &gt; 0), but there is no evidence that y influences x (<code>b_yx</code> is near 0).</p>
</section>
<section id="excercise" class="level1">
<h1>Excercise</h1>
<p>A new reading curriculum is being tested. Its developers are excited that students who are taught to read using the curriculum seems to learn to read faster than students who were taught with previous methods. The developers notice that although spelling is not specifically targeted, students using the new reading program appear to develop better spelling abilities as well.</p>
<p>A sample of 300 1st-grader are randomly assigned to treatment and control conditions. Their reading and spelling abilities are measured 6 times throughout the year. Obviously, reading and spelling is going to improve over the course of the year. The main question is whether it improves faster in the treatment condition. In addition, the researchers are interested in whether reading affects spelling or vice-versa.</p>
<p>Get data here:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://github.com/wjschne/EDUC8825/raw/main/reading2spelling.csv"</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> F</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You will need to restructure the data (use <code>pivot_longer</code> and <code>pivot_wider</code> functions) to get all variables on 1 row.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>d_wider <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(reading, spelling)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(name, name, time) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol type="1">
<li>Use the Latent Growth with Structured Residuals Model to see how Reading and Spelling affect each other over time.</li>
<li>Use the intervention variable to predict the intercept and slope for reading.</li>
<li>Write-up your analysis and explain your results in a quarto file.</li>
</ol>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/wjschne\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>