<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>W. Joel Schneider</title>
<link>https://wjschne.github.io/tutorials.html</link>
<atom:link href="https://wjschne.github.io/tutorials.xml" rel="self" type="application/rss+xml"/>
<description>{{&lt; meta description-meta &gt;}}</description>
<generator>quarto-1.4.548</generator>
<lastBuildDate>Tue, 23 Jan 2024 23:30:36 GMT</lastBuildDate>
<item>
  <title>ANOVA in R</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/ANOVA/ANOVA.html</link>
  <description><![CDATA[ 




<section id="load-packages" class="level1">
<h1>Load Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
</div>
</section>
<section id="import-data-and-create-labelled-factors" class="level1">
<h1>Import Data and Create Labelled Factors</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File location</span></span>
<span id="cb2-2">file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5325/raw/master/Attachment.sav"</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import SPSS data file using haven</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also, change Attachment variable to a factor</span></span>
<span id="cb2-7">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haven<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_spss</span>(file) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Attachment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(Attachment))</span></code></pre></div>
</div>
</section>
<section id="descriptives" class="level1">
<h1>Descriptives</h1>
<p>Let’s look at the means and standard deviations for anxiety of each attachment group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(Anxiety_Questionnaire),</span>
<span id="cb3-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(Anxiety_Questionnaire), </span>
<span id="cb3-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> Attachment) </span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Attachment</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Secure</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">10.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ambivalent</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">9.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avoidant</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">10.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="plot" class="level1">
<h1>Plot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Attachment,</span>
<span id="cb4-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Anxiety_Questionnaire)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Just looking at the plot, we can see that the Ambivalent group has a higher mean anxiety than the other two groups. However, let’s conduct a formal test of the difference of the group means.</p>
</section>
<section id="create-one-way-anova" class="level1">
<h1>Create One-Way ANOVA</h1>
<p>The <code>aov</code> (Analysis of Variance) function is what you want to use. The <code>anova</code> function is better used for comparing models. The dependent variable goes on the left, and any predictor variables are on the right hand side of the ~.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aov</span>(Anxiety_Questionnaire <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Attachment, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>The base R function <code>summary</code> gives us most of what we might want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Attachment    2  20359   10179      93 &lt;2e-16 ***
Residuals   297  32517     109                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="other-summary-functions" class="level2">
<h2 class="anchored" data-anchor-id="other-summary-functions">Other Summary Functions</h2>
<p>If you want other summary functions, there are many options. Here are a few:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glance</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">nobs</th>
<th style="text-align: right;">r.squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-1129</td>
<td style="text-align: right;">2265</td>
<td style="text-align: right;">2280</td>
<td style="text-align: right;">32517</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">0.39</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attachment</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20359</td>
<td style="text-align: right;">10179</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">32517</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">sjstats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova_stats</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">etasq</th>
<th style="text-align: right;">partial.etasq</th>
<th style="text-align: right;">omegasq</th>
<th style="text-align: right;">partial.omegasq</th>
<th style="text-align: right;">epsilonsq</th>
<th style="text-align: right;">cohens.f</th>
<th style="text-align: right;">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attachment</td>
<td style="text-align: left;">Attachment</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20359</td>
<td style="text-align: right;">10179</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">…2</td>
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">32517</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">R2_adjusted</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2265</td>
<td style="text-align: right;">2265</td>
<td style="text-align: right;">2280</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">parameters<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Sum_Squares</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">Mean_Square</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attachment</td>
<td style="text-align: right;">20359</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10179</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">32517</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA (formula: Anxiety_Questionnaire ~ Attachment) suggests that:

  - The main effect of Attachment is statistically significant and large (F(2,
297) = 92.98, p &lt; .001; Eta2 = 0.39, 95% CI [0.32, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
</section>
<section id="diagnostic-plots" class="level2">
<h2 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/assumptions-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-tests">Post-hoc Tests</h2>
<p>Tukey Honestly Significant Differences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TukeyHSD</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Anxiety_Questionnaire ~ Attachment, data = d)

$Attachment
                    diff  lwr  upr p adj
Avoidant-Secure     -2.3 -5.8  1.3  0.29
Ambivalent-Secure   16.2 12.8 19.5  0.00
Ambivalent-Avoidant 18.4 14.8 22.0  0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TukeyHSD</span>(fit))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/tukey-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/ANOVA/ANOVA.html</guid>
  <pubDate>Tue, 23 Jan 2024 23:30:36 GMT</pubDate>
</item>
</channel>
</rss>
