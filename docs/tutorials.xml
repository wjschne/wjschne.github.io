<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>W. Joel Schneider</title>
<link>https://wjschne.github.io/tutorials.html</link>
<atom:link href="https://wjschne.github.io/tutorials.xml" rel="self" type="application/rss+xml"/>
<description>{{&lt; meta description-meta &gt;}}</description>
<generator>quarto-1.6.42</generator>
<lastBuildDate>Tue, 11 Mar 2025 04:00:00 GMT</lastBuildDate>
<item>
  <title>Multilevel Modeling of Longitudinal Data in R</title>
  <link>https://wjschne.github.io/tutorials/Longitudinal/longitudinal.html</link>
  <description><![CDATA[ 





<p>Longitudinal data analysis refers to the examination of how variables change over time, typically within individuals. Multilevel modeling allows us to study “unbalanced” longitudinal data in which not everyone has the same number of measurements.</p>
<p>In clustered data, the lowest level is typically a person, with higher levels referring to groups of people. With longitudinal data, the person is typically level 2, and level 1 is a measurement occasion associated with a specific instance in time.</p>
<p>With multilevel approaches to longitudinal data, data for each person fits on multiple rows with each measurement instance on its own row as seen in Table&nbsp;1.</p>
<div id="tbl-data" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">person_id</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">x</th>
<th style="text-align: center;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Longitudinal data with multiple rows per person
</figcaption>
</figure>
</div>
<p>Specifying when the time variable equals 0 becomes increasingly important with complex longitudinal model because it influences the interpretation of other coefficients in the model. If there are interaction effects or polynomial effects, the lower-order effects refer to the effect of the variable when all other predictors are 0. Thus, we try to mark time such that <em>T</em><sub>0</sub> (when time = 0) is meaningful. For example, <em>T</em><sub>0</sub> is often simply the first measurement occasion. <em>T</em><sub>0</sub> could be the point at which an important event occurs, such as the onset of an intervention. In such cases, measurements before the intervention are marked as negative (<em>Time</em> = −3, −2, −1, 0, 1, 2, …).</p>
<p>Time does not have to be marked as integers, not everyone needs to be measured at the same times, and measurements do not necessarily need to occur at exactly <em>T</em><sub>0</sub>. For person 1, the measurements could be at <em>Time</em> = −2.1 minutes, +5.3 minutes, and +44.2 minutes. For person 2, the measurements could be at <em>Time</em> = −8.8 minutes, −6.0 minutes, +10.1 minutes, and +10.5 minutes.</p>
<section id="hypothetical-longitudinal-study-of-reading-comprehension" class="level1 page-columns page-full">
<h1>Hypothetical Longitudinal Study of Reading Comprehension</h1>
<p>Suppose we are measuring how schoolchildren’s reading comprehension changes over time. We believe that reading comprehension (understanding of the text’s meaning) is influenced by Reading Decoding skills (correct identification of words). If we measure Reading Decoding skill at each occasion, it is a time-varying covariate at level 1.</p>
<p>Suppose we believe that children’s working memory capacity also is an important influence on reading comprehension. If we only measure working memory capacity once (typically at the beginning of the study), working memory capacity is a person-level covariate at level 2. Of course, if we had measured working memory capacity at each measurement occasion, it would be an additional time-varying covariate at level 1.</p>
<p>For the sake of demonstration, I am going to present a model in which Working Memory Capacity not only influences the initial level of Reading Comprehension, but it also has every possible cross-level interaction effect. In a real analysis, we would only investigate such effects if we had good theoretical reasons for doing so. Testing for every possible effect just because we can will dramatically increase our risk of “finding” spurious effects.</p>
<section id="level-1-measurement-occasion" class="level2">
<h2 class="anchored" data-anchor-id="level-1-measurement-occasion">Level 1: Measurement Occasion</h2>
<p>Every time a person is measured, we will call this a <em>measurement occasion</em>. In longitudinal studies, each measurement occasion is placed in its own data row.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AY_%7Bti%7D&amp;=b_%7B0i%7D+b_%7B1i%7DT_%7Bti%7D+b_%7B2i%7DRD_%7Bti%7D+e_%7Bti%7D%5C%5C%0Ae_%7Bti%7D&amp;%5Csim%5Cmathcal%7BN%7D(0,%20%5Ctau_1%5E2)%0A%5Cend%7Balign*%7D%0A"></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?Y_%7Bti%7D"></td>
<td style="text-align: left;">The measure of Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i"> at occasion (time) <img src="https://latex.codecogs.com/png.latex?t">.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?RD_%7Bti%7D"></td>
<td style="text-align: left;">The measure of Reading Decoding at occasion <img src="https://latex.codecogs.com/png.latex?t"> for person <img src="https://latex.codecogs.com/png.latex?i">.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?T_%7Bti%7D"></td>
<td style="text-align: left;">How much time has elapsed at occasion <img src="https://latex.codecogs.com/png.latex?t"> for person <img src="https://latex.codecogs.com/png.latex?i">.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B0i%7D"></td>
<td style="text-align: left;">The random intercept: The predicted Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i"> at time 0 (<em>T</em><sub>0</sub>) if Reading Decoding = 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B1i%7D"></td>
<td style="text-align: left;">The random slope of Time: The rate of increase in Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i"> if Reading Decoding is held constant at 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B2i%7D"></td>
<td style="text-align: left;">The size of Reading Decoding’s association with Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i">.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?e_%7Bti%7D"></td>
<td style="text-align: left;">The deviation from expectations for Reading Comprehension at occasion <img src="https://latex.codecogs.com/png.latex?t"> for person <img src="https://latex.codecogs.com/png.latex?i">. It represents the model’s failure to accurately predict Reading Comprehension at each measurement occasion.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?%5Ctau_1"></td>
<td style="text-align: left;">The variance of <img src="https://latex.codecogs.com/png.latex?e_%7Bti%7D"></td>
</tr>
</tbody>
</table>
</section>
<section id="level-2-person" class="level2">
<h2 class="anchored" data-anchor-id="level-2-person">Level 2: Person</h2>
<section id="predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0" class="level3">
<h3 class="anchored" data-anchor-id="predicting-the-random-intercept-b_0i-what-determines-the-conditions-at-t0">Predicting the Random Intercept <img src="https://latex.codecogs.com/png.latex?(b_%7B0i%7D)">: <br> What Determines the Conditions at <em>T</em><sub>0</sub>?</h3>
<p>If Time and Reading Decoding = 0, what determines our prediction of Reading Comprehension?</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab_%7B0i%7D=b_%7B00%7D+b_%7B01%7DWM_i+e_%7B0i%7D%0A"></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B0i%7D"></td>
<td style="text-align: left;">The random intercept: The predicted Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i"> at time 0 (<em>T</em><sub>0</sub>) if Reading Decoding = 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?WM_i"></td>
<td style="text-align: left;">The measurement of Working Memory Capacity for person <img src="https://latex.codecogs.com/png.latex?i">.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B00%7D"></td>
<td style="text-align: left;">The predicted value of Reading Comprehension when Time, Reading Decoding, and Working Memory = 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B01%7D"></td>
<td style="text-align: left;">Working Memory’s association with Reading Comprehension at <em>T</em><sub>0</sub> when Reading Decoding is 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?e_%7B0i%7D"></td>
<td style="text-align: left;">Person <img src="https://latex.codecogs.com/png.latex?i">’s deviation from expectations for the random intercept. It represents the model’s failure to predict each person’s random intercept.</td>
</tr>
</tbody>
</table>
</section>
<section id="predicting-times-random-slope-what-determines-the-effect-of-time-grade" class="level3">
<h3 class="anchored" data-anchor-id="predicting-times-random-slope-what-determines-the-effect-of-time-grade">Predicting Time’s Random Slope: <br> What determines the effect of time (Grade)?</h3>
<p>Suppose we believe that Reading Comprehension will, on average, increase over time for everyone, but the rate of increase will be faster for children with greater working memory capacity.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab_%7B1i%7D=b_%7B10%7D+b_%7B11%7DWM_i+e_%7B1i%7D%0A"></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B1i%7D"></td>
<td style="text-align: left;">The random slope of Time: The rate of increase in Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i"> if Reading Decoding is held constant at 0.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B10%7D"></td>
<td style="text-align: left;">The rate at which Reading Comprehension increases for each unit of time if both Reading Decoding and Working Memory are held constant at 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B11%7D"></td>
<td style="text-align: left;">Working Memory’s effect on the rate of Reading Comprehension’s change over time, after controlling for Reading Decoding (i.e., if Reading Decoding were held constant at 0). If positive, students with higher working memory should improve their Reading Comprehension ability faster than students with lower working memory.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?e_%7B1i%7D"></td>
<td style="text-align: left;">Person <img src="https://latex.codecogs.com/png.latex?i">’s the deviation from expectations for the random slope for time. It represents the model’s failure to predict each person’s rate of increase in Reading Comprehension over time (after controlling for Reading Decoding).</td>
</tr>
</tbody>
</table>
</section>
<section id="predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding" class="level3">
<h3 class="anchored" data-anchor-id="predicting-reading-decodings-random-slope-what-determines-the-effect-of-reading-decoding">Predicting Reading Decoding’s Random Slope: <br> What determines the effect of Reading Decoding?</h3>
<p>Suppose that the effect of Reading Decoding on Reading Comprehension differs from person to person. Obviously, to comprehend text a person needs at least some ability to decode words. However, there is evidence that working memory helps a person make inferences in reading comprehension such that one can work around unfamiliar words and still derive meaning from the text. Thus, we might predict that higher Working Memory Capacity makes Reading Decoding a less important predictor of Reading Comprehension.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab_%7B2i%7D=b_%7B20%7D+b_%7B21%7DWM_i+e_%7B2i%7D%0A"></p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B2i%7D"></td>
<td style="text-align: left;">The size of Reading Decoding’s association with Reading Comprehension for person <img src="https://latex.codecogs.com/png.latex?i">.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B20%7D"></td>
<td style="text-align: left;">The size of the association of Reading Decoding and Reading Comprehension when Working Memory is 0.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?b_%7B21%7D"></td>
<td style="text-align: left;">The interaction effect of Working Memory and Reading Decoding. It represents how much the effect of Reading Decoding on Reading Comprehension changes for each unit of increase in Working Memory.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><img src="https://latex.codecogs.com/png.latex?e_%7B2i%7D"></td>
<td style="text-align: left;">Person <img src="https://latex.codecogs.com/png.latex?i">’s the deviation from expectations for the random slope for Reading Decoding. It represents the model’s failure to predict the person-specific relationship between Reading Decoding and Reading Comprehension.</td>
</tr>
</tbody>
</table>
</section>
<section id="level-2-random-effects" class="level3">
<h3 class="anchored" data-anchor-id="level-2-random-effects">Level-2 Random Effects</h3>
<p>The error terms at level 2 (<img src="https://latex.codecogs.com/png.latex?e_%7B0i%7D,%20e_%7B1i%7D,%20%5C&amp;~e_%7B2i%7D">) have variances, and possibly covariances.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cboldsymbol%7Be%7D_2&amp;=%0A%5Cbegin%7Bbmatrix%7D%0Ae_%7B0i%7D%5C%5C%0Ae_%7B1i%7D%5C%5C%0Ae_%7B2i%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cboldsymbol%7Be%7D_2&amp;%5Csim%5Cmathcal%7BN%7D%5Cleft(%5Cboldsymbol%7B0%7D,%5Cboldsymbol%7B%5Ctau%7D_2%5Cright)%5C%5C%0A%5Cboldsymbol%7B%5Ctau%7D_2&amp;=%0A%5Cbegin%7Bbmatrix%7D%0A%5Ctau_%7B2.00%7D%5C%5C%0A%5Ctau_%7B2.10%7D%20&amp;%20%5Ctau_%7B2.11%7D%5C%5C%0A%5Ctau_%7B2.20%7D%20&amp;%20%5Ctau_%7B2.21%7D%20&amp;%20%5Ctau_%7B2.22%7D%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D%0A"></p>
</section>
</section>
<section id="combined-equations" class="level2">
<h2 class="anchored" data-anchor-id="combined-equations">Combined Equations</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AY_%7Bti%7D&amp;=%0A%5Cunderbrace%7Bb_%7B00%7D+b_%7B01%7DWM_i+u_%7B0i%7D%7D_%7Bb_%7B0i%7D~%5Ctext%7B(Random%20Intercept)%7D%7D%5C%5C%0A&amp;+(%5Cunderbrace%7Bb_%7B10%7D+b_%7B11%7DWM_i+u_%7B1i%7D%7D_%7Bb_%7B1i%7D~%5Ctext%7B(Random%20Slope%20for%20Time)%7D%7D)T_%7Bti%7D%5C%5C%0A&amp;+(%5Cunderbrace%7Bb_%7B20%7D+b_%7B21%7DWM_i+u_%7B2i%7D%7D_%7Bb_%7B2i%7D~%5Ctext%7B(Random%20Slope%20for%20RD)%7D%7D)RD_%7Bti%7D%5C%5C%0A&amp;+e_%7Bti%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>An equation aligned to the lmer formula:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AY_%7Bti%7D&amp;=b_%7B00%7D%5C%5C%0A&amp;+%5Cunderbrace%7Bb_%7B01%7DWM_i+b_%7B10%7DT_%7Bti%7D+b_%7B20%7DRD_%7Bti%7D%7D_%7B%5Ctext%7BSimple%20Slopes%20(when%20other%20predictors%20=%200)%7D%7D%5C%5C%0A&amp;+%5Cunderbrace%7Bb_%7B11%7DT_%7Bti%7DWM_i+b_%7B21%7DRD_%7Bti%7DWM_i%7D_%7B%5Ctext%7BInteractions%7D%7D%5C%5C%0A&amp;+%5Cunderbrace%7Be_%7B0i%7D+e_%7B1i%7DT_%7Bti%7D+e_%7B2i%7DRD_%7Bti%7D%7D_%7B%5Ctext%7BL2%20Random%20Effects%7D%7D%5C%5C%0A&amp;+e_%7Bti%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>Here is the model as a <code>lmer</code> formula:</p>
<pre><code>reading_comprehension~1+
working_memory+time+reading_decoding+
time:working_memory+reading_decoding:working_memory+
(1+time+reading_decoding | person_id)</code></pre>
<p>A simplified version would look like this:</p>
<pre><code>reading_comprehension~
working_memory * time + 
working_memory * reading_decoding +
(time+reading_decoding | person_id)</code></pre>
</section>
<section id="simulate-longitudinal-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulate-longitudinal-data">Simulate longitudinal data</h2>
<p>I am going to simulate a longitudinal observational study of these three variables.</p>
<p>To make things simple, suppose that Reading Decoding also grows over time like so:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ARD_%7Bti%7D=6+2T_%7Bti%7D+.5WM_%7Bti%7D+e_%7Bti%7D%5C%5C%0Ae%5Csim%5Cmathcal%7BN%7D(0,%201%5E2)%0A"></p>
<section id="simulate-level-2-data-person-level" class="level3">
<h3 class="anchored" data-anchor-id="simulate-level-2-data-person-level">Simulate Level-2 Data (Person Level)</h3>
<p>We begin at level 2 by setting the sample size, the fixed effects, the level-2 random effect covariance matrix <img src="https://latex.codecogs.com/png.latex?(%5Cboldsymbol%7B%5Ctau%7D)">, and</p>
<p>We can simulate Working Memory Capacity as a standard normal variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123456</span>)</span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample size</span></span>
<span id="cb3-6">n_person <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of occasions</span></span>
<span id="cb3-9">n_occasions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed effects</span></span>
<span id="cb3-12">b_00 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed intercept</span></span>
<span id="cb3-13">b_01 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simple main effect of working memory</span></span>
<span id="cb3-14">b_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simple main effect of time (Grade)</span></span>
<span id="cb3-15">b_11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time * working memory interaction</span></span>
<span id="cb3-16">b_20 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simple main effect of reading decoding</span></span>
<span id="cb3-17">b_21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reading decoding * working memory interaction</span></span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standard deviations of level-2 random effects</span></span>
<span id="cb3-20">e_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e0i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sd of random intercept</span></span>
<span id="cb3-21">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e1i =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sd of random slope for time</span></span>
<span id="cb3-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e2i =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sd of random slope for reading decoding</span></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlations among level-2 random effects</span></span>
<span id="cb3-25">e_cor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-26">           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-27">           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-28">  lavaan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lav_matrix_lower2full</span>(.)</span>
<span id="cb3-29"></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># level-2 random effects covariance matrix</span></span>
<span id="cb3-31">tau_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lavaan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor2cov</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">R =</span> e_cor, </span>
<span id="cb3-32">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sds =</span> e_sd, </span>
<span id="cb3-33">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(e_sd))</span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate level-2 random effects</span></span>
<span id="cb3-36">e_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mvtnorm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(n_person, </span>
<span id="cb3-37">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e0i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e1i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e2i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb3-38">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> tau_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate level-2 data and coefficients</span></span>
<span id="cb3-42">d_level2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_person),</span>
<span id="cb3-43">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_occasions =</span> n_occasions,</span>
<span id="cb3-44">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">working_memory =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n_person)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(e_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_0i =</span> b_00 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_01 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e0i,</span>
<span id="cb3-47">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_1i =</span> b_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_11 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e1i,</span>
<span id="cb3-48">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_2i =</span> b_20 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_21 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e2i)</span>
<span id="cb3-49"></span>
<span id="cb3-50">d_level2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 9
   person_id n_occasions working_memory    e0i     e1i     e2i  b_0i  b_1i  b_2i
   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 1                   6        -1.22    41.7  -0.469  -0.639   89.5  43.4  8.46
 2 2                   6         1.20     4.37  3.83    1.50    76.3  59.8  8.43
 3 3                   6        -0.956   65.6   4.25    2.10   116.   49.5 11.0 
 4 4                   6        -0.746  -21.3  -1.69   -2.01    31.2  44.6  6.67
 5 5                   6        -1.64    -2.79  2.00    1.90    40.9  43.8 11.4 
 6 6                   6        -0.0452   2.88 -1.25    1.67    62.4  48.5  9.72
 7 7                   6        -0.933   83.4   0.951  -1.36   134.   46.3  7.48
 8 8                   6        -0.291   62.8   0.0654  0.341  120.   48.6  8.60
 9 9                   6         1.36    23.1  -0.727   0.0299  96.7  56.1  6.81
10 10                  6         0.311   35.2   1.65   -1.12    98.4  53.2  6.60
# ℹ 1,990 more rows</code></pre>
</div>
</div>
</section>
<section id="simulate-level-1-data-occasion-level" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="simulate-level-1-data-occasion-level">Simulate Level-1 Data (Occasion Level)</h3>
<p>Let’s say that our measurement of our level-1 variables occurs at the beginning of each Grade starting in Kindergarten (i.e., Grade 0) and continues every year until fifth grade. Our measurement of working memory capacity occurs once—at the beginning of Kindergarten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># level-1 sd</span></span>
<span id="cb5-2">tau_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-3"></span>
<span id="cb5-4">d_level1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_level2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uncount</span>(n_occasions) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(person_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Grade =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_decoding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.)),</span>
<span id="cb5-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e_ti =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(tau_1)), </span>
<span id="cb5-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_comprehension =</span> b_0i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_2i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e_ti) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(Grade, reading_comprehension) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(person_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(person_id, Grade)</span>
<span id="cb5-15"></span>
<span id="cb5-16">d_level1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,000 × 12
   person_id working_memory   e0i   e1i    e2i   b_0i  b_1i  b_2i Grade
   &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     0
 2 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     1
 3 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     2
 4 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     3
 5 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     4
 6 12                 0.557 -137. -1.92 -1.55   -71.9  50.9  5.95     5
 7 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     0
 8 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     1
 9 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     2
10 918               -1.87  -151.  2.37 -0.284 -109.   43.0  9.40     3
# ℹ 11,990 more rows
# ℹ 3 more variables: reading_decoding &lt;dbl&gt;, e_ti &lt;dbl&gt;,
#   reading_comprehension &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Notes on the code from above:</p>
<table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Code</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>uncount(n_occasions)</code></td>
<td style="text-align: left;">Make copies of each row in <code>d_level2</code> according to what value is in <code>n_occasions</code>, which in this case is 6 in every row. Thus, the 6 copies of each row <code>d_level2</code> are made.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>group_by(person_id)</code></td>
<td style="text-align: left;">“I’m about to do something to groups of rows defined by <code>person_id</code>.”</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>mutate(Grade = row_number() - 1)</code></td>
<td style="text-align: left;">Create a variable called <code>Grade</code> by taking the row number of each group defined by <code>person_id</code> and subtract 1. Because there are 6 rows per person, the values within each person will be 0, 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>ungroup()</code></td>
<td style="text-align: left;">Stop computing things by group and compute variables the same way for the whole tibble.</td>
</tr>
</tbody>
</table>
<p>If the data were real, and I wanted to test the hypothesized model, I would run this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4)</span>
<span id="cb7-2">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> working_memory  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1 ) </span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * working_memory + reading_decoding *  
    working_memory + ((1 | person_id) + (0 + Grade | person_id) +  
    (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109220.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3829 -0.5871 -0.0044  0.5850  3.0921 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.172 49.600  
 person_id.1 Grade               2.241  1.497  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.953 14.932  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                Estimate Std. Error t value
(Intercept)                      60.7239     1.4854  40.880
Grade                            50.1376     0.3272 153.240
working_memory                   10.7375     1.4716   7.296
reading_decoding                  7.9683     0.1640  48.599
Grade:working_memory              5.5824     0.3233  17.265
working_memory:reading_decoding  -1.0912     0.1620  -6.734

Correlation of Fixed Effects:
            (Intr) Grade  wrkng_ rdng_d Grd:w_
Grade        0.587                            
workng_mmry  0.045  0.043                     
redng_dcdng -0.621 -0.932 -0.039              
Grd:wrkng_m  0.042 -0.010  0.584  0.012       
wrkng_mmr:_ -0.039  0.012 -0.619 -0.018 -0.931</code></pre>
</div>
</div>
<p>Figure&nbsp;1 plots the observed data, in which we can see that both reading decoding and reading comprehension increase across grade and that high working memory is associated with higher levels of the reading variables.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_level1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(reading_decoding, reading_comprehension, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> working_memory)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(Grade), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as.table =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradient2</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Working</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Memory</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Capacity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"royalblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Decoding"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Comprehension"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotmodel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-plotmodel-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plotmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Reading Decoding Predicting
</figcaption>
</figure>
</div>
</div>
</div>
<p>These effects might be easier to see in an animated plot like Figure&nbsp;2.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_level1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Grade =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Grade)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(reading_decoding, reading_comprehension, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> working_memory)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># facet_grid(rows = vars(Grade), as.table = F, labeller = label_both) +</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradient2</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Working</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Memory</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Capacity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"royalblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Decoding"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Comprehension"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_states</span>(Grade) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Grade: {closest_state}'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plotmodel2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotmodel2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-plotmodel2-1.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plotmodel2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Reading Decoding Predicting
</figcaption>
</figure>
</div>
</div>
</div>
<p>If you need to plot interaction effects, and you want to make your life much, much easier, use the <a href="https://strengejacke.github.io/sjPlot/articles/plot_interactions.html"><code>plot_model</code> function from the sjPlot package</a>.</p>
<p>In the <code>terms</code> parameter of the <code>plot_model</code> function, the first term is what goes on the x-axis. The second term is the moderator variable that shows up as lines with different colors. By default, it plots values at plus or minus 1 standard deviation, but you can specify any values you wish.</p>
<p>In Figure&nbsp;3, it can be seen that reading decoding is related to reading comprehension but the strength of that relation depends on working memory. The effects of reading decoding are increasingly strong as working memory decreases.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple slopes of reading decoding at different levels of working memory (collapsing across grade)</span></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb11-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb11-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-1, 0, 1]"</span>)) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-wm" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-wm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-wm-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-wm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Effects of Reading Decoding Are Moderated by Working Memory
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another way to think about the interaction is to say that for poor decoders working memory strongly predicts reading comprehension. By contrast, for strong decoders, working memory is a weak predictor. In Figure&nbsp;4, we are viewing the same interaction seen Figure&nbsp;3 but we have flipped the x-axis and the color-facet. There is no new information here, but it helps to see the finding from different vantage points.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple slopes of working memory at different levels of reading decoding (collapsing across grade)</span></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb12-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb12-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding [0, 10, 20]"</span>)) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-dc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-dc-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The Effects of Working Memory Depend on Reading Decoding
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;5, we can view the simple slopes of reading decoding at different levels of grade (collapsing across working memory). Because the simple slopes are parallel, it appears that the effect of reading decoding is constant across grades.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb13-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb13-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade"</span>))</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-gradedc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gradedc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-gradedc-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gradedc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: The Effects of Reading Decoding at Different Grades
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;6, we see that reading comprehension grows faster for students with higher working memory than for students with lower working memory.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb14-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb14-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-1, 0, 1]"</span>))</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-gradewm" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gradewm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-gradewm-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gradewm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: The Growth of Reading Comprehension Across Grade at Different Levels of Working Memory
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;7, we see the effects of reading decoding, working memory, and grade simultaneously. It appears that reading decoding’s effect is stronger for students with lower working memory but that the effect of working memory becomes increasingly strong across grades.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show simple slopes of reading decoding at different levels of grade and working memory</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb15-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb15-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-1, 0, 1]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>))</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-dcwmgrade" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dcwmgrade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-dcwmgrade-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dcwmgrade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: The Effect of Reading Decoding on Reading Comprehensionat Different Levels of Working Memory and Grade
</figcaption>
</figure>
</div>
</div>
</div>
<p>I can’t tell you how much trouble functions like <code>plot_model</code> will save you. I don’t care to admit how many hours of my life have been spent making interaction plots. Of course, ggplot2 made my coding experience much simpler than it used to to be. I mainly use sjPlot to make quick plots. If I needed to make a publication-ready plot, I would probably use code like Figure&nbsp;8.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make predicted values at each unique combination of predictor variables</span></span>
<span id="cb16-2">d_predicted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Grade =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb16-3">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">working_memory =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb16-4">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_decoding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_comprehension =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re.form =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb16-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">working_memory =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(working_memory,</span>
<span id="cb16-7">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb16-8">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High (+1 SD)"</span>,</span>
<span id="cb16-9">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean"</span>,</span>
<span id="cb16-10">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low (-1 SD)"</span>)))</span>
<span id="cb16-11"></span>
<span id="cb16-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_predicted,</span>
<span id="cb16-13">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> reading_decoding, </span>
<span id="cb16-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> reading_comprehension, </span>
<span id="cb16-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> working_memory)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> working_memory), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(Grade), </span>
<span id="cb16-18">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_bquote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .(Grade))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Working Memory"</span>, </span>
<span id="cb16-20">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"royalblue4"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb16-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Decoding"</span>, </span>
<span id="cb16-24">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Comprehension"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted Values of Reading Comprehension"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pubworthy" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pubworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fig-pubworthy-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pubworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: The Effects of Reading Decoding on Reading Comprehension by Working Memory Capacity Across Grades
</figcaption>
</figure>
</div>
</div>
</div>
<p>Also from the sjPlot package, an attractive table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.81&nbsp;–&nbsp;63.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.50&nbsp;–&nbsp;50.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.65&nbsp;–&nbsp;8.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.95</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.17</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>

</div>
</div>
</section>
</section>
</section>
<section id="complete-analysis-walkthrough" class="level1">
<h1>Complete Analysis Walkthrough</h1>
<p>Okay, suppose that we had no idea how the simulated data were generated. Imagine that we are researchers who collected the data rather than the people who simulated it. However, we hypothesized the model with which the data were simulated. Of course, we can go straight to testing the hypothesized model, but generally we start with the null model and build from there.</p>
<section id="model-building-plan" class="level2">
<h2 class="anchored" data-anchor-id="model-building-plan">Model Building Plan</h2>
<p>The sequence of model building is the same but at every step, start with the time variable (Grade in this case). This sequence is a suggestion only.</p>
<ul>
<li>Null Model (Random Intercepts)</li>
<li>Level 1 Fixed Effects
<ul>
<li>Time (as many polynomial terms as you hypothesized you would need)
<ul>
<li>Linear (Time)</li>
<li>Quadratic (Time + Time ^ 2)</li>
<li>Cubic (Time + Time ^ 2 + Time ^ 3)</li>
<li>Quartic (Time + Time ^ 2 + Time ^ 3 + Time ^ 4)</li>
<li>You can keep going but consider alternatives to polynomials like <a href="https://people.maths.bris.ac.uk/~sw15190/mgcv/">Generalized Additive Mixed Models</a>.</li>
</ul></li>
<li>Other level-1 time-varying covariates</li>
<li>Interactions of time-varying covariates with Time</li>
<li>Interactions of time-varying covariates with each other</li>
</ul></li>
<li>Level-2 Fixed Effects
<ul>
<li>Main effects of level-2 covariates</li>
<li>Interactions among level-2 covariates</li>
</ul></li>
<li>Level 1 Random Slopes
<ul>
<li>Time’s random slope
<ul>
<li>Uncorrelated with random intercepts</li>
<li>Correlated with random intercepts</li>
</ul></li>
<li>Other level-1 random slopes
<ul>
<li>Uncorrelated with random intercepts</li>
<li>Correlated with random intercepts</li>
</ul></li>
<li>Interactions of random slopes
<ul>
<li>These models are pretty unlikely to converge, but it is up to you.</li>
</ul></li>
</ul></li>
<li>Cross-Level Interactions
<ul>
<li>Interaction of level-2 covariates with Time</li>
<li>Interaction of level-2 covariates with level-1 time-varying covariates</li>
</ul></li>
</ul>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4)</span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(broom.mixed)</span>
<span id="cb18-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(performance)</span>
<span id="cb18-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(report)</span>
<span id="cb18-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span></code></pre></div>
</div>
</section>
<section id="null-model" class="level2">
<h2 class="anchored" data-anchor-id="null-model">Null Model</h2>
<p>Let’s start where we always start, with no predictors except the random intercept variable. In this case it refers to the person-level intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">fit_null <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_null)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 150425.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.3787 -0.7944 -0.0162  0.7785  2.8396 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept)   630.6   25.11  
 Residual              15707.2  125.33  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
            Estimate Std. Error t value
(Intercept)  273.644      1.274   214.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_null)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">273.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">271.15&nbsp;–&nbsp;276.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">15707.18</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">630.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.039</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_null)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |    RMSE |   Sigma
---------------------------------------------------------------------------------------
1.504e+05 | 1.504e+05 | 1.505e+05 |      0.039 |      0.000 | 0.039 | 123.280 | 125.328</code></pre>
</div>
</div>
<p>Here we see that the R2-conditional is 0.04, which is the proportion of variance explained by the entire model. Because the model has only the random intercept as a predictor, it represents the proportion of variance explained by the random intercept (i.e., between-persons variance).</p>
</section>
<section id="linear-effect-of-time-grade" class="level2">
<h2 class="anchored" data-anchor-id="linear-effect-of-time-grade">Linear Effect of Time (Grade)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">fit_time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_time)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 113425.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3829 -0.6085 -0.0069  0.6017  3.6388 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3183.8   56.42   
 Residual               388.3   19.70   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
            Estimate Std. Error t value
(Intercept) 108.2498     1.3014   83.18
Grade        66.1577     0.1053  628.12

Correlation of Fixed Effects:
      (Intr)
Grade -0.202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_time)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">108.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">105.70&nbsp;–&nbsp;110.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">66.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">65.95&nbsp;–&nbsp;66.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">388.28</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3183.78</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.89</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.781 / 0.976</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_time)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.134e+05 | 1.134e+05 | 1.135e+05 |      0.976 |      0.781 | 0.891 | 18.023 | 19.705</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_time)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade (formula: reading_comprehension ~ 1
+ Grade). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.78. The model's intercept, corresponding to Grade = 0, is at 108.25 (95% CI
[105.70, 110.80], t(11996) = 83.18, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 66.16,
95% CI [65.95, 66.36], t(11996) = 628.12, p &lt; .001; Std. beta = 0.88, 95% CI
[0.88, 0.89])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>The effect of time (Grade) is very large. The R2_marginal is 0, which is the proportion of variance explained by all the fixed effects, which in this case is <code>Grade</code>.</p>
<p>It is easy to predict that <code>fit_time</code> will be a better model than <code>fit_null</code>, but let’s run the code anyway:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_null, fit_time)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_null: reading_comprehension ~ 1 + (1 | person_id)
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
         npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
fit_null    3 150434 150456 -75214   150428                        
fit_time    4 113433 113463 -56713   113425 37002  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_null, fit_time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     |   Model | R2 (cond.) | R2 (marg.) |   ICC |    RMSE |   Sigma
------------------------------------------------------------------------
fit_time | lmerMod |      0.976 |      0.781 | 0.891 |  18.023 |  19.705
fit_null | lmerMod |      0.039 |      0.000 | 0.039 | 123.280 | 125.328

Name     | AIC weights | AICc weights | BIC weights | Performance-Score
-----------------------------------------------------------------------
fit_time |        1.00 |         1.00 |        1.00 |           100.00%
fit_null |    0.00e+00 |     0.00e+00 |    0.00e+00 |             0.00%</code></pre>
</div>
</div>
<p>As expected, the <code>fit_time</code> model fits better than the <code>fit_null</code> model.</p>
</section>
<section id="quadratic-effect-of-time" class="level2">
<h2 class="anchored" data-anchor-id="quadratic-effect-of-time">Quadratic effect of Time</h2>
<p>We did not have a hypothesis about whether time (Grade) would have a linear effect. Let’s see if we need a quadratic effect. We can construct a quadratic effect by using the <code>poly</code> function with a degree of 2. By default, it creates orthogonal polynomials (i.e., uncorrelated). Often raw polynomials are so highly correlated that they cannot be in the same regression formula. If you need raw polynomials (i.e., Grade and Grade squared), then specify <code>poly(Grade, 2, raw = T)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">fit_time_quadratic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(Grade, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb35-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_time_quadratic)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + poly(Grade, 2) + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 113407.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3812 -0.6088 -0.0071  0.6023  3.6401 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3183.8   56.42   
 Residual               388.3   19.71   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                 Estimate Std. Error t value
(Intercept)       273.644      1.274 214.714
poly(Grade, 2)1 12376.970     19.706 628.087
poly(Grade, 2)2    -2.301     19.706  -0.117

Correlation of Fixed Effects:
            (Intr) p(G,2)1
ply(Grd,2)1 0.000         
ply(Grd,2)2 0.000  0.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_time_quadratic)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">273.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">271.15&nbsp;–&nbsp;276.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade [1st degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12376.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12338.34&nbsp;–&nbsp;12415.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade [2nd degree]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-40.93&nbsp;–&nbsp;36.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.907</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">388.32</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3183.77</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.89</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.781 / 0.976</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_time_quadratic)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.134e+05 | 1.134e+05 | 1.135e+05 |      0.976 |      0.781 | 0.891 | 18.023 | 19.706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_time_quadratic)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade (formula: reading_comprehension ~ 1
+ poly(Grade, 2)). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.78. The model's intercept, corresponding to Grade = 0, is at 273.64 (95% CI
[271.15, 276.14], t(11995) = 214.71, p &lt; .001). Within this model:

  - The effect of Grade [1st degree] is statistically significant and positive
(beta = 12376.97, 95% CI [12338.34, 12415.60], t(11995) = 628.09, p &lt; .001;
Std. beta = 96.83, 95% CI [96.53, 97.13])
  - The effect of Grade [2nd degree] is statistically non-significant and
negative (beta = -2.30, 95% CI [-40.93, 36.33], t(11995) = -0.12, p = 0.907;
Std. beta = -0.02, 95% CI [-0.32, 0.28])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare linear and quadratic models</span></span>
<span id="cb42-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_time, fit_time_quadratic)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
fit_time_quadratic: reading_comprehension ~ 1 + poly(Grade, 2) + (1 | person_id)
                   npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_time              4 113433 113463 -56713   113425                     
fit_time_quadratic    5 113435 113472 -56713   113425 0.0136  1      0.907</code></pre>
</div>
</div>
<p>No effect! We could add a third-order polynomial (i.e., the effect of Grade to the third power), but we did not hypothesize such an effect. Let’s stick with the linear effect of time.</p>
<p>If we plot our data, we get this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_level1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Grade, reading_comprehension, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> person_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/plottime-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>It looks like the effect of time really is linear.</p>
</section>
<section id="fixed-effect-of-reading-decoding-level-1-time-varying-covariate" class="level2">
<h2 class="anchored" data-anchor-id="fixed-effect-of-reading-decoding-level-1-time-varying-covariate">Fixed effect of reading decoding (level 1 time-varying covariate)</h2>
<p>Unsurprisingly, reading decoding is a predictor of reading comprehension:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">fit_decoding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb45-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111582.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3167 -0.6144 -0.0032  0.6033  3.5148 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3044     55.18   
 Residual               326     18.05   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                 Estimate Std. Error t value
(Intercept)       59.7447     1.6669   35.84
Grade             50.0036     0.3731  134.03
reading_decoding   8.0665     0.1800   44.83

Correlation of Fixed Effects:
            (Intr) Grade 
Grade        0.590       
redng_dcdng -0.649 -0.966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_decoding)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">59.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">56.48&nbsp;–&nbsp;63.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.27&nbsp;–&nbsp;50.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">8.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.71&nbsp;–&nbsp;8.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325.96</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3044.37</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.792 / 0.980</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.116e+05 | 1.116e+05 | 1.116e+05 |      0.980 |      0.792 | 0.903 | 16.509 | 18.054</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade + reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 59.74 (95% CI
[56.48, 63.01], t(11995) = 35.84, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 50.00,
95% CI [49.27, 50.73], t(11995) = 134.03, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 8.07, 95% CI [7.71, 8.42], t(11995) = 44.82, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare with linear effect of time</span></span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_time, fit_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_time: reading_comprehension ~ 1 + Grade + (1 | person_id)
fit_decoding: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
             npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_time        4 113433 113463 -56713   113425                         
fit_decoding    5 111590 111627 -55790   111580 1844.9  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_time, fit_decoding, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name         |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
--------------------------------------------------------------------------
fit_decoding | lmerMod |      0.980 |      0.792 | 0.903 | 16.509 | 18.054
fit_time     | lmerMod |      0.976 |      0.781 | 0.891 | 18.023 | 19.705

Name         | AIC weights | AICc weights | BIC weights | Performance-Score
---------------------------------------------------------------------------
fit_decoding |        1.00 |         1.00 |        1.00 |           100.00%
fit_time     |    0.00e+00 |     0.00e+00 |    0.00e+00 |             0.00%</code></pre>
</div>
</div>
<p>The <em>t</em> value of the fixed effect of reading_decoding is huge. It is significant. The model comparisons with <code>fit_time</code> suggests that <code>fit_decoding</code> is clearly preferred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade + reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 59.74 (95% CI
[56.48, 63.01], t(11995) = 35.84, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 50.00,
95% CI [49.27, 50.73], t(11995) = 134.03, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 8.07, 95% CI [7.71, 8.42], t(11995) = 44.82, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_decoding, </span>
<span id="cb58-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb58-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>),</span>
<span id="cb58-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Effect of Reading Decoding on Reading Comprehension</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> at Different Grades"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/plotfit_decoding-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="level-1-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="level-1-interaction-effects">Level-1 interaction effects</h2>
<p>Let’s see if the effect of reading decoding depends on Grade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">fit_decoding_x_Grade <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb59-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_decoding_x_Grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111552.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3295 -0.6159  0.0036  0.6114  3.4131 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 3044.3   55.18   
 Residual               324.9   18.02   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            63.70831    1.79477  35.497
Grade                  47.97522    0.50605  94.803
reading_decoding        7.61071    0.19540  38.950
Grade:reading_decoding  0.18358    0.03099   5.924

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d
Grade        0.150              
redng_dcdng -0.700 -0.387       
Grd:rdng_dc  0.372 -0.677 -0.393</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_decoding_x_Grade)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">63.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.19&nbsp;–&nbsp;67.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">47.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">46.98&nbsp;–&nbsp;48.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.23&nbsp;–&nbsp;7.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12&nbsp;–&nbsp;0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">324.86</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3044.29</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.792 / 0.980</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_decoding_x_Grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.116e+05 | 1.116e+05 | 1.116e+05 |      0.980 |      0.792 | 0.904 | 16.480 | 18.024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_decoding_x_Grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade and reading_decoding (formula:
reading_comprehension ~ 1 + Grade * reading_decoding). The model included
person_id as random effect (formula: ~1 | person_id). The model's total
explanatory power is substantial (conditional R2 = 0.98) and the part related
to the fixed effects alone (marginal R2) is of 0.79. The model's intercept,
corresponding to Grade = 0 and reading_decoding = 0, is at 63.71 (95% CI
[60.19, 67.23], t(11994) = 35.50, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 47.98,
95% CI [46.98, 48.97], t(11994) = 94.80, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.61, 95% CI [7.23, 7.99], t(11994) = 38.95, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.24])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.18, 95% CI [0.12, 0.24], t(11994) = 5.92, p &lt; .001; Std.
beta = 8.83e-03, 95% CI [5.91e-03, 0.01])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model</span></span>
<span id="cb66-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_decoding, fit_decoding_x_Grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_decoding: reading_comprehension ~ 1 + Grade + reading_decoding + (1 | person_id)
fit_decoding_x_Grade: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
                     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_decoding            5 111590 111627 -55790   111580                     
fit_decoding_x_Grade    6 111557 111602 -55773   111545 35.044  1  3.224e-09
                        
fit_decoding            
fit_decoding_x_Grade ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_decoding, fit_decoding_x_Grade, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                 |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE
-------------------------------------------------------------------------
fit_decoding_x_Grade | lmerMod |      0.980 |      0.792 | 0.904 | 16.480
fit_decoding         | lmerMod |      0.980 |      0.792 | 0.903 | 16.509

Name                 |  Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------------------
fit_decoding_x_Grade | 18.024 |       1.000 |        1.000 |       1.000 |           100.00%
fit_decoding         | 18.054 |    6.68e-08 |     6.68e-08 |    2.69e-06 |             0.00%</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_decoding_x_Grade, </span>
<span id="cb70-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb70-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/plotfit_decoding_x_Grade-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>So the interaction effect is present, but tiny.</p>
</section>
<section id="level-2-covariate-working-memory" class="level2">
<h2 class="anchored" data-anchor-id="level-2-covariate-working-memory">Level-2 covariate: working memory</h2>
<p>As seen below, the effect of working memory is statistically significant, meaning that students with higher working memory tend to have better reading comprehension.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1">fit_working <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb71-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_working)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    (1 | person_id)
   Data: d_level1

REML criterion at convergence: 111443

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3005 -0.6165  0.0010  0.6123  3.4503 

Random effects:
 Groups    Name        Variance Std.Dev.
 person_id (Intercept) 2884.8   53.71   
 Residual               324.8   18.02   
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            64.19123    1.77295  36.206
Grade                  48.24408    0.50670  95.212
reading_decoding        7.47852    0.19581  38.193
working_memory         12.67919    1.20755  10.500
Grade:reading_decoding  0.18332    0.03099   5.916

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.153                     
redng_dcdng -0.709 -0.389              
workng_mmry  0.029  0.054 -0.068       
Grd:rdng_dc  0.377 -0.676 -0.392 -0.001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_working)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">64.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72&nbsp;–&nbsp;67.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">47.25&nbsp;–&nbsp;49.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.09&nbsp;–&nbsp;7.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">12.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.31&nbsp;–&nbsp;15.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12&nbsp;–&nbsp;0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">324.84</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2884.79</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.803 / 0.980</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_working)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.115e+05 | 1.115e+05 | 1.115e+05 |      0.980 |      0.803 | 0.899 | 16.481 | 18.023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_working)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effect (formula: ~1 |
person_id). The model's total explanatory power is substantial (conditional R2
= 0.98) and the part related to the fixed effects alone (marginal R2) is of
0.80. The model's intercept, corresponding to Grade = 0, reading_decoding = 0
and working_memory = 0, is at 64.19 (95% CI [60.72, 67.67], t(11993) = 36.21, p
&lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 48.24,
95% CI [47.25, 49.24], t(11993) = 95.21, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.48, 95% CI [7.09, 7.86], t(11993) = 38.19, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 12.68, 95% CI [10.31, 15.05], t(11993) = 10.50, p &lt; .001; Std. beta = 0.10,
95% CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.18, 95% CI [0.12, 0.24], t(11993) = 5.92, p &lt; .001; Std.
beta = 8.81e-03, 95% CI [5.89e-03, 0.01])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model</span></span>
<span id="cb78-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_decoding_x_Grade, fit_working)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_decoding_x_Grade: reading_comprehension ~ 1 + Grade * reading_decoding + (1 | person_id)
fit_working: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + (1 | person_id)
                     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit_decoding_x_Grade    6 111557 111602 -55773   111545                     
fit_working             7 111452 111504 -55719   111438 107.46  1  &lt; 2.2e-16
                        
fit_decoding_x_Grade    
fit_working          ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_decoding_x_Grade, fit_working, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                 |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE
-------------------------------------------------------------------------
fit_working          | lmerMod |      0.980 |      0.803 | 0.899 | 16.481
fit_decoding_x_Grade | lmerMod |      0.980 |      0.792 | 0.904 | 16.480

Name                 |  Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------------------
fit_working          | 18.023 |        1.00 |         1.00 |        1.00 |            75.00%
fit_decoding_x_Grade | 18.024 |    1.26e-23 |     1.26e-23 |    5.06e-22 |            25.00%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_working, </span>
<span id="cb82-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb82-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-2, 2]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fit_working-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="level-1-random-slope-grade" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-slope-grade">Level-1 random slope: Grade</h2>
<p>As seen below, letting the slope of Grade be random improves the fit of the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1">fit_grade_random_uncorrelated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb83-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_grade_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    ((1 | person_id) + (0 + Grade | person_id))
   Data: d_level1

REML criterion at convergence: 110049.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2898 -0.5710 -0.0043  0.5689  3.2100 

Random effects:
 Groups      Name        Variance Std.Dev.
 person_id   (Intercept) 2647.26  51.452  
 person_id.1 Grade         28.63   5.351  
 Residual                 226.98  15.066  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            61.32490    1.62690  37.694
Grade                  49.44598    0.46061 107.350
reading_decoding        7.84505    0.17440  44.983
working_memory          6.84561    1.16575   5.872
Grade:reading_decoding  0.06248    0.02639   2.368

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.179                     
redng_dcdng -0.683 -0.418              
workng_mmry  0.029  0.036 -0.070       
Grd:rdng_dc  0.346 -0.637 -0.370  0.018</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_grade_random_uncorrelated)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">61.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">58.14&nbsp;–&nbsp;64.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.54&nbsp;–&nbsp;50.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.50&nbsp;–&nbsp;8.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">6.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.56&nbsp;–&nbsp;9.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.018</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">226.98</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2647.26</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">28.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.818 / 0.986</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_grade_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.101e+05 | 1.101e+05 | 1.101e+05 |      0.986 |      0.818 | 0.921 | 12.811 | 15.066</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_grade_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effects (formula:
list(~1 | person_id, ~0 + Grade | person_id)). The model's total explanatory
power is substantial (conditional R2 = 0.99) and the part related to the fixed
effects alone (marginal R2) is of 0.82. The model's intercept, corresponding to
Grade = 0, reading_decoding = 0 and working_memory = 0, is at 61.32 (95% CI
[58.14, 64.51], t(11992) = 37.69, p &lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 49.45,
95% CI [48.54, 50.35], t(11992) = 107.35, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.85, 95% CI [7.50, 8.19], t(11992) = 44.98, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 6.85, 95% CI [4.56, 9.13], t(11992) = 5.87, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.06, 95% CI [0.01, 0.11], t(11992) = 2.37, p = 0.018; Std.
beta = 3.13e-03, 95% CI [6.33e-04, 5.62e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb90-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_working, fit_grade_random_uncorrelated, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_working: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + (1 | person_id)
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
                              npar    AIC    BIC logLik deviance  Chisq Df
fit_working                      7 111457 111509 -55721   111443          
fit_grade_random_uncorrelated    8 110066 110125 -55025   110050 1393.2  1
                              Pr(&gt;Chisq)    
fit_working                                 
fit_grade_random_uncorrelated  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_working, fit_grade_random_uncorrelated, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                          |   Model | R2 (cond.) | R2 (marg.) |   ICC
-------------------------------------------------------------------------
fit_grade_random_uncorrelated | lmerMod |      0.986 |      0.818 | 0.921
fit_working                   | lmerMod |      0.980 |      0.803 | 0.899

Name                          |   RMSE |  Sigma | AIC weights | AICc weights
----------------------------------------------------------------------------
fit_grade_random_uncorrelated | 12.811 | 15.066 |        1.00 |         1.00
fit_working                   | 16.481 | 18.023 |   8.74e-303 |    8.75e-303

Name                          | BIC weights | Performance-Score
---------------------------------------------------------------
fit_grade_random_uncorrelated |        1.00 |           100.00%
fit_working                   |   3.52e-301 |             0.00%</code></pre>
</div>
</div>
</section>
<section id="level-1-random-slope-reading_decoding" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-slope-reading_decoding">Level-1 random slope: reading_decoding</h2>
<p>We run into a model convergence problem when we add the random slope for reading decoding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1">fit_decoding_random_uncorrelated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span></code></pre></div>
</div>
<p>We can try a different optimizer to see if that helps. The <code>lmer</code> function’s previous default optimizer (<code>Nelder_Mead</code>) sometimes finds a good solution when the current default optimizer (<code>bobyqa</code>) does not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1">fit_decoding_random_uncorrelated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmerControl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">optimizer=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nelder_Mead"</span>))</span></code></pre></div>
</div>
<p>It worked!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_decoding_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding |  
        person_id))
   Data: d_level1
Control: lmerControl(optimizer = "Nelder_Mead")

REML criterion at convergence: 110004.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2379 -0.5687 -0.0066  0.5675  3.1103 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2495.324 49.953  
 person_id.1 Grade              17.901  4.231  
 person_id.2 reading_decoding    2.558  1.599  
 Residual                      225.299 15.010  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                       Estimate Std. Error t value
(Intercept)            61.16775    1.60592  38.089
Grade                  49.37052    0.45458 108.607
reading_decoding        7.85081    0.17819  44.059
working_memory          4.80887    1.15773   4.154
Grade:reading_decoding  0.06668    0.02645   2.521

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade        0.182                     
redng_dcdng -0.680 -0.413              
workng_mmry  0.034  0.032 -0.071       
Grd:rdng_dc  0.352 -0.647 -0.363  0.025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_decoding_random_uncorrelated)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">61.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">58.02&nbsp;–&nbsp;64.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">48.48&nbsp;–&nbsp;50.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.50&nbsp;–&nbsp;8.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.54&nbsp;–&nbsp;7.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.012</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">225.30</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2495.32</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">17.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.56</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.826 / 0.986</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_decoding_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.100e+05 | 1.100e+05 | 1.101e+05 |      0.986 |      0.826 | 0.917 | 12.747 | 15.010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_decoding_random_uncorrelated)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and Nelder-Mead optimizer)
to predict reading_comprehension with Grade, reading_decoding and
working_memory (formula: reading_comprehension ~ 1 + Grade * reading_decoding +
working_memory). The model included person_id as random effects (formula:
list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to Grade = 0, reading_decoding = 0
and working_memory = 0, is at 61.17 (95% CI [58.02, 64.32], t(11991) = 38.09, p
&lt; .001). Within this model:

  - The effect of Grade is statistically significant and positive (beta = 49.37,
95% CI [48.48, 50.26], t(11991) = 108.61, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.85, 95% CI [7.50, 8.20], t(11991) = 44.06, p &lt; .001; Std. beta =
0.23, 95% CI [0.22, 0.23])
  - The effect of working memory is statistically significant and positive (beta
= 4.81, 95% CI [2.54, 7.08], t(11991) = 4.15, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade × reading decoding is statistically significant and
positive (beta = 0.07, 95% CI [0.01, 0.12], t(11991) = 2.52, p = 0.012; Std.
beta = 3.28e-03, 95% CI [7.88e-04, 5.78e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb103-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_grade_random_uncorrelated, fit_decoding_random_uncorrelated, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
fit_decoding_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                                 npar    AIC    BIC logLik deviance  Chisq Df
fit_grade_random_uncorrelated       8 110066 110125 -55025   110050          
fit_decoding_random_uncorrelated    9 110023 110089 -55002   110005 44.976  1
                                 Pr(&gt;Chisq)    
fit_grade_random_uncorrelated                  
fit_decoding_random_uncorrelated  1.995e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_grade_random_uncorrelated, fit_decoding_random_uncorrelated, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                             |   Model | R2 (cond.) | R2 (marg.) |   ICC
----------------------------------------------------------------------------
fit_decoding_random_uncorrelated | lmerMod |      0.986 |      0.826 | 0.917
fit_grade_random_uncorrelated    | lmerMod |      0.986 |      0.818 | 0.921

Name                             |   RMSE |  Sigma | AIC weights | AICc weights
-------------------------------------------------------------------------------
fit_decoding_random_uncorrelated | 12.747 | 15.010 |       1.000 |        1.000
fit_grade_random_uncorrelated    | 12.811 | 15.066 |    4.66e-10 |     4.67e-10

Name                             | BIC weights | Performance-Score
------------------------------------------------------------------
fit_decoding_random_uncorrelated |       1.000 |            75.00%
fit_grade_random_uncorrelated    |    1.88e-08 |            25.00%</code></pre>
</div>
</div>
</section>
<section id="level-1-random-intercept-slope-correlations" class="level2">
<h2 class="anchored" data-anchor-id="level-1-random-intercept-slope-correlations">Level-1 random intercept-slope correlations</h2>
<p>Do the intercepts and slopes correlate?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1">fit_correlated_intercept_slopes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_at</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(reading_decoding, working_memory), scale, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> F), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmerControl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">optimizer=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nelder_Mead"</span>))</span>
<span id="cb107-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_correlated_intercept_slopes)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
reading_comprehension ~ 1 + Grade * reading_decoding + working_memory +  
    (1 + Grade + reading_decoding | person_id)
   Data: d_level1 %&gt;% mutate_at(vars(reading_decoding, working_memory),  
    scale, center = T, scale = F)
Control: lmerControl(optimizer = "Nelder_Mead")

REML criterion at convergence: 109996.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2902 -0.5690 -0.0060  0.5652  3.1303 

Random effects:
 Groups    Name             Variance Std.Dev. Corr       
 person_id (Intercept)      2979.649 54.586              
           Grade              32.179  5.673   -0.13      
           reading_decoding    4.533  2.129    0.43 -0.47
 Residual                    223.467 14.949              
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                        Estimate Std. Error t value
(Intercept)            147.91594    1.49422   98.99
Grade                   50.09898    0.35818  139.87
reading_decoding         7.85703    0.18135   43.33
working_memory           4.07157    1.15659    3.52
Grade:reading_decoding   0.06527    0.02642    2.47

Correlation of Fixed Effects:
            (Intr) Grade  rdng_d wrkng_
Grade       -0.562                     
redng_dcdng  0.615 -0.855              
workng_mmry -0.036  0.062 -0.071       
Grd:rdng_dc -0.099 -0.007 -0.357  0.028</code></pre>
</div>
</div>
<p>The model did not converge. I checked various solutions (different optimizers, more iterations, centering variables), but none worked for me. Do the slopes and intercepts correlate? From various attempts, the answer seems to be that they do not, but it is hard to be sure. The random slopes for reading decoding and Grade might be negatively correlated, but I am reluctant to trust the results of a non-convergent model, especially when I have no theoretical reason to expect such a correlation. Therefore, I am going to go with the uncorrelated slopes and intercepts model.</p>
</section>
<section id="cross-level-interaction-working-memory-grade" class="level2">
<h2 class="anchored" data-anchor-id="cross-level-interaction-working-memory-grade">Cross-level interaction: Working Memory × Grade</h2>
<p>As seen below, working memory has a positive interaction with Grade, meaning that the growth of reading comprehension (i.e., the effect of Grade) is faster with students with higher working memory capacity.</p>
<p>Note that the cross-level interaction is significant—and the level-1 interaction between Reading Decoding and Grade is no longer significant. What happened? Usually we would have to be pretty clever to figure out the reason, but we happen to know how the data were simulated: Working Memory and Grade really do interact, and Reading Decoding and Grade really do not. However, Working Memory and Grade are correlated (i.e., Working Memory increases over time). When Grade was not allowed to interact with Working Memory, Reading Decoding interacted with Grade, a correlate of Working Memory. Now that the true interaction has been included in the model, the false interaction is no longer significant. We can leave it in for now, but we can get rid of it at the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1">fit_wm_x_grade <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb109-2"></span>
<span id="cb109-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_wm_x_grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * Grade + Grade *  
    reading_decoding + ((1 | person_id) + (0 + Grade | person_id) +  
    (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109269.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4081 -0.5853 -0.0036  0.5802  3.0518 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2459.903 49.597  
 person_id.1 Grade               1.746  1.321  
 person_id.2 reading_decoding    3.629  1.905  
 Residual                      224.121 14.971  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                        Estimate Std. Error t value
(Intercept)            60.470968   1.589967  38.033
working_memory          4.623729   1.157350   3.995
Grade                  50.095459   0.440333 113.767
reading_decoding        7.932988   0.176734  44.887
working_memory:Grade    3.554948   0.118362  30.035
Grade:reading_decoding  0.006277   0.026503   0.237

Correlation of Fixed Effects:
            (Intr) wrkng_ Grade  rdng_d wrk_:G
workng_mmry  0.034                            
Grade        0.171  0.030                     
redng_dcdng -0.672 -0.069 -0.400              
wrkng_mmr:G -0.024  0.028  0.078  0.030       
Grd:rdng_dc  0.356  0.026 -0.669 -0.367 -0.112
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00396576 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_wm_x_grade)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.35&nbsp;–&nbsp;63.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.36&nbsp;–&nbsp;6.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.23&nbsp;–&nbsp;50.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.59&nbsp;–&nbsp;8.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.32&nbsp;–&nbsp;3.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade × reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.813</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">224.12</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2459.90</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1.75</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.63</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb112" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_wm_x_grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.093e+05 | 1.093e+05 | 1.094e+05 |      0.986 |      0.831 | 0.916 | 12.932 | 14.971</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_wm_x_grade)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, Grade and
reading_decoding (formula: reading_comprehension ~ 1 + working_memory * Grade +
Grade * reading_decoding). The model included person_id as random effects
(formula: list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to working_memory = 0, Grade = 0 and
reading_decoding = 0, is at 60.47 (95% CI [57.35, 63.59], t(11990) = 38.03, p &lt;
.001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 4.62, 95% CI [2.36, 6.89], t(11990) = 4.00, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of Grade is statistically significant and positive (beta = 50.10,
95% CI [49.23, 50.96], t(11990) = 113.77, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.93, 95% CI [7.59, 8.28], t(11990) = 44.89, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 3.55, 95% CI [3.32, 3.79], t(11990) = 30.03, p &lt; .001; Std.
beta = 0.05, 95% CI [0.04, 0.05])
  - The effect of Grade × reading decoding is statistically non-significant and
positive (beta = 6.28e-03, 95% CI [-0.05, 0.06], t(11990) = 0.24, p = 0.813;
Std. beta = 4.20e-04, 95% CI [-2.08e-03, 2.92e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb116-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_grade_random_uncorrelated, fit_wm_x_grade, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_grade_random_uncorrelated: reading_comprehension ~ 1 + Grade * reading_decoding + working_memory + ((1 | person_id) + (0 + Grade | person_id))
fit_wm_x_grade: reading_comprehension ~ 1 + working_memory * Grade + Grade * reading_decoding + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                              npar    AIC    BIC logLik deviance Chisq Df
fit_grade_random_uncorrelated    8 110066 110125 -55025   110050         
fit_wm_x_grade                  10 109289 109363 -54635   109269 780.7  2
                              Pr(&gt;Chisq)    
fit_grade_random_uncorrelated               
fit_wm_x_grade                 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_grade_random_uncorrelated, fit_wm_x_grade, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                          |   Model | R2 (cond.) | R2 (marg.) |   ICC
-------------------------------------------------------------------------
fit_wm_x_grade                | lmerMod |      0.986 |      0.831 | 0.916
fit_grade_random_uncorrelated | lmerMod |      0.986 |      0.818 | 0.921

Name                          |   RMSE |  Sigma | AIC weights | AICc weights
----------------------------------------------------------------------------
fit_wm_x_grade                | 12.932 | 14.971 |        1.00 |         1.00
fit_grade_random_uncorrelated | 12.811 | 15.066 |   5.33e-170 |    5.35e-170

Name                          | BIC weights | Performance-Score
---------------------------------------------------------------
fit_wm_x_grade                |        1.00 |            75.00%
fit_grade_random_uncorrelated |   8.66e-167 |            25.00%</code></pre>
</div>
</div>
</section>
<section id="cross-level-interaction-working-memory-reading-decoding" class="level2">
<h2 class="anchored" data-anchor-id="cross-level-interaction-working-memory-reading-decoding">Cross-level interaction: Working Memory × Reading Decoding</h2>
<p>The interaction of working memory and reading decoding is negative, meaning that reading decoding is a weaker predictor of reading comprehension among students with higher working memory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1">fit_wm_x_decoding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Grade  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  reading_decoding<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb120-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_wm_x_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * reading_decoding +  
    working_memory * Grade + reading_decoding * Grade + ((1 |  
    person_id) + (0 + Grade | person_id) + (0 + reading_decoding |  
    person_id))
   Data: d_level1

REML criterion at convergence: 109225.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3824 -0.5867 -0.0049  0.5853  3.0929 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.171 49.600  
 person_id.1 Grade               2.239  1.496  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.981 14.933  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                 Estimate Std. Error t value
(Intercept)                     60.789650   1.588845  38.260
working_memory                  10.738982   1.471720   7.297
reading_decoding                 7.960728   0.176274  45.161
Grade                           50.103391   0.439645 113.963
working_memory:reading_decoding -1.090817   0.162071  -6.730
working_memory:Grade             5.580178   0.323878  17.229
reading_decoding:Grade           0.003082   0.026438   0.117

Correlation of Fixed Effects:
            (Intr) wrkng_ rdng_d Grade  wrk_:_ wrk_:G
workng_mmry  0.045                                   
redng_dcdng -0.670 -0.040                            
Grade        0.171  0.026 -0.400                     
wrkng_mmr:_ -0.030 -0.618 -0.023 -0.003              
wrkng_mmr:G  0.019  0.583  0.032  0.031 -0.931       
rdng_dcdn:G  0.355  0.009 -0.367 -0.668  0.018 -0.058</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_wm_x_decoding)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.68&nbsp;–&nbsp;63.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.62&nbsp;–&nbsp;8.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.24&nbsp;–&nbsp;50.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05&nbsp;–&nbsp;0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.907</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.98</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.17</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb123" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_wm_x_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.092e+05 | 1.092e+05 | 1.093e+05 |      0.986 |      0.831 | 0.917 | 12.892 | 14.933</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_wm_x_decoding)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, reading_decoding and
Grade (formula: reading_comprehension ~ 1 + working_memory * reading_decoding +
working_memory * Grade + reading_decoding * Grade). The model included
person_id as random effects (formula: list(~1 | person_id, ~0 + Grade |
person_id, ~0 + reading_decoding | person_id)). The model's total explanatory
power is substantial (conditional R2 = 0.99) and the part related to the fixed
effects alone (marginal R2) is of 0.83. The model's intercept, corresponding to
working_memory = 0, reading_decoding = 0 and Grade = 0, is at 60.79 (95% CI
[57.68, 63.90], t(11989) = 38.26, p &lt; .001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 10.74, 95% CI [7.85, 13.62], t(11989) = 7.30, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.96, 95% CI [7.62, 8.31], t(11989) = 45.16, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of Grade is statistically significant and positive (beta = 50.10,
95% CI [49.24, 50.97], t(11989) = 113.96, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of working memory × reading decoding is statistically significant
and negative (beta = -1.09, 95% CI [-1.41, -0.77], t(11989) = -6.73, p &lt; .001;
Std. beta = -0.03, 95% CI [-0.04, -0.02])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 5.58, 95% CI [4.95, 6.22], t(11989) = 17.23, p &lt; .001; Std.
beta = 0.08, 95% CI [0.07, 0.08])
  - The effect of reading decoding × Grade is statistically non-significant and
positive (beta = 3.08e-03, 95% CI [-0.05, 0.05], t(11989) = 0.12, p = 0.907;
Std. beta = 2.63e-04, 95% CI [-2.23e-03, 2.76e-03])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb127-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_wm_x_grade, fit_wm_x_decoding, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_wm_x_grade: reading_comprehension ~ 1 + working_memory * Grade + Grade * reading_decoding + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
fit_wm_x_decoding: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + reading_decoding * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                  npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_wm_x_grade      10 109289 109363 -54635   109269                         
fit_wm_x_decoding   11 109248 109329 -54613   109226 43.292  1  4.714e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_wm_x_grade, fit_wm_x_decoding, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------
fit_wm_x_decoding | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.933
fit_wm_x_grade    | lmerMod |      0.986 |      0.831 | 0.916 | 12.932 | 14.971

Name              | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------
fit_wm_x_decoding |       1.000 |        1.000 |       1.000 |            87.50%
fit_wm_x_grade    |    4.36e-10 |     4.37e-10 |    1.76e-08 |            12.50%</code></pre>
</div>
</div>
</section>
<section id="final-model" class="level2">
<h2 class="anchored" data-anchor-id="final-model">Final model</h2>
<p>Let’s remove the now non-significant level-1 interaction, which brings us to the true model we simulated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1">fit_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> working_memory <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_decoding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> person_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_level1)</span>
<span id="cb131-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit_final)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + working_memory * reading_decoding +  
    working_memory * Grade + ((1 | person_id) + (0 + Grade |  
    person_id) + (0 + reading_decoding | person_id))
   Data: d_level1

REML criterion at convergence: 109220.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3828 -0.5871 -0.0044  0.5850  3.0921 

Random effects:
 Groups      Name             Variance Std.Dev.
 person_id   (Intercept)      2460.165 49.600  
 person_id.1 Grade               2.241  1.497  
 person_id.2 reading_decoding    3.517  1.875  
 Residual                      222.953 14.932  
Number of obs: 12000, groups:  person_id, 2000

Fixed effects:
                                Estimate Std. Error t value
(Intercept)                      60.7239     1.4854  40.880
working_memory                   10.7375     1.4716   7.296
reading_decoding                  7.9683     0.1640  48.599
Grade                            50.1376     0.3272 153.240
working_memory:reading_decoding  -1.0912     0.1620  -6.734
working_memory:Grade              5.5824     0.3233  17.265

Correlation of Fixed Effects:
            (Intr) wrkng_ rdng_d Grade  wrk_:_
workng_mmry  0.045                            
redng_dcdng -0.621 -0.039                     
Grade        0.587  0.043 -0.932              
wrkng_mmr:_ -0.039 -0.619 -0.018  0.012       
wrkng_mmr:G  0.042  0.584  0.012 -0.010 -0.931</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(fit_final)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading comprehension</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">60.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">57.81&nbsp;–&nbsp;63.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">10.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.85&nbsp;–&nbsp;13.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.65&nbsp;–&nbsp;8.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">50.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">49.50&nbsp;–&nbsp;50.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × reading<br>decoding</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.41&nbsp;–&nbsp;-0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">working memory × Grade</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.95&nbsp;–&nbsp;6.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">222.95</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2460.16</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.Grade</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2.24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>person_id.reading_decoding</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.52</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.92</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>person_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">2000</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">12000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.831 / 0.986</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb134" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_performance</span>(fit_final)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------------
1.092e+05 | 1.092e+05 | 1.093e+05 |      0.986 |      0.831 | 0.917 | 12.892 | 14.932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_final)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with working_memory, reading_decoding and
Grade (formula: reading_comprehension ~ 1 + working_memory * reading_decoding +
working_memory * Grade). The model included person_id as random effects
(formula: list(~1 | person_id, ~0 + Grade | person_id, ~0 + reading_decoding |
person_id)). The model's total explanatory power is substantial (conditional R2
= 0.99) and the part related to the fixed effects alone (marginal R2) is of
0.83. The model's intercept, corresponding to working_memory = 0,
reading_decoding = 0 and Grade = 0, is at 60.72 (95% CI [57.81, 63.64],
t(11990) = 40.88, p &lt; .001). Within this model:

  - The effect of working memory is statistically significant and positive (beta
= 10.74, 95% CI [7.85, 13.62], t(11990) = 7.30, p &lt; .001; Std. beta = 0.10, 95%
CI [0.08, 0.12])
  - The effect of reading decoding is statistically significant and positive
(beta = 7.97, 95% CI [7.65, 8.29], t(11990) = 48.60, p &lt; .001; Std. beta =
0.22, 95% CI [0.21, 0.23])
  - The effect of Grade is statistically significant and positive (beta = 50.14,
95% CI [49.50, 50.78], t(11990) = 153.24, p &lt; .001; Std. beta = 0.67, 95% CI
[0.66, 0.68])
  - The effect of working memory × reading decoding is statistically significant
and negative (beta = -1.09, 95% CI [-1.41, -0.77], t(11990) = -6.73, p &lt; .001;
Std. beta = -0.03, 95% CI [-0.04, -0.02])
  - The effect of working memory × Grade is statistically significant and
positive (beta = 5.58, 95% CI [4.95, 6.22], t(11990) = 17.27, p &lt; .001; Std.
beta = 0.08, 95% CI [0.07, 0.08])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare with main effects model (note refit = F because we are comparing random effects)</span></span>
<span id="cb138-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fit_wm_x_decoding, fit_final, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d_level1
Models:
fit_final: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
fit_wm_x_decoding: reading_comprehension ~ 1 + working_memory * reading_decoding + working_memory * Grade + reading_decoding * Grade + ((1 | person_id) + (0 + Grade | person_id) + (0 + reading_decoding | person_id))
                  npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)
fit_final           10 109240 109314 -54610   109220                    
fit_wm_x_decoding   11 109248 109329 -54613   109226     0  1          1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(fit_wm_x_decoding, fit_final, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              |   Model | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------------------------------------------
fit_final         | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.932
fit_wm_x_decoding | lmerMod |      0.986 |      0.831 | 0.917 | 12.892 | 14.933

Name              | AIC weights | AICc weights | BIC weights | Performance-Score
--------------------------------------------------------------------------------
fit_final         |       0.730 |        0.730 |       0.991 |           100.00%
fit_wm_x_decoding |       0.270 |        0.270 |       0.009 |             0.00%</code></pre>
</div>
</div>
<p>In this plot, we can see that Reading Decoding’s effect is steeper for individuals with lower working memory:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_final, </span>
<span id="cb142-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb142-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-1, 0, 1]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>),</span>
<span id="cb142-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Effect of Reading Decoding on Reading Comprehension</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> at Different Levels of Working Memory and Grade"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/fit_finalplot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>An alternate view of the same model suggests that the effect of working memory on reading comprehension is minimal in Kindergarten (Grade 0) and 1st grade when the focus is more on reading letters, single words, and very short sentences. However as the focus moves to longer, more complex sentences and paragraphs, the effect of Working Memory on Reading Comprehension increases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_final, </span>
<span id="cb143-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb143-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-2, 2]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding [5, 10, 15]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>),</span>
<span id="cb143-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Effect of Working Memory on Reading Comprehension</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> at Different Levels of Reading Decoding and Grade"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/plotwmbygradefinal-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Another view of the same model suggests that students with higher Working Memory have faster Reading Comprehension growth rates, even after controlling for Reading Decoding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit_final, </span>
<span id="cb144-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb144-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grade [0:5]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"working_memory [-1, 0, 1]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_decoding [5, 10, 15]"</span>),</span>
<span id="cb144-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Effect of Working Memory on Reading Comprehension</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> at Different Levels of Reading Decoding and Grade"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb144-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Longitudinal/longitudinal_files/figure-html/plotwmbygradefinal2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="callout-info" title="Reflect">
<p>How this method could be used in your own research?</p>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/Longitudinal/longitudinal.html</guid>
  <pubDate>Tue, 11 Mar 2025 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Simulation for Multilevel Models</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/DataSimulation/data_simulation.html</link>
  <description><![CDATA[ 





<p>Once you learn how to simulate data, you will possess a data-science superpower. Generating simulated data allows you to run complicated “What-If” thought experiments, which can help identify implications of models, methods, and procedures that are otherwise difficult to discern. For example, you can ask, if my hypothesized model is correct, what sample size will I need to detect my hypothesized results? Of course, this is what power analysis is for. However, there are many models for which no analytic solution exists, and only simulated data can generate approximate answers to your questions.</p>
<p>Simulated data can help you understand implicit implications of statistical procedures. For example, you might have heard that ANOVA is robust to mild to moderate violations of the normality assumption. How do we know this? Scholars simulated data with normal and non-normal residuals, and found that ANOVA generally came to the correct decision except when the normality assumption was violated to extreme degrees.</p>
<p>Simulated data can help you understand non-obvious implications of complex decisions. For example, Schneider &amp; Roman (2018) used simulated data to show that some well-intentioned diagnostic procedures cause diagnosis of learning disabilities to be less accurate, not more.</p>
<p>Simulated data have a primary limitation: they can only tell you about truths implicit in your model, method, or procedure. To observe genuinely new truths, you must observe genuinely new data.</p>
<section id="univariate-data" class="level1">
<h1>Univariate Data</h1>
<p>Sometimes we need to generate simulated data one variable at a time. Let’s generate 5 points from a normal distribution with a mean of 50 and a standard deviation of 10:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67.30920 41.82210 43.08040 46.17178 54.89969</code></pre>
</div>
</div>
<p>Of course, as long as the order of your parameters is what R expects, you can write this code more succinctly like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.82466 30.79626 60.79281 49.26028 38.71159</code></pre>
</div>
</div>
<p>Let’s generate many cases and see if the plot looks normal. We need to put the variable in a tibble because ggplot needs its input to be in a data.frame or tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>That looks reasonably normal.</p>
</section>
<section id="multivariate-data" class="level1 page-columns page-full">
<h1>Multivariate Data</h1>
<p>Suppose that we need to generate three variables <em>x</em>, <em>y</em>, and <em>z</em> with means of 50, 75, and 80, and standard deviations of 5, 8 and 9. <em>x</em> and <em>y</em> correlate at 0.6, <em>x</em> and <em>z</em> correlate at 0.7, and <em>y</em> and <em>z</em> correlate at 0.8. The mvtnorm package can help us.</p>
<section id="specify-means" class="level2">
<h2 class="anchored" data-anchor-id="specify-means">Specify Means</h2>
<p>You already know how to set up a vector with the <code>c</code> function. We are going to create a named vector of means. That is, we are going to associate the mean values with their respective variable names. The reason we are doing this is that when we set the mean vector with names, the data generating function will automatically name the columns.</p>
<p>There are, of course, several ways to give vector elements names. Pick one that you like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Supply names directly. Does the job with the least typing.</span></span>
<span id="cb6-2">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using the names function.</span></span>
<span id="cb6-5">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>)</span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(m) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z"</span>)</span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using the names function after a pipe:</span></span>
<span id="cb6-9">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names&lt;-</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z"</span>))</span>
<span id="cb6-11"></span>
<span id="cb6-12">m</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> x  y  z 
50 75 80 </code></pre>
</div>
</div>
</section>
<section id="specify-standard-deviations" class="level2">
<h2 class="anchored" data-anchor-id="specify-standard-deviations">Specify Standard Deviations</h2>
<p>We set up the vector of standard deviations in the standard way, though you can apply names to it if you like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)</span></code></pre></div>
</div>
</section>
<section id="specify-the-correlation-matrix" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="specify-the-correlation-matrix">Specify the Correlation Matrix</h2>
<p>The <code>matrix</code> function takes a vector, and you tell it how many rows and columns the matrix has. If you omit the number of columns, it will figure out how many columns are needed from the number of elements in your vector. In this case, there are 3 elements and 3 rows, so it divides 9 elements by 3 rows and assumes there are 3 columns.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7BR%7D=%5Cleft%5B%5Cbegin%7Barray%7D%7Br%7D%201%20&amp;%20.6%20&amp;%20.7%20%5C%5C%20.6%20&amp;%201%20&amp;%20.8%20%5C%5C%20.7%20&amp;%20.8%20&amp;%201%5Cend%7Barray%7D%5Cright%5D"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation matrix</span></span>
<span id="cb9-2">R <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb9-3">             .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb9-4">             .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb9-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb9-6">R</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  1.0  0.6  0.7
[2,]  0.6  1.0  0.8
[3,]  0.7  0.8  1.0</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>In a <em>k</em>&nbsp;×&nbsp;<em>k</em> symmetric matrix, the number of redundant elements is</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bk(k-1)%7D%7B2%7D"></p>
</div></div><p>With a 3&nbsp;×&nbsp;3 matrix, it is easy to specify a symmetric matrix because there are only 3 redundant entries. However, imagine how tedious specifying a 20&nbsp;×&nbsp;20 matrix with 190 redundant entries would be. With larger matrices, consider specifying just the lower triangle of the matrix, and converting it to a full symmetric matrix using lavaan’s <code>lower2full</code> function. I believe this approach is not only less tedious but also less error-prone.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7BR%7D_%7B%5Ctext%7BLower%7D%7D=%5Cleft%5B%5Cbegin%7Barray%7D%7Br%7D%201%20&amp;%20%5C%5C%20.6%20&amp;%201%20%5C%5C%20.7%20&amp;%20.8%20&amp;%201%5Cend%7Barray%7D%5Cright%5D"></p>
<p>The input for lavaan’s <code>lav_matrix_lower2full</code> function is just a vector, but I put line breaks in it to mimic the configuration of the lower triangle of the matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">R <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lavaan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lav_matrix_lower2full</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-2">                                    .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-3">                                    .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</div>
</section>
<section id="convert-correlation-matrix-to-covariance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="convert-correlation-matrix-to-covariance-matrix">Convert Correlation Matrix to Covariance Matrix</h2>
<p>The covariance of <em>x</em> and <em>y</em> (<em>σ<sub>xy</sub></em>) is the product of the correlation of <em>x</em> and <em>y</em> (<em>r<sub>xy</sub></em>) and the standard deviations of <em>x</em> and <em>y</em>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Bxy%7D=r_%7Bxy%7D%5Csigma_x%5Csigma_y"></p>
<p>To convert a correlation matrix <em>R</em> into a covariance matrix <em>Σ</em> using just matrix algebra requires converting the standard deviations into a diagonal matrix <em>D</em> (i.e., standard deviations on the diagonal and zeroes everywhere else).</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7BD%7D=%5Cleft%5B%5Cbegin%7Barray%7D%7Bl%7D%20%5Csigma_x&amp;0%5C%5C0&amp;%5Csigma_y%20%5Cend%7Barray%7D%5Cright%5D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7B%5CSigma%20=%20DRD%7D"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using matrix operations:</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The diag function converts a vector to a diagonal matrix</span></span>
<span id="cb12-3">D <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(s)</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the correlation matrix to covariances</span></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The %*% function is the matrix multiplication operator</span></span>
<span id="cb12-7">Sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> D <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> R <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> D</span></code></pre></div>
</div>
<p>If this conversion process seems like a lot of work, lavaan’s <code>cor2cov</code> function is a quicker alternative:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">Sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lavaan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor2cov</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">R =</span> R, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sds =</span> s)</span></code></pre></div>
</div>
</section>
<section id="generate-multivariate-data" class="level2">
<h2 class="anchored" data-anchor-id="generate-multivariate-data">Generate Multivariate Data</h2>
<p>Now we are ready to generate our multivariate normal data. Let’s generate 1000 cases. The <code>rmvnorm</code> function outputs a matrix, so we usually need to convert it to a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mvtnorm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> m, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> Sigma) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb14-3"></span>
<span id="cb14-4">d</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 3
       x     y     z
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  47.0  65.7  84.6
 2  62.1  87.7  91.5
 3  44.6  72.0  82.5
 4  45.9  77.2  80.3
 5  58.4  80.2  87.2
 6  52.2  78.7  71.5
 7  55.0  86.7  91.4
 8  49.5  72.4  70.5
 9  48.0  56.3  62.3
10  46.5  68.5  74.9
# ℹ 990 more rows</code></pre>
</div>
</div>
<p>Let’s plot the simulated data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>If you want to add marginal density plots, ggExtra’s <code>ggMarginal</code> function looks nice to me.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Here we save a plot as a variable p</span></span>
<span id="cb17-2">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Marginal histograms will be added to our saved plot</span></span>
<span id="cb17-6">ggExtra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggMarginal</span>(p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"histogram"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="generate-data-based-on-structural-model" class="level1 page-columns page-full">
<h1>Generate Data Based on Structural Model</h1>
<p>If you need to simulate data based on a model, the <code>simulateData</code> function from lavaan is quite good. The <a href="https://simsem.org/">simsem package</a> takes this approach to the next level, with excellent functions for power analysis.</p>
<p>If you think about things in terms of standardized path coefficients, my own package, <a href="https://wjschne.github.io/simstandard/articles/simstandard_tutorial.html">simstandard</a>, may be what you are looking for. The advantage of this package is that you do not need to know what the error variances need to be to make the path coefficients standardized.</p>
<p>For example, in this model, we know what path coefficients we want, but we do not know what the error variances should be:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://wjschne.github.io/simstandard/articles/ModelFigure.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Standardized Model</figcaption>
</figure>
</div>
<p>Using <a href="https://lavaan.ugent.be/tutorial/syntax1.html">lavaan syntax</a>, we can specify the model like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(simstandard)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lavaan syntax for model</span></span>
<span id="cb18-4">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb18-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span id="cb18-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span id="cb18-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">B ~ 0.6 * A</span></span>
<span id="cb18-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb18-9"></span>
<span id="cb18-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data</span></span>
<span id="cb18-11">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sim_standardized</span>(m, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>)</span>
<span id="cb18-12"></span>
<span id="cb18-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display First 6 rows</span></span>
<span id="cb18-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
      A1     A2      A3      B1      B2     B3       A      B   e_A1   e_A2
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1  0.621  1.10   0.0201 -0.916   0.484  -0.750  0.275  -0.769  0.429 0.885 
2  0.383  0.916  0.464   0.574  -0.0765  0.349  1.05    0.175 -0.353 0.0734
3  0.366  2.00   1.75    1.04    0.181   0.640  1.73    1.57  -0.844 0.616 
4  0.107 -0.332 -0.602  -0.0403 -0.312  -0.869 -0.513  -0.198  0.466 0.0780
5 -0.383  0.535  0.463   0.672  -0.488  -0.866  0.265  -0.188 -0.568 0.323 
6  0.618  0.131 -0.507   0.304   1.05    0.413 -0.0974  0.932  0.686 0.209 
# ℹ 5 more variables: e_A3 &lt;dbl&gt;, e_B1 &lt;dbl&gt;, e_B2 &lt;dbl&gt;, e_B3 &lt;dbl&gt;, d_B &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display complete model with variances</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_complete</span>(m))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1
B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3
B ~ 0.6 * A

# Variances
A1 ~~ 0.51 * A1
A2 ~~ 0.36 * A2
A3 ~~ 0.19 * A3
B1 ~~ 0.168 * B1
B2 ~~ 0.36 * B2
B3 ~~ 0.19 * B3
A ~~ 1 * A
B ~~ 0.64 * B</code></pre>
</div>
</div>
<p>Let’s verify that the simulated data really has the right model. First we take the model and remove all the fixed coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">m_free <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fixed2free</span>(m)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(m_free)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>B ~ A
A =~ A1 + A2 + A3 + B1
B =~ B1 + B2 + B3</code></pre>
</div>
</div>
<p>Now we use lavaan to evaluate the data with the <code>m_free</code> model. The simulated data has the latent variables in the data frame. We need to remove them before this can work:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lavaan)</span>
<span id="cb24-2">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>A, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>B) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sem</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> m_free)</span>
<span id="cb24-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardized =</span> T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 28 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                        100000

Model Test User Model:
                                                      
  Test statistic                                 4.977
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.663

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  A =~                                                                  
    A1                1.000                               0.698    0.698
    A2                1.147    0.005  229.433    0.000    0.801    0.801
    A3                1.293    0.005  245.285    0.000    0.903    0.901
    B1                0.430    0.004  114.446    0.000    0.300    0.300
  B =~                                                                  
    B1                1.000                               0.703    0.701
    B2                1.144    0.005  239.772    0.000    0.804    0.801
    B3                1.285    0.005  249.032    0.000    0.903    0.901

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  B ~                                                                   
    A                 0.606    0.004  141.482    0.000    0.602    0.602

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .A1                0.512    0.003  195.297    0.000    0.512    0.513
   .A2                0.357    0.002  165.301    0.000    0.357    0.358
   .A3                0.190    0.002   97.715    0.000    0.190    0.189
   .B1                0.167    0.001  130.319    0.000    0.167    0.166
   .B2                0.360    0.002  178.343    0.000    0.360    0.358
   .B3                0.190    0.002  108.212    0.000    0.190    0.189
    A                 0.487    0.004  120.445    0.000    1.000    1.000
   .B                 0.315    0.003  124.590    0.000    0.638    0.638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">semPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">semPaths</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">what =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"std"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">layout =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circle"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>That looks like the model we specified.</p>
</section>
<section id="multilevel-data" class="level1 page-columns page-full">
<h1>Multilevel Data</h1>
<p>In generating multilevel data, we will use the techniques of generating both univariate and multivariate data.</p>
<section id="step-1-write-out-your-equations" class="level2">
<h2 class="anchored" data-anchor-id="step-1-write-out-your-equations">Step 1: Write Out Your Equations</h2>
<p>I cannot stress this point strongly enough. <strong>Taking the time to write your equations makes subsequent steps so much easier.</strong></p>
<p>Suppose we want to simulate data in which first-graders’ reading ability is predicted by their vocabulary measured at the beginning of the year and by their first grade teacher’s conscientiousness. Suppose that teacher conscientiousness is expected to help all students learn to read, but it is expected that teacher conscientiousness will be particularly important for students with low vocabulary. That is, the effect of teacher conscientiousness is expected to be stronger for students with low vocabulary compared to students with strong vocabulary. Thus, teacher conscientiousness will have an effect on vocabulary’s random slope.</p>
<p>So, we know that vocabulary is a level-1 variable, and teacher conscientiousness is a level-2 variable. Teacher conscientiousness is expected to have an effect on both the random intercept and vocabulary’s random slope.</p>
<p>Let’s write out the entire equations:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%5B1.5ex%5D%0AReading_%7Bij%7D&amp;=b_%7B0j%7D%20+%20b_%7B1j%7DV_%7Bij%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%5Cmathcal%7BN%7D(0,%5Ctau_1)%5C%5C%5B1.5ex%5D%0A%5Ctext%7BWhere%7D%5C%5C%0AReading_%7Bij%7D&amp;=%5Ctext%7BReading%20score%20for%20student%20%7D%20i%20%5Ctext%7B%20in%20class%20%7D%20%20j%5C%5C%0Ab_%7B0j%7D%20&amp;=%20%5Ctext%7BRandom%20intercept%20for%20class%20%7D%20j%5C%5C%0Ab_%7B1j%7D%20&amp;=%20%5Ctext%7BRandom%20slope%20for%20Vocabulary%20for%20class%20%7D%20j%5C%5C%0AV_%7Bij%7D&amp;=%5Ctext%7BVocabulary%20score%20for%20student%20%7D%20i%20%5Ctext%7B%20in%20class%20%7D%20%20j%5C%5C%0Ae_%7Bij%7D&amp;=%5Ctext%7BLevel-1%20error%20for%20student%20%7D%20i%20%5Ctext%7B%20in%20class%20%7D%20%20j%5C%5C%0A%5Ctau_1%20&amp;=%20%5Ctext%7BLevel-1%20Error%20Variance%7D%5C%5C%5B2ex%5D%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%5B1.5ex%5D%0Ab_%7B0j%7D&amp;=b_%7B00%7D%20+%20b_%7B01%7DC_%7Bj%7D+e_%7B0j%7D%5C%5C%0Ab_%7B1j%7D&amp;=b_%7B10%7D%20+%20b_%7B11%7DC_%7Bj%7D+e_%7B1j%7D%5C%5C%0A%5Cbegin%7Bbmatrix%7De_%7B0j%7D%5C%5Ce_%7B1j%7D%5Cend%7Bbmatrix%7D&amp;%5Csim%5Cmathcal%7BN%7D%5Cleft(%5Cbegin%7Bbmatrix%7D0%5C%5C%200%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bmatrix%7D%20%5C%5C%20,%5Cend%7Bmatrix%7D%5Cbegin%7Bbmatrix%7D%5Ctau_%7B00%7D&amp;%5C%5C%20%5Ctau_%7B10%7D&amp;%5Ctau_%7B11%7D%5Cend%7Bbmatrix%7D%5Cright)%5C%5C%5B1.5ex%5D%0A%5Ctext%7BWhere%7D%5C%5C%0Ab_%7B0j%7D%20&amp;=%20%5Ctext%7BRandom%20intercept%20for%20class%20%7D%20j%5C%5C%0Ab_%7B00%7D%20&amp;=%20%5Ctext%7BThe%20expected%20intercept%20when%20%7D%20C_j%20%5Ctext%7B%20is%200%7D%5C%5C%0Ab_%7B01%7D%20&amp;=%20%5Ctext%7BThe%20effect%20of%20%7D%20C_j%20%5Ctext%7B%20on%20the%20random%20intercept%7D%5C%5C%0AC_j%20&amp;=%20%5Ctext%7BTeacher%20conscientiousness%20in%20class%20%7D%20j%5C%5C%0Ae_%7B0j%7D%20&amp;=%20%5Ctext%7BThe%20random%20intercept's%20error%20for%20class%20%7D%20j%20%5C%5C%0Ab_%7B1j%7D%20&amp;=%20%5Ctext%7BRandom%20slope%20for%20Vocabulary%20for%20class%20%7D%20j%5C%5C%0Ab_%7B10%7D%20&amp;=%20%5Ctext%7BThe%20expected%20Vocabulary%20slope%20when%20%7D%20C_j%20%5Ctext%7B%20is%200%7D%5C%5C%0Ab_%7B11%7D%20&amp;=%20%5Ctext%7BThe%20effect%20of%20%7D%20C_j%20%5Ctext%7B%20on%20the%20Vocabulary%20slope%7D%5C%5C%0Ae_%7B1j%7D%20&amp;=%20%5Ctext%7BThe%20Vocabulary%20slope's%20error%20for%20class%20%7D%20j%20%5C%5C%0A%5Ctau_%7B00%7D%20&amp;=%20%5Ctext%7BThe%20variance%20of%20%7D%20e_%7B0j%7D%5C%5C%0A%5Ctau_%7B11%7D%20&amp;=%20%5Ctext%7BThe%20variance%20of%20%7D%20e_%7B1j%7D%5C%5C%0A%5Ctau_%7B10%7D%20&amp;=%20%5Ctext%7BThe%20covariance%20of%20%7D%20e_%7B0j%7D%20%5Ctext%7B%20and%20%7D%20e_%7B1j%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Combining the level-1 and level-2 formulas:</p>
<p><img src="https://latex.codecogs.com/png.latex?Reading_%7Bij%7D=%5Cunderbrace%7Bb_%7B00%7D%20+%20b_%7B01%7DC_%7Bj%7D+e_%7B0j%7D%7D_%7Bb_%7B0j%7D%7D%20+%20(%5Cunderbrace%7Bb_%7B10%7D%20+%20b_%7B11%7DC_%7Bj%7D+e_%7B1j%7D%7D_%7Bb_%7B1j%7D%7D)V_%7Bij%7D+e_%7Bij%7D"></p>
<p>By multiplying everything out, we can see exactly how everything needs to be calculated.</p>
<p><img src="https://latex.codecogs.com/png.latex?Reading_%7Bij%7D=b_%7B00%7D%20+%20b_%7B01%7DC_%7Bj%7D+e_%7B0j%7D%20+%20b_%7B10%7DV_%7Bij%7D%20+%20b_%7B11%7DC_%7Bj%7DV_%7Bij%7D+e_%7B1j%7DV_%7Bij%7D+e_%7Bij%7D"></p>
<p>Now we are ready!</p>
</section>
<section id="step-2-specify-all-model-parameters" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-2-specify-all-model-parameters">Step 2: Specify all model parameters</h2>
<section id="specifying-the-fixed-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-fixed-coefficients">Specifying the fixed coefficients</h3>
<p>In this case, we have four coefficients, and it is straightforward to specify them all.</p>
<p>Which values should you choose? That is determined by theory. With complex models like this one, sometimes there is a bit of trial-and-error to get parameter values that produce data that are consistent with the theory you have in mind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed coefficients</span></span>
<span id="cb27-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed intercept</span></span>
<span id="cb27-3">b_00 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb27-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Teacher conscientiousness effect on intercept</span></span>
<span id="cb27-5">b_01 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb27-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed slope for Vocabulary</span></span>
<span id="cb27-7">b_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb27-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Teacher conscientiousness effect on Vocabulary's slope</span></span>
<span id="cb27-9">b_11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span></code></pre></div>
</div>
</section>
<section id="specify-the-level-1-error-standard-deviation-or-variance" class="level3">
<h3 class="anchored" data-anchor-id="specify-the-level-1-error-standard-deviation-or-variance">Specify the level-1 error standard deviation (or variance)</h3>
<p>You need to remember whether you set this number up as a variance or as a standard deviation. I am setting it up as a variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-1 error variance</span></span>
<span id="cb28-2">tau_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span></code></pre></div>
</div>
</section>
<section id="specify-tau_2-the-level-2-error-covariance-matrix" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="specify-tau_2-the-level-2-error-covariance-matrix">Specify tau_2, the level-2 error covariance matrix</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7B%5Ctau%7D_2=%5Cbegin%7Bbmatrix%7D%5Ctau_%7B00%7D&amp;%5C%5C%20%5Ctau_%7B10%7D&amp;%5Ctau_%7B11%7D%5Cend%7Bbmatrix%7D"></p>
<p>I have written out the <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7B%5Ctau%7D_2"> matrix showing only the lower triangle of the matrix because the upper triangle is redundant. I think it is safer to write the lower triangle rather than specifying the full matrix with its duplicate covariancs.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Specifying the full matrix would look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(tau_00, tau_10,</span>
<span id="cb29-3">    tau_10, tau_11), </span>
<span id="cb29-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</div>
</div></div><p>We can create the <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7B%5Ctau%7D_2"> matrix like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance of intercepts</span></span>
<span id="cb30-2">tau_00 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb30-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance of Vocabulary slope</span></span>
<span id="cb30-4">tau_11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb30-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation of intercepts and Vocabulary slopes</span></span>
<span id="cb30-6">r_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb30-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Covariance of intercepts and slopes</span></span>
<span id="cb30-8">tau_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(tau_00 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> tau_11) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r_10</span>
<span id="cb30-9"></span>
<span id="cb30-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tau lower triangle in vector form</span></span>
<span id="cb30-11">tau_lower_triangle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(tau_00,</span>
<span id="cb30-12">                        tau_10, tau_11)</span>
<span id="cb30-13"></span>
<span id="cb30-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert lower triangle to a full symmetric matrix</span></span>
<span id="cb30-15">tau_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lavaan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lav_matrix_lower2full</span>(tau_lower_triangle)</span></code></pre></div>
</div>
</section>
</section>
<section id="step-2-simulate-the-level-2-variables." class="level2">
<h2 class="anchored" data-anchor-id="step-2-simulate-the-level-2-variables.">Step 2: Simulate the level-2 variables.</h2>
<section id="how-many-level-2-clusters-will-there-be" class="level3">
<h3 class="anchored" data-anchor-id="how-many-level-2-clusters-will-there-be">How many level-2 clusters will there be?</h3>
<p>It is generally best to start with a small number so that you simulations will run quickly. You can increase the number of clusters later. Let’s start with 100 groups. We will use the variable <code>k</code> to refer to the number of clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of clusters</span></span>
<span id="cb31-2">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb31-3"></span>
<span id="cb31-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cluster ID variable</span></span>
<span id="cb31-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Makes a sequence from 1 to k</span></span>
<span id="cb31-6">cluster_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(k)</span></code></pre></div>
</div>
</section>
<section id="how-many-people-in-each-cluster" class="level3">
<h3 class="anchored" data-anchor-id="how-many-people-in-each-cluster">How many people in each cluster?</h3>
<p><strong>Option 1</strong> Every cluster has the same size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Every class has 28 students</span></span>
<span id="cb32-2">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span></span></code></pre></div>
</div>
<p><strong>Option 2</strong> Cluster size is determined by a random variable.</p>
<p>Which random variable? It is up to you. Some common choices include the normal distribution, Poisson distribution, or the uniform distribution.</p>
<ol type="A">
<li><em>Use the normal distribution, and round to the nearest integer.</em> With small means and/or large standard deviations, there is a chance that you will have cluster sizes less than one, so you will want to plan for that. <br><br>To make sure we never have a cluster size less than 1, we will use the <code>pmax</code> function. It replaces any vector element less than the lower limit with the lower limit. For example:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 1 1 4</code></pre>
</div>
</div>
<p>Here we generate a normal variate with a mean of 28 and a standard deviation of 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(k, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb35-4"> </span>
<span id="cb35-5"></span>
<span id="cb35-6">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(cluster_id, cluster_size)</span>
<span id="cb35-7"></span>
<span id="cb35-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cluster_size)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="A">
<li><em>Use the Poisson distribution to create integers with a mean (and variance) of λ.</em> With a small λ, it is possible to have cluster sizes of zero.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(k, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb36-3"></span>
<span id="cb36-4">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(cluster_id, cluster_size)</span>
<span id="cb36-5"></span>
<span id="cb36-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cluster_size)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb36-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The binomial distribution is also a good choice for generating non-negative numbers.</p>
<ol start="3" type="A">
<li>Use the <code>sample</code> function to have cluster sizes uniformly distributed between 2 values.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> k, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb37-2"></span>
<span id="cb37-3">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(cluster_id, cluster_size)</span>
<span id="cb37-4"></span>
<span id="cb37-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cluster_size)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>() </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Option 3</strong> Make your own distribution function.</p>
<ol type="A">
<li>If you know the probability of each member of your sample space, you can specify each probability in the <code>prob</code> argument in the <code>sample</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A tribble is a "transposed tibble" that is easy to view.</span></span>
<span id="cb38-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I pasted it directly from Excel using the datapasta RStudio addin</span></span>
<span id="cb38-3">d_probs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(</span>
<span id="cb38-4">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>sample_space, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>probability,</span>
<span id="cb38-5">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb38-6">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>,</span>
<span id="cb38-7">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span>,</span>
<span id="cb38-8">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>,</span>
<span id="cb38-9">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span>,</span>
<span id="cb38-10">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span>,</span>
<span id="cb38-11">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span>,</span>
<span id="cb38-12">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>,</span>
<span id="cb38-13">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>,</span>
<span id="cb38-14">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">34</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb38-15">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>L,         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb38-16"></span>
<span id="cb38-17"></span>
<span id="cb38-18">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(</span>
<span id="cb38-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> d_probs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sample_space, </span>
<span id="cb38-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> d_probs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>probability,</span>
<span id="cb38-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> k, </span>
<span id="cb38-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb38-23"></span>
<span id="cb38-24">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(cluster_id, cluster_size)</span>
<span id="cb38-25"></span>
<span id="cb38-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cluster_size)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="A">
<li>If you have real data that you want to mimic, you can use the <code>sample</code> function to generate new data with the same proportions as the real data.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pretend that x is a vector with real data on class sizes. </span></span>
<span id="cb39-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also pretend that we do not know how it was made. </span></span>
<span id="cb39-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All we know is the data in x.</span></span>
<span id="cb39-4"></span>
<span id="cb39-5">d_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.))</span>
<span id="cb39-8"></span>
<span id="cb39-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate new data based on same proportions</span></span>
<span id="cb39-10">cluster_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> d_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb39-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> k,</span>
<span id="cb39-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb39-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> d_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>probability) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>()</span>
<span id="cb39-15"></span>
<span id="cb39-16">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(cluster_id, cluster_size)</span>
<span id="cb39-17"></span>
<span id="cb39-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cluster_size)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulate-level-2-error-terms." class="level3">
<h3 class="anchored" data-anchor-id="simulate-level-2-error-terms.">Simulate level-2 error terms.</h3>
<p>We will use the <em>τ</em> matrix to simulate <em>u</em><sub>0<em>j</em></sub> and <em>u</em><sub>1<em>j</em></sub>.</p>
<p>Recall that</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bbmatrix%7De_%7B0j%7D%5C%5Ce_%7B1j%7D%5Cend%7Bbmatrix%7D%5Csim%5Cmathcal%7BN%7D%5Cleft(%5Cbegin%7Bbmatrix%7D0%5C%5C%200%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bmatrix%7D%20%5C%5C%20,%5Cend%7Bmatrix%7D%5Cbegin%7Bbmatrix%7D%5Ctau_%7B00%7D&amp;%5C%5C%20%5Ctau_%7B10%7D&amp;%5Ctau_%7B11%7D%5Cend%7Bbmatrix%7D%5Cright)"></p>
<p>Create level-2 error terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">u <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(k, </span>
<span id="cb40-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e_0j =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e_1j =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb40-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> tau_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb40-5"></span>
<span id="cb40-6">u</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
     e_0j   e_1j
    &lt;dbl&gt;  &lt;dbl&gt;
 1 -10.8  -0.255
 2  36.7  -0.375
 3 -36.0   0.600
 4  40.4  -0.617
 5  49.8  -0.148
 6  17.8  -0.369
 7  15.6   0.448
 8  24.1  -0.304
 9   7.26  0.374
10 -12.6   0.256
# ℹ 90 more rows</code></pre>
</div>
</div>
</section>
<section id="simulate-level-2-predictors" class="level3">
<h3 class="anchored" data-anchor-id="simulate-level-2-predictors">Simulate level-2 predictors</h3>
<p>How you simulate the level-2 predictors depends on theory. Personality variables like conscientiousness usually have a normal distribution. I am going to make things simple by creating a standard normal variate (mean = 0, sd = 1).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">C_j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(k)</span></code></pre></div>
</div>
</section>
<section id="compute-all-level-2-data-in-one-sequence-of-steps." class="level3">
<h3 class="anchored" data-anchor-id="compute-all-level-2-data-in-one-sequence-of-steps.">Compute all level-2 data in one sequence of steps.</h3>
<p>The <code>bind_cols</code> function binds the columns of two data.frames (or tibbles).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">d2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>k,</span>
<span id="cb43-2">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(k, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb43-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_j =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(k)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb43-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(u) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb43-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_0j =</span> b_00 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_01 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e_0j,</span>
<span id="cb43-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_1j =</span> b_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_11 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e_1j)</span>
<span id="cb43-7">d2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 7
   cluster_id cluster_size     C_j   e_0j   e_1j  b_0j  b_1j
        &lt;int&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1          1           30  1.45   -10.8  -0.255  518.  23.9
 2          2           30 -0.889   36.7  -0.375  519.  33.2
 3          3           28 -0.0361 -36.0   0.600  463.  30.7
 4          4           36 -0.615   40.4  -0.617  528.  31.8
 5          5           34 -0.332   49.8  -0.148  543.  31.2
 6          6           26  0.434   17.8  -0.369  526.  27.9
 7          7           29 -2.40    15.6   0.448  468.  40.1
 8          8           25 -0.379   24.1  -0.304  516.  31.2
 9          9           25  1.42     7.26  0.374  536.  24.7
10         10           25  0.288  -12.6   0.256  493.  29.1
# ℹ 90 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="step-3-simulate-level-1-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3-simulate-level-1-data">Step 3: Simulate Level-1 Data</h2>
<section id="convert-level-2-data-to-level-1-data" class="level3">
<h3 class="anchored" data-anchor-id="convert-level-2-data-to-level-1-data">Convert Level-2 Data to Level-1 Data</h3>
<p>The <code>uncount</code> function makes this step easy. It duplicates a row the number of times specified in the weights variable—the cluster size in this case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">d1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uncount</span>(cluster_size)</span>
<span id="cb45-3"></span>
<span id="cb45-4">d1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,842 × 6
   cluster_id   C_j  e_0j   e_1j  b_0j  b_1j
        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1          1  1.45 -10.8 -0.255  518.  23.9
 2          1  1.45 -10.8 -0.255  518.  23.9
 3          1  1.45 -10.8 -0.255  518.  23.9
 4          1  1.45 -10.8 -0.255  518.  23.9
 5          1  1.45 -10.8 -0.255  518.  23.9
 6          1  1.45 -10.8 -0.255  518.  23.9
 7          1  1.45 -10.8 -0.255  518.  23.9
 8          1  1.45 -10.8 -0.255  518.  23.9
 9          1  1.45 -10.8 -0.255  518.  23.9
10          1  1.45 -10.8 -0.255  518.  23.9
# ℹ 2,832 more rows</code></pre>
</div>
</div>
</section>
<section id="compute-the-level-1-error-term-and-the-level-1-covariates." class="level3">
<h3 class="anchored" data-anchor-id="compute-the-level-1-error-term-and-the-level-1-covariates.">Compute the level-1 error term and the level-1 covariates.</h3>
<p>The <code>rnorm</code> function needs to know how many rows there are. Because the number of rows was generated randomly, we do not usually know how many rows there will be. Fortunately, we can use the <code>nrow</code> function, which tells us how many rows are in a data frame. The dot in the phrase <code>nrow(.)</code> the data.frame that was piped into the <code>mutate</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">d1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb47-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V_ij =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.)),</span>
<span id="cb47-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(tau_1)))</span>
<span id="cb47-4">d1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,842 × 8
   cluster_id   C_j  e_0j   e_1j  b_0j  b_1j    V_ij     e
        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1          1  1.45 -10.8 -0.255  518.  23.9 -1.03   -1.69
 2          1  1.45 -10.8 -0.255  518.  23.9 -0.320   2.66
 3          1  1.45 -10.8 -0.255  518.  23.9  0.415   5.41
 4          1  1.45 -10.8 -0.255  518.  23.9 -0.601   1.19
 5          1  1.45 -10.8 -0.255  518.  23.9 -0.372   3.37
 6          1  1.45 -10.8 -0.255  518.  23.9 -0.0809  1.08
 7          1  1.45 -10.8 -0.255  518.  23.9 -1.99    3.95
 8          1  1.45 -10.8 -0.255  518.  23.9 -1.11    3.87
 9          1  1.45 -10.8 -0.255  518.  23.9  1.47    3.04
10          1  1.45 -10.8 -0.255  518.  23.9 -2.42   -5.74
# ℹ 2,832 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="simulate-the-outcome-variable" class="level2">
<h2 class="anchored" data-anchor-id="simulate-the-outcome-variable">Simulate the outcome variable</h2>
<p>If we have written out the level-1 equation, this step is easy.</p>
<p><img src="https://latex.codecogs.com/png.latex?Reading_%7Bij%7D=b_%7B0j%7D%20+%20b_%7B1j%7DV_%7Bij%7D+e_%7Bij%7D"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1">d1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb49-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Reading =</span> b_0j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> V_ij <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e)</span>
<span id="cb49-3">d1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,842 × 9
   cluster_id   C_j  e_0j   e_1j  b_0j  b_1j    V_ij     e Reading
        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1          1  1.45 -10.8 -0.255  518.  23.9 -1.03   -1.69    492.
 2          1  1.45 -10.8 -0.255  518.  23.9 -0.320   2.66    513.
 3          1  1.45 -10.8 -0.255  518.  23.9  0.415   5.41    534.
 4          1  1.45 -10.8 -0.255  518.  23.9 -0.601   1.19    505.
 5          1  1.45 -10.8 -0.255  518.  23.9 -0.372   3.37    513.
 6          1  1.45 -10.8 -0.255  518.  23.9 -0.0809  1.08    517.
 7          1  1.45 -10.8 -0.255  518.  23.9 -1.99    3.95    475.
 8          1  1.45 -10.8 -0.255  518.  23.9 -1.11    3.87    496.
 9          1  1.45 -10.8 -0.255  518.  23.9  1.47    3.04    557.
10          1  1.45 -10.8 -0.255  518.  23.9 -2.42   -5.74    454.
# ℹ 2,832 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="all-the-code-in-one-place" class="level1">
<h1>All the code in one place</h1>
<p>In the context of this tutorial, it might seem like the number of steps was really, really long. It is not actually all that bad. Let’s see what things look like put together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)</span>
<span id="cb51-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(tidyverse, mvtnorm, lavaan, lme4)</span>
<span id="cb51-3"></span>
<span id="cb51-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of clusters</span></span>
<span id="cb51-5">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb51-6"></span>
<span id="cb51-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed coefficients</span></span>
<span id="cb51-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed intercept</span></span>
<span id="cb51-9">b_00 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb51-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Teacher conscientiousness effect on intercept</span></span>
<span id="cb51-11">b_01 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb51-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed slope for Vocabulary</span></span>
<span id="cb51-13">b_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb51-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Teacher conscientiousness effect on Vocabulary's slope</span></span>
<span id="cb51-15">b_11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb51-16"></span>
<span id="cb51-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-1 error standard deviation</span></span>
<span id="cb51-18">tau_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb51-19"></span>
<span id="cb51-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Random variances</span></span>
<span id="cb51-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance of intercepts</span></span>
<span id="cb51-22">tau_00 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb51-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance of Vocabulary slope</span></span>
<span id="cb51-24">tau_11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb51-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation of intercepts and Vocabulary slopes</span></span>
<span id="cb51-26">r_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb51-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Covariance of intercepts and Vocabulary slopes</span></span>
<span id="cb51-28">tau_10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(tau_00 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> tau_11) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r_10</span>
<span id="cb51-29"></span>
<span id="cb51-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-2 covariance matrix</span></span>
<span id="cb51-31">tau_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lav_matrix_lower2full</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(tau_00,</span>
<span id="cb51-32">                               tau_10, tau_11))</span>
<span id="cb51-33"></span>
<span id="cb51-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-2 error terms</span></span>
<span id="cb51-35">u <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(k, </span>
<span id="cb51-36">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e_0j =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e_1j =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb51-37">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> tau_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb51-39"></span>
<span id="cb51-40"></span>
<span id="cb51-41">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>k),</span>
<span id="cb51-42">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(k, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb51-43">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_j =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(k)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(u) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_0j =</span> b_00 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_01 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e_0j,</span>
<span id="cb51-46">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_1j =</span> b_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_11 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e_1j) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uncount</span>(cluster_size) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V_ij =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.)), </span>
<span id="cb51-49">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(tau_1)),</span>
<span id="cb51-50">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Reading =</span> b_0j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> V_ij <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e,</span>
<span id="cb51-51">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(cluster_id, C_j))</span></code></pre></div>
</div>
</section>
<section id="model-the-data" class="level1">
<h1>Model the data</h1>
<p>Let’s see what our simulated data look like</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Final model</span></span>
<span id="cb52-2">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(Reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> V_ij <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> V_ij <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> cluster_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb52-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Reading ~ 1 + C_j * V_ij + (1 + V_ij | cluster_id)
   Data: d

REML criterion at convergence: 59808.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.7672 -0.6602  0.0046  0.6449  3.3959 

Random effects:
 Groups     Name        Variance  Std.Dev. Corr 
 cluster_id (Intercept)  574.5203 23.9692       
            V_ij           0.4954  0.7038  -1.00
 Residual               2511.8457 50.1183       
Number of obs: 5571, groups:  cluster_id, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 501.3340     1.8740 267.527
C_j          20.9674     1.7940  11.687
V_ij         29.6150     0.7018  42.199
C_j:V_ij     -3.7965     0.6615  -5.739

Correlation of Fixed Effects:
         (Intr) C_j    V_ij  
C_j       0.222              
V_ij     -0.072 -0.010       
C_j:V_ij -0.010 -0.079  0.214
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p>We see that our fixed effect and random variance estimates are reasonably close to our population parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fncvndvyhh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fncvndvyhh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fncvndvyhh thead, #fncvndvyhh tbody, #fncvndvyhh tfoot, #fncvndvyhh tr, #fncvndvyhh td, #fncvndvyhh th {
  border-style: none;
}

#fncvndvyhh p {
  margin: 0;
  padding: 0;
}

#fncvndvyhh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fncvndvyhh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fncvndvyhh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fncvndvyhh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fncvndvyhh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fncvndvyhh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fncvndvyhh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fncvndvyhh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fncvndvyhh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fncvndvyhh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fncvndvyhh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fncvndvyhh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fncvndvyhh .gt_spanner_row {
  border-bottom-style: hidden;
}

#fncvndvyhh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fncvndvyhh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fncvndvyhh .gt_from_md > :first-child {
  margin-top: 0;
}

#fncvndvyhh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fncvndvyhh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fncvndvyhh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fncvndvyhh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fncvndvyhh .gt_row_group_first td {
  border-top-width: 2px;
}

#fncvndvyhh .gt_row_group_first th {
  border-top-width: 2px;
}

#fncvndvyhh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fncvndvyhh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fncvndvyhh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fncvndvyhh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fncvndvyhh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fncvndvyhh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fncvndvyhh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fncvndvyhh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fncvndvyhh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fncvndvyhh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fncvndvyhh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fncvndvyhh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fncvndvyhh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fncvndvyhh .gt_left {
  text-align: left;
}

#fncvndvyhh .gt_center {
  text-align: center;
}

#fncvndvyhh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fncvndvyhh .gt_font_normal {
  font-weight: normal;
}

#fncvndvyhh .gt_font_bold {
  font-weight: bold;
}

#fncvndvyhh .gt_font_italic {
  font-style: italic;
}

#fncvndvyhh .gt_super {
  font-size: 65%;
}

#fncvndvyhh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fncvndvyhh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fncvndvyhh .gt_indent_1 {
  text-indent: 5px;
}

#fncvndvyhh .gt_indent_2 {
  text-indent: 10px;
}

#fncvndvyhh .gt_indent_3 {
  text-indent: 15px;
}

#fncvndvyhh .gt_indent_4 {
  text-indent: 20px;
}

#fncvndvyhh .gt_indent_5 {
  text-indent: 25px;
}

#fncvndvyhh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fncvndvyhh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Effect" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Effect</th>
<th id="Parameter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Parameter</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Estimate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Effect">(b_{00})</td>
<td class="gt_row gt_right" headers="Parameter">500</td>
<td class="gt_row gt_right" headers="Estimate">501.33</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect">(b_{01})</td>
<td class="gt_row gt_right" headers="Parameter">20</td>
<td class="gt_row gt_right" headers="Estimate">20.97</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Effect">(b_{10})</td>
<td class="gt_row gt_right" headers="Parameter">30</td>
<td class="gt_row gt_right" headers="Estimate">29.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect">(b_{11})</td>
<td class="gt_row gt_right" headers="Parameter">-4</td>
<td class="gt_row gt_right" headers="Estimate">−3.80</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Effect">(_{00})</td>
<td class="gt_row gt_right" headers="Parameter">625</td>
<td class="gt_row gt_right" headers="Estimate">574.52</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect">(_{10})</td>
<td class="gt_row gt_right" headers="Parameter">-4</td>
<td class="gt_row gt_right" headers="Estimate">−16.87</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Effect">(_{11})</td>
<td class="gt_row gt_right" headers="Parameter">0.16</td>
<td class="gt_row gt_right" headers="Estimate">0.50</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Not bad. The variance components look a bit off. I am not showing the results here, but when I increased the level 1 and level 2 sample sizes to much larger values, the tau matrix approximated the correct values. The model took a looooooong time to run. However, it was worth the wait because I now have confidence that the data are being generated correctly.</p>
</section>
<section id="plot-the-data" class="level1">
<h1>Plot the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(fit, </span>
<span id="cb54-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb54-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V_ij"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C_j"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb54-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vocabulary"</span>, </span>
<span id="cb54-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Teacher</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Conscientiousness"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Alternately, make the plot yourself</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">d_augmented <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> broom.mixed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(fit)</span>
<span id="cb55-2"></span>
<span id="cb55-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make fitted values for conditional slopes</span></span>
<span id="cb55-4">d_conditional_slope_v <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> broom.mixed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(</span>
<span id="cb55-5">  fit, </span>
<span id="cb55-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_j =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span id="cb55-7">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V_ij =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb55-8">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb55-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Reading =</span> .fitted)</span>
<span id="cb55-10"></span>
<span id="cb55-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_augmented, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(V_ij, Reading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_conditional_slope_v, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> C_j, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> C_j)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> C_j)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb55-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vocabulary"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Teacher</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Conscientiousness"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/DataSimulation/data_simulation_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulation-packages" class="level1">
<h1>Simulation packages</h1>
<p>There are many R packages for simulating multilevel data. I recommend checking out <a href="https://github.com/pitakakariki/simr">simr</a> and <a href="https://kgoldfeld.github.io/simstudy/">simstudy</a>.</p>


</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/DataSimulation/data_simulation.html</guid>
  <pubDate>Tue, 25 Feb 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Generalized Linear Mixed Models</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models.html</link>
  <description><![CDATA[ 





<p>Some outcome variables are incompatible with the general linear model’s normality assumption. Binary outcomes cannot possibly have normally distributed error terms. Generalized linear models allow us to predict outcomes that have non-normal errors. If you know how to analyze linear mixed models, and you understand generalized linear models, generalized linear mixed models require very little additional learning to get started.</p>
<p>A generalized linear model has one or more random response (outcome) variables <img src="https://latex.codecogs.com/png.latex?(%5Cboldsymbol%7BY%7D)">, one or predictor variables <img src="https://latex.codecogs.com/png.latex?X"> that are combined optimally using a set of coefficients <img src="https://latex.codecogs.com/png.latex?B">, and a link function, <img src="https://latex.codecogs.com/png.latex?g">, that specifies the relationship between the predictors and the expected value of the response variables conditioned on the predictor variables:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ag%5Cleft(%5Cmathcal%7BE%7D%5Cleft(%5Cboldsymbol%7BY%7D%7C%5Cboldsymbol%7BXB%7D%5Cright)%5Cright)=%5Cboldsymbol%7BXB%7D%0A"> The inverse of the link function <img src="https://latex.codecogs.com/png.latex?g"> (i.e., <img src="https://latex.codecogs.com/png.latex?g%5E%7B-1%7D">) is called the <em>mean function</em> because it transforms the linear combination of the predictors to the expected value (i.e., the mean) of the response variable.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BE%7D%5Cleft(%5Cboldsymbol%7BY%7D%7C%5Cboldsymbol%7BXB%7D%5Cright)=g%5E%7B-1%7D%5Cleft(%5Cboldsymbol%7BXB%7D%5Cright)%0A"></p>
<p>The generalized linear mixed model is very similar to the generalized linear model, except that it adds a random component:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BE%7D%5Cleft(%5Cboldsymbol%7BY%7D%7C%5Cboldsymbol%7BXB%7D%5Cright)=g%5E%7B-1%7D%5Cleft(%5Cboldsymbol%7BXB%7D+%5Cboldsymbol%7BZv%5Cleft(u%5Cright)%7D%5Cright)%0A"></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?Z"> is the model matrix for random effects, <img src="https://latex.codecogs.com/png.latex?u"> is a random component following a distribution conjugate to a generalized linear model family of distributions with parameters <img src="https://latex.codecogs.com/png.latex?%5Clambda">, and <img src="https://latex.codecogs.com/png.latex?v()"> is a monotone function.</p>
<p>Let’s imagine we are predicting student dropout rates using student absences and student GPA as predictors. Suppose in 200 schools we conduct an intervention study to see if a school-wide intervention prevents dropout. Schools were randomly assigned to a treatment or control condition. We want to know if our intervention has succeeded, controlling for student absence and GPA.</p>
<section id="import-data" class="level1">
<h1>Import data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/hw7_dropout.csv"</span>)</span></code></pre></div>
</div>
</section>
<section id="exploratory-analyses" class="level1 page-columns page-full">
<h1>Exploratory Analyses</h1>
<p>The <code>skim</code> function from the skimr package gives a great overview of what the data looks like. It is fantastic for making sure the data look like they are supposed to. Unfortunately, it does not print well to rmarkdown. The <code>describe</code> function from the psych package is also great.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">skimr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>(d)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped small">

<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">d</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">6133</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Data summary</div><p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intervention</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">school_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">100.68</td>
<td style="text-align: right;">57.49</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">101.00</td>
<td style="text-align: right;">151.00</td>
<td style="text-align: right;">200</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">GPA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">▂▃▆▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Absences</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dropout</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              vars    n   mean    sd median trimmed   mad  min max  range  skew
school_id        1 6133 100.68 57.49 101.00  100.70 72.65 1.00 200 199.00  0.00
Intervention*    2 6133   1.57  0.49   2.00    1.59  0.00 1.00   2   1.00 -0.29
GPA              3 6133   2.51  0.94   2.61    2.57  1.06 0.04   4   3.96 -0.42
Absences         4 6133   2.72  1.86   2.00    2.58  1.48 0.00  12  12.00  0.80
Dropout          5 6133   0.05  0.21   0.00    0.00  0.00 0.00   1   1.00  4.29
              kurtosis   se
school_id        -1.19 0.73
Intervention*    -1.92 0.01
GPA              -0.71 0.01
Absences          0.72 0.02
Dropout          16.41 0.00</code></pre>
</div>
</div>
<p>What is the distribution of GPA?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(GPA)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models_files/figure-html/gpa-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>What is the distribution of Absences?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(Absences) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Absences, n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> n), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models_files/figure-html/Absences-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Dropout Rates Across Schools</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(school_id, Intervention) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Dropout =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(Dropout)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Dropout)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Intervention), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School Dropout Rate"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models_files/figure-html/DropoutRates-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Let’s use the “glm” method in <code>geom_smooth</code> to get a rough sense of what a proper analysis is likely to show.</p>
<div class="cell preview-image">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Absences, Dropout)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Intervention), </span>
<span id="cb8-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb8-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb8-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">015</span>, </span>
<span id="cb8-6">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb8-7">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Intervention), </span>
<span id="cb8-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, </span>
<span id="cb8-10">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binomial"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models_files/figure-html/smooth-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>To me, that looks like a successful intervention! However, we did not do a proper analysis that accounted for the multilevel nature of the data.</p>
</section>
<section id="null-model" class="level1">
<h1>Null model</h1>
<p>The <code>glmer</code> function works exactly like <code>lmer</code> except that we must tell it which kind of generalized model we want. With binary outcomes, specify the binomial family. By default, it will do a logistic regression. You can specify probit regression with <code>binomial(link = "probit")</code>, if needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">m0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glmer</span>(Dropout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>())</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Dropout ~ 1 + (1 | school_id)
   Data: d

     AIC      BIC   logLik deviance df.resid 
    1827     1841     -912     1823     6131 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.375 -0.167 -0.070 -0.068  7.498 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 4.46     2.11    
Number of obs: 6133, groups:  school_id, 200

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -4.670      0.272   -17.2   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE
------------------------------------------------------------------------
1827.186 | 1827.188 | 1840.629 |      0.576 |      0.000 | 0.576 | 0.185

AIC      | Sigma | Log_loss | Score_log | Score_spherical
---------------------------------------------------------
1827.186 | 1.000 |    0.121 |   -14.611 |           0.010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m0)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Dropout</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">4.46</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.58</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">200</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">6133</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.576</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If you want the raw coefficients (log-odds) instead of odds ratios</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transform =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Dropout</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Log-Odds</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.20&nbsp;–&nbsp;-4.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">4.46</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.58</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">200</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">6133</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.576</td>
</tr>

</tbody></table>

</div>
</div>
<p>We can see from the ICC (or conditional R<sup>2</sup>) that 57.6% of the variance in dropout rate is explained by the grouping variable, <code>school_id</code>.</p>
</section>
<section id="first-l1-predictor-absences" class="level1">
<h1>First L1 predictor: Absences</h1>
<p>Let’s add to the null model using the update function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">m1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m0, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Absences)</span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Does this model fit better than the null model?</span></span>
<span id="cb15-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m0,m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m0: Dropout ~ 1 + (1 | school_id)
m1: Dropout ~ (1 | school_id) + Absences
   npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m0    2 1827 1841   -912     1823                        
m1    3 1371 1391   -682     1365   459  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall numbers</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Dropout ~ (1 | school_id) + Absences
   Data: d

     AIC      BIC   logLik deviance df.resid 
    1370     1391     -682     1364     6130 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-6.212 -0.097 -0.033 -0.015 17.443 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 9.59     3.1     
Number of obs: 6133, groups:  school_id, 200

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -9.0916     0.5889   -15.4   &lt;2e-16 ***
Absences      0.8777     0.0537    16.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
         (Intr)
Absences -0.687</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performance metrics</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE
------------------------------------------------------------------------
1370.510 | 1370.514 | 1390.674 |      0.788 |      0.171 | 0.745 | 0.152

AIC      | Sigma | Log_loss | Score_log | Score_spherical
---------------------------------------------------------
1370.510 | 1.000 |    0.080 |      -Inf |           0.010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report</span></span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and Nelder-Mead optimizer)
to predict Dropout with Absences (formula: Dropout ~ Absences). The model
included school_id as random effect (formula: ~1 | school_id). The model's
total explanatory power is substantial (conditional R2 = 0.79) and the part
related to the fixed effects alone (marginal R2) is of 0.17. The model's
intercept, corresponding to Absences = 0, is at -9.09 (95% CI [-10.25, -7.94],
p &lt; .001). Within this model:

  - The effect of Absences is statistically significant and positive (beta =
0.88, 95% CI [0.77, 0.98], p &lt; .001; Std. beta = 1.63, 95% CI [1.44, 1.83])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald z-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice table</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Dropout</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.00&nbsp;–&nbsp;0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Absences</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.41</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.17&nbsp;–&nbsp;2.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">9.59</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.74</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">200</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">6133</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.171 / 0.788</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed effect plot</span></span>
<span id="cb24-2">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Absences"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models_files/figure-html/m1-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="second-l1-predictor-gpa" class="level1">
<h1>Second L1 predictor: GPA</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add the <code>GPA</code> variable as a predictor to a model called <code>m2</code>. Conduct and interpret your analyses, documenting whether the GPA is a significant predictor of dropout rate.</p>
</div>
</div>
<p>This plot might aid interpretation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m2, </span>
<span id="cb25-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb25-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Absences"</span>, </span>
<span id="cb25-4">                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPA [0,2,4]"</span>))</span></code></pre></div>
</div>
</section>
<section id="l2-predictor-intervention" class="level1">
<h1>L2 predictor: Intervention</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add the <code>Intervention</code> variable as a predictor to a model called <code>m3</code>. Conduct and interpret your analyses, documenting whether the intervention succeeded in reducing the dropout rate.</p>
</div>
</div>
<p>This plot might aid interpretation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m3, </span>
<span id="cb26-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb26-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Absences"</span>, </span>
<span id="cb26-4">                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPA [0,2,4]"</span>, </span>
<span id="cb26-5">                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intervention"</span>))</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>What additional analyses might you conduct with these data? Try testing at least one more model that makes sense to you and write your conclusions.</p>
</div>
</div>


</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/GeneralizedMixed/generalized_linear_mixed_models.html</guid>
  <pubDate>Tue, 18 Feb 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Multilevel Models with Three Levels</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/MultiLevel3/multilevel3.html</link>
  <description><![CDATA[ 





<section id="load-packages" class="level1">
<h1>Load Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load packages, installing them if needed</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(broom.mixed)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span></code></pre></div>
</div>
</section>
<section id="study" class="level1">
<h1>Study</h1>
<p>We are evaluating the effects of a school-wide reading intervention in which principals helped teachers implement an innovative reading curriculum that helps students to read for pleasure at home and at school. Some principals were more engaged in this intervention than others. That is, some took this task seriously, spending many hours on it. Some did not. Some teachers likewise spend many classroom hours implementing the intervention whereas some teacher spent minimal time. Not surprisingly, some students were highly engaged in the intervention, spending many hours reading, and some were not.</p>
<p>Our outcome variable is a reading comprehension score on a standardized test. The predictor variables are principal engagement (hours per month on intervention-related activity), teaching engagement (hours per month on intervention-related activity), and student engagement (hours per week reading).</p>
</section>
<section id="hypotheses" class="level1">
<h1>Hypotheses</h1>
<ul>
<li>Principal, teacher, and student engagement all contribute to reading scores</li>
<li>The effect on reading is particularly high when teachers and students are both highly engaged. That is, the effect of student engagement is stronger with a high-engagement teacher than with a low-engagement teacher.</li>
<li>The effect on reading is also particularly high when principals and teachers are both highly engaged. That is, the effect of teacher engagement is higher when the principal is highly engaged than when the principal is not highly engaged.</li>
</ul>
</section>
<section id="complete-model-with-all-possible-effects" class="level1">
<h1>Complete Model with all possible effects</h1>
<p>The <code>lmer</code> formula in its most compact form will be:</p>
<p><code>Reading ~ S * T * P + (S | id2) + (S * T | id3)</code></p>
<p>That is not so bad, right? We have masked some of the model’s complexity by omitting the intercepts and using the <code>*</code> operator, which specifies an interaction effect along with all its lower-order terms.</p>
<p>In its least compact form, including the intercepts and all the lower-order terms specified with the <code>:</code> operator, the formula would be:</p>
<p><code>Reading ~ 1 + S + T + P + S:T + S:P + T:P + S:T:P + (1 + S | id_classroom) + (1 + S + T + S:T | id_school)</code></p>
<p>This model has</p>
<ul>
<li>Eight fixed coefficients:
<ul>
<li>1 fixed intercept: <code>1</code></li>
<li>3 fixed conditional slopes: <code>S</code>, <code>T</code>, and <code>P</code></li>
<li>3 fixed conditional two-way interactions: <code>S:T</code>, <code>S:P</code>, and <code>T:P</code></li>
<li>1 fixed three-way interaction: <code>S:T:P</code></li>
</ul></li>
<li>One L1 random effect (not shown in formula)</li>
<li>Two L2 random effects
<ul>
<li>1 random intercept: <code>(1 | id_classroom)</code></li>
<li>1 random slope: <code>(S | id_classroom)</code></li>
</ul></li>
<li>Four L3 random effects
<ul>
<li>1 random intercept: <code>(1 | id_school)</code></li>
<li>2 random conditional slopes: <code>(S | id_school)</code> and <code>(T | id_school)</code></li>
<li>1 random two-way interaction: <code>(S:T | id_school)</code></li>
</ul></li>
<li>A 2 × 2 L2 residual covariance matrix
<ul>
<li>2 variances (for <code>1</code> and <code>S</code>)</li>
<li>1 covariance of L2 intercept and slope (between <code>1</code> and <code>S</code>)</li>
</ul></li>
<li>A 4 × 4 L3 residual covariance matrix
<ul>
<li>4 variances (for <code>1</code>, <code>S</code>, <code>T</code>, and <code>S:T</code>)</li>
<li>6 covariances (among <code>1</code>, <code>S</code>, <code>T</code>, and <code>S:T</code>)</li>
</ul></li>
</ul>
<p>How realistic is this model? Not very! It allows every possible fixed and random effect. It allows for every possible interaction effect and every possible correlation among random effects. The probability is quite remote that everything matters and everything interacts with everything.</p>
<p>Not only is the model unrealistic, it is likely to have convergence problems, as well. With real data sets, the algorithms sometimes have a hard time finding the besting fitting model when many complex effects are specified. We are much better off starting with a simple model and building from there.</p>
<p>Nevertheless, let’s look at the complete model to help us understand what kinds of effects are possible.</p>
<section id="level-1-equation" class="level2">
<h2 class="anchored" data-anchor-id="level-1-equation">Level 1 Equation</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notation Change
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this tutorial, I am going to use <img src="https://latex.codecogs.com/png.latex?b"> for both fixed and random coefficients instead of the tradition of using <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> for fixed coefficients and <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> for random coefficients. Any coefficient that has numbers only in its subscript is fixed (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B010%7D">). Any coefficient that has one or more letters in its subscript is random (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B0jk%7D">).</p>
<p>In addition, I am going to further simplify the notation for residuals and variances. All residuals will be <img src="https://latex.codecogs.com/png.latex?e"> and all variances will be <img src="https://latex.codecogs.com/png.latex?%5Ctau">. Their levels can be inferred from their subscripts. For example, <img src="https://latex.codecogs.com/png.latex?%5Ctau_1"> is the variance of the level 1 residual.</p>
</div>
</div>
<p>If you can ignore the subscripts, this is a simple model in which student engagement predicts reading ability:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AReading_%7Bijk%7D&amp;=b_%7B0jk%7D+b_%7B1jk%7DS_%7Bijk%7D+e_%7Bijk%7D%5C%5C%0Ae_%7Bijk%7D&amp;%5Csim%5Cmathcal%7BN%7D(0,%5Ctau_1)%0A%5Cend%7Baligned%7D%0A"></p>
<div class="cell">
<div class="cell-output-display">
<div id="jqaxizetwz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jqaxizetwz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jqaxizetwz thead, #jqaxizetwz tbody, #jqaxizetwz tfoot, #jqaxizetwz tr, #jqaxizetwz td, #jqaxizetwz th {
  border-style: none;
}

#jqaxizetwz p {
  margin: 0;
  padding: 0;
}

#jqaxizetwz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jqaxizetwz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jqaxizetwz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jqaxizetwz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jqaxizetwz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqaxizetwz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqaxizetwz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqaxizetwz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jqaxizetwz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jqaxizetwz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jqaxizetwz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jqaxizetwz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jqaxizetwz .gt_spanner_row {
  border-bottom-style: hidden;
}

#jqaxizetwz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jqaxizetwz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jqaxizetwz .gt_from_md > :first-child {
  margin-top: 0;
}

#jqaxizetwz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jqaxizetwz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jqaxizetwz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jqaxizetwz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jqaxizetwz .gt_row_group_first td {
  border-top-width: 2px;
}

#jqaxizetwz .gt_row_group_first th {
  border-top-width: 2px;
}

#jqaxizetwz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqaxizetwz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jqaxizetwz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jqaxizetwz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqaxizetwz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqaxizetwz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jqaxizetwz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jqaxizetwz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jqaxizetwz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqaxizetwz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqaxizetwz .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqaxizetwz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqaxizetwz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqaxizetwz .gt_left {
  text-align: left;
}

#jqaxizetwz .gt_center {
  text-align: center;
}

#jqaxizetwz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jqaxizetwz .gt_font_normal {
  font-weight: normal;
}

#jqaxizetwz .gt_font_bold {
  font-weight: bold;
}

#jqaxizetwz .gt_font_italic {
  font-style: italic;
}

#jqaxizetwz .gt_super {
  font-size: 65%;
}

#jqaxizetwz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jqaxizetwz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jqaxizetwz .gt_indent_1 {
  text-indent: 5px;
}

#jqaxizetwz .gt_indent_2 {
  text-indent: 10px;
}

#jqaxizetwz .gt_indent_3 {
  text-indent: 15px;
}

#jqaxizetwz .gt_indent_4 {
  text-indent: 20px;
}

#jqaxizetwz .gt_indent_5 {
  text-indent: 25px;
}

#jqaxizetwz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jqaxizetwz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Interpretation">Interpretation</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="Variables stub_1_1 stub_1" rowspan="2" class="gt_row gt_left gt_stub_row_group">Variables</td>
<td headers="Variables stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpamt9XCk="><span class="gt_from_md">\(Reading_{ijk}\)</span></span></td>
<td headers="Variables stub_1_1 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VGhlIHJlYWRpbmcgY29tcHJlaGVuc2lvbiBzY29yZSBmb3Igc3R1ZGVudCBcKGlcKSBpbiBjbGFzc3Jvb20gXChqXCkgaW4gc2Nob29sIFwoa1wpLg=="><span class="gt_from_md">The reading comprehension score for student \(i\) in classroom \(j\) in school \(k\).</span></span></td></tr>
    <tr><td headers="Variables Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChTX3tpamt9XCk="><span class="gt_from_md">\(S_{ijk}\)</span></span></td>
<td headers="Variables Symbol_2 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlN0dWRlbnQgRW5nYWdlbWVudDwvZW0+IChMMSBwcmVkaWN0b3IpLiBUaGUgbnVtYmVyIG9mIGhvdXJzIHBlciB3ZWVrIHNwZW50IHJlYWRpbmcgZm9yIHN0dWRlbnQgXChpXCkgaW4gY2xhc3Nyb29tIFwoalwpIGluIHNjaG9vbCBcKGtcKS4="><span class="gt_from_md"><em>Student Engagement</em> (L1 predictor). The number of hours per week spent reading for student \(i\) in classroom \(j\) in school \(k\).</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Random Coefficients stub_1_3 stub_1" rowspan="2" class="gt_row gt_left gt_stub_row_group">Random Coefficients</td>
<td headers="Random Coefficients stub_1_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swamt9XCk="><span class="gt_from_md">\(b_{0jk}\)</span></span></td>
<td headers="Random Coefficients stub_1_3 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwyIHJhbmRvbSBpbnRlcmNlcHQ8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3swamt9XCkgcmVmZXJzIHRvIHRoZSBwcmVkaWN0ZWQgcmVhZGluZyBzY29yZSBmb3IgYSBzdHVkZW50IGluIGNsYXNzcm9vbSBcKGpcKSBpbiBzY2hvb2wgXChrXCkgd2hvIHNwZW50IDAgaG91cnMgcGVyIHdlZWsgcmVhZGluZy4="><span class="gt_from_md"><em>L2 random intercept</em>. In this model, \(b_{0jk}\) refers to the predicted reading score for a student in classroom \(j\) in school \(k\) who spent 0 hours per week reading.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxamt9XCk="><span class="gt_from_md">\(b_{1jk}\)</span></span></td>
<td headers="Random Coefficients Symbol_4 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwyIHJhbmRvbSBzbG9wZSBvZiBMMSBwcmVkaWN0b3I8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3sxamt9XCkgcmVmZXJzIHRvIHRoZSBwcmVkaWN0ZWQgZWZmZWN0IG9mIHN0dWRlbnQgZW5nYWdlbWVudCBmb3IgYSBzdHVkZW50IGluIGNsYXNzcm9vbSBcKGpcKSBpbiBzY2hvb2wgXChrXCku"><span class="gt_from_md"><em>L2 random slope of L1 predictor</em>. In this model, \(b_{1jk}\) refers to the predicted effect of student engagement for a student in classroom \(j\) in school \(k\).</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residuals stub_1_5 stub_1" rowspan="1" class="gt_row gt_left gt_stub_row_group">Residuals</td>
<td headers="Residuals stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpamt9XCk="><span class="gt_from_md">\(e_{ijk}\)</span></span></td>
<td headers="Residuals stub_1_5 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwxIHJlc2lkdWFsPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoZV97aWprfVwpIHJlZmVycyB0byBob3cgbXVjaCB0aGUgcmVhZGluZyBjb21wcmVoZW5zaW9uIHNjb3JlIGZvciBzdHVkZW50IFwoaVwpIGluIGNsYXNzcm9vbSBcKGpcKSBpbiBzY2hvb2wgXChrXCkgZGlmZmVycyBmcm9tIGV4cGVjdGF0aW9ucy4="><span class="gt_from_md"><em>L1 residual</em>. In this model, \(e_{ijk}\) refers to how much the reading comprehension score for student \(i\) in classroom \(j\) in school \(k\) differs from expectations.</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residual Variance stub_1_6 stub_1" rowspan="1" class="gt_row gt_left gt_stub_row_group">Residual Variance</td>
<td headers="Residual Variance stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1XzFcKQ=="><span class="gt_from_md">\(\tau_1\)</span></span></td>
<td headers="Residual Variance stub_1_6 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwxIHJlc2lkdWFsIHZhcmlhbmNlPC9lbT4uIFRoZSB2YXJpYW5jZSBvZiBcKGVfe2lqa31cKQ=="><span class="gt_from_md"><em>L1 residual variance</em>. The variance of \(e_{ijk}\)</span></span></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="level-2-equations" class="level2">
<h2 class="anchored" data-anchor-id="level-2-equations">Level 2 Equations</h2>
<p>The L2 predictor, teacher engagement <img src="https://latex.codecogs.com/png.latex?T_%7Bjk%7D">, can have an effect on the L2 random intercept <img src="https://latex.codecogs.com/png.latex?b_%7B0jk%7D"> and on the L2 random slope <img src="https://latex.codecogs.com/png.latex?b_%7B1jk%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ab_%7B0jk%7D&amp;=b_%7B00k%7D%20+%20b_%7B01k%7DT_%7Bjk%7D+e_%7B0jk%7D%5C%5C%0Ab_%7B1jk%7D&amp;=b_%7B10k%7D%20+%20b_%7B11k%7DT_%7Bjk%7D+e_%7B1jk%7D%5C%5C%0A%5Cboldsymbol%7Be_2%7D&amp;=%5Cbegin%7Bbmatrix%7De_%7B0jk%7D%5C%5C%20e_%7B1jk%7D%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cboldsymbol%7B%5Ctau_2%7D&amp;=%5Cbegin%7Bbmatrix%7D%5Ctau_%7B2.00%7D%20&amp;%20%5C%5C%20%5Ctau_%7B2.10%7D%20&amp;%20%5Ctau_%7B2.11%7D%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cboldsymbol%7Be_2%7D&amp;%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Cboldsymbol%7B0%7D,%5Cboldsymbol%7B%5Ctau_2%7D%5Cright)%0A%5Cend%7Baligned%7D%0A"></p>
<div class="cell">
<div class="cell-output-display">
<div id="jkyuocwyql" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jkyuocwyql table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jkyuocwyql thead, #jkyuocwyql tbody, #jkyuocwyql tfoot, #jkyuocwyql tr, #jkyuocwyql td, #jkyuocwyql th {
  border-style: none;
}

#jkyuocwyql p {
  margin: 0;
  padding: 0;
}

#jkyuocwyql .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jkyuocwyql .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jkyuocwyql .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jkyuocwyql .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jkyuocwyql .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jkyuocwyql .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkyuocwyql .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jkyuocwyql .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jkyuocwyql .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jkyuocwyql .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jkyuocwyql .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jkyuocwyql .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jkyuocwyql .gt_spanner_row {
  border-bottom-style: hidden;
}

#jkyuocwyql .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jkyuocwyql .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jkyuocwyql .gt_from_md > :first-child {
  margin-top: 0;
}

#jkyuocwyql .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jkyuocwyql .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jkyuocwyql .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jkyuocwyql .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jkyuocwyql .gt_row_group_first td {
  border-top-width: 2px;
}

#jkyuocwyql .gt_row_group_first th {
  border-top-width: 2px;
}

#jkyuocwyql .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkyuocwyql .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jkyuocwyql .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jkyuocwyql .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkyuocwyql .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkyuocwyql .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jkyuocwyql .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jkyuocwyql .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jkyuocwyql .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkyuocwyql .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jkyuocwyql .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkyuocwyql .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jkyuocwyql .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkyuocwyql .gt_left {
  text-align: left;
}

#jkyuocwyql .gt_center {
  text-align: center;
}

#jkyuocwyql .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jkyuocwyql .gt_font_normal {
  font-weight: normal;
}

#jkyuocwyql .gt_font_bold {
  font-weight: bold;
}

#jkyuocwyql .gt_font_italic {
  font-style: italic;
}

#jkyuocwyql .gt_super {
  font-size: 65%;
}

#jkyuocwyql .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jkyuocwyql .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jkyuocwyql .gt_indent_1 {
  text-indent: 5px;
}

#jkyuocwyql .gt_indent_2 {
  text-indent: 10px;
}

#jkyuocwyql .gt_indent_3 {
  text-indent: 15px;
}

#jkyuocwyql .gt_indent_4 {
  text-indent: 20px;
}

#jkyuocwyql .gt_indent_5 {
  text-indent: 25px;
}

#jkyuocwyql .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jkyuocwyql div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Interpretation">Interpretation</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="Variables stub_1_1 stub_1" rowspan="1" class="gt_row gt_left gt_stub_row_group">Variables</td>
<td headers="Variables stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChUX3tqa31cKQ=="><span class="gt_from_md">\(T_{jk}\)</span></span></td>
<td headers="Variables stub_1_1 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlRlYWNoZXIgZW5nYWdlbWVudDwvZW0+IChMMiBwcmVkaWN0b3IpLiBOdW1iZXIgb2YgaG91cnMgdGVhY2hlciBcKGpcKSBpbiBzY2hvb2wgXChrXCkgc3BlbmQgb24gaW50ZXJ2ZW50aW9uLXJlbGF0ZWQgYWN0aXZpdGllcy4="><span class="gt_from_md"><em>Teacher engagement</em> (L2 predictor). Number of hours teacher \(j\) in school \(k\) spend on intervention-related activities.</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Random Coefficients stub_1_2 stub_1" rowspan="6" class="gt_row gt_left gt_stub_row_group">Random Coefficients</td>
<td headers="Random Coefficients stub_1_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swamt9XCk="><span class="gt_from_md">\(b_{0jk}\)</span></span></td>
<td headers="Random Coefficients stub_1_2 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwyIHJhbmRvbSBpbnRlcmNlcHQ8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3swamt9XCkgcmVmZXJzIHRvIHRoZSBwcmVkaWN0ZWQgcmVhZGluZyBzY29yZSBmb3IgYSBzdHVkZW50IGluIGNsYXNzcm9vbSBcKGpcKSBpbiBzY2hvb2wgXChrXCkgd2hvIHNwZW50IDAgaG91cnMgcGVyIHdlZWsgcmVhZGluZy4="><span class="gt_from_md"><em>L2 random intercept</em>. In this model, \(b_{0jk}\) refers to the predicted reading score for a student in classroom \(j\) in school \(k\) who spent 0 hours per week reading.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxamt9XCk="><span class="gt_from_md">\(b_{1jk}\)</span></span></td>
<td headers="Random Coefficients Symbol_3 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwyIHJhbmRvbSBzbG9wZSBmb3IgTDEgcHJlZGljdG9yPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MWprfVwpIHJlZmVycyB0byB0aGUgcHJlZGljdGVkIGVmZmVjdCBvZiBzdHVkZW50IGVuZ2FnZW1lbnQgZm9yIGEgc3R1ZGVudCBpbiBjbGFzc3Jvb20gXChqXCkgaW4gc2Nob29sIFwoa1wpLg=="><span class="gt_from_md"><em>L2 random slope for L1 predictor</em>. In this model, \(b_{1jk}\) refers to the predicted effect of student engagement for a student in classroom \(j\) in school \(k\).</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMGt9XCk="><span class="gt_from_md">\(b_{00k}\)</span></span></td>
<td headers="Random Coefficients Symbol_4 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBpbnRlcmNlcHQ8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3swMGt9XCkgcmVmZXJzIHRvIHRoZSBwcmVkaWN0ZWQgcmVhZGluZyBzY29yZSBmb3IgY2xhc3Nyb29tIFwoalwpIGluIHNjaG9vbCBcKGtcKSB3aG9zZSB0ZWFjaGVyIHNwZW50IDAgaG91cnMgcGVyIG1vbnRoIG9uIGludGVydmVudGlvbi1yZWxhdGVkIGFjdGl2aXRvZXMu"><span class="gt_from_md"><em>L3 random intercept</em>. In this model, \(b_{00k}\) refers to the predicted reading score for classroom \(j\) in school \(k\) whose teacher spent 0 hours per month on intervention-related activitoes.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMWt9XCk="><span class="gt_from_md">\(b_{01k}\)</span></span></td>
<td headers="Random Coefficients Symbol_5 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBjb25kaXRpb25hbCBzbG9wZSBmb3IgTDIgcHJlZGljdG9yPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MDFrfVwpIHJlZmVycyB0byB0aGUgZWZmZWN0IG9mIHRlYWNoZXIgZW5nYWdlbWVudCBpbiBzY2hvb2wgXChrXCkgd2hlbiB0aGUgc3R1ZGVudCBlbmdhZ2VtZW50IGlzIDAu"><span class="gt_from_md"><em>L3 random conditional slope for L2 predictor</em>. In this model, \(b_{01k}\) refers to the effect of teacher engagement in school \(k\) when the student engagement is 0.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMGt9XCk="><span class="gt_from_md">\(b_{10k}\)</span></span></td>
<td headers="Random Coefficients Symbol_6 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBjb25kaXRpb25hbCBzbG9wZSBmb3IgTDEgcHJlZGljdG9yPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MTBrfVwpIHJlZmVycyB0byB0aGUgZWZmZWN0IG9mIHN0dWRlbnQgZW5nYWdlbWVudCBpbiBzY2hvb2wgXChrXCkgd2hlbiB0aGUgdGVhY2hlciBzcGVuZHMgMCBob3VycyBwZXIgbW9udGggb24gaW50ZXJ2ZW50aW9uLXJlbGF0ZWQgYWN0aXZpdG9lcy4="><span class="gt_from_md"><em>L3 random conditional slope for L1 predictor</em>. In this model, \(b_{10k}\) refers to the effect of student engagement in school \(k\) when the teacher spends 0 hours per month on intervention-related activitoes.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMWt9XCk="><span class="gt_from_md">\(b_{11k}\)</span></span></td>
<td headers="Random Coefficients Symbol_7 Interpretation" class="gt_row gt_left"><span data-qmd-base64="KkwzIHJhbmRvbSBpbnRlcmFjdGlvbiBlZmZlY3QgZm9yIEwxIGFuZCBMMiBwcmVkaWN0b3JzICouIEluIHRoaXMgbW9kZWwsIFwoYl97MTFrfVwpIHJlZmVycyB0byB0aGUgaW50ZXJhY3Rpb24gb2Ygc3R1ZGVudCBhbmQgdGVhY2hlciBlbmdhZ2VtZW50IGluIHNjaG9vbCBcKGtcKS4="><span class="gt_from_md">*L3 random interaction effect for L1 and L2 predictors *. In this model, \(b_{11k}\) refers to the interaction of student and teacher engagement in school \(k\).</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residuals stub_1_8 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group">Residuals</td>
<td headers="Residuals stub_1_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHtlXzJ9XCk="><span class="gt_from_md">\(\boldsymbol{e_2}\)</span></span></td>
<td headers="Residuals stub_1_8 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VGhlIHZlY3RvciBvZiBMMiByZXNpZHVhbHMsIFwoXHtlX3swamt9LGVfezFqa30gXH1cKQ=="><span class="gt_from_md">The vector of L2 residuals, \(\{e_{0jk},e_{1jk} \}\)</span></span></td></tr>
    <tr><td headers="Residuals Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3swamt9XCk="><span class="gt_from_md">\(e_{0jk}\)</span></span></td>
<td headers="Residuals Symbol_9 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciBMMiByYW5kb20gaW50ZXJjZXB0PC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoZV97MGprfVwpIHJlZmVycyB0byBob3cgbXVjaCB0aGUgcmVhZGluZyBjb21wcmVoZW5zaW9uIHNjb3JlIGZvciBjbGFzc3Jvb20gXChqXCkgaW4gc2Nob29sIFwoa1wpIGRpZmZlcnMgZnJvbSBleHBlY3RhdGlvbnMgd2hlbiB0aGUgdGVhY2hlciBzcGVudCAwIGhvdXJzIHBlciBtb250aCBvbiBpbnRlcnZlbnRpb24tcmVsYXRlZCBhY3Rpdml0aWVzLg=="><span class="gt_from_md"><em>Residual for L2 random intercept</em>. In this model, \(e_{0jk}\) refers to how much the reading comprehension score for classroom \(j\) in school \(k\) differs from expectations when the teacher spent 0 hours per month on intervention-related activities.</span></span></td></tr>
    <tr><td headers="Residuals Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3sxamt9XCk="><span class="gt_from_md">\(e_{1jk}\)</span></span></td>
<td headers="Residuals Symbol_10 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciBMMiByYW5kb20gc2xvcGUgb2YgTDEgcHJlZGljdG9yPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoZV97MWprfVwpIGFsbG93cyB0aGUgZWZmZWN0IG9mIHN0dWRlbnQgZW5nYWdlbWVudCB0byB2YXJ5IGZyb20gY2xhc3MgdG8gY2xhc3MgYWZ0ZXIgYWNjb3VudGluZyBmb3IgdGVhY2hlciBlbmdhZ2VtZW50Lg=="><span class="gt_from_md"><em>Residual for L2 random slope of L1 predictor</em>. In this model, \(e_{1jk}\) allows the effect of student engagement to vary from class to class after accounting for teacher engagement.</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residual Variance stub_1_11 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group">Residual Variance</td>
<td headers="Residual Variance stub_1_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHtcdGF1XzJ9XCk="><span class="gt_from_md">\(\boldsymbol{\tau_2}\)</span></span></td>
<td headers="Residual Variance stub_1_11 Interpretation" class="gt_row gt_left"><span data-qmd-base64="MiDDlyAyIGNvdmFyaWFuY2UgbWF0cml4IGZvciBMMiByZXNpZHVhbHM="><span class="gt_from_md">2 × 2 covariance matrix for L2 residuals</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3syLjAwfVwp"><span class="gt_from_md">\(\tau_{2.00}\)</span></span></td>
<td headers="Residual Variance Symbol_12 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgdGhlIEwyIHJhbmRvbSBpbnRlcmNlcHQgcmVzaWR1YWwsIFwoZV97MGprfVwp"><span class="gt_from_md">Variance of the L2 random intercept residual, \(e_{0jk}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3syLjExfVwp"><span class="gt_from_md">\(\tau_{2.11}\)</span></span></td>
<td headers="Residual Variance Symbol_13 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgdGhlIEwyIHNsb3BlIHJlc2lkdWFsLCBcKGVfezFqa31cKQ=="><span class="gt_from_md">Variance of the L2 slope residual, \(e_{1jk}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_14 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3syLjEwfVwp"><span class="gt_from_md">\(\tau_{2.10}\)</span></span></td>
<td headers="Residual Variance Symbol_14 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgTDIgaW50ZXJjZXB0IGFuZCBzbG9wZSByZXNpZHVhbHMsIFwoZV97MGprfVwpIGFuZCBcKGVfezFqa31cKQ=="><span class="gt_from_md">Covariance of the L2 intercept and slope residuals, \(e_{0jk}\) and \(e_{1jk}\)</span></span></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="level-3-equations" class="level2">
<h2 class="anchored" data-anchor-id="level-3-equations">Level 3 Equations</h2>
<p>The L3 predictor, principal engagement <img src="https://latex.codecogs.com/png.latex?P_%7Bjk%7D">, can have have an effect on all four L3 random coefficients:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ab_%7B00k%7D&amp;=b_%7B000%7D%20+%20b_%7B001%7DP_%7Bk%7D+e_%7B00k%7D%5C%5C%0Ab_%7B01k%7D&amp;=b_%7B010%7D%20+%20b_%7B011%7DP_%7Bk%7D+e_%7B01k%7D%5C%5C%0Ab_%7B10k%7D&amp;=b_%7B100%7D%20+%20b_%7B101%7DP_%7Bk%7D+e_%7B10k%7D%5C%5C%0Ab_%7B11k%7D&amp;=b_%7B110%7D%20+%20b_%7B111%7DP_%7Bk%7D+e_%7B11k%7D%5C%5C%0A%5Cboldsymbol%7Be_3%7D&amp;=%5Cbegin%7Bbmatrix%7De_%7B00k%7D%5C%5C%20e_%7B01k%7D%5C%5C%20e_%7B10k%7D%5C%5C%20e_%7B11k%7D%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cboldsymbol%7B%5Ctau_3%7D&amp;=%5Cbegin%7Bbmatrix%7D%0A%5Ctau_%7B3.00%7D%20&amp;%20%5C%5C%0A%5Ctau_%7B3.10%7D%20&amp;%20%5Ctau_%7B3.11%7D%5C%5C%0A%5Ctau_%7B3.20%7D%20&amp;%20%5Ctau_%7B3.21%7D%20&amp;%20%20%5Ctau_%7B3.22%7D%5C%5C%0A%5Ctau_%7B3.30%7D%20&amp;%20%5Ctau_%7B3.31%7D%20&amp;%20%20%5Ctau_%7B3.32%7D%20&amp;%20%20%5Ctau_%7B3.33%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cboldsymbol%7Be_3%7D&amp;%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Cboldsymbol%7B0%7D,%5Cboldsymbol%7B%5Ctau_3%7D%5Cright)%0A%5Cend%7Baligned%7D%0A"></p>
<div class="cell">
<div class="cell-output-display">
<div id="erlbhoqvnr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#erlbhoqvnr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#erlbhoqvnr thead, #erlbhoqvnr tbody, #erlbhoqvnr tfoot, #erlbhoqvnr tr, #erlbhoqvnr td, #erlbhoqvnr th {
  border-style: none;
}

#erlbhoqvnr p {
  margin: 0;
  padding: 0;
}

#erlbhoqvnr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#erlbhoqvnr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#erlbhoqvnr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#erlbhoqvnr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#erlbhoqvnr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#erlbhoqvnr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#erlbhoqvnr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#erlbhoqvnr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#erlbhoqvnr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#erlbhoqvnr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#erlbhoqvnr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#erlbhoqvnr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#erlbhoqvnr .gt_spanner_row {
  border-bottom-style: hidden;
}

#erlbhoqvnr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#erlbhoqvnr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#erlbhoqvnr .gt_from_md > :first-child {
  margin-top: 0;
}

#erlbhoqvnr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#erlbhoqvnr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#erlbhoqvnr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#erlbhoqvnr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#erlbhoqvnr .gt_row_group_first td {
  border-top-width: 2px;
}

#erlbhoqvnr .gt_row_group_first th {
  border-top-width: 2px;
}

#erlbhoqvnr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#erlbhoqvnr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#erlbhoqvnr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#erlbhoqvnr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#erlbhoqvnr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#erlbhoqvnr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#erlbhoqvnr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#erlbhoqvnr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#erlbhoqvnr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#erlbhoqvnr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#erlbhoqvnr .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#erlbhoqvnr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#erlbhoqvnr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#erlbhoqvnr .gt_left {
  text-align: left;
}

#erlbhoqvnr .gt_center {
  text-align: center;
}

#erlbhoqvnr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#erlbhoqvnr .gt_font_normal {
  font-weight: normal;
}

#erlbhoqvnr .gt_font_bold {
  font-weight: bold;
}

#erlbhoqvnr .gt_font_italic {
  font-style: italic;
}

#erlbhoqvnr .gt_super {
  font-size: 65%;
}

#erlbhoqvnr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#erlbhoqvnr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#erlbhoqvnr .gt_indent_1 {
  text-indent: 5px;
}

#erlbhoqvnr .gt_indent_2 {
  text-indent: 10px;
}

#erlbhoqvnr .gt_indent_3 {
  text-indent: 15px;
}

#erlbhoqvnr .gt_indent_4 {
  text-indent: 20px;
}

#erlbhoqvnr .gt_indent_5 {
  text-indent: 25px;
}

#erlbhoqvnr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#erlbhoqvnr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Interpretation">Interpretation</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="Variables stub_1_1 stub_1" rowspan="1" class="gt_row gt_left gt_stub_row_group">Variables</td>
<td headers="Variables stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChQX3trfVwp"><span class="gt_from_md">\(P_{k}\)</span></span></td>
<td headers="Variables stub_1_1 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlByaW5jaXBhbCBlbmdhZ2VtZW50PC9lbT4gKEwzIHByZWRpY3RvcikuIE51bWJlciBvZiBob3VycyB0aGUgcHJpbmNpcGFsIGluIHNjaG9vbCBcKGtcKSBzcGVuZCBvbiBpbnRlcnZlbnRpb24tcmVsYXRlZCBhY3Rpdml0aWVzLg=="><span class="gt_from_md"><em>Principal engagement</em> (L3 predictor). Number of hours the principal in school \(k\) spend on intervention-related activities.</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Random Coefficients stub_1_2 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group">Random Coefficients</td>
<td headers="Random Coefficients stub_1_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMGt9XCk="><span class="gt_from_md">\(b_{00k}\)</span></span></td>
<td headers="Random Coefficients stub_1_2 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBpbnRlcmNlcHQ8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3swMGt9XCkgcmVmZXJzIHRvIHRoZSBwcmVkaWN0ZWQgcmVhZGluZyBzY29yZSBmb3IgY2xhc3Nyb29tIFwoalwpIGluIHNjaG9vbCBcKGtcKSB3aG9zZSB0ZWFjaGVyIHNwZW50IDAgaG91cnMgcGVyIG1vbnRoIG9uIGludGVydmVudGlvbi1yZWxhdGVkIGFjdGl2aXRvZXMu"><span class="gt_from_md"><em>L3 random intercept</em>. In this model, \(b_{00k}\) refers to the predicted reading score for classroom \(j\) in school \(k\) whose teacher spent 0 hours per month on intervention-related activitoes.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMWt9XCk="><span class="gt_from_md">\(b_{01k}\)</span></span></td>
<td headers="Random Coefficients Symbol_3 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBjb25kaXRpb25hbCBzbG9wZSBvZiBMMiBwcmVkaWN0b3I8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3swMWt9XCkgcmVmZXJzIHRvIHRoZSBlZmZlY3Qgb2YgdGVhY2hlciBlbmdhZ2VtZW50IGluIHNjaG9vbCBcKGtcKSB3aGVuIHRoZSBzdHVkZW50IGVuZ2FnZW1lbnQgaXMgMC4="><span class="gt_from_md"><em>L3 random conditional slope of L2 predictor</em>. In this model, \(b_{01k}\) refers to the effect of teacher engagement in school \(k\) when the student engagement is 0.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMGt9XCk="><span class="gt_from_md">\(b_{10k}\)</span></span></td>
<td headers="Random Coefficients Symbol_4 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBjb25kaXRpb25hbCBzbG9wZSBvZiBMMSBwcmVkaWN0b3I8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3sxMGt9XCkgcmVmZXJzIHRvIHRoZSBlZmZlY3Qgb2Ygc3R1ZGVudCBlbmdhZ2VtZW50IGluIHNjaG9vbCBcKGtcKSB3aGVuIHRoZSB0ZWFjaGVyIHNwZW5kcyAwIGhvdXJzIHBlciBtb250aCBvbiBpbnRlcnZlbnRpb24tcmVsYXRlZCBhY3Rpdml0b2VzLg=="><span class="gt_from_md"><em>L3 random conditional slope of L1 predictor</em>. In this model, \(b_{10k}\) refers to the effect of student engagement in school \(k\) when the teacher spends 0 hours per month on intervention-related activitoes.</span></span></td></tr>
    <tr><td headers="Random Coefficients Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMWt9XCk="><span class="gt_from_md">\(b_{11k}\)</span></span></td>
<td headers="Random Coefficients Symbol_5 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkwzIHJhbmRvbSBpbnRlcmFjdGlvbiBlZmZlY3Q8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChiX3sxMWt9XCkgcmVmZXJzIHRvIHRoZSBpbnRlcmFjdGlvbiBvZiBzdHVkZW50IGFuZCB0ZWFjaGVyIGVuZ2FnZW1lbnQgaW4gc2Nob29sIFwoa1wpLg=="><span class="gt_from_md"><em>L3 random interaction effect</em>. In this model, \(b_{11k}\) refers to the interaction of student and teacher engagement in school \(k\).</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Fixed Coefficients stub_1_6 stub_1" rowspan="8" class="gt_row gt_left gt_stub_row_group">Fixed Coefficients</td>
<td headers="Fixed Coefficients stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMDB9XCk="><span class="gt_from_md">\(b_{000}\)</span></span></td>
<td headers="Fixed Coefficients stub_1_6 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIEludGVyY2VwdDwvZW0+LiBJbiB0aGlzIG1vZGVsLCBcKGJfezAwMH1cKSByZWZlcnMgdG8gdGhlIHByZWRpY3RlZCByZWFkaW5nIHNjb3JlIHdoZW4gc3R1ZGVudCwgdGVhY2hlciwgYW5kIHByaW5jaXBhbCBlbmdhZ2VtZW50IGlzIDAu"><span class="gt_from_md"><em>Fixed Intercept</em>. In this model, \(b_{000}\) refers to the predicted reading score when student, teacher, and principal engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMDF9XCk="><span class="gt_from_md">\(b_{001}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_7 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIENvbmRpdGlvbmFsIFNsb3BlIG9mIEwzIHByZWRpY3RvcjwvZW0+LiBJbiB0aGlzIG1vZGVsLCBcKGJfezAwMX1cKSByZWZlcnMgdG8gdGhlIGVmZmVjdCBvZiBwcmluY2lwYWwgZW5nYWdlbWVudCB3aGVuIHN0dWRlbnQgYW5kIHRlYWNoZXIgZW5nYWdlbWVudCBpcyAwLg=="><span class="gt_from_md"><em>Fixed Conditional Slope of L3 predictor</em>. In this model, \(b_{001}\) refers to the effect of principal engagement when student and teacher engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMTB9XCk="><span class="gt_from_md">\(b_{010}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_8 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIENvbmRpdGlvbmFsIFNsb3BlIG9mIEwyIHByZWRpY3RvcjwvZW0+LiBJbiB0aGlzIG1vZGVsLCBcKGJfezAxMH1cKSByZWZlcnMgdG8gdGhlIGVmZmVjdCBvZiB0ZWFjaGVyIGVuZ2FnZW1lbnQgd2hlbiBzdHVkZW50IGFuZCBwcmluY2lwYWwgZW5nYWdlbWVudCBpcyAwLg=="><span class="gt_from_md"><em>Fixed Conditional Slope of L2 predictor</em>. In this model, \(b_{010}\) refers to the effect of teacher engagement when student and principal engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3swMTF9XCk="><span class="gt_from_md">\(b_{011}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_9 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIEwyLUwzIENvbmRpdGlvbmFsIEludGVyYWN0aW9uPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MDExfVwpIHJlZmVycyB0byB0aGUgaW50ZXJhY3Rpb24gb2YgdGVhY2hlciBhbmQgcHJpbmNpcGFsIGVuZ2FnZW1lbnQgd2hlbiBzdHVkZW50IGVuZ2FnZW1lbnQgaXMgMC4="><span class="gt_from_md"><em>Fixed L2-L3 Conditional Interaction</em>. In this model, \(b_{011}\) refers to the interaction of teacher and principal engagement when student engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMDB9XCk="><span class="gt_from_md">\(b_{100}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_10 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIENvbmRpdGlvbmFsIFNsb3BlIG9mIEwxIHByZWRpY3RvcjwvZW0+LiBJbiB0aGlzIG1vZGVsLCBcKGJfezEwMH1cKSByZWZlcnMgdG8gdGhlIGVmZmVjdCBvZiBzdHVkZW50IGVuZ2FnZW1lbnQgd2hlbiB0ZWFjaGVyIGFuZCBwcmluY2lwYWwgZW5nYWdlbWVudCBpcyAwLg=="><span class="gt_from_md"><em>Fixed Conditional Slope of L1 predictor</em>. In this model, \(b_{100}\) refers to the effect of student engagement when teacher and principal engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMDF9XCk="><span class="gt_from_md">\(b_{101}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_11 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIEwxLUwzIENvbmRpdGlvbmFsIEludGVyYWN0aW9uPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MTAxfVwpIHJlZmVycyB0byB0aGUgaW50ZXJhY3Rpb24gb2Ygc3R1ZGVudCBhbmQgcHJpbmNpcGFsIGVuZ2FnZW1lbnQgd2hlbiB0ZWFjaGVyIGVuZ2FnZW1lbnQgaXMgMC4="><span class="gt_from_md"><em>Fixed L1-L3 Conditional Interaction</em>. In this model, \(b_{101}\) refers to the interaction of student and principal engagement when teacher engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMTB9XCk="><span class="gt_from_md">\(b_{110}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_12 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIEwxLUwyIENvbmRpdGlvbmFsIEludGVyYWN0aW9uPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MTEwfVwpIHJlZmVycyB0byB0aGUgaW50ZXJhY3Rpb24gb2Ygc3R1ZGVudCBhbmQgcHJpbmNpcGFsIGVuZ2FnZW1lbnQgd2hlbiB0ZWFjaGVyIGVuZ2FnZW1lbnQgaXMgMC4="><span class="gt_from_md"><em>Fixed L1-L2 Conditional Interaction</em>. In this model, \(b_{110}\) refers to the interaction of student and principal engagement when teacher engagement is 0.</span></span></td></tr>
    <tr><td headers="Fixed Coefficients Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChiX3sxMTF9XCk="><span class="gt_from_md">\(b_{111}\)</span></span></td>
<td headers="Fixed Coefficients Symbol_13 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPkZpeGVkIEwxLUwyLUwzIEludGVyYWN0aW9uPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoYl97MTExfVwpIHJlZmVycyB0byB0aGUgaW50ZXJhY3Rpb24gb2Ygc3R1ZGVudCwgdGVhY2hlciwgYW5kIHByaW5jaXBhbCBlbmdhZ2VtZW50Lg=="><span class="gt_from_md"><em>Fixed L1-L2-L3 Interaction</em>. In this model, \(b_{111}\) refers to the interaction of student, teacher, and principal engagement.</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residuals stub_1_14 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group">Residuals</td>
<td headers="Residuals stub_1_14 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHtlXzN9XCk="><span class="gt_from_md">\(\boldsymbol{e_3}\)</span></span></td>
<td headers="Residuals stub_1_14 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VGhlIHZlY3RvciBvZiBMMyByZXNpZHVhbHMsIFwoXHtlX3swMGt9LGVfezAxa30sZV97MTBrfSxlX3sxMWt9IFx9XCk="><span class="gt_from_md">The vector of L3 residuals, \(\{e_{00k},e_{01k},e_{10k},e_{11k} \}\)</span></span></td></tr>
    <tr><td headers="Residuals Symbol_15 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3swMGt9XCk="><span class="gt_from_md">\(e_{00k}\)</span></span></td>
<td headers="Residuals Symbol_15 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciBMMyBpbnRlcmNlcHQ8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChlX3swMGt9XCkgcmVmZXJzIHRvIGhvdyBtdWNoIHRoZSByZWFkaW5nIGNvbXByZWhlbnNpb24gc2NvcmUgZm9yIHNjaG9vbCBcKGtcKSBkaWZmZXJzIGZyb20gZXhwZWN0YXRpb25zIHdoZW4gc3R1ZGVudCwgdGVhY2hlciwgYW5kIHByaW5jaXBhbCBlbmdhZ2VtZW50IGlzIDAu"><span class="gt_from_md"><em>Residual for L3 intercept</em>. In this model, \(e_{00k}\) refers to how much the reading comprehension score for school \(k\) differs from expectations when student, teacher, and principal engagement is 0.</span></span></td></tr>
    <tr><td headers="Residuals Symbol_16 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3swMWt9XCk="><span class="gt_from_md">\(e_{01k}\)</span></span></td>
<td headers="Residuals Symbol_16 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciByYW5kb20gTDMgY29uZGl0aW9uYWwgc2xvcGUgb2YgTDIgcHJlZGljdG9yPC9lbT4uIEluIHRoaXMgbW9kZWwsIFwoZV97MDFrfVwpIHJlZmVycyBob3cgbXVjaCB0aGUgY29uZGl0aW9uYWwgZWZmZWN0IG9mIHRlYWNoZXIgZW5nYWdlbWVudCAod2hlbiBzdHVkZW50IGFuZCBwcmluY2lwYWwgZW5nYWdlbWVudCBpcyAwKSBkaWZmZXJzIGZyb20gZXhwZWN0YXRpb25zIGluIHNjaG9vbCBcKGtcKS4="><span class="gt_from_md"><em>Residual for random L3 conditional slope of L2 predictor</em>. In this model, \(e_{01k}\) refers how much the conditional effect of teacher engagement (when student and principal engagement is 0) differs from expectations in school \(k\).</span></span></td></tr>
    <tr><td headers="Residuals Symbol_17 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3sxMGt9XCk="><span class="gt_from_md">\(e_{10k}\)</span></span></td>
<td headers="Residuals Symbol_17 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciByYW5kb20gTDMgY29uZGl0aW9uYWwgc2xvcGUgb2YgdGhlIEwxIHByZWRpY3RvcjwvZW0+LiBJbiB0aGlzIG1vZGVsLCBcKGVfezEwa31cKSByZWZlcnMgaG93IG11Y2ggdGhlIGNvbmRpdGlvbmFsIGVmZmVjdCBvZiBzdHVkZW50IGVuZ2FnZW1lbnQgKHdoZW4gdGVhY2hlciBhbmQgcHJpbmNpcGFsIGVuZ2FnZW1lbnQgaXMgMCkgZGlmZmVycyBmcm9tIGV4cGVjdGF0aW9ucyBpbiBzY2hvb2wgXChrXCku"><span class="gt_from_md"><em>Residual for random L3 conditional slope of the L1 predictor</em>. In this model, \(e_{10k}\) refers how much the conditional effect of student engagement (when teacher and principal engagement is 0) differs from expectations in school \(k\).</span></span></td></tr>
    <tr><td headers="Residuals Symbol_18 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3sxMWt9XCk="><span class="gt_from_md">\(e_{11k}\)</span></span></td>
<td headers="Residuals Symbol_18 Interpretation" class="gt_row gt_left"><span data-qmd-base64="PGVtPlJlc2lkdWFsIGZvciByYW5kb20gTDMgaW50ZXJhY3Rpb24gb2YgTDEgYW5kIEwyIHByZWRpY3RvcnM8L2VtPi4gSW4gdGhpcyBtb2RlbCwgXChlX3sxMWt9XCkgcmVmZXJzIGhvdyBtdWNoIHRoZSBpbnRlcmFjdGlvbiBvZiBzdHVkZW50IGFuZCB0ZWFjaGVyIGVuZ2FnZW1lbnQgZGlmZmVycyBmcm9tIGV4cGVjdGF0aW9ucyBpbiBzY2hvb2wgXChrXCku"><span class="gt_from_md"><em>Residual for random L3 interaction of L1 and L2 predictors</em>. In this model, \(e_{11k}\) refers how much the interaction of student and teacher engagement differs from expectations in school \(k\).</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="Residual Variance stub_1_19 stub_1" rowspan="11" class="gt_row gt_left gt_stub_row_group">Residual Variance</td>
<td headers="Residual Variance stub_1_19 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHtcdGF1XzN9XCk="><span class="gt_from_md">\(\boldsymbol{\tau_3}\)</span></span></td>
<td headers="Residual Variance stub_1_19 Interpretation" class="gt_row gt_left"><span data-qmd-base64="NCDDlyA0IGNvdmFyaWFuY2UgbWF0cml4IGZvciBMMyByZXNpZHVhbHM="><span class="gt_from_md">4 × 4 covariance matrix for L3 residuals</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_20 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjAwfVwp"><span class="gt_from_md">\(\tau_{3.00}\)</span></span></td>
<td headers="Residual Variance Symbol_20 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3swMGt9XCkuIEFmdGVyIGNvbnRyb2xpbmcgZm9yIHRoZSBMMyBwcmVkaWN0b3IgKHByaW5jaXBhbCBlbmdhZ2VtZW50KSwgaG93IG11Y2ggZG9lcyB0aGUgTDMgaW50ZXJjZXB0IHZhcnk/"><span class="gt_from_md">Variance of \(e_{00k}\). After controling for the L3 predictor (principal engagement), how much does the L3 intercept vary?</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_21 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjExfVwp"><span class="gt_from_md">\(\tau_{3.11}\)</span></span></td>
<td headers="Residual Variance Symbol_21 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3swMWt9XCkuIEFmdGVyIGNvbnRyb2xpbmcgZm9yIHRoZSBMMyBwcmVkaWN0b3IgKHByaW5jaXBhbCBlbmdhZ2VtZW50KSwgaG93IG11Y2ggZG9lcyB0aGUgTDMgc2xvcGUgb2YgdGhlIEwyIHByZWRpY3RvciAodGVhY2hlciBlbmdhZ2VtZW50KSB2YXJ5Pw=="><span class="gt_from_md">Variance of \(e_{01k}\). After controling for the L3 predictor (principal engagement), how much does the L3 slope of the L2 predictor (teacher engagement) vary?</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_22 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjIyfVwp"><span class="gt_from_md">\(\tau_{3.22}\)</span></span></td>
<td headers="Residual Variance Symbol_22 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3sxMGt9XCkuIEFmdGVyIGNvbnRyb2xpbmcgZm9yIHRoZSBMMyBwcmVkaWN0b3IgKHByaW5jaXBhbCBlbmdhZ2VtZW50KSwgaG93IG11Y2ggZG9lcyB0aGUgTDMgc2xvcGUgb2YgdGhlIEwxIHByZWRpY3RvciAoc3R1ZGVudCBlbmdhZ2VtZW50KSB2YXJ5Pw=="><span class="gt_from_md">Variance of \(e_{10k}\). After controling for the L3 predictor (principal engagement), how much does the L3 slope of the L1 predictor (student engagement) vary?</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_23 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjMzfVwp"><span class="gt_from_md">\(\tau_{3.33}\)</span></span></td>
<td headers="Residual Variance Symbol_23 Interpretation" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3sxMWt9XCkuIEFmdGVyIGNvbnRyb2xpbmcgZm9yIHRoZSBMMyBwcmVkaWN0b3IgKHByaW5jaXBhbCBlbmdhZ2VtZW50KSwgaG93IG11Y2ggZG9lcyB0aGUgTDMgaW50ZXJhY3Rpb24gb2YgdGhlIEwx4oCTTDIgcHJlZGljdG9ycyAoc3R1ZGVudCBhbmQgdGVhY2hlciBlbmdhZ2VtZW50KSB2YXJ5Pw=="><span class="gt_from_md">Variance of \(e_{11k}\). After controling for the L3 predictor (principal engagement), how much does the L3 interaction of the L1–L2 predictors (student and teacher engagement) vary?</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_24 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjEwfVwp"><span class="gt_from_md">\(\tau_{3.10}\)</span></span></td>
<td headers="Residual Variance Symbol_24 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3swMGt9XCkgYW5kIFwoZV97MDFrfVwpLg=="><span class="gt_from_md">Covariance of the \(e_{00k}\) and \(e_{01k}\).</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_25 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjIwfVwp"><span class="gt_from_md">\(\tau_{3.20}\)</span></span></td>
<td headers="Residual Variance Symbol_25 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3swMGt9XCkgYW5kIFwoZV97MTBrfVwp"><span class="gt_from_md">Covariance of the \(e_{00k}\) and \(e_{10k}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_26 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjMwfVwp"><span class="gt_from_md">\(\tau_{3.30}\)</span></span></td>
<td headers="Residual Variance Symbol_26 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3swMGt9XCkgYW5kIFwoZV97MTFrfVwp"><span class="gt_from_md">Covariance of the \(e_{00k}\) and \(e_{11k}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_27 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjEwfVwp"><span class="gt_from_md">\(\tau_{3.10}\)</span></span></td>
<td headers="Residual Variance Symbol_27 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3swMWt9XCkgYW5kIFwoZV97MTBrfVwp"><span class="gt_from_md">Covariance of the \(e_{01k}\) and \(e_{10k}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_28 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjEwfVwp"><span class="gt_from_md">\(\tau_{3.10}\)</span></span></td>
<td headers="Residual Variance Symbol_28 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3swMWt9XCkgYW5kIFwoZV97MTFrfVwp"><span class="gt_from_md">Covariance of the \(e_{01k}\) and \(e_{11k}\)</span></span></td></tr>
    <tr><td headers="Residual Variance Symbol_29 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3szLjEwfVwp"><span class="gt_from_md">\(\tau_{3.10}\)</span></span></td>
<td headers="Residual Variance Symbol_29 Interpretation" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiB0aGUgXChlX3sxMGt9XCkgYW5kIFwoZV97MTBrfVwp"><span class="gt_from_md">Covariance of the \(e_{10k}\) and \(e_{10k}\)</span></span></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="combined-equation" class="level2">
<h2 class="anchored" data-anchor-id="combined-equation">Combined Equation</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bmultline%7D%0AReading_%7Bijk%7D=%5Cunderbrace%7B%5Cunderbrace%7Bb_%7B000%7D%20+%20b_%7B001%7DP_%7Bk%7D+e_%7B00k%7D%7D_%7Bb_%7B00k%7D%7D%20+%20%5Cunderbrace%7B(b_%7B010%7D%20+%20b_%7B011%7DP_%7Bk%7D+e_%7B01k%7D)%7D_%7Bb_%7B01k%7D%7DT_%7Bjk%7D+e_%7B0jk%7D%7D_%7Bb_%7B0jk%7D%7D+%5C%5C%0A%5Cunderbrace%7B(%5Cunderbrace%7Bb_%7B100%7D+b_%7B101%7DP_k+e_%7B10k%7D%7D_%7Bb_%7B10k%7D%7D%20+%20(%5Cunderbrace%7Bb_%7B110%7D+b_%7B111%7DP_k+e_%7B11k%7D%7D_%7Bb_%7B11k%7D%7D)T_%7Bjk%7D+e_%7B1jk%7D)%7D_%7Bb_%7B1jk%7D%7DS_%7Bijk%7D+e_%7Bijk%7D%5C%5C%0A~%0A%5Cend%7Bmultline%7D%0A"></p>
</section>
<section id="combined-fixed-vs.-random-effects-equation" class="level2">
<h2 class="anchored" data-anchor-id="combined-fixed-vs.-random-effects-equation">Combined Fixed vs.&nbsp;Random Effects Equation</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AReading_%7Bijk%7D&amp;=%0A%5Cunderbrace%7Bb_%7B000%7D%7D_%7B%5Ctext%7BFixed%20Intercept%7D%7D%20+%5C%5C%20&amp;%5Cunderbrace%7Bb_%7B001%7DP_%7Bk%7D+b_%7B010%7DT_%7Bjk%7D%20+%20b_%7B100%7DS_%7Bijk%7D%7D_%7B%5Ctext%7BFixed%20Conditional%20Slopes%7D%7D%20+%5C%5C%0A&amp;%5Cunderbrace%7Bb_%7B110%7DS_%7Bijk%7DT_%7Bjk%7D+b_%7B101%7DS_%7Bijk%7DP_%7Bk%7D+b_%7B011%7DT_%7Bjk%7DP_%7Bk%7D%7D_%7B%5Ctext%7BFixed%20Conditional%202-Way%20Interactions%7D%7D+%5C%5C%0A&amp;%5Cunderbrace%7Bb_%7B111%7DS_%7Bijk%7DT_%7Bjk%7DP_%7Bk%7D%7D_%7B%5Ctext%7BFixed%20L1-L2-L3%20Interaction%7D%7D+%5C%5C%0A&amp;%5Cunderbrace%7Be_%7B00k%7D+e_%7B01k%7DT_%7Bjk%7D+e_%7B10k%7DS_%7Bijk%7D+e_%7B11k%7DS_%7Bijk%7DT_%7Bjk%7D%7D_%7B%5Ctext%7BL3%20Random%20Effects%7D%7D+%5C%5C%0A&amp;%5Cunderbrace%7Be_%7B0jk%7D+e_%7B1jk%7DS_%7Bijk%7D%7D_%7B%5Ctext%7BL2%20Random%20Effects%7D%7D+%5C%5C%0A&amp;%5Cunderbrace%7Be_%7Bijk%7D%7D_%7B%5Ctext%7BL1%20Random%20Effect%7D%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>This last equation is equivalent to this model in R:</p>
<pre><code>Reading ~ 
  1 + 
  P + T + S + 
  S:T + T:P + 
  S:T:P +
  (1 + T + S + S:T | id_school) +
  (1 + S | id_classrom)</code></pre>
<p>Some helpful hints about notation:</p>
<ul>
<li>Terms with letters in the subscripts are random. These include variables (e.g., <img src="https://latex.codecogs.com/png.latex?Reading_%7Bijk%7D,%20S_%7Bijk%7D,%20T_%7Bjk%7D,%20P_k">), residuals (e.g., <img src="https://latex.codecogs.com/png.latex?e_%7Bijk%7D,%20e_%7B0jk%7D,%20e_%7B10k%7D">), and random coefficients (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B0jk%7D,%20b_%7B10k%7D">).</li>
<li>Random coefficients have a mix of numbers and letters in the subscripts (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B0jk%7D,%20b_%7B10k%7D">).</li>
<li>Fixed coefficients have numbers only in the subscripts (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B000%7D,%20b_%7B110%7D">).</li>
<li>Coefficients with numbers that are exclusively 0 are intercepts (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B000%7D,%20b_%7B0jk%7D,%20b_%7B00k%7D">).</li>
<li>Coefficients with only 1 non-zero number are slopes (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B001%7D,%20b_%7B010%7D,%20b_%7B100%7D,%20b_%7B1jk%7D,%20b_%7B01k%7D">). If interaction effects involving the same variable are present in the model, these slopes are conditional slopes (AKA simple slopes).</li>
<li>Coefficients with multiple non-zero numbers are interaction effects (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B011%7D,%20b_%7B110%7D,%20b_%7B101%7D,b_%7B111%7D,%20b_%7B11k%7D">).</li>
</ul>
<p>To determine the level of the variable:</p>
<ul>
<li>All fixed coefficients are specified at the highest level (i.e., 3 in this model)</li>
<li>All variables, random coefficients, and error terms belong to the level that corresponds to the number of letters like so:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BLevel%7D=1+%5Ctext%7BHighest%20Level%7D-%5Ctext%7BNumber%20of%20Letters%20in%20Subscript%7D%0A"></p>
<p>Thus, in this model, any symbol with <img src="https://latex.codecogs.com/png.latex?ijk"> in the subscript is a level-1 variable (e.g., <img src="https://latex.codecogs.com/png.latex?Reading_%7Bijk%7D,%20S_%7Bijk%7D,%20e_%7Bijk%7D">).</p>
<p>Otherwise, any symbol with <img src="https://latex.codecogs.com/png.latex?jk"> in the subscript belongs to level 2 . Otherwise, any symbol with <img src="https://latex.codecogs.com/png.latex?k"> in the subscript belongs to level 3. Fixed coefficients are included in the highest level’s equations (i.e., 3).</p>
<p>Predictors are paired with coefficients from the next highest level or with fixed coefficients if no higher level exists. Thus,</p>
<ul>
<li>Level-1 predictors are paired with level-2 coefficients (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B1jk%7DS_%7Bijk%7D">).</li>
<li>Level-2 predictors are paired with level-3 coefficients (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B01k%7DT_%7Bjk%7D"> and <img src="https://latex.codecogs.com/png.latex?b_%7B11k%7DT_%7Bjk%7D">).</li>
<li>Level-3 predictors (highest level) are paired with fixed coefficients (e.g., <img src="https://latex.codecogs.com/png.latex?b_%7B001%7DP_%7Bk%7D">, <img src="https://latex.codecogs.com/png.latex?b_%7B011%7DP_%7Bk%7D">, <img src="https://latex.codecogs.com/png.latex?b_%7B101%7DP_%7Bk%7D">, and <img src="https://latex.codecogs.com/png.latex?b_%7B111%7DP_%7Bk%7D">).</li>
</ul>
</section>
</section>
<section id="path-diagram" class="level1">
<h1>Path Diagram</h1>
<div class="cell preview-image">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">myfont <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdiagram)</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggdiagram is an experimental package that can be installed </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github("wjschne/ggdiagram")</span></span>
<span id="cb3-5"></span>
<span id="cb3-6">my_hue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> viridis<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">viridis</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) </span>
<span id="cb3-7"></span>
<span id="cb3-8">my_color_dark <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_hue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2_chr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), tinter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>darken)</span>
<span id="cb3-10"></span>
<span id="cb3-11"></span>
<span id="cb3-12">my_color_light <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_hue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  tinter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15">my_color <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_hue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-16">  tinter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb3-17"></span>
<span id="cb3-18">line_color <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span></span>
<span id="cb3-19">my_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-20">  ob_ngon,</span>
<span id="cb3-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb3-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb3-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb3-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~1~"</span>,</span>
<span id="cb3-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vertex_radius =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-27">)</span>
<span id="cb3-28">my_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(connect, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb3-29">my_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle,</span>
<span id="cb3-30">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-31">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-32">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-33">my_error_variance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-34">  ob_variance,</span>
<span id="cb3-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb3-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb3-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">where =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb3-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span>  my_color[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb3-41">)</span>
<span id="cb3-42">my_path_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-43">  ob_label,</span>
<span id="cb3-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb3-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb3-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb3-49">)</span>
<span id="cb3-50">my_coefficient <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle,</span>
<span id="cb3-51">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb3-52">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb3-53">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb3-54">my_coefficient_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb3-55"></span>
<span id="cb3-56">my_residual <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle,</span>
<span id="cb3-57">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>,</span>
<span id="cb3-58">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb3-59">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb3-60">my_residual_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb3-61">my_residual_variance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-62">  ob_variance,</span>
<span id="cb3-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb3-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">where =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb3-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb3-69">)</span>
<span id="cb3-70"></span>
<span id="cb3-71">my_residual_variance_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-72">  ob_label,</span>
<span id="cb3-73">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb3-74">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-75">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-76">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb3-77">)</span>
<span id="cb3-78">my_observed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb3-79">  ob_ellipse, </span>
<span id="cb3-80">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, </span>
<span id="cb3-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb3-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-83"></span>
<span id="cb3-84">my_observed_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label, </span>
<span id="cb3-85">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, </span>
<span id="cb3-86">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb3-87">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-88"></span>
<span id="cb3-89"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggdiagram</span>(myfont, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-90">  {read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Reading*~*ijk*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-91">  {S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Student*~*ijk*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-92">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-93">  {S2read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(S, read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-94">  {b_1jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb3-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb3-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(S2read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb3-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~1*jk*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-98">  {i_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_label</span>(</span>
<span id="cb3-99">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~1~"</span>, </span>
<span id="cb3-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-102">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(S, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"above"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-103">  {i12read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(i_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>vertices[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-104">  {b_0jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb3-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb3-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(i12read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>),</span>
<span id="cb3-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~0*jk*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-108">  {i_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(</span>
<span id="cb3-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb3-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_label</span>(</span>
<span id="cb3-111">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~2~"</span>,</span>
<span id="cb3-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-114">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_1jk, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-115">  {i22b0jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-116">      i_2,</span>
<span id="cb3-117">      b_0jk,</span>
<span id="cb3-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-119">  {b_00k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(i22b0jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39</span>),</span>
<span id="cb3-120">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~00*k*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-121">  {i22b0jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-122">      i_2,</span>
<span id="cb3-123">      b_1jk,</span>
<span id="cb3-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-125">  {T_jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Teacher*~jk~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_0jk, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>) } <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-126">  {T2b0jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(T_jk, b_0jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-127">  {T2b1jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(T_jk, b_1jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-128">  {b_11k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb3-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(T2b1jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>), </span>
<span id="cb3-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~11*k*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-131">  {b_01k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersection</span>(T2b0jk, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_segment</span>(b_00k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center, b_11k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center)),</span>
<span id="cb3-132">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~01*k*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-133">  {b_10k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersection</span>(i22b0jk, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_segment</span>(b_00k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center, b_11k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center)),</span>
<span id="cb3-134">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~10*k*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-135">  {P_k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Principal*~k~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_10k, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>) } <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-136">  {i_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(</span>
<span id="cb3-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb3-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_label</span>(</span>
<span id="cb3-139">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~3~"</span>, </span>
<span id="cb3-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-142">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(P_k, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-143">  {i32b00k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-144">    i_3, </span>
<span id="cb3-145">    b_00k, </span>
<span id="cb3-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~000~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-147">  {i32b10k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-148">    i_3, </span>
<span id="cb3-149">    b_10k, </span>
<span id="cb3-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~100~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-151">  {i32b01k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-152">    i_3, </span>
<span id="cb3-153">    b_01k, </span>
<span id="cb3-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~010~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-155">  {i32b11k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-156">    i_3, </span>
<span id="cb3-157">    b_11k, </span>
<span id="cb3-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~110~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-159">  {Pk2b00k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-160">    P_k, </span>
<span id="cb3-161">    b_00k, </span>
<span id="cb3-162">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~001~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-163">  {Pk2b10k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-164">    P_k, </span>
<span id="cb3-165">    b_10k, </span>
<span id="cb3-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~101~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-167">  {Pk2b01k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-168">    P_k,</span>
<span id="cb3-169">    b_01k, </span>
<span id="cb3-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~011~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-171">  {Pk2b11k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb3-172">    P_k, </span>
<span id="cb3-173">    b_11k, </span>
<span id="cb3-174">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*b*~111~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-175">  {e_ijk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~*ijk*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-176">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-177">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_ijk, read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-178">  {e_ijk_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error_variance</span>(e_ijk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;tau;~1~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-179">  {e_0jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~0*jk*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-180">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_0jk, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-181">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-182">    e_0jk,</span>
<span id="cb3-183">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>),</span>
<span id="cb3-184">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb3-185">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;2.00&lt;/sub&gt;"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb3-186">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-187">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_0jk, b_0jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-188">  {e_1jk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~1*jk*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_dark[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-189">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_1jk, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-190">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-191">    e_1jk,</span>
<span id="cb3-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>),</span>
<span id="cb3-193">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb3-194">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;2.11&lt;/sub&gt;"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb3-195">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-196">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_1jk, b_1jk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-197">  {e_00k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~00*k*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-198">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_00k, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-199">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-200">    e_00k,</span>
<span id="cb3-201">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span>),</span>
<span id="cb3-202">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;3.00&lt;/sub&gt;"</span>)</span>
<span id="cb3-203">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-204">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_00k, b_00k) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-205">  {e_10k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~10*k*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-206">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_10k, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-207">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-208">    e_10k,</span>
<span id="cb3-209">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>),</span>
<span id="cb3-210">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;3.22&lt;/sub&gt;"</span>)</span>
<span id="cb3-211">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-212">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_10k, b_10k) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-213">  {e_01k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~01*k*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-214">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_01k, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-215">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-216">    e_01k,</span>
<span id="cb3-217">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">225</span>),</span>
<span id="cb3-218">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;3.11&lt;/sub&gt;"</span>)</span>
<span id="cb3-219">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-220">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_01k, b_01k) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-221">  {e_11k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~11*k*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-222">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_11k, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-223">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb3-224">    e_11k,</span>
<span id="cb3-225">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">degree</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb3-226">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;3.33&lt;/sub&gt;"</span>)</span>
<span id="cb3-227">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-228">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e_11k, b_11k) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-229">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_covariance</span>(</span>
<span id="cb3-230">    e_0jk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>),</span>
<span id="cb3-231">    e_1jk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>),</span>
<span id="cb3-232">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;2.10&lt;/sub&gt;"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb3-233">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_head =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-234">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_fins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-235">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb3-236">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-237">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb3-238">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-239">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb3-240">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-241">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_covariance</span>(</span>
<span id="cb3-242">    e_01k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>),</span>
<span id="cb3-243">    e_00k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">265</span>),</span>
<span id="cb3-244">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*&lt;sub&gt;3.10&lt;/sub&gt;"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>),</span>
<span id="cb3-245">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_head =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-246">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_fins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-247">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb3-248">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-249">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb3-250">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-251">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> my_color_light[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb3-252">  ) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/ggdiagramcode-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="import-data-and-transform-variables" class="level1">
<h1>Import Data and Transform Variables</h1>
<p>Here we import the data using <code>read_csv</code>, then we convert the L2 identifier variable <code>id_classroom</code> and the L3 identifier variable <code>id_school</code> into factors. At this point we would normally center our predictors. However, our engagement predictors are measured in hours, which is a ratio-level variable. In ratio variables, 0 indicates the absence of the quantity being measured. The whole point of centering variables is, if you can forgive the pun, to make zero <em>mean</em>ingful (i.e., 0 = mean). Here, the 0 already has a clear meaning (0 = no engagement), and thus we need not transform the predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/hw5_three_level.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_classroom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id_classroom),</span>
<span id="cb4-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_school =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id_school))</span></code></pre></div>
</div>
</section>
<section id="null-models" class="level1">
<h1>Null Models</h1>
</section>
<section id="level-fixed-intercept-model" class="level1">
<h1>1-Level Fixed Intercept Model</h1>
<p>This is not much of a model. We use this model solely as a null hypothesis against which to contrast the next model. It posits an overall fixed intercept, <img src="https://latex.codecogs.com/png.latex?b_%7B000%7D">, and every person deviates from it.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AReading_%7Bijk%7D=%5Cunderbrace%7B%5Cunderbrace%7Bb_%7B000%7D%7D_%7Bb_%7B00k%7D%7D%7D_%7Bb_%7B0jk%7D%7D+e_%7Bijk%7D%0A"></p>
</section>
<section id="level-random-intercept-model" class="level1">
<h1>2-Level Random Intercept Model</h1>
<p>In this model, each class has an intercept, <img src="https://latex.codecogs.com/png.latex?b_%7B0jk%7D">. It posits an overall fixed intercept, <img src="https://latex.codecogs.com/png.latex?b_%7B000%7D">, and every person deviates from it.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AReading_%7Bijk%7D=%5Cunderbrace%7B%5Cunderbrace%7Bb_%7B000%7D%7D_%7Bb_%7B00k%7D%7D+e_%7B0jk%7D%7D_%7Bb_%7B0jk%7D%7D+e_%7Bijk%7D%0A"></p>
</section>
<section id="level-random-intercept-model-1" class="level1">
<h1>3-Level Random Intercept Model</h1>
<p><img src="https://latex.codecogs.com/png.latex?%0AReading_%7Bijk%7D=%5Cunderbrace%7B%5Cunderbrace%7Bb_%7B000%7D+e_%7B00k%7D%7D_%7Bb_%7B00k%7D%7D+e_%7B0jk%7D%7D_%7Bb_%7B0jk%7D%7D+e_%7Bijk%7D%0A"></p>
<p>We can test to see if there is sufficient variability in Reading at level 2 and at level three to justify a level-2 and/or level-3 model.</p>
<p>In the code below, we create a level-1 null model with the <code>lm</code> function, specifying just a a fixed intercept. Then we specify a level-2 null model with just classroom intercepts and a level-3 null model with classroom and school intercepts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-1 null model</span></span>
<span id="cb5-2">m_null_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-2 null model</span></span>
<span id="cb5-5">m_null_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_classroom), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_null_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading ~ 1 + (1 | id_classroom)
   Data: d

REML criterion at convergence: 104515

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.782 -0.638 -0.040  0.594  6.240 

Random effects:
 Groups       Name        Variance Std.Dev.
 id_classroom (Intercept) 191      13.8    
 Residual                 312      17.7    
Number of obs: 11914, groups:  id_classroom, 1191

Fixed effects:
            Estimate Std. Error t value
(Intercept)  116.363      0.435     268</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Level-2 null model</span></span>
<span id="cb7-2">m_null_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_classroom) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_school), d)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_null_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading ~ 1 + (1 | id_classroom) + (1 | id_school)
   Data: d

REML criterion at convergence: 104107

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.796 -0.640 -0.042  0.587  6.430 

Random effects:
 Groups       Name        Variance Std.Dev.
 id_classroom (Intercept) 105.2    10.26   
 id_school    (Intercept)  89.3     9.45   
 Residual                 312.0    17.66   
Number of obs: 11914, groups:  id_classroom, 1191; id_school, 60

Fixed effects:
            Estimate Std. Error t value
(Intercept)   116.19       1.27    91.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare both null models</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will fail if m_null_1 is listed first.</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set refit to FALSE because we are comparing models with different random effects</span></span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_null_3, m_null_2, m_null_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refit =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_null_1: reading ~ 1
m_null_2: reading ~ 1 + (1 | id_classroom)
m_null_3: reading ~ 1 + (1 | id_classroom) + (1 | id_school)
         npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_null_1    2 107884 107898 -53940   107880                        
m_null_2    3 104521 104543 -52257   104515  3365  1     &lt;2e-16 ***
m_null_3    4 104115 104144 -52053   104107   408  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We can see in the <code>Pr(&gt;Chisq)</code> column that the difference is significant for both comparisons, meaning that the level-2 and level-3 models are justified.</p>
<section id="check-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="check-assumptions">Check Assumptions</h2>
<p>The normality assumption holds at all levels. That is, all random variables, at all levels, should be normal.</p>
<p>First, let’s just look at the density plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_null_3)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/checknull-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The level-2 and level-3 intercepts look a little positively skewed. However, this level of non-normality is not usually fatal to the model.</p>
<p>Lets check the assumptions again after we have added our fixed effects to the model.</p>
</section>
</section>
<section id="fixed-effects-models" class="level1 page-columns page-full">
<h1>Fixed-Effects Models</h1>
<section id="level-1-predictors" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="level-1-predictors">Level 1 Predictors</h2>
<p>Let’s add our L1 predictor first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">m_1_L1fixed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_null_3, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_student)</span></code></pre></div>
</div>
<p>First, we need a new function that will compute variance reduction.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variance reduction does not always behave as it does in ordinary least squares. Think carefully about what is happening. Sometimes the variance reduction will be negative, meaning that the new variances are larger than the old variances. This does not necessarily mean that the new model is worse.</p>
<p>In general, do not interpret variance reduction when models have different random slopes structure <span class="citation" data-cites="mccoachMultilevelModelSelection2022">[@mccoachMultilevelModelSelection2022, 70]</span>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's make a function that automates the process of computing variance reduction</span></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This function will find which random components the 2 models have in common and compares them.</span></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Any non-shared variance components will be omitted.</span></span>
<span id="cb13-4">variance_reduction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(model_new, model_old) {</span>
<span id="cb13-5">  </span>
<span id="cb13-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(</span>
<span id="cb13-7">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VarCorr</span>(model_new), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower.tri"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-8">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Model"</span>),</span>
<span id="cb13-9">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VarCorr</span>(model_old), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower.tri"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-10">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Old Model"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sdcor) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Model"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Old Model"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(grp, var1, var2, model) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(grp, var1, var2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> vcov) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(term, var1, var2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variance Reduction</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Old Model</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">New Model</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Old Model</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb13-22">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">term =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(grp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residual"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 Variance"</span>, term) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-23">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Intercept</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intercept"</span>)) </span>
<span id="cb13-24">    </span>
<span id="cb13-25">}</span></code></pre></div>
</div>
<p>We are going to want a bunch of things every time we get a new model.</p>
<ol type="1">
<li>An assumption check plot (optional)</li>
<li>An automatic interpretation report</li>
<li>A summary of the model, preferably in a nice table</li>
<li>A plot of the fixed effects</li>
<li>A test of conditional slopes, if the model has interactions.</li>
<li>A statistical test of difference of the new model with a previous model</li>
<li>A statistical comparison of performance metrics from the new and previous models</li>
<li>Variance reduction statistics for the new model compared to a previous model</li>
</ol>
<p>The easiest way to get all this with only minimal fussing with code is to specify the old and new models each time like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_null_3</span>
<span id="cb14-2">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_1_L1fixed</span>
<span id="cb14-3">checkassumptions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set to TRUE if you want the check assumptions.</span></span></code></pre></div>
</div>
<p>Then run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb15-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb15-3">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb15-4">  }</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb15-7">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb15-8"></span>
<span id="cb15-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb15-10">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span>
<span id="cb15-11"></span>
<span id="cb15-12"></span>
<span id="cb15-13"></span>
<span id="cb15-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb15-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb15-16">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb15-17">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb15-18">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb15-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb15-20">           )</span>
<span id="cb15-21">}</span>
<span id="cb15-22"></span>
<span id="cb15-23"></span>
<span id="cb15-24"></span>
<span id="cb15-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb15-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb15-27">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb15-28">}</span>
<span id="cb15-29"></span>
<span id="cb15-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb15-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-32">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-33">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb15-35"></span>
<span id="cb15-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb15-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb15-38">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb15-39">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb15-40">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb15-41">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb15-42">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb15-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span>
<span id="cb15-44"></span>
<span id="cb15-45">  </span>
<span id="cb15-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb15-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
</div>
<p>If you want an easy way to run a lot of code repeatedly without making a function, you can “re-use” a previous code chunk. This way, if you make changes, you do so in one location only. The chunk with re-usable code was called <code>compare2models</code>. We can run it again by enclosing the code chunk name in brackets like so:</p>
<pre><code>m_old &lt;- m_null_3
m_new &lt;- m_1_L1fixed
&lt;&lt;compare2models&gt;&gt;</code></pre>
<p>When rendered, this chunk will expand to have the <code>compare2models</code> code copied into the chunk like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_null_3</span>
<span id="cb17-2">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_1_L1fixed</span>
<span id="cb17-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb17-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb17-5">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb17-6">  }</span>
<span id="cb17-7"></span>
<span id="cb17-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb17-9">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-10"></span>
<span id="cb17-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb17-12">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span>
<span id="cb17-13"></span>
<span id="cb17-14"></span>
<span id="cb17-15"></span>
<span id="cb17-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb17-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb17-18">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb17-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb17-20">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb17-21">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb17-22">           )</span>
<span id="cb17-23">}</span>
<span id="cb17-24"></span>
<span id="cb17-25"></span>
<span id="cb17-26"></span>
<span id="cb17-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb17-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb17-29">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb17-30">}</span>
<span id="cb17-31"></span>
<span id="cb17-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb17-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-35">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-36">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb17-37"></span>
<span id="cb17-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb17-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb17-40">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb17-41">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb17-42">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb17-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb17-44">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb17-45">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span>
<span id="cb17-46"></span>
<span id="cb17-47">  </span>
<span id="cb17-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb17-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
</div>
<p>However, this will give you a ton of output at once, which is fine for a rendered document but is cumbersome for interactive sessions. When you are first running the analyses, I recommend just copying the code and running the parts you want to see. Later, you can run the whole <code>compare2models</code> chunk for the rendered document, if desired.</p>
<p>Now let’s run the code and see what happens:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_null_3</span>
<span id="cb18-2">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_1_L1fixed</span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb18-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb18-5">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb18-6">  }</span>
<span id="cb18-7"></span>
<span id="cb18-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb18-9">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="5" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Beta</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">standardized CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">108.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">105.97&nbsp;–&nbsp;111.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.11&nbsp;–&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.75&nbsp;–&nbsp;4.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.33&nbsp;–&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="6" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">251.47</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">106.28</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">92.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.44</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">1191</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">60</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="5">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.118 / 0.507</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb19-2">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading with engagement_student (formula: reading ~
engagement_student). The model included id_classroom as random effects
(formula: list(~1 | id_classroom, ~1 | id_school)). The model's total
explanatory power is substantial (conditional R2 = 0.51) and the part related
to the fixed effects alone (marginal R2) is of 0.12. The model's intercept,
corresponding to engagement_student = 0, is at 108.51 (95% CI [105.97, 111.04],
t(11909) = 83.85, p &lt; .001). Within this model:

  - The effect of engagement student is statistically significant and positive
(beta = 3.90, 95% CI [3.75, 4.05], t(11909) = 51.27, p &lt; .001; Std. beta =
0.35, 95% CI [0.33, 0.36])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb21-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb21-3">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb21-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb21-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb21-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb21-7">           )</span>
<span id="cb21-8">}</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/L1fixedagain-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb22-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb22-3">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb22-4">}</span>
<span id="cb22-5"></span>
<span id="cb22-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb22-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="eulgzyppve" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#eulgzyppve table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eulgzyppve thead, #eulgzyppve tbody, #eulgzyppve tfoot, #eulgzyppve tr, #eulgzyppve td, #eulgzyppve th {
  border-style: none;
}

#eulgzyppve p {
  margin: 0;
  padding: 0;
}

#eulgzyppve .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eulgzyppve .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eulgzyppve .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eulgzyppve .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eulgzyppve .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eulgzyppve .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eulgzyppve .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eulgzyppve .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eulgzyppve .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eulgzyppve .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eulgzyppve .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eulgzyppve .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eulgzyppve .gt_spanner_row {
  border-bottom-style: hidden;
}

#eulgzyppve .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eulgzyppve .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eulgzyppve .gt_from_md > :first-child {
  margin-top: 0;
}

#eulgzyppve .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eulgzyppve .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eulgzyppve .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eulgzyppve .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eulgzyppve .gt_row_group_first td {
  border-top-width: 2px;
}

#eulgzyppve .gt_row_group_first th {
  border-top-width: 2px;
}

#eulgzyppve .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eulgzyppve .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eulgzyppve .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eulgzyppve .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eulgzyppve .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eulgzyppve .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eulgzyppve .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eulgzyppve .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eulgzyppve .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eulgzyppve .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eulgzyppve .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eulgzyppve .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eulgzyppve .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eulgzyppve .gt_left {
  text-align: left;
}

#eulgzyppve .gt_center {
  text-align: center;
}

#eulgzyppve .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eulgzyppve .gt_font_normal {
  font-weight: normal;
}

#eulgzyppve .gt_font_bold {
  font-weight: bold;
}

#eulgzyppve .gt_font_italic {
  font-style: italic;
}

#eulgzyppve .gt_super {
  font-size: 65%;
}

#eulgzyppve .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eulgzyppve .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eulgzyppve .gt_indent_1 {
  text-indent: 5px;
}

#eulgzyppve .gt_indent_2 {
  text-indent: 10px;
}

#eulgzyppve .gt_indent_3 {
  text-indent: 15px;
}

#eulgzyppve .gt_indent_4 {
  text-indent: 20px;
}

#eulgzyppve .gt_indent_5 {
  text-indent: 25px;
}

#eulgzyppve .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eulgzyppve div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="npar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">npar</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="BIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BIC</th>
<th id="logLik" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">logLik</th>
<th id="deviance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">deviance</th>
<th id="Chisq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chisq</th>
<th id="Df" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Df</th>
<th id="Pr(>Chisq)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="npar">4.00</td>
<td class="gt_row gt_right" headers="AIC">104,117.09</td>
<td class="gt_row gt_right" headers="BIC">104,146.63</td>
<td class="gt_row gt_right" headers="logLik">−52,054.54</td>
<td class="gt_row gt_right" headers="deviance">104,109.09</td>
<td class="gt_row gt_right" headers="Chisq"><br>
</td>
<td class="gt_row gt_right" headers="Df"><br>
</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="npar">5.00</td>
<td class="gt_row gt_right" headers="AIC">101,759.69</td>
<td class="gt_row gt_right" headers="BIC">101,796.62</td>
<td class="gt_row gt_right" headers="logLik">−50,874.85</td>
<td class="gt_row gt_right" headers="deviance">101,749.69</td>
<td class="gt_row gt_right" headers="Chisq">2,359.39</td>
<td class="gt_row gt_right" headers="Df">1.00</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)">0.00</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Test Model difference</div></div>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb23-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb23-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb23-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb23-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb23-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb23-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table style="border-collapse:collapse; border:none;">

<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">116.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">108.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">312.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.47</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">105.17 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">106.28 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">89.34 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">92.00 <sub>id_school</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.44</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.384</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.118 / 0.507</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">AIC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">104114.778</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101760.677</td>
</tr>

</tbody></table>

<div class="quarto-table-caption margin-caption">Model Comparison</div></div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="lkxsucvhsd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#lkxsucvhsd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lkxsucvhsd thead, #lkxsucvhsd tbody, #lkxsucvhsd tfoot, #lkxsucvhsd tr, #lkxsucvhsd td, #lkxsucvhsd th {
  border-style: none;
}

#lkxsucvhsd p {
  margin: 0;
  padding: 0;
}

#lkxsucvhsd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lkxsucvhsd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lkxsucvhsd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lkxsucvhsd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lkxsucvhsd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkxsucvhsd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkxsucvhsd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkxsucvhsd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lkxsucvhsd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lkxsucvhsd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lkxsucvhsd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lkxsucvhsd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lkxsucvhsd .gt_spanner_row {
  border-bottom-style: hidden;
}

#lkxsucvhsd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lkxsucvhsd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lkxsucvhsd .gt_from_md > :first-child {
  margin-top: 0;
}

#lkxsucvhsd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lkxsucvhsd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lkxsucvhsd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lkxsucvhsd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lkxsucvhsd .gt_row_group_first td {
  border-top-width: 2px;
}

#lkxsucvhsd .gt_row_group_first th {
  border-top-width: 2px;
}

#lkxsucvhsd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkxsucvhsd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lkxsucvhsd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lkxsucvhsd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkxsucvhsd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkxsucvhsd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lkxsucvhsd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lkxsucvhsd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lkxsucvhsd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkxsucvhsd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkxsucvhsd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkxsucvhsd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkxsucvhsd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkxsucvhsd .gt_left {
  text-align: left;
}

#lkxsucvhsd .gt_center {
  text-align: center;
}

#lkxsucvhsd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lkxsucvhsd .gt_font_normal {
  font-weight: normal;
}

#lkxsucvhsd .gt_font_bold {
  font-weight: bold;
}

#lkxsucvhsd .gt_font_italic {
  font-style: italic;
}

#lkxsucvhsd .gt_super {
  font-size: 65%;
}

#lkxsucvhsd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lkxsucvhsd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lkxsucvhsd .gt_indent_1 {
  text-indent: 5px;
}

#lkxsucvhsd .gt_indent_2 {
  text-indent: 10px;
}

#lkxsucvhsd .gt_indent_3 {
  text-indent: 15px;
}

#lkxsucvhsd .gt_indent_4 {
  text-indent: 20px;
}

#lkxsucvhsd .gt_indent_5 {
  text-indent: 25px;
}

#lkxsucvhsd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lkxsucvhsd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<thead>
<tr class="gt_col_headings header">
<th id="grp" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">grp</th>
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="New-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">New Model</th>
<th id="Old-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Old Model</th>
<th id="Variance-Reduction" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance Reduction</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="grp">Residual</td>
<td class="gt_row gt_left" headers="term">Level 1 Variance</td>
<td class="gt_row gt_right" headers="New Model">251</td>
<td class="gt_row gt_right" headers="Old Model">312.0</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.1941</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="grp">id_classroom</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">106</td>
<td class="gt_row gt_right" headers="Old Model">105.2</td>
<td class="gt_row gt_right" headers="Variance Reduction">-0.0105</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="grp">id_school</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">92</td>
<td class="gt_row gt_right" headers="Old Model">89.3</td>
<td class="gt_row gt_right" headers="Variance Reduction">-0.0298</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Variance Reduction</div></div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Coperatorname%7Breading%7D_%7Bi%7D%20%20&amp;%5Csim%20N%20%5Cleft(%5Calpha_%7Bj%5Bi%5D,k%5Bi%5D%7D,%20%5Csigma%5E2%20%5Cright)%20%5C%5C%0A%20%20%20%20%5Calpha_%7Bj%7D%20%20&amp;%5Csim%20N%20%5Cleft(%5Cmu_%7B%5Calpha_%7Bj%7D%7D,%20%5Csigma%5E2_%7B%5Calpha_%7Bj%7D%7D%20%5Cright)%0A%20%20%20%20%5Ctext%7B,%20for%20id%5C_classroom%20j%20=%201,%7D%20%5Cdots%20%5Ctext%7B,J%7D%20%5C%5C%0A%20%20%20%20%5Calpha_%7Bk%7D%20%20&amp;%5Csim%20N%20%5Cleft(%5Cmu_%7B%5Calpha_%7Bk%7D%7D,%20%5Csigma%5E2_%7B%5Calpha_%7Bk%7D%7D%20%5Cright)%0A%20%20%20%20%5Ctext%7B,%20for%20id%5C_school%20k%20=%201,%7D%20%5Cdots%20%5Ctext%7B,K%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>There was a lot going on in that output, but it is clear that <code>engagement_student</code> is a significant predictor of reading.</p>
</section>
<section id="level-2-predictors" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="level-2-predictors">Level 2 Predictors</h2>
<p>Now let’s add the L2 predictor, <code>engagement_teacher</code>:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">m_2_L2fixed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_1_L1fixed, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_teacher)</span>
<span id="cb25-2">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_1_L1fixed</span>
<span id="cb25-3">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_2_L2fixed</span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb25-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb25-6">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb25-7">  }</span>
<span id="cb25-8"></span>
<span id="cb25-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb25-10">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="5" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Beta</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">standardized CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">101.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">99.10&nbsp;–&nbsp;104.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.12&nbsp;–&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.76&nbsp;–&nbsp;4.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.33&nbsp;–&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.08&nbsp;–&nbsp;3.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28&nbsp;–&nbsp;0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="6" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">251.33</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">57.74</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">96.06</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.38</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">1191</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">60</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="5">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.209 / 0.509</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb26-2">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading with engagement_student and engagement_teacher (formula:
reading ~ engagement_student + engagement_teacher). The model included
id_classroom as random effects (formula: list(~1 | id_classroom, ~1 |
id_school)). The model's total explanatory power is substantial (conditional R2
= 0.51) and the part related to the fixed effects alone (marginal R2) is of
0.21. The model's intercept, corresponding to engagement_student = 0 and
engagement_teacher = 0, is at 101.70 (95% CI [99.10, 104.31], t(11908) = 76.45,
p &lt; .001). Within this model:

  - The effect of engagement student is statistically significant and positive
(beta = 3.91, 95% CI [3.76, 4.06], t(11908) = 51.68, p &lt; .001; Std. beta =
0.35, 95% CI [0.33, 0.36])
  - The effect of engagement teacher is statistically significant and positive
(beta = 3.34, 95% CI [3.08, 3.60], t(11908) = 25.51, p &lt; .001; Std. beta =
0.31, 95% CI [0.28, 0.33])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb28-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb28-3">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb28-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb28-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb28-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb28-7">           )</span>
<span id="cb28-8">}</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/L2fixed-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb29-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb29-3">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb29-4">}</span>
<span id="cb29-5"></span>
<span id="cb29-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb29-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="ojixinemlz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#ojixinemlz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ojixinemlz thead, #ojixinemlz tbody, #ojixinemlz tfoot, #ojixinemlz tr, #ojixinemlz td, #ojixinemlz th {
  border-style: none;
}

#ojixinemlz p {
  margin: 0;
  padding: 0;
}

#ojixinemlz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ojixinemlz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ojixinemlz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ojixinemlz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ojixinemlz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojixinemlz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojixinemlz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojixinemlz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ojixinemlz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ojixinemlz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ojixinemlz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ojixinemlz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ojixinemlz .gt_spanner_row {
  border-bottom-style: hidden;
}

#ojixinemlz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ojixinemlz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ojixinemlz .gt_from_md > :first-child {
  margin-top: 0;
}

#ojixinemlz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ojixinemlz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ojixinemlz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ojixinemlz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ojixinemlz .gt_row_group_first td {
  border-top-width: 2px;
}

#ojixinemlz .gt_row_group_first th {
  border-top-width: 2px;
}

#ojixinemlz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojixinemlz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ojixinemlz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ojixinemlz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojixinemlz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojixinemlz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ojixinemlz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ojixinemlz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ojixinemlz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojixinemlz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojixinemlz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojixinemlz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojixinemlz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojixinemlz .gt_left {
  text-align: left;
}

#ojixinemlz .gt_center {
  text-align: center;
}

#ojixinemlz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ojixinemlz .gt_font_normal {
  font-weight: normal;
}

#ojixinemlz .gt_font_bold {
  font-weight: bold;
}

#ojixinemlz .gt_font_italic {
  font-style: italic;
}

#ojixinemlz .gt_super {
  font-size: 65%;
}

#ojixinemlz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ojixinemlz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ojixinemlz .gt_indent_1 {
  text-indent: 5px;
}

#ojixinemlz .gt_indent_2 {
  text-indent: 10px;
}

#ojixinemlz .gt_indent_3 {
  text-indent: 15px;
}

#ojixinemlz .gt_indent_4 {
  text-indent: 20px;
}

#ojixinemlz .gt_indent_5 {
  text-indent: 25px;
}

#ojixinemlz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ojixinemlz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="npar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">npar</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="BIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BIC</th>
<th id="logLik" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">logLik</th>
<th id="deviance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">deviance</th>
<th id="Chisq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chisq</th>
<th id="Df" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Df</th>
<th id="Pr(>Chisq)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="npar">5.00</td>
<td class="gt_row gt_right" headers="AIC">101,759.69</td>
<td class="gt_row gt_right" headers="BIC">101,796.62</td>
<td class="gt_row gt_right" headers="logLik">−50,874.85</td>
<td class="gt_row gt_right" headers="deviance">101,749.69</td>
<td class="gt_row gt_right" headers="Chisq"><br>
</td>
<td class="gt_row gt_right" headers="Df"><br>
</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="npar">6.00</td>
<td class="gt_row gt_right" headers="AIC">101,245.12</td>
<td class="gt_row gt_right" headers="BIC">101,289.43</td>
<td class="gt_row gt_right" headers="logLik">−50,616.56</td>
<td class="gt_row gt_right" headers="deviance">101,233.12</td>
<td class="gt_row gt_right" headers="Chisq">516.57</td>
<td class="gt_row gt_right" headers="Df">1.00</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)">0.00</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Test Model difference</div></div>
</div>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb30-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb30-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb30-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb30-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb30-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb30-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table style="border-collapse:collapse; border:none;">

<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">108.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">101.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.33</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">106.28 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">57.74 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">92.00 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">96.06 <sub>id_school</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.38</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.118 / 0.507</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.209 / 0.509</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">AIC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101760.677</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101248.328</td>
</tr>

</tbody></table>

<div class="quarto-table-caption margin-caption">Model Comparison</div></div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="snjtkaiwfw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#snjtkaiwfw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#snjtkaiwfw thead, #snjtkaiwfw tbody, #snjtkaiwfw tfoot, #snjtkaiwfw tr, #snjtkaiwfw td, #snjtkaiwfw th {
  border-style: none;
}

#snjtkaiwfw p {
  margin: 0;
  padding: 0;
}

#snjtkaiwfw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#snjtkaiwfw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#snjtkaiwfw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#snjtkaiwfw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#snjtkaiwfw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#snjtkaiwfw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#snjtkaiwfw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#snjtkaiwfw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#snjtkaiwfw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#snjtkaiwfw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#snjtkaiwfw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#snjtkaiwfw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#snjtkaiwfw .gt_spanner_row {
  border-bottom-style: hidden;
}

#snjtkaiwfw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#snjtkaiwfw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#snjtkaiwfw .gt_from_md > :first-child {
  margin-top: 0;
}

#snjtkaiwfw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#snjtkaiwfw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#snjtkaiwfw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#snjtkaiwfw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#snjtkaiwfw .gt_row_group_first td {
  border-top-width: 2px;
}

#snjtkaiwfw .gt_row_group_first th {
  border-top-width: 2px;
}

#snjtkaiwfw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#snjtkaiwfw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#snjtkaiwfw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#snjtkaiwfw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#snjtkaiwfw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#snjtkaiwfw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#snjtkaiwfw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#snjtkaiwfw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#snjtkaiwfw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#snjtkaiwfw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#snjtkaiwfw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#snjtkaiwfw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#snjtkaiwfw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#snjtkaiwfw .gt_left {
  text-align: left;
}

#snjtkaiwfw .gt_center {
  text-align: center;
}

#snjtkaiwfw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#snjtkaiwfw .gt_font_normal {
  font-weight: normal;
}

#snjtkaiwfw .gt_font_bold {
  font-weight: bold;
}

#snjtkaiwfw .gt_font_italic {
  font-style: italic;
}

#snjtkaiwfw .gt_super {
  font-size: 65%;
}

#snjtkaiwfw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#snjtkaiwfw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#snjtkaiwfw .gt_indent_1 {
  text-indent: 5px;
}

#snjtkaiwfw .gt_indent_2 {
  text-indent: 10px;
}

#snjtkaiwfw .gt_indent_3 {
  text-indent: 15px;
}

#snjtkaiwfw .gt_indent_4 {
  text-indent: 20px;
}

#snjtkaiwfw .gt_indent_5 {
  text-indent: 25px;
}

#snjtkaiwfw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#snjtkaiwfw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<thead>
<tr class="gt_col_headings header">
<th id="grp" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">grp</th>
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="New-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">New Model</th>
<th id="Old-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Old Model</th>
<th id="Variance-Reduction" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance Reduction</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="grp">Residual</td>
<td class="gt_row gt_left" headers="term">Level 1 Variance</td>
<td class="gt_row gt_right" headers="New Model">251.3</td>
<td class="gt_row gt_right" headers="Old Model">251</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.000525</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="grp">id_classroom</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">57.7</td>
<td class="gt_row gt_right" headers="Old Model">106</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.456652</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="grp">id_school</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">96.1</td>
<td class="gt_row gt_right" headers="Old Model">92</td>
<td class="gt_row gt_right" headers="Variance Reduction">-0.044126</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Variance Reduction</div></div>
</div>
</div>
<p>Again, that is a lot of output to wade through, but it is clear that <code>engagement_teacher</code> is a significant predictor of reading.</p>
</section>
<section id="level-3-predictors" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="level-3-predictors">Level 3 Predictors</h2>
<p>Let’s add the L3 predictor, <code>engagement_principal</code>:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">m_3_L3fixed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_2_L2fixed, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_principal)</span>
<span id="cb32-2">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_2_L2fixed</span>
<span id="cb32-3">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_3_L3fixed</span>
<span id="cb32-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb32-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb32-6">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb32-7">  }</span>
<span id="cb32-8"></span>
<span id="cb32-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb32-10">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="5" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Beta</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">standardized CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">97.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">94.73&nbsp;–&nbsp;101.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.11&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.76&nbsp;–&nbsp;4.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.33&nbsp;–&nbsp;0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.08&nbsp;–&nbsp;3.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28&nbsp;–&nbsp;0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.70&nbsp;–&nbsp;2.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07&nbsp;–&nbsp;0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="6" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">251.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">57.75</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">81.23</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.36</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">1191</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">60</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="5">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">0.237 / 0.508</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb33-2">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading with engagement_student, engagement_teacher and
engagement_principal (formula: reading ~ engagement_student +
engagement_teacher + engagement_principal). The model included id_classroom as
random effects (formula: list(~1 | id_classroom, ~1 | id_school)). The model's
total explanatory power is substantial (conditional R2 = 0.51) and the part
related to the fixed effects alone (marginal R2) is of 0.24. The model's
intercept, corresponding to engagement_student = 0, engagement_teacher = 0 and
engagement_principal = 0, is at 97.99 (95% CI [94.73, 101.25], t(11907) =
58.92, p &lt; .001). Within this model:

  - The effect of engagement student is statistically significant and positive
(beta = 3.91, 95% CI [3.76, 4.06], t(11907) = 51.68, p &lt; .001; Std. beta =
0.35, 95% CI [0.33, 0.36])
  - The effect of engagement teacher is statistically significant and positive
(beta = 3.34, 95% CI [3.08, 3.60], t(11907) = 25.51, p &lt; .001; Std. beta =
0.31, 95% CI [0.28, 0.33])
  - The effect of engagement principal is statistically significant and positive
(beta = 1.69, 95% CI [0.70, 2.69], t(11907) = 3.34, p &lt; .001; Std. beta = 0.17,
95% CI [0.07, 0.27])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb35-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb35-3">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb35-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb35-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb35-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb35-7">           )</span>
<span id="cb35-8">}</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/L3fixed-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb36-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb36-3">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb36-4">}</span>
<span id="cb36-5"></span>
<span id="cb36-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb36-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="pkyoiiiswl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#pkyoiiiswl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pkyoiiiswl thead, #pkyoiiiswl tbody, #pkyoiiiswl tfoot, #pkyoiiiswl tr, #pkyoiiiswl td, #pkyoiiiswl th {
  border-style: none;
}

#pkyoiiiswl p {
  margin: 0;
  padding: 0;
}

#pkyoiiiswl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pkyoiiiswl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pkyoiiiswl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pkyoiiiswl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pkyoiiiswl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkyoiiiswl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkyoiiiswl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkyoiiiswl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pkyoiiiswl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pkyoiiiswl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pkyoiiiswl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pkyoiiiswl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pkyoiiiswl .gt_spanner_row {
  border-bottom-style: hidden;
}

#pkyoiiiswl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pkyoiiiswl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pkyoiiiswl .gt_from_md > :first-child {
  margin-top: 0;
}

#pkyoiiiswl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pkyoiiiswl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pkyoiiiswl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pkyoiiiswl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pkyoiiiswl .gt_row_group_first td {
  border-top-width: 2px;
}

#pkyoiiiswl .gt_row_group_first th {
  border-top-width: 2px;
}

#pkyoiiiswl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkyoiiiswl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pkyoiiiswl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pkyoiiiswl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkyoiiiswl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkyoiiiswl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pkyoiiiswl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pkyoiiiswl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pkyoiiiswl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkyoiiiswl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkyoiiiswl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkyoiiiswl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkyoiiiswl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkyoiiiswl .gt_left {
  text-align: left;
}

#pkyoiiiswl .gt_center {
  text-align: center;
}

#pkyoiiiswl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pkyoiiiswl .gt_font_normal {
  font-weight: normal;
}

#pkyoiiiswl .gt_font_bold {
  font-weight: bold;
}

#pkyoiiiswl .gt_font_italic {
  font-style: italic;
}

#pkyoiiiswl .gt_super {
  font-size: 65%;
}

#pkyoiiiswl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pkyoiiiswl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pkyoiiiswl .gt_indent_1 {
  text-indent: 5px;
}

#pkyoiiiswl .gt_indent_2 {
  text-indent: 10px;
}

#pkyoiiiswl .gt_indent_3 {
  text-indent: 15px;
}

#pkyoiiiswl .gt_indent_4 {
  text-indent: 20px;
}

#pkyoiiiswl .gt_indent_5 {
  text-indent: 25px;
}

#pkyoiiiswl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pkyoiiiswl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="npar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">npar</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="BIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BIC</th>
<th id="logLik" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">logLik</th>
<th id="deviance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">deviance</th>
<th id="Chisq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chisq</th>
<th id="Df" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Df</th>
<th id="Pr(>Chisq)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="npar">6.00</td>
<td class="gt_row gt_right" headers="AIC">101,245.12</td>
<td class="gt_row gt_right" headers="BIC">101,289.43</td>
<td class="gt_row gt_right" headers="logLik">−50,616.56</td>
<td class="gt_row gt_right" headers="deviance">101,233.12</td>
<td class="gt_row gt_right" headers="Chisq"><br>
</td>
<td class="gt_row gt_right" headers="Df"><br>
</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="npar">7.00</td>
<td class="gt_row gt_right" headers="AIC">101,236.58</td>
<td class="gt_row gt_right" headers="BIC">101,288.28</td>
<td class="gt_row gt_right" headers="logLik">−50,611.29</td>
<td class="gt_row gt_right" headers="deviance">101,222.58</td>
<td class="gt_row gt_right" headers="Chisq">10.54</td>
<td class="gt_row gt_right" headers="Df">1.00</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)">0.00</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Test Model difference</div></div>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb37-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb37-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb37-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb37-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb37-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb37-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb37-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table style="border-collapse:collapse; border:none;">

<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">101.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">97.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">57.74 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">57.75 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">96.06 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">81.23 <sub>id_school</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.36</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.209 / 0.509</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.237 / 0.508</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">AIC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101248.328</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101239.498</td>
</tr>

</tbody></table>

<div class="quarto-table-caption margin-caption">Model Comparison</div></div>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb38-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="ofajihbcvk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#ofajihbcvk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ofajihbcvk thead, #ofajihbcvk tbody, #ofajihbcvk tfoot, #ofajihbcvk tr, #ofajihbcvk td, #ofajihbcvk th {
  border-style: none;
}

#ofajihbcvk p {
  margin: 0;
  padding: 0;
}

#ofajihbcvk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ofajihbcvk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ofajihbcvk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ofajihbcvk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ofajihbcvk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ofajihbcvk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofajihbcvk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ofajihbcvk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ofajihbcvk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ofajihbcvk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ofajihbcvk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ofajihbcvk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ofajihbcvk .gt_spanner_row {
  border-bottom-style: hidden;
}

#ofajihbcvk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ofajihbcvk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ofajihbcvk .gt_from_md > :first-child {
  margin-top: 0;
}

#ofajihbcvk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ofajihbcvk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ofajihbcvk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ofajihbcvk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ofajihbcvk .gt_row_group_first td {
  border-top-width: 2px;
}

#ofajihbcvk .gt_row_group_first th {
  border-top-width: 2px;
}

#ofajihbcvk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofajihbcvk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ofajihbcvk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ofajihbcvk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofajihbcvk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofajihbcvk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ofajihbcvk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ofajihbcvk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ofajihbcvk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofajihbcvk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ofajihbcvk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofajihbcvk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ofajihbcvk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofajihbcvk .gt_left {
  text-align: left;
}

#ofajihbcvk .gt_center {
  text-align: center;
}

#ofajihbcvk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ofajihbcvk .gt_font_normal {
  font-weight: normal;
}

#ofajihbcvk .gt_font_bold {
  font-weight: bold;
}

#ofajihbcvk .gt_font_italic {
  font-style: italic;
}

#ofajihbcvk .gt_super {
  font-size: 65%;
}

#ofajihbcvk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ofajihbcvk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ofajihbcvk .gt_indent_1 {
  text-indent: 5px;
}

#ofajihbcvk .gt_indent_2 {
  text-indent: 10px;
}

#ofajihbcvk .gt_indent_3 {
  text-indent: 15px;
}

#ofajihbcvk .gt_indent_4 {
  text-indent: 20px;
}

#ofajihbcvk .gt_indent_5 {
  text-indent: 25px;
}

#ofajihbcvk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ofajihbcvk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<thead>
<tr class="gt_col_headings header">
<th id="grp" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">grp</th>
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="New-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">New Model</th>
<th id="Old-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Old Model</th>
<th id="Variance-Reduction" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance Reduction</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="grp">Residual</td>
<td class="gt_row gt_left" headers="term">Level 1 Variance</td>
<td class="gt_row gt_right" headers="New Model">251.3</td>
<td class="gt_row gt_right" headers="Old Model">251.3</td>
<td class="gt_row gt_right" headers="Variance Reduction">-1.85e-06</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="grp">id_classroom</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">57.7</td>
<td class="gt_row gt_right" headers="Old Model">57.7</td>
<td class="gt_row gt_right" headers="Variance Reduction">-5.51e-05</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="grp">id_school</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">81.2</td>
<td class="gt_row gt_right" headers="Old Model">96.1</td>
<td class="gt_row gt_right" headers="Variance Reduction">1.54e-01</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Variance Reduction</div></div>
</div>
</div>
<p>Now we see that all three engagement variables are significant preductors.</p>
<p>Let’s see how much variance our fixed effects explain compared to our null model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_3_L3fixed, m_null_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name        |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
---------------------------------------------------------------------------
m_3_L3fixed | lmerMod | 1.0e+05 (&gt;.999) | 1.0e+05 (&gt;.999) | 1.0e+05 (&gt;.999)
m_null_3    | lmerMod | 1.0e+05 (&lt;.001) | 1.0e+05 (&lt;.001) | 1.0e+05 (&lt;.001)

Name        | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
---------------------------------------------------------------
m_3_L3fixed |      0.508 |      0.237 | 0.356 | 15.291 | 15.854
m_null_3    |      0.384 |      0.000 | 0.384 | 16.974 | 17.665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_3_L3fixed, m_null_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  grp          term             `New Model` `Old Model` `Variance Reduction`
  &lt;chr&gt;        &lt;chr&gt;                  &lt;dbl&gt;       &lt;dbl&gt;                &lt;dbl&gt;
1 Residual     Level 1 Variance       251.        312.                0.195 
2 id_classroom Intercept               57.7       105.                0.451 
3 id_school    Intercept               81.2        89.3               0.0908</code></pre>
</div>
</div>
<p>Not bad!</p>
</section>
</section>
<section id="level-2-random-slopes" class="level1 page-columns page-full">
<h1>Level-2 Random Slopes</h1>
<section id="uncorrelated-slopes-and-intercepts-at-l2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="uncorrelated-slopes-and-intercepts-at-l2">Uncorrelated slopes and intercepts at L2</h2>
<p>We are going to fit two models with random slopes for student engagement. First, we will make the L2 slopes uncorrelated with the L2 intercepts. Then we will allow them to correlate.</p>
<p>Although I normally use the <code>update</code> function to specify new models, my experience is that updating random components gets messy very fast. It seems safer to just specify the models by hand (but carefully!).</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">m_4_L2_uncorrelated_slopes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> engagement_student  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_teacher <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_principal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_student <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> id_classroom) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_school), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb43-2"></span>
<span id="cb43-3">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_3_L3fixed</span>
<span id="cb43-4">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_4_L2_uncorrelated_slopes</span>
<span id="cb43-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb43-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb43-7">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb43-8">  }</span>
<span id="cb43-9"></span>
<span id="cb43-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb43-11">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="6" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Beta</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">standardized CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">std. p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">98.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">95.60&nbsp;–&nbsp;102.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.11&nbsp;–&nbsp;0.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.861</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.77&nbsp;–&nbsp;4.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.33&nbsp;–&nbsp;0.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.71&nbsp;–&nbsp;3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28&nbsp;–&nbsp;0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.63&nbsp;–&nbsp;2.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07&nbsp;–&nbsp;0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">226.74</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">33.84</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">81.17</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>id_classroom.engagement_student</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">5.99</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">0.34</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">1191</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">60</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="6">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">0.246 / 0.500</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb44-2">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading with engagement_student, engagement_teacher and
engagement_principal (formula: reading ~ engagement_student +
engagement_teacher + engagement_principal). The model included id_classroom as
random effects (formula: list(~1 | id_classroom, ~0 + engagement_student |
id_classroom, ~1 | id_school)). The model's total explanatory power is
substantial (conditional R2 = 0.50) and the part related to the fixed effects
alone (marginal R2) is of 0.25. The model's intercept, corresponding to
engagement_student = 0, engagement_teacher = 0 and engagement_principal = 0, is
at 98.83 (95% CI [95.60, 102.06], t(11906) = 59.94, p &lt; .001). Within this
model:

  - The effect of engagement student is statistically significant and positive
(beta = 3.98, 95% CI [3.77, 4.20], t(11906) = 35.88, p &lt; .001; Std. beta =
0.35, 95% CI [0.33, 0.37])
  - The effect of engagement teacher is statistically significant and positive
(beta = 2.94, 95% CI [2.71, 3.17], t(11906) = 24.63, p &lt; .001; Std. beta =
0.31, 95% CI [0.28, 0.33])
  - The effect of engagement principal is statistically significant and positive
(beta = 1.61, 95% CI [0.63, 2.60], t(11906) = 3.20, p = 0.001; Std. beta =
0.17, 95% CI [0.07, 0.27])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb46-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb46-3">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb46-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb46-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb46-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb46-7">           )</span>
<span id="cb46-8">}</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/L2uncorrelated-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb47-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb47-3">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb47-4">}</span>
<span id="cb47-5"></span>
<span id="cb47-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb47-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb47-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb47-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb47-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="opkoidbogt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#opkoidbogt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#opkoidbogt thead, #opkoidbogt tbody, #opkoidbogt tfoot, #opkoidbogt tr, #opkoidbogt td, #opkoidbogt th {
  border-style: none;
}

#opkoidbogt p {
  margin: 0;
  padding: 0;
}

#opkoidbogt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#opkoidbogt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#opkoidbogt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#opkoidbogt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#opkoidbogt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#opkoidbogt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#opkoidbogt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#opkoidbogt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#opkoidbogt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#opkoidbogt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#opkoidbogt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#opkoidbogt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#opkoidbogt .gt_spanner_row {
  border-bottom-style: hidden;
}

#opkoidbogt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#opkoidbogt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#opkoidbogt .gt_from_md > :first-child {
  margin-top: 0;
}

#opkoidbogt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#opkoidbogt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#opkoidbogt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#opkoidbogt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#opkoidbogt .gt_row_group_first td {
  border-top-width: 2px;
}

#opkoidbogt .gt_row_group_first th {
  border-top-width: 2px;
}

#opkoidbogt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#opkoidbogt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#opkoidbogt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#opkoidbogt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#opkoidbogt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#opkoidbogt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#opkoidbogt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#opkoidbogt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#opkoidbogt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#opkoidbogt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#opkoidbogt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#opkoidbogt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#opkoidbogt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#opkoidbogt .gt_left {
  text-align: left;
}

#opkoidbogt .gt_center {
  text-align: center;
}

#opkoidbogt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#opkoidbogt .gt_font_normal {
  font-weight: normal;
}

#opkoidbogt .gt_font_bold {
  font-weight: bold;
}

#opkoidbogt .gt_font_italic {
  font-style: italic;
}

#opkoidbogt .gt_super {
  font-size: 65%;
}

#opkoidbogt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#opkoidbogt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#opkoidbogt .gt_indent_1 {
  text-indent: 5px;
}

#opkoidbogt .gt_indent_2 {
  text-indent: 10px;
}

#opkoidbogt .gt_indent_3 {
  text-indent: 15px;
}

#opkoidbogt .gt_indent_4 {
  text-indent: 20px;
}

#opkoidbogt .gt_indent_5 {
  text-indent: 25px;
}

#opkoidbogt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#opkoidbogt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="npar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">npar</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="BIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BIC</th>
<th id="logLik" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">logLik</th>
<th id="deviance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">deviance</th>
<th id="Chisq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chisq</th>
<th id="Df" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Df</th>
<th id="Pr(>Chisq)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="npar">7.00</td>
<td class="gt_row gt_right" headers="AIC">101,236.58</td>
<td class="gt_row gt_right" headers="BIC">101,288.28</td>
<td class="gt_row gt_right" headers="logLik">−50,611.29</td>
<td class="gt_row gt_right" headers="deviance">101,222.58</td>
<td class="gt_row gt_right" headers="Chisq"><br>
</td>
<td class="gt_row gt_right" headers="Df"><br>
</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="npar">8.00</td>
<td class="gt_row gt_right" headers="AIC">100,619.42</td>
<td class="gt_row gt_right" headers="BIC">100,678.50</td>
<td class="gt_row gt_right" headers="logLik">−50,301.71</td>
<td class="gt_row gt_right" headers="deviance">100,603.42</td>
<td class="gt_row gt_right" headers="Chisq">619.17</td>
<td class="gt_row gt_right" headers="Df">1.00</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)">0.00</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Test Model difference</div></div>
</div>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb48-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb48-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb48-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb48-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb48-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb48-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb48-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table style="border-collapse:collapse; border:none;">

<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">std. p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">97.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">98.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.861</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="8" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">251.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">226.74</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">57.75 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">33.84 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">81.23 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">81.17 <sub>id_school</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">5.99 <sub>id_classroom.engagement_student</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.34</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1191 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">1191 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">60 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">60 <sub>id_school</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">11914</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.237 / 0.508</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.246 / 0.500</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">AIC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">101239.498</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">100621.770</td>
</tr>

</tbody></table>

<div class="quarto-table-caption margin-caption">Model Comparison</div></div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb49-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb49-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="flotsnzjef" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#flotsnzjef table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#flotsnzjef thead, #flotsnzjef tbody, #flotsnzjef tfoot, #flotsnzjef tr, #flotsnzjef td, #flotsnzjef th {
  border-style: none;
}

#flotsnzjef p {
  margin: 0;
  padding: 0;
}

#flotsnzjef .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#flotsnzjef .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#flotsnzjef .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#flotsnzjef .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#flotsnzjef .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#flotsnzjef .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#flotsnzjef .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#flotsnzjef .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#flotsnzjef .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#flotsnzjef .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#flotsnzjef .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#flotsnzjef .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#flotsnzjef .gt_spanner_row {
  border-bottom-style: hidden;
}

#flotsnzjef .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#flotsnzjef .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#flotsnzjef .gt_from_md > :first-child {
  margin-top: 0;
}

#flotsnzjef .gt_from_md > :last-child {
  margin-bottom: 0;
}

#flotsnzjef .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#flotsnzjef .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#flotsnzjef .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#flotsnzjef .gt_row_group_first td {
  border-top-width: 2px;
}

#flotsnzjef .gt_row_group_first th {
  border-top-width: 2px;
}

#flotsnzjef .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#flotsnzjef .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#flotsnzjef .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#flotsnzjef .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#flotsnzjef .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#flotsnzjef .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#flotsnzjef .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#flotsnzjef .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#flotsnzjef .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#flotsnzjef .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#flotsnzjef .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#flotsnzjef .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#flotsnzjef .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#flotsnzjef .gt_left {
  text-align: left;
}

#flotsnzjef .gt_center {
  text-align: center;
}

#flotsnzjef .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#flotsnzjef .gt_font_normal {
  font-weight: normal;
}

#flotsnzjef .gt_font_bold {
  font-weight: bold;
}

#flotsnzjef .gt_font_italic {
  font-style: italic;
}

#flotsnzjef .gt_super {
  font-size: 65%;
}

#flotsnzjef .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#flotsnzjef .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#flotsnzjef .gt_indent_1 {
  text-indent: 5px;
}

#flotsnzjef .gt_indent_2 {
  text-indent: 10px;
}

#flotsnzjef .gt_indent_3 {
  text-indent: 15px;
}

#flotsnzjef .gt_indent_4 {
  text-indent: 20px;
}

#flotsnzjef .gt_indent_5 {
  text-indent: 25px;
}

#flotsnzjef .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#flotsnzjef div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<thead>
<tr class="gt_col_headings header">
<th id="grp" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">grp</th>
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="New-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">New Model</th>
<th id="Old-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Old Model</th>
<th id="Variance-Reduction" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance Reduction</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="grp">Residual</td>
<td class="gt_row gt_left" headers="term">Level 1 Variance</td>
<td class="gt_row gt_right" headers="New Model">226.7</td>
<td class="gt_row gt_right" headers="Old Model">251.3</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.09785</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="grp">id_classroom</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">33.8</td>
<td class="gt_row gt_right" headers="Old Model">57.7</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.41393</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="grp">id_school</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">81.2</td>
<td class="gt_row gt_right" headers="Old Model">81.2</td>
<td class="gt_row gt_right" headers="Variance Reduction">0.00069</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Variance Reduction</div></div>
</div>
</div>
<p><strong>Interpretation</strong>: We need to include the L2 random slopes for <code>student engagment</code> in our model. Why? The comparison using the <code>anova</code> function was significant. Also, the <code>AIC-wt</code> from the <code>compare_performance</code> function tells us we should prefer the random slopes model over the fixed effects model.</p>
</section>
<section id="correlated-slopes-and-intercepts-at-l2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="correlated-slopes-and-intercepts-at-l2">Correlated slopes and intercepts at L2</h2>
<p>For the sake of completeness, we can let the random slopes and intercepts correlate.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">m_5_L2_correlated_slopes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> engagement_student  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_teacher <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_principal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_student <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_classroom) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_school), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb50-2"></span>
<span id="cb50-3">m_old <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_4_L2_uncorrelated_slopes</span>
<span id="cb50-4">m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_5_L2_correlated_slopes</span>
<span id="cb50-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check assumptions if checkassumptions is TRUE</span></span>
<span id="cb50-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (checkassumptions) {</span>
<span id="cb50-7">  performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_new)</span>
<span id="cb50-8">  }</span>
<span id="cb50-9"></span>
<span id="cb50-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabular display of new model</span></span>
<span id="cb50-11">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="6" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. Beta</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">standardized CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">std. p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">98.84</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">95.61&nbsp;–&nbsp;102.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.11&nbsp;–&nbsp;0.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.864</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.77&nbsp;–&nbsp;4.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34&nbsp;–&nbsp;0.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.70&nbsp;–&nbsp;3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.25&nbsp;–&nbsp;0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.62&nbsp;–&nbsp;2.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;0.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">226.82</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">33.45</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">81.18</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>id_classroom.engagement_student</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">5.94</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub> <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">0.02</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">0.42</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">1191</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">60</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="6">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="6">0.223 / 0.547</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Automated report of new model</span></span>
<span id="cb51-2">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_effectsize =</span> T) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading with engagement_student, engagement_teacher and
engagement_principal (formula: reading ~ engagement_student +
engagement_teacher + engagement_principal). The model included
engagement_student as random effects (formula: list(~1 + engagement_student |
id_classroom, ~1 | id_school)). The model's total explanatory power is
substantial (conditional R2 = 0.55) and the part related to the fixed effects
alone (marginal R2) is of 0.22. The model's intercept, corresponding to
engagement_student = 0, engagement_teacher = 0 and engagement_principal = 0, is
at 98.84 (95% CI [95.61, 102.07], t(11905) = 59.95, p &lt; .001). Within this
model:

  - The effect of engagement student is statistically significant and positive
(beta = 3.98, 95% CI [3.77, 4.20], t(11905) = 35.96, p &lt; .001; Std. beta =
0.35, 95% CI [0.34, 0.37])
  - The effect of engagement teacher is statistically significant and positive
(beta = 2.93, 95% CI [2.70, 3.17], t(11905) = 24.59, p &lt; .001; Std. beta =
0.27, 95% CI [0.25, 0.29])
  - The effect of engagement principal is statistically significant and positive
(beta = 1.61, 95% CI [0.62, 2.60], t(11905) = 3.20, p = 0.001; Std. beta =
0.16, 95% CI [0.06, 0.26])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot fixed effects in new model</span></span>
<span id="cb53-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional)) {</span>
<span id="cb53-3">  sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_new, </span>
<span id="cb53-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, </span>
<span id="cb53-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse1</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(m_new)), </span>
<span id="cb53-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_predictors</span>(m_new)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>conditional</span>
<span id="cb53-7">           )</span>
<span id="cb53-8">}</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/MultiLevel3/multilevel3_files/figure-html/L2correlated-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test simple slopes, if interactions are present</span></span>
<span id="cb54-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(insight<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_interactions</span>(m_new))) {</span>
<span id="cb54-3">  reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reghelper</span>(m_new)</span>
<span id="cb54-4">}</span>
<span id="cb54-5"></span>
<span id="cb54-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test comparison</span></span>
<span id="cb54-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_old, m_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb54-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Model difference"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb54-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb54-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="ydwuznycod" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#ydwuznycod table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ydwuznycod thead, #ydwuznycod tbody, #ydwuznycod tfoot, #ydwuznycod tr, #ydwuznycod td, #ydwuznycod th {
  border-style: none;
}

#ydwuznycod p {
  margin: 0;
  padding: 0;
}

#ydwuznycod .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ydwuznycod .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ydwuznycod .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ydwuznycod .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ydwuznycod .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydwuznycod .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydwuznycod .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydwuznycod .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ydwuznycod .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ydwuznycod .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ydwuznycod .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ydwuznycod .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ydwuznycod .gt_spanner_row {
  border-bottom-style: hidden;
}

#ydwuznycod .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ydwuznycod .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ydwuznycod .gt_from_md > :first-child {
  margin-top: 0;
}

#ydwuznycod .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ydwuznycod .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ydwuznycod .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ydwuznycod .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ydwuznycod .gt_row_group_first td {
  border-top-width: 2px;
}

#ydwuznycod .gt_row_group_first th {
  border-top-width: 2px;
}

#ydwuznycod .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydwuznycod .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ydwuznycod .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ydwuznycod .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydwuznycod .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydwuznycod .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ydwuznycod .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ydwuznycod .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ydwuznycod .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydwuznycod .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydwuznycod .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydwuznycod .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydwuznycod .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydwuznycod .gt_left {
  text-align: left;
}

#ydwuznycod .gt_center {
  text-align: center;
}

#ydwuznycod .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ydwuznycod .gt_font_normal {
  font-weight: normal;
}

#ydwuznycod .gt_font_bold {
  font-weight: bold;
}

#ydwuznycod .gt_font_italic {
  font-style: italic;
}

#ydwuznycod .gt_super {
  font-size: 65%;
}

#ydwuznycod .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ydwuznycod .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ydwuznycod .gt_indent_1 {
  text-indent: 5px;
}

#ydwuznycod .gt_indent_2 {
  text-indent: 10px;
}

#ydwuznycod .gt_indent_3 {
  text-indent: 15px;
}

#ydwuznycod .gt_indent_4 {
  text-indent: 20px;
}

#ydwuznycod .gt_indent_5 {
  text-indent: 25px;
}

#ydwuznycod .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ydwuznycod div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="npar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">npar</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="BIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BIC</th>
<th id="logLik" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">logLik</th>
<th id="deviance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">deviance</th>
<th id="Chisq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chisq</th>
<th id="Df" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Df</th>
<th id="Pr(>Chisq)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="npar">8.00</td>
<td class="gt_row gt_right" headers="AIC">100,619.42</td>
<td class="gt_row gt_right" headers="BIC">100,678.50</td>
<td class="gt_row gt_right" headers="logLik">−50,301.71</td>
<td class="gt_row gt_right" headers="deviance">100,603.42</td>
<td class="gt_row gt_right" headers="Chisq"><br>
</td>
<td class="gt_row gt_right" headers="Df"><br>
</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="npar">9.00</td>
<td class="gt_row gt_right" headers="AIC">100,621.38</td>
<td class="gt_row gt_right" headers="BIC">100,687.85</td>
<td class="gt_row gt_right" headers="logLik">−50,301.69</td>
<td class="gt_row gt_right" headers="deviance">100,603.38</td>
<td class="gt_row gt_right" headers="Chisq">0.04</td>
<td class="gt_row gt_right" headers="Df">1.00</td>
<td class="gt_row gt_right" headers="Pr(>Chisq)">0.84</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Test Model difference</div></div>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare fixed parameters with unstandardized (b) and standardized (beta) coefficients</span></span>
<span id="cb55-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_old, m_new, </span>
<span id="cb55-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Comparison"</span>, </span>
<span id="cb55-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.std =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb55-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb55-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.aic =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb55-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, </span>
<span id="cb55-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">string.std =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;beta;"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<table style="border-collapse:collapse; border:none;">

<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">std. p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">b</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">β</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">std. p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">98.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.861</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">98.84</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.864</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement student</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement teacher</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">engagement principal</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8"><strong>0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9"><strong>0.001</strong></td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">226.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">226.82</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">33.84 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">33.45 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">81.17 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">81.18 <sub>id_school</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">5.99 <sub>id_classroom.engagement_student</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">5.94 <sub>id_classroom.engagement_student</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.02 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.42</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">1191 <sub>id_classroom</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">1191 <sub>id_classroom</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">60 <sub>id_school</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">60 <sub>id_school</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">11914</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">11914</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.246 / 0.500</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">0.223 / 0.547</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">AIC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">100621.770</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">100623.733</td>
</tr>

</tbody></table>

<div class="quarto-table-caption margin-caption">Model Comparison</div></div>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance reduction</span></span>
<span id="cb56-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_new, m_old) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb56-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Reduction"</span>) </span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="tixncovywh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#tixncovywh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tixncovywh thead, #tixncovywh tbody, #tixncovywh tfoot, #tixncovywh tr, #tixncovywh td, #tixncovywh th {
  border-style: none;
}

#tixncovywh p {
  margin: 0;
  padding: 0;
}

#tixncovywh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tixncovywh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tixncovywh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tixncovywh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tixncovywh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tixncovywh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tixncovywh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tixncovywh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tixncovywh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tixncovywh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tixncovywh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tixncovywh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tixncovywh .gt_spanner_row {
  border-bottom-style: hidden;
}

#tixncovywh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tixncovywh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tixncovywh .gt_from_md > :first-child {
  margin-top: 0;
}

#tixncovywh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tixncovywh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tixncovywh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tixncovywh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tixncovywh .gt_row_group_first td {
  border-top-width: 2px;
}

#tixncovywh .gt_row_group_first th {
  border-top-width: 2px;
}

#tixncovywh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tixncovywh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tixncovywh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tixncovywh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tixncovywh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tixncovywh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tixncovywh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tixncovywh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tixncovywh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tixncovywh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tixncovywh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tixncovywh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tixncovywh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tixncovywh .gt_left {
  text-align: left;
}

#tixncovywh .gt_center {
  text-align: center;
}

#tixncovywh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tixncovywh .gt_font_normal {
  font-weight: normal;
}

#tixncovywh .gt_font_bold {
  font-weight: bold;
}

#tixncovywh .gt_font_italic {
  font-style: italic;
}

#tixncovywh .gt_super {
  font-size: 65%;
}

#tixncovywh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tixncovywh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tixncovywh .gt_indent_1 {
  text-indent: 5px;
}

#tixncovywh .gt_indent_2 {
  text-indent: 10px;
}

#tixncovywh .gt_indent_3 {
  text-indent: 15px;
}

#tixncovywh .gt_indent_4 {
  text-indent: 20px;
}

#tixncovywh .gt_indent_5 {
  text-indent: 25px;
}

#tixncovywh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tixncovywh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<thead>
<tr class="gt_col_headings header">
<th id="grp" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">grp</th>
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="New-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">New Model</th>
<th id="Old-Model" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Old Model</th>
<th id="Variance-Reduction" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance Reduction</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="grp">Residual</td>
<td class="gt_row gt_left" headers="term">Level 1 Variance</td>
<td class="gt_row gt_right" headers="New Model">226.8</td>
<td class="gt_row gt_right" headers="Old Model">226.7</td>
<td class="gt_row gt_right" headers="Variance Reduction">-3.61e-04</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="grp">id_classroom</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">33.5</td>
<td class="gt_row gt_right" headers="Old Model">33.8</td>
<td class="gt_row gt_right" headers="Variance Reduction">1.16e-02</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="grp">id_school</td>
<td class="gt_row gt_left" headers="term">Intercept</td>
<td class="gt_row gt_right" headers="New Model">81.2</td>
<td class="gt_row gt_right" headers="Old Model">81.2</td>
<td class="gt_row gt_right" headers="Variance Reduction">-7.03e-05</td>
</tr>
</tbody>
</table>

<div class="quarto-table-caption margin-caption">Variance Reduction</div></div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Of the models we have seen so far, which should we prefer, fixed effects only (<code>m_3_L3fixed</code>), uncorrelated L2 random effects (<code>m_4_L2_uncorrelated_slopes</code>), or correlated L2 random effects (<code>m_5_L2_correlated_slopes</code>)?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Look at the output of these functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_3_L3fixed, m_4_L2_uncorrelated_slopes, m_5_L2_correlated_slopes)</span>
<span id="cb57-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_3_L3fixed, m_4_L2_uncorrelated_slopes, m_5_L2_correlated_slopes)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="level-3-random-slopes" class="level1">
<h1>Level-3 Random Slopes</h1>
<p>To the model that you decided on in the previous question, add random slopes for teacher engagement at level 3. Just as with level 3, create a version with uncorrelated slopes and intercepts (call it <code>m_6_L3_uncorrelated_slopes</code>) and a model with correlated slopes and intercepts (call it <code>m_7_L3_correlated_slopes</code>). Compare the models with previous model and with each other.</p>
<p>For now, pay no attention to the convergence warnings. We will deal with that later.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Concerning L3 random effects, with model should you prefer?</p>
</div>
</div>
</section>
<section id="l1l2-interaction" class="level1">
<h1>L1–L2 Interaction</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is there evidence of an interaction effect of student and teacher engagement?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Specify <code>engagement_student * engagement_teacher</code> instead of <code>engagement_student + engagement_teacher</code> in your model.</p>
<p>If you want to know if the conditional effects (AKA simple slopes) of <code>engagement_student</code> are significant at particular values of <code>engagement_teacher</code>, try <code>reghelper::simple_slopes</code>.</p>
<p>For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">m_L1L2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> engagement_student  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> engagement_teacher <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_principal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_student <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> id_classroom) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> engagement_teacher  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_school), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb58-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Default values are at -1SD, mean, +1SD</span></span>
<span id="cb58-3">reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simple_slopes</span>(m_L1L2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  engagement_student engagement_teacher Test Estimate Std. Error t value
1          -0.025859             sstest        2.4605     0.1870 13.1573
2           1.967079             sstest        3.4328     0.1802 19.0476
3           3.960017             sstest        4.4314     0.2056 21.5533
4             sstest          -0.059759        2.9880     0.1538 19.4244
5             sstest           2.007031        4.0008     0.1080 37.0494
6             sstest           4.073821        5.0136     0.1570 31.9431</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Specify specific values:</span></span>
<span id="cb60-2">reghelper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simple_slopes</span>(m_L1L2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engagement_teacher =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sstest"</span>), </span>
<span id="cb60-3">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engagement_student =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sstest"</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  engagement_student engagement_teacher Test Estimate Std. Error t value
1             sstest                  0        3.0173     0.1515 19.9105
2             sstest                  1        3.5073     0.1200 29.2386
3             sstest                  2        3.9974     0.1080 37.0189
4                  0             sstest        2.4732     0.1867 13.2478
5                  1             sstest        2.9626     0.1787 16.5742
6                  2             sstest        3.4489     0.1804 19.1142</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="l2l3-interaction" class="level1">
<h1>L2–L3 Interaction</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>According to the <code>anova</code> comparison, is there evidence of an interaction of principal and teacher engagement?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Specify <code>engagement_teacher * engagement_principal</code> instead of <code>engagement_teacher + engagement_principal</code> in your model.</p>
</div>
</div>
</div>
</section>
<section id="more-hypotheses" class="level1">
<h1>More Hypotheses?</h1>
<p>Could we specify an L1–L3 interaction? A L1–L2–L3 interaction? A random L1-L2 interaction? Yes, we could. However, we did not hypothesize any of those effects. I would have a hard time coming up with a plausible reason that they should be present. Thus any “test” of those effects should be thought of as exploratory. Even if the results are statistically significant, we should not have the same faith in the findings as we would with tests we planned.</p>


</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/MultiLevel3/multilevel3.html</guid>
  <pubDate>Tue, 11 Feb 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Random Slopes</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/RandomSlopes/random_slopes.html</link>
  <description><![CDATA[ 





<p>This is a long tutorial. Don’t let that scare you. Once understood, the analyses themselves do not take that much time or effort to complete. My goal here is to give you a sense of your options when conducting analyses like these.</p>
<section id="load-packages" class="level1">
<h1>Load packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data wrangling and visualization</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Multilevel modeling</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(broom.mixed) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model information</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model information and visualization</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model plots and tables</span></span></code></pre></div>
</div>
</section>
<section id="data-description" class="level1 page-columns page-full">
<h1>Data Description</h1>
<p>Suppose that statewide reforms in reading instruction appear to be successful in improving reading test scores, particularly in low-SES schools. We are not going to do a longitudinal analysis just yet. Here we are going to concentrate on understanding the relationships among reading scores and socioeconomic status.</p>
<div class="cell page-columns page-full">
<div id="tbl-data" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ikxpswrngh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ikxpswrngh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ikxpswrngh thead, #ikxpswrngh tbody, #ikxpswrngh tfoot, #ikxpswrngh tr, #ikxpswrngh td, #ikxpswrngh th {
  border-style: none;
}

#ikxpswrngh p {
  margin: 0;
  padding: 0;
}

#ikxpswrngh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ikxpswrngh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ikxpswrngh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ikxpswrngh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ikxpswrngh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikxpswrngh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikxpswrngh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikxpswrngh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ikxpswrngh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ikxpswrngh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ikxpswrngh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ikxpswrngh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ikxpswrngh .gt_spanner_row {
  border-bottom-style: hidden;
}

#ikxpswrngh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ikxpswrngh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ikxpswrngh .gt_from_md > :first-child {
  margin-top: 0;
}

#ikxpswrngh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ikxpswrngh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ikxpswrngh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ikxpswrngh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ikxpswrngh .gt_row_group_first td {
  border-top-width: 2px;
}

#ikxpswrngh .gt_row_group_first th {
  border-top-width: 2px;
}

#ikxpswrngh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikxpswrngh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ikxpswrngh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ikxpswrngh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikxpswrngh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikxpswrngh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ikxpswrngh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ikxpswrngh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ikxpswrngh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikxpswrngh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikxpswrngh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikxpswrngh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikxpswrngh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikxpswrngh .gt_left {
  text-align: left;
}

#ikxpswrngh .gt_center {
  text-align: center;
}

#ikxpswrngh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ikxpswrngh .gt_font_normal {
  font-weight: normal;
}

#ikxpswrngh .gt_font_bold {
  font-weight: bold;
}

#ikxpswrngh .gt_font_italic {
  font-style: italic;
}

#ikxpswrngh .gt_super {
  font-size: 65%;
}

#ikxpswrngh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ikxpswrngh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ikxpswrngh .gt_indent_1 {
  text-indent: 5px;
}

#ikxpswrngh .gt_indent_2 {
  text-indent: 10px;
}

#ikxpswrngh .gt_indent_3 {
  text-indent: 15px;
}

#ikxpswrngh .gt_indent_4 {
  text-indent: 20px;
}

#ikxpswrngh .gt_indent_5 {
  text-indent: 25px;
}

#ikxpswrngh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ikxpswrngh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Variable">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+c2Nob29sX2lkPC9jb2RlPg=="><span class="gt_from_md"><code>school_id</code></span></span></td>
<td headers="Description" class="gt_row gt_left">A code for the school</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+cmVhZGluZ18xPC9jb2RlPg=="><span class="gt_from_md"><code>reading_1</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each student’s reading test score in z-score units last year before the reform.</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+cmVhZGluZ18yPC9jb2RlPg=="><span class="gt_from_md"><code>reading_2</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each student’s reading test score in z-score units this year after the reform.</td></tr>
    <tr><td headers="Variable" class="gt_row gt_left"><span data-qmd-base64="PGNvZGU+c2Nob29sX3NlczwvY29kZT4="><span class="gt_from_md"><code>school_ses</code></span></span></td>
<td headers="Description" class="gt_row gt_left">Each school’s average level of socioeconomic status, measured in z-score units</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Reading Scores Data Set Description
</figcaption>
</figure>
</div>
</div>
</section>
<section id="import-data" class="level1">
<h1>Import data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/dhw4.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">school_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(school_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(school_ses, mean))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 18257 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): school_id, reading_1, reading_2, school_ses

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Note that we have reordered the <code>school_id</code> factor by the <code>school_ses</code> variable. Doing so will make plotting the effects of SES easier.</p>
<p>Let’s view our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  school_id reading_1 reading_2 school_ses
  &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 1            -0.935     0.307     -0.704
2 1            -0.972     0.640     -0.704
3 1            -1.39      0.535     -0.704
4 1            -0.742     0.260     -0.704
5 1            -1.38      0.174     -0.704
6 1             0.461     1.11      -0.704</code></pre>
</div>
</div>
</section>
<section id="analysis-plan" class="level1">
<h1>Analysis Plan</h1>
<ul>
<li>Modeling Sequence for Time 1 Reading
<ol start="0" type="1">
<li>Random Intercepts</li>
<li>Mean SES Fixed Effect</li>
</ol></li>
<li>Modeling Sequence for Time 2 Reading
<ol start="0" type="1">
<li>Random Intercepts</li>
<li>Time 1 Reading Fixed Effect</li>
<li>Mean SES Fixed Effect</li>
<li>Random Slopes for Time 1 Reading</li>
<li>Correlation between Random Slopes and Intercepts</li>
<li>Time 1 Reading and Mean SES Interaction</li>
</ol></li>
</ul>
<p>Why is the modeling sequence so much more complicated for Reading at Time 2 comparing the modeling sequence for Reading at Time 1? Reading at Time 1 can only have a Level-2 covariate, which does not allow for random slopes. The introduction of a Level-1 covariate for Reading at Time 2 allows for the possibility of random slopes and correlations between slopes and intercepts. Having both a level-1 and level-2 predictor allows for cross-level interaction effects. That is, the effect of a level-1 predictor might depend on the value of a level-2 predictor.</p>
<p>Amazingly enough, this would be considered a fairly simple analysis plan. It seems like a lot, but when there are many predictors, the number of analysis options increases exponentially. In general, I endorse the following sequence:</p>
<ol type="1">
<li>Random Intercepts</li>
<li>Level 1 fixed effects</li>
<li>Level 1 interaction effects</li>
<li>Level 2 fixed effects</li>
<li>Level 2 interaction effects</li>
<li>Level 1 random slopes</li>
<li>Correlations between slopes and intercepts</li>
<li>Interactions between level 1 and level 2 variables (cross-level interactions)</li>
</ol>
<p>This sequence is not sacred. If you have good reasons to alter it, you may do so without raising any eyebrows.</p>
</section>
<section id="predicting-time-1-reading" class="level1 page-columns page-full">
<h1>Predicting Time 1 Reading</h1>
<p>If we want to understand how reading at time 1 (reading<sub>1</sub>) affects reading at time 2 (reading<sub>2</sub>), it can be helpful to model reading<sub>1</sub> first. For example, we might find that after controlling for reading<sub>1</sub>, socioeconomic status (SES) has a direct effect on reading<sub>2</sub>. If we do not model reading<sub>1</sub>, we might not realize that much of SES’s effect on reading is obscured because it also has indirect effects via reading<sub>1</sub>.</p>
<section id="reading1-model-0-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-0-random-intercepts">Reading<sub>1</sub> Model 0: Random Intercepts</h2>
<p>First we start modeling reading<sub>1</sub> with our multilevel “null” model: random intercepts. We will the model equations, then a table with a description of all symbols, then a visual representation fo the model in the form of a path diagram.</p>
<section id="model-0-equations" class="level3">
<h3 class="anchored" data-anchor-id="model-0-equations">Model 0 Equations</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij1%7D%20&amp;=%20%5Cbeta_%7B0j%7D+e_%7Bij%7D%5C%5C%0Ae_%7Bij%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+u_%7B0j%7D%5C%5C%0Au_%7B0j%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Ctau_%7B00%7D)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij1%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+e_%7Bij%7D%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="model-0-fully-annotated" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-0-fully-annotated">Model 0 Fully Annotated</h3>
<p>Table&nbsp;2 explains the meaning of the symbols in the Model 0 equations. The symbols I do not explain repeatedly are <img src="https://latex.codecogs.com/png.latex?%5Csim"> (“is distributed as.”) and <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D"> (normal disbribution). Thus, <img src="https://latex.codecogs.com/png.latex?X%5Csim%5Cmathcal%7BN%7D(%5Cmu,%20%5Csigma%5E2)"> means <img src="https://latex.codecogs.com/png.latex?X"> is a normally distributed random variable with mean <img src="https://latex.codecogs.com/png.latex?%5Cmu"> and variance <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2">.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb6-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij1}$"</span>,</span>
<span id="cb6-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb6-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb6-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb6-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb6-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb6-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span></span>
<span id="cb6-10">    </span>
<span id="cb6-11">  ),</span>
<span id="cb6-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb6-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 1"</span>,</span>
<span id="cb6-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the classroom mean for class $j$"</span>,</span>
<span id="cb6-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb6-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb6-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the overall classroom mean for Time 1 Reading"</span>,</span>
<span id="cb6-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb6-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>),</span>
<span id="cb6-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb6-21">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb6-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb6-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{aligned}</span></span>
<span id="cb6-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb6-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb6-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  u_{0j}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00})</span></span>
<span id="cb6-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{aligned}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb6-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb6-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb6-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij1} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb6-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-38">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-39">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb6-40"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Combined Model}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb6-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij1} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">underbrace{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}}+e_{ij}</span></span>
<span id="cb6-42"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-43">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ibvrwwrozj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ibvrwwrozj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ibvrwwrozj thead, #ibvrwwrozj tbody, #ibvrwwrozj tfoot, #ibvrwwrozj tr, #ibvrwwrozj td, #ibvrwwrozj th {
  border-style: none;
}

#ibvrwwrozj p {
  margin: 0;
  padding: 0;
}

#ibvrwwrozj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ibvrwwrozj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ibvrwwrozj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ibvrwwrozj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ibvrwwrozj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibvrwwrozj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibvrwwrozj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibvrwwrozj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ibvrwwrozj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ibvrwwrozj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ibvrwwrozj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ibvrwwrozj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ibvrwwrozj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ibvrwwrozj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ibvrwwrozj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ibvrwwrozj .gt_from_md > :first-child {
  margin-top: 0;
}

#ibvrwwrozj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ibvrwwrozj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ibvrwwrozj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ibvrwwrozj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ibvrwwrozj .gt_row_group_first td {
  border-top-width: 2px;
}

#ibvrwwrozj .gt_row_group_first th {
  border-top-width: 2px;
}

#ibvrwwrozj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibvrwwrozj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ibvrwwrozj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ibvrwwrozj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibvrwwrozj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibvrwwrozj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ibvrwwrozj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ibvrwwrozj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ibvrwwrozj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibvrwwrozj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibvrwwrozj .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibvrwwrozj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibvrwwrozj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibvrwwrozj .gt_left {
  text-align: left;
}

#ibvrwwrozj .gt_center {
  text-align: center;
}

#ibvrwwrozj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ibvrwwrozj .gt_font_normal {
  font-weight: normal;
}

#ibvrwwrozj .gt_font_bold {
  font-weight: bold;
}

#ibvrwwrozj .gt_font_italic {
  font-style: italic;
}

#ibvrwwrozj .gt_super {
  font-size: 65%;
}

#ibvrwwrozj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ibvrwwrozj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ibvrwwrozj .gt_indent_1 {
  text-indent: 5px;
}

#ibvrwwrozj .gt_indent_2 {
  text-indent: 10px;
}

#ibvrwwrozj .gt_indent_3 {
  text-indent: 15px;
}

#ibvrwwrozj .gt_indent_4 {
  text-indent: 20px;
}

#ibvrwwrozj .gt_indent_5 {
  text-indent: 25px;
}

#ibvrwwrozj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ibvrwwrozj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoxfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajF9XCk="><span class="gt_from_md">\(Reading_{ij1}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMQ=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 1</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIGNsYXNzcm9vbSBtZWFuIGZvciBjbGFzcyBcKGpcKQ=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgb3ZlcmFsbCBjbGFzc3Jvb20gbWVhbiBmb3IgVGltZSAxIFJlYWRpbmc="><span class="gt_from_md">Fixed Intercept. In this model, it is the overall classroom mean for Time 1 Reading</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMX0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K3VfezBqfX1fe1xiZXRhX3swan19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij1} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Random Intercepts Model for Reading at Time 1
</figcaption>
</figure>
</div>
</div>
</section>
<section id="model-0-path-diagram" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-0-path-diagram">Model 0 Path Diagram</h3>
<p>Sometimes equations can be overwhelming, especially for complex models. It can help to visualize a model as a path diagram like Figure&nbsp;1.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">myfont <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggdiagram is an experimental package that can be installed </span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github("wjschne/ggdiagram")</span></span>
<span id="cb7-5"></span>
<span id="cb7-6">my_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb7-7">  ob_ngon,</span>
<span id="cb7-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb7-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb7-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb7-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~1~"</span>,</span>
<span id="cb7-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vertex_radius =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-14">)</span>
<span id="cb7-15"></span>
<span id="cb7-16">my_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(connect, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-17"></span>
<span id="cb7-18"></span>
<span id="cb7-19">my_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-20">my_error_variance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_variance,</span>
<span id="cb7-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb7-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb7-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">where =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span></span>
<span id="cb7-26">  )</span>
<span id="cb7-27">my_error_variance_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb7-28">  ob_latex,</span>
<span id="cb7-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tex =</span> r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mph{σ}}^{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{2}}_{\mkern-1.5mu</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mph{e}}})"</span>,</span>
<span id="cb7-30">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb7-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> myfont,</span>
<span id="cb7-32">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma_e_2"</span>,</span>
<span id="cb7-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_recompile =</span> F,</span>
<span id="cb7-34">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delete_files =</span> F</span>
<span id="cb7-35">)</span>
<span id="cb7-36"></span>
<span id="cb7-37">my_path_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label,</span>
<span id="cb7-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb7-39">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-40">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb7-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-42">      )</span>
<span id="cb7-43"></span>
<span id="cb7-44">my_coefficient <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb7-45">my_residual <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_circle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb7-46">my_residual_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)</span>
<span id="cb7-47">my_residual_variance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb7-48">  ob_variance,</span>
<span id="cb7-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb7-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">where =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span></span>
<span id="cb7-54">)</span>
<span id="cb7-55">my_residual_variance_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(</span>
<span id="cb7-56">  ob_label,</span>
<span id="cb7-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb7-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb7-60">)</span>
<span id="cb7-61">my_observed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_ellipse, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-62">my_observed_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb7-63"></span>
<span id="cb7-64">my_observed_l2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redefault</span>(ob_ellipse, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span></code></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">p_read1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggdiagram</span>(myfont, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  {read_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Reading*~*1ij*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3">  {i_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~1~"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read_1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  {i12read1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(i_1, read_1)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-6">  {b_0j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(i12read1),</span>
<span id="cb8-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;beta;*~0*j*~"</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">  {i_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~2~"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_0j, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"above"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-11">  {i12read1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb8-12">      i_2,</span>
<span id="cb8-13">      b_0j,</span>
<span id="cb8-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~00~"</span>)</span>
<span id="cb8-15">    )} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-16">  {e <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~*ij*~"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read_1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e, read_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-19">  {e_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error_variance</span>(e)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  {u_0j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*u*~0*j*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_0j, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"below"</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb8-23">    u_0j,</span>
<span id="cb8-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"below"</span>,</span>
<span id="cb8-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*~00~"</span>)</span>
<span id="cb8-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(u_0j, b_0j) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error_variance_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> e_var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>())</span>
<span id="cb8-29"></span>
<span id="cb8-30">p_read1</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read1-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Path Diagram for Reading Time 1 Random Intercepts Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Path models have these characteristics:</p>
<ul>
<li>Observed variables are squares/rectangles.</li>
<li>Latent variables and residuals are circles/ellipses.</li>
<li>Regression coefficients are single-headed arrows leading from predictor to outcome.</li>
<li>Covariances are double-headed arrows between two variables.</li>
<li>Variances are double-headed arrows leading back to the same variable.</li>
<li>Intercepts/means are triangles with a “1” as a label.</li>
<li>Random coefficients are circles that lie on a path.</li>
</ul>
<p>The idea of representing random coefficients as latent variables (circles) on paths was proposed by <span class="citation" data-cites="curran2007">Curran &amp; Bauer (2007)</span>.</p>
</section>
</section>
<section id="reading1-model-0-in-r" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-0-in-r">Reading<sub>1</sub> Model 0 in R</h2>
<p>The <code>lmer</code> function from the lme4 package <span class="citation" data-cites="lme4">(Bates et al., 2015)</span> specifies model formulas with fixed effects listed in the same way as in the <code>lm</code> function (ordinary least squares linear model) and random effects listed inside parentheses, with the grouping variable listed after a post symbol (<code>|</code>). Consider this model:</p>
<p><code>Y ~ 1 + X + (1 + X | group)</code></p>
<div id="fig-annotated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/annotatedequation.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Annotated formula for <code>lmer</code> models
</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">m_read_1_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d)</span></code></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The fixed intercept is optional, but I like to include it for clarity. Omitting the fixed intercept looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d)</span></code></pre></div>
</div>
</div></div><p>In R, an outcome variable is placed on the left hand side of the tilde <code>~</code>. The first <code>1</code> means to specify an overall fixed intercept. The parentheses indicate a random effect. The <code>1</code> inside the parentheses means that a random intercept should be specified by the grouping variable, <code>school_id</code>.</p>
<p>Now we can use various tools to inspect the overall results</p>
<section id="check-assumptions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="check-assumptions">Check Assumptions</h3>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_read_1_0)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-m10check" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-m10check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-m10check-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-m10check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Check assumptions for reading time 1 null model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nothing in the diagnostic plots in Figure&nbsp;3 raises concerns.</p>
</section>
<section id="evaluate-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="evaluate-model">Evaluate Model</h3>
<p>As always, we can get a quick summary of the model like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_1_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_1 ~ 1 + (1 | school_id)
   Data: d

REML criterion at convergence: 33352

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.649 -0.673  0.005  0.668  4.035 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.655    0.809   
 Residual              0.337    0.580   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.00464    0.04695    -0.1</code></pre>
</div>
</div>
<p>An overall automated report:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_read_1_0) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a constant (intercept-only) linear mixed model (estimated using REML
and nloptwrap optimizer) to predict reading_1 (formula: reading_1 ~ 1). The
model included school_id as random effect (formula: ~1 | school_id). The
model's intercept is at -4.64e-03 (95% CI [-0.10, 0.09], t(18254) = -0.10, p =
0.921).

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>There is not much to comment on here because this model does not attempt to explain anything. It will be a basis of comparison for the next model.</p>
<p>We can get a quick look at some performance metrics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read_1_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
33358.049 | 33358.051 | 33381.486 |      0.660 |      0.000 | 0.660 | 0.576 | 0.580</code></pre>
</div>
</div>
<p>The ICC for this model suggests that schools are highly segregated by reading ability. That is, variation by classroom accounts for 66% of the variance in reading<sub>1</sub>.</p>
<p>The <code>sjPlot:tab_model</code> function can produce a table that is very close to publication-ready:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_1_0)</span></code></pre></div>
<div id="tbl-m10table" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-m10table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.10&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.921</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.65</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.66</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.660</td>
</tr>

</tbody></table>

</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-m10table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Model summary for reading time 1 null model
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="reading1-model-1-l2-covariate" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading1-model-1-l2-covariate">Reading<sub>1</sub> Model 1: L2 Covariate</h2>
<p>This model builds upon the previous model by adding the classroom’s average socioeconomic status (SES) variable as a covariate. Because average SES varies by classroom instead of by individual, it is a level-2 covariate. It can be thought of as a predictor of the random intercept. Because the random intercept represents the classroom mean, the level 2 equation in this model is sometimes revered to as a <em>means-as-outcomes</em> model.</p>
<p>Note that SES’s coefficient is <em>γ</em><sub>01</sub>. The subscript of coefficient, 01, has a 0 in the first position, which tells us that this is a predictor of the random intercept (<em>β</em><sub>0<em>j</em></sub>). The 1 in the second position in the subscript tell us that this is the first predictor of the <em>β</em><sub>0<em>j</em></sub>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij1%7D%20&amp;=%20%5Cbeta_%7B0j%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%5C%5C%0Au_%7B0j%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Ctau_%7B00%7D)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij1%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full" data-tbl-cap="Reading Time 1 Model 1: Model 0 + Level 2 SES">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb19-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb19-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij1}$"</span>,</span>
<span id="cb19-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb19-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb19-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb19-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb19-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}$"</span>,</span>
<span id="cb19-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb19-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span></span>
<span id="cb19-11">    </span>
<span id="cb19-12">  ),</span>
<span id="cb19-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb19-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 1"</span>,</span>
<span id="cb19-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the classroom mean for class $j$"</span>,</span>
<span id="cb19-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb19-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb19-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is predicted classroom mean for Reading~1~ when SES is 0."</span>,</span>
<span id="cb19-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Effect for SES. It represents the predicted increase in the classroom mean for Reading~1~ when SES increases by 1."</span>,</span>
<span id="cb19-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb19-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>),</span>
<span id="cb19-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb19-23">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-25">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb19-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb19-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb19-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-29">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{aligned}</span></span>
<span id="cb19-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb19-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}SES_j+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb19-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  u_{0j}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00})</span></span>
<span id="cb19-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{aligned}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb19-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb19-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb19-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij1} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb19-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-40">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-41">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb19-42"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Combined Model}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb19-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij1} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">underbrace{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}SES_j+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}}+e_{ij}</span></span>
<span id="cb19-44"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-45">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="yvxwjltauz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#yvxwjltauz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yvxwjltauz thead, #yvxwjltauz tbody, #yvxwjltauz tfoot, #yvxwjltauz tr, #yvxwjltauz td, #yvxwjltauz th {
  border-style: none;
}

#yvxwjltauz p {
  margin: 0;
  padding: 0;
}

#yvxwjltauz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yvxwjltauz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yvxwjltauz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yvxwjltauz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yvxwjltauz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvxwjltauz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvxwjltauz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvxwjltauz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yvxwjltauz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yvxwjltauz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yvxwjltauz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yvxwjltauz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yvxwjltauz .gt_spanner_row {
  border-bottom-style: hidden;
}

#yvxwjltauz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yvxwjltauz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yvxwjltauz .gt_from_md > :first-child {
  margin-top: 0;
}

#yvxwjltauz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yvxwjltauz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yvxwjltauz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yvxwjltauz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yvxwjltauz .gt_row_group_first td {
  border-top-width: 2px;
}

#yvxwjltauz .gt_row_group_first th {
  border-top-width: 2px;
}

#yvxwjltauz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvxwjltauz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yvxwjltauz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yvxwjltauz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvxwjltauz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvxwjltauz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yvxwjltauz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yvxwjltauz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yvxwjltauz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvxwjltauz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvxwjltauz .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvxwjltauz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvxwjltauz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvxwjltauz .gt_left {
  text-align: left;
}

#yvxwjltauz .gt_center {
  text-align: center;
}

#yvxwjltauz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yvxwjltauz .gt_font_normal {
  font-weight: normal;
}

#yvxwjltauz .gt_font_bold {
  font-weight: bold;
}

#yvxwjltauz .gt_font_italic {
  font-style: italic;
}

#yvxwjltauz .gt_super {
  font-size: 65%;
}

#yvxwjltauz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yvxwjltauz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yvxwjltauz .gt_indent_1 {
  text-indent: 5px;
}

#yvxwjltauz .gt_indent_2 {
  text-indent: 10px;
}

#yvxwjltauz .gt_indent_3 {
  text-indent: 15px;
}

#yvxwjltauz .gt_indent_4 {
  text-indent: 20px;
}

#yvxwjltauz .gt_indent_5 {
  text-indent: 25px;
}

#yvxwjltauz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yvxwjltauz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoxfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij1} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajF9XCk="><span class="gt_from_md">\(Reading_{ij1}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMQ=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 1</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIGNsYXNzcm9vbSBtZWFuIGZvciBjbGFzcyBcKGpcKQ=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIHVfezBqfSZhbXA7XHNpbSBcbWF0aGNhbHtOfSgwLFx0YXVfezAwfSkgXGVuZHthbGlnbmVkfSQk"><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyBwcmVkaWN0ZWQgY2xhc3Nyb29tIG1lYW4gZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4gd2hlbiBTRVMgaXMgMC4="><span class="gt_from_md">Fixed Intercept. In this model, it is predicted classroom mean for Reading<sub>1</sub> when SES is 0.</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgRWZmZWN0IGZvciBTRVMuIEl0IHJlcHJlc2VudHMgdGhlIHByZWRpY3RlZCBpbmNyZWFzZSBpbiB0aGUgY2xhc3Nyb29tIG1lYW4gZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4gd2hlbiBTRVMgaW5jcmVhc2VzIGJ5IDEu"><span class="gt_from_md">Fixed Effect for SES. It represents the predicted increase in the classroom mean for Reading<sub>1</sub> when SES increases by 1.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMX0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2ordV97MGp9fV97XGJldGFfezBqfX0rZV97aWp9IFxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij1} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
<div class="quarto-table-caption margin-caption"><p>Reading Time 1 Model 1: Model 0 + Level 2 SES</p></div></div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">p_read1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-2">  {SES <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_l2</span>(</span>
<span id="cb20-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> i_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%-|%</span> i_1,</span>
<span id="cb20-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*SES*~*j*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(SES<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"southeast"</span>), </span>
<span id="cb20-6">          b_0j, </span>
<span id="cb20-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~01~"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read1L2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read1L2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Reading Time 1 Model 0 + Level 2 SES
</figcaption>
</figure>
</div>
</div>
</div>
<section id="exploratory-plot-for-reading1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="exploratory-plot-for-reading1">Exploratory Plot for Reading<sub>1</sub></h3>
<p>It helps to get a rough plot to see what is happening. Let’s create and informal plot of <code>school_ses</code> with <code>reading_1</code>. We display individual reading scores as little points and the means for each school with big dots and error bars.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(school_ses, reading_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> school_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.data =</span> mean_se) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y ~ x"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading at Time 1"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-m10plot" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-m10plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-m10plot-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-m10plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Mean SES predicting reading time 1
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;5 we see that <code>school_ses</code> and <code>reading_1</code> are correlated. Why are all the data in columns? Because <code>school_ses</code> is the mean SES for each school. Every child in the same school has the same <code>school_ses</code>.</p>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">Model Summary</h3>
<p>We can create the model from scratch:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">m_read_1_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> school_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d)</span></code></pre></div>
</div>
<p>Alternately, we can update the previous model, which is usually safer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">m_read_1_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_read_1_0, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> school_ses)</span></code></pre></div>
</div>
<p>The model can be summarized in many ways:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_1 ~ (1 | school_id) + school_ses
   Data: d

REML criterion at convergence: 33175

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.661 -0.674  0.006  0.665  4.032 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.354    0.595   
 Residual              0.337    0.580   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.00475    0.03467   -0.14
school_ses   0.54917    0.03472   15.82

Correlation of Fixed Effects:
           (Intr)
school_ses 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.891</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.35</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.51</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.307 / 0.662</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
33182.831 | 33182.833 | 33214.080 |      0.662 |      0.307 | 0.513 | 0.576 | 0.580</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |        95% CI | t(18253) |      p
--------------------------------------------------------------------
(Intercept) |   -4.75e-03 | 0.03 | [-0.07, 0.06] |    -0.14 | 0.891 
school ses  |        0.55 | 0.03 | [ 0.48, 0.62] |    15.82 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.59
SD (Residual)             |        0.58</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_1 with school_ses (formula: reading_1 ~ school_ses). The
model included school_id as random effect (formula: ~1 | school_id). The
model's total explanatory power is substantial (conditional R2 = 0.66) and the
part related to the fixed effects alone (marginal R2) is of 0.31. The model's
intercept, corresponding to school_ses = 0, is at -4.75e-03 (95% CI [-0.07,
0.06], t(18253) = -0.14, p = 0.891). Within this model:

  - The effect of school ses is statistically significant and positive (beta =
0.55, 95% CI [0.48, 0.62], t(18253) = 15.82, p &lt; .001; Std. beta = 0.55, 95% CI
[0.48, 0.62])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>The slope for school_ses is statistically significant and explains significant variance in <code>reading_1</code>.</p>
</section>
<section id="compare-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="compare-model-fit">Compare model fit</h3>
<p>We have many options for comparing models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_models</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |              m_read_1_0 |              m_read_1_1
----------------------------------------------------------------
(Intercept)  | -4.64e-03 (-0.10, 0.09) | -4.75e-03 (-0.07, 0.06)
school ses   |                         |      0.55 ( 0.48, 0.62)
----------------------------------------------------------------
Observations |                   18257 |                   18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.10&nbsp;–&nbsp;0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.921</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.891</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.34</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.65 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.35 <sub>school_id</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.66</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.51</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.660</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.307 / 0.662</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_1_0: reading_1 ~ 1 + (1 | school_id)
m_read_1_1: reading_1 ~ (1 | school_id) + school_ses
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_1_0    3 33354 33377 -16674    33348                        
m_read_1_1    4 33173 33204 -16583    33165   183  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_1_0 | lmerMod | 33353.8 (&lt;.001) | 33353.8 (&lt;.001) | 33377.2 (&lt;.001)
m_read_1_1 | lmerMod | 33173.1 (&gt;.999) | 33173.1 (&gt;.999) | 33204.3 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_1_0 |      0.660 |      0.000 | 0.660 | 0.576 | 0.580
m_read_1_1 |      0.662 |      0.307 | 0.513 | 0.576 | 0.580</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_performance</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_1_0 | lmerMod |       
m_read_1_1 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">lmerTest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ranova</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
reading_1 ~ school_ses + (1 | school_id)
                npar logLik   AIC   LRT Df Pr(&gt;Chisq)    
&lt;none&gt;             4 -16587 33183                        
(1 | school_id)    3 -22333 44673 11492  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Using <code>school_ses</code> as an L2 covariate, Model 1 fits significantly better than Model 0.</p>
<p>When in doubt, the <code>anova</code> results are the most common way of comparing models. The comparison only works if you are comparing nested models with exactly the same data. The <code>anova</code> function will warn you if you add a predictor with missing data that causes the comparison to be misleading.</p>
<p>The AIC weights are probably your next best option, especially for comparing non-nested models. Here, our models are nested.</p>
</section>
<section id="nested-or-non-nested" class="level3">
<h3 class="anchored" data-anchor-id="nested-or-non-nested">Nested or Non-Nested?</h3>
<p>If you create one model from another by adding one or more features, the models are <em>nested</em>. If you create one model from another by adding some features AND removing other features, the models are <em>non-nested</em>.</p>
<section id="nested-models" class="level4">
<h4 class="anchored" data-anchor-id="nested-models">Nested Models</h4>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ A + B</code></p>
<p>These models are nested because we added predictor <code>B</code> to the first model.</p>
<p>These models are also nested because we are adding a random intercept:</p>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ A + (1 | id)</code></p>
<p>Nested models can differ by more than one feature. For example, the following models are nested because we add predictor <code>B</code> and the random slope for <code>A</code>:</p>
<p>Model 1: <code>Y ~ A + (1 | id)</code><br>
Model 2: <code>Y ~ A + B + (1 + A | id)</code></p>
</section>
<section id="non-nested-models" class="level4">
<h4 class="anchored" data-anchor-id="non-nested-models">Non-nested Models</h4>
<p>Model 1: <code>Y ~ A</code><br>
Model 2: <code>Y ~ B</code></p>
<p>These models are non-nested because we add predictor <code>B</code> AND remove predictor <code>A</code>.</p>
<p>Model 1: <code>Y ~ A + (1 + A | id)</code><br>
Model 2: <code>Y ~ A + B + (1 | id)</code></p>
<p>These models are non-nested because we add predictor <code>B</code> but remove the random slopes for <code>A</code></p>
</section>
</section>
<section id="check-conditional-intraclass-correlation-coefficient-and-variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="check-conditional-intraclass-correlation-coefficient-and-variance-explained">Check Conditional intraclass correlation coefficient and variance explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icc</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.513
  Unadjusted ICC: 0.355</code></pre>
</div>
</div>
<p>It looks like the conditional ICC is much lower than before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2</span>(m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.662
     Marginal R2: 0.307</code></pre>
</div>
</div>
<p>It looks like the school SES explained a lot of variance.</p>
<p>How much does the level-2 random intercept variance <img src="https://latex.codecogs.com/png.latex?(%5Ctau_%7B00%7D)"> shrink when we compare the two models we have run so far:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20R_2%5E2%20=%20%5Cfrac%7B%5Ctau_%7B00_0%7D-%5Ctau_%7B00_1%7D%7D%7B%5Ctau_%7B00_0%7D%7D%0A"></p>
<p>We can also see how much variance was reduced in the level-1 residuals. The level-1 variance reduction is calculated like so:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20R_1%5E2%20=%20%5Cfrac%7B%5Csigma_0%5E2-%5Csigma_1%5E2%7D%7B%5Csigma_0%5E2%7D%0A"></p>
<p>I do not want to perform this calculation by hand, so I will make a function that automates the process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to calculate variance reduction for levels 1 and 2</span></span>
<span id="cb48-2">variance_reduction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(m1, m2) {</span>
<span id="cb48-3">  tau_00_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_random</span>(m1)</span>
<span id="cb48-4">  tau_00_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_random</span>(m2)</span>
<span id="cb48-5">  level2_reduction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (tau_00_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau_00_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_00_1</span>
<span id="cb48-6"></span>
<span id="cb48-7">  sigma_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sigma</span>(m1)</span>
<span id="cb48-8">  sigma_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sigma</span>(m2)</span>
<span id="cb48-9">  level1_reduction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (sigma_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> sigma_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma_1</span>
<span id="cb48-10"></span>
<span id="cb48-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb48-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb48-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model_1_variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(sigma_1, tau_00_1),</span>
<span id="cb48-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model_2_variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(sigma_2, tau_00_2),</span>
<span id="cb48-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance_reduction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(level1_reduction, level2_reduction)</span>
<span id="cb48-16">  )</span>
<span id="cb48-17">}</span>
<span id="cb48-18"></span>
<span id="cb48-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_read_1_0, m_read_1_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  level model_1_variance model_2_variance variance_reduction
  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;
1     1            0.580            0.580        -0.00000574
2     2            0.655            0.354         0.459     </code></pre>
</div>
</div>
<p>It looks like school SES explained a good bit of the level-2 intercept variability.</p>
<p>Because the school SES variable is a level-2 covariate, it cannot reduce level-1 residual variance.</p>
</section>
</section>
<section id="formal-plot-for-reading1-model-1" class="level2">
<h2 class="anchored" data-anchor-id="formal-plot-for-reading1-model-1">Formal plot for Reading<sub>1</sub> Model 1</h2>
<p>The <code>sjPlot::plot_model</code> function is a quick and easy way to create models of fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_read_1_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school_ses"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb50-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/m11plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overall-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="overall-interpretation">Overall interpretation</h2>
<p>It appears that schools vary greatly by their average <code>reading_1</code> scores. Almost half of this variability is explained by the school’s average SES, which is positively associated with <code>reading_1</code>.</p>
</section>
</section>
<section id="predicting-time-2-reading" class="level1 page-columns page-full">
<h1>Predicting Time 2 Reading</h1>
<p>Now we turn our attention to the reading comprehension at Time 2 variable, <code>reading_2</code>. We start with random intercepts and, as needed, add level 1 fixed effects, level 2 fixed effects, random slopes, and cross-level interaction effects.</p>
<section id="reading-2-model-0-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-0-random-intercepts">Reading 2 Model 0: Random Intercepts</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+u_%7B0j%7D%5C%5C%0Au_%7B0j%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Ctau_%7B00%7D)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb51-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb51-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb51-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb51-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb51-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb51-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb51-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb51-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span></span>
<span id="cb51-10">    </span>
<span id="cb51-11">  ),</span>
<span id="cb51-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb51-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb51-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$"</span>,</span>
<span id="cb51-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb51-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb51-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the overall classroom mean for Time 2 Reading"</span>,</span>
<span id="cb51-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb51-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>),</span>
<span id="cb51-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb51-21">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb51-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb51-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb51-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{aligned}</span></span>
<span id="cb51-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb51-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb51-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  u_{0j}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00})</span></span>
<span id="cb51-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{aligned}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb51-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb51-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb51-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb51-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-38">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-39">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb51-40"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Combined Model}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb51-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">underbrace{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}}+e_{ij}</span></span>
<span id="cb51-42"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-43">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read2" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="lmzbbqhvym" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lmzbbqhvym table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lmzbbqhvym thead, #lmzbbqhvym tbody, #lmzbbqhvym tfoot, #lmzbbqhvym tr, #lmzbbqhvym td, #lmzbbqhvym th {
  border-style: none;
}

#lmzbbqhvym p {
  margin: 0;
  padding: 0;
}

#lmzbbqhvym .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lmzbbqhvym .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lmzbbqhvym .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lmzbbqhvym .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lmzbbqhvym .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lmzbbqhvym .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lmzbbqhvym .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lmzbbqhvym .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lmzbbqhvym .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lmzbbqhvym .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lmzbbqhvym .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lmzbbqhvym .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lmzbbqhvym .gt_spanner_row {
  border-bottom-style: hidden;
}

#lmzbbqhvym .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lmzbbqhvym .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lmzbbqhvym .gt_from_md > :first-child {
  margin-top: 0;
}

#lmzbbqhvym .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lmzbbqhvym .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lmzbbqhvym .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lmzbbqhvym .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lmzbbqhvym .gt_row_group_first td {
  border-top-width: 2px;
}

#lmzbbqhvym .gt_row_group_first th {
  border-top-width: 2px;
}

#lmzbbqhvym .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lmzbbqhvym .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lmzbbqhvym .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lmzbbqhvym .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lmzbbqhvym .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lmzbbqhvym .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lmzbbqhvym .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lmzbbqhvym .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lmzbbqhvym .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lmzbbqhvym .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lmzbbqhvym .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lmzbbqhvym .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lmzbbqhvym .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lmzbbqhvym .gt_left {
  text-align: left;
}

#lmzbbqhvym .gt_center {
  text-align: center;
}

#lmzbbqhvym .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lmzbbqhvym .gt_font_normal {
  font-weight: normal;
}

#lmzbbqhvym .gt_font_bold {
  font-weight: bold;
}

#lmzbbqhvym .gt_font_italic {
  font-style: italic;
}

#lmzbbqhvym .gt_super {
  font-size: 65%;
}

#lmzbbqhvym .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lmzbbqhvym .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lmzbbqhvym .gt_indent_1 {
  text-indent: 5px;
}

#lmzbbqhvym .gt_indent_2 {
  text-indent: 10px;
}

#lmzbbqhvym .gt_indent_3 {
  text-indent: 15px;
}

#lmzbbqhvym .gt_indent_4 {
  text-indent: 20px;
}

#lmzbbqhvym .gt_indent_5 {
  text-indent: 25px;
}

#lmzbbqhvym .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lmzbbqhvym div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwp"><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_5 stub_1" rowspan="3" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgb3ZlcmFsbCBjbGFzc3Jvb20gbWVhbiBmb3IgVGltZSAyIFJlYWRpbmc="><span class="gt_from_md">Fixed Intercept. In this model, it is the overall classroom mean for Time 2 Reading</span></span></td></tr>
    <tr><td headers="l2 Symbol_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkIE1vZGVsfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K3VfezBqfX1fe1xiZXRhX3swan19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined Model}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Reading at Time 2 Model 0: Random Intercepts
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">p_read1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb52-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Reading*~*2ij*~"</span>),</span>
<span id="cb52-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> read_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center, </span>
<span id="cb52-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Path Diagram for Reading Time 2 Random Intercepts Model
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">m_read_2_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d)</span>
<span id="cb53-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ 1 + (1 | school_id)
   Data: d

REML criterion at convergence: 22814

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.076 -0.644  0.003  0.642  4.417 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.800    0.895   
 Residual              0.187    0.432   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.9891     0.0518    19.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;1.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.19</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.80</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.81</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000 / 0.811</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
22819.501 | 22819.502 | 22842.937 |      0.811 |      0.000 | 0.811 | 0.428 | 0.432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |       95% CI | t(18254) |      p
-------------------------------------------------------------------
(Intercept) |        0.99 | 0.05 | [0.89, 1.09] |    19.11 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.89
SD (Residual)             |        0.43</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a constant (intercept-only) linear mixed model (estimated using REML
and nloptwrap optimizer) to predict reading_2 (formula: reading_2 ~ 1). The
model included school_id as random effect (formula: ~1 | school_id). The
model's intercept is at 0.99 (95% CI [0.89, 1.09], t(18254) = 19.11, p &lt; .001).

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<section id="check-model-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="check-model-assumptions">Check model assumptions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/m20check-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>All is well.</p>
</section>
<section id="check-intraclass-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="check-intraclass-correlation-coefficient">Check Intraclass correlation coefficient</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icc</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.811
  Unadjusted ICC: 0.811</code></pre>
</div>
</div>
<p>The ICC for this model suggests that schools are highly segregated by reading ability. Because there are no fixed effects in the random intercepts model, the adjusted and conditional ICC are the same.</p>
</section>
<section id="variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="variance-explained">Variance Explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2</span>(m_read_2_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.811
     Marginal R2: 0.000</code></pre>
</div>
</div>
<p>The conditional <img src="https://latex.codecogs.com/png.latex?R%5E2"> tells us the proportion of variance in the outcome variable explained by the grouping structure (i.e., the fact that each class has its own intercept) and the fixed effects. Because random intercepts models have no fixed effects, the conditional <img src="https://latex.codecogs.com/png.latex?R%5E2"> and the ICC are the same.</p>
<p>The marginal <img src="https://latex.codecogs.com/png.latex?R%5E2"> tells us the proportion of variance in the outcome variable explained by the fixed effects. For random intercepts models, the marginal <img src="https://latex.codecogs.com/png.latex?R%5E2"> is 0 because there are no fixed effects.</p>
</section>
</section>
<section id="reading-2-model-1-level-1-fixed-effects-reading1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-1-level-1-fixed-effects-reading1">Reading 2 Model 1: Level-1 Fixed Effects (Reading<sub>1</sub>)</h2>
<p>In the prediction of <code>reading_2</code>, we have an important level-1 covariate—<code>reading_1</code>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+%5Cbeta_%7B1j%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+u_%7B0j%7D%5C%5C%0A%5Cbeta_%7B1j%7D&amp;=%5Cgamma_%7B10%7D%5C%5C%0Au_%7B0j%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Ctau_%7B00%7D)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+%5Cunderbrace%7B%5Cgamma_%7B10%7D%7D_%7B%5Cbeta_%7B1j%7D%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0A&amp;%5Ctext%7BFixed%20vs.%20Random%20Effects%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B10%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BFixed%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D%7D_%7B%5Ctext%7BL2%20Random%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb67-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb67-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb67-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb67-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb67-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb67-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb67-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb67-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$"</span>,</span>
<span id="cb67-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb67-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span></span>
<span id="cb67-12">    </span>
<span id="cb67-13">  ),</span>
<span id="cb67-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb67-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb67-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when reading~1~ is 0."</span>,</span>
<span id="cb67-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope for reading~1~ for class $j$. In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j} = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$."</span>,</span>
<span id="cb67-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb67-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb67-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading~1~ is zero."</span>,</span>
<span id="cb67-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for reading~1~. When reading~1~ increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb67-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~"</span>,</span>
<span id="cb67-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>),</span>
<span id="cb67-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb67-25">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb67-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb67-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb67-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb67-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb67-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{aligned}</span></span>
<span id="cb67-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb67-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb67-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb67-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  u_{0j}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00})</span></span>
<span id="cb67-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{aligned}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb67-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb67-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb67-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb67-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-43">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-44">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb67-45"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Combined:}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb67-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}}+\underbrace{\gamma_{10}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb67-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed vs. Random Effects}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb67-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{10}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed}}+\underbrace{u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{L2 Random}}+e_{ij}</span></span>
<span id="cb67-49"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb67-50">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read2L1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="uaovtlhmsu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uaovtlhmsu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uaovtlhmsu thead, #uaovtlhmsu tbody, #uaovtlhmsu tfoot, #uaovtlhmsu tr, #uaovtlhmsu td, #uaovtlhmsu th {
  border-style: none;
}

#uaovtlhmsu p {
  margin: 0;
  padding: 0;
}

#uaovtlhmsu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uaovtlhmsu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uaovtlhmsu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uaovtlhmsu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uaovtlhmsu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uaovtlhmsu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uaovtlhmsu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uaovtlhmsu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uaovtlhmsu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uaovtlhmsu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uaovtlhmsu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uaovtlhmsu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uaovtlhmsu .gt_spanner_row {
  border-bottom-style: hidden;
}

#uaovtlhmsu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uaovtlhmsu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uaovtlhmsu .gt_from_md > :first-child {
  margin-top: 0;
}

#uaovtlhmsu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uaovtlhmsu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uaovtlhmsu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uaovtlhmsu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uaovtlhmsu .gt_row_group_first td {
  border-top-width: 2px;
}

#uaovtlhmsu .gt_row_group_first th {
  border-top-width: 2px;
}

#uaovtlhmsu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaovtlhmsu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uaovtlhmsu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uaovtlhmsu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uaovtlhmsu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaovtlhmsu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uaovtlhmsu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uaovtlhmsu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uaovtlhmsu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uaovtlhmsu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uaovtlhmsu .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaovtlhmsu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uaovtlhmsu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaovtlhmsu .gt_left {
  text-align: left;
}

#uaovtlhmsu .gt_center {
  text-align: center;
}

#uaovtlhmsu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uaovtlhmsu .gt_font_normal {
  font-weight: normal;
}

#uaovtlhmsu .gt_font_bold {
  font-weight: bold;
}

#uaovtlhmsu .gt_font_italic {
  font-style: italic;
}

#uaovtlhmsu .gt_super {
  font-size: 65%;
}

#uaovtlhmsu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uaovtlhmsu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uaovtlhmsu .gt_indent_1 {
  text-indent: 5px;
}

#uaovtlhmsu .gt_indent_2 {
  text-indent: 10px;
}

#uaovtlhmsu .gt_indent_3 {
  text-indent: 15px;
}

#uaovtlhmsu .gt_indent_4 {
  text-indent: 20px;
}

#uaovtlhmsu .gt_indent_5 {
  text-indent: 25px;
}

#uaovtlhmsu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uaovtlhmsu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLiBJbiB0aGlzIG1vZGVsLCBob3dldmVyLCB0aGVyZSBhcmUgbm8gcmFuZG9tIHNsb3Blcy4gVGh1cywgdGhlIHNsb3BlIGZvciBldmVyeSBjbGFzc3Jvb20gaXMgdGhlIHNhbWU6IFwoXGJldGFfezFqfSA9IFxnYW1tYV97MTB9XCku"><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\). In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: \(\beta_{1j} = \gamma_{10}\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="4" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfSt1X3swan1cXCBcYmV0YV97MWp9JmFtcDs9XGdhbW1hX3sxMH1cXCB1X3swan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcdGF1X3swMH0pIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgcmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for reading<sub>1</sub>. When reading<sub>1</sub> increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub></span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfSt1X3swan19X3tcYmV0YV97MGp9fStcdW5kZXJicmFjZXtcZ2FtbWFfezEwfX1fe1xiZXRhX3sxan19UmVhZGluZ197aWoxfStlX3tpan1cXCAmYW1wO1x0ZXh0e0ZpeGVkIHZzLiBSYW5kb20gRWZmZWN0c31cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezEwfVJlYWRpbmdfe2lqMX19X3tcdGV4dHtGaXhlZH19K1x1bmRlcmJyYWNle3VfezBqfX1fe1x0ZXh0e0wyIFJhbmRvbX19K2Vfe2lqfSBcZW5ke2FsaWduKn0kJA=="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{L2 Random}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Reading at Time 2 Model 1: Model 0 + L1 Covariate (Reading<sub>1</sub>)
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">p_read2L1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggdiagram</span>(myfont, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-2">  {read_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(</span>
<span id="cb68-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Reading*~*2ij*~"</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-4">  {read_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed</span>(</span>
<span id="cb68-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*Reading*~*1ij*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb68-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read_2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-7">  {i_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~1~"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb68-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read_1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"above"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.9</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-9">  {i12read2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(i_1, read_2)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-10">  {r1r2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(read_1, read_2)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-11">  {b_0j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb68-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(i12read2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb68-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;beta;*~0*j*~"</span></span>
<span id="cb68-14">    )} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-15">  {b_1j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_coefficient</span>(</span>
<span id="cb68-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>(r1r2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>),</span>
<span id="cb68-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;beta;*~1*j*~"</span></span>
<span id="cb68-18">    )} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-19">  {i_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_intercept</span>(</span>
<span id="cb68-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1~2~"</span>, </span>
<span id="cb68-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersection</span>(</span>
<span id="cb68-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotate</span>(i12read2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>line, </span>
<span id="cb68-23">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">turn</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>), </span>
<span id="cb68-24">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> b_0j<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center),</span>
<span id="cb68-25">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> b_1j<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>center<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>x)))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-26">  {i22b0j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb68-27">      i_2,</span>
<span id="cb68-28">      b_0j,</span>
<span id="cb68-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(</span>
<span id="cb68-30">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~00~"</span>)</span>
<span id="cb68-31">  )} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-32">  {i22b1j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(</span>
<span id="cb68-33">      i_2,</span>
<span id="cb68-34">      b_1j,</span>
<span id="cb68-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(</span>
<span id="cb68-36">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~10~"</span>)</span>
<span id="cb68-37">    )} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-38">  {e <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*e*~*ij*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb68-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(read_2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(e, read_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-41">  {e_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error_variance</span>(e)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-42">  {u_0j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*u*~0*j*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb68-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_0j, i12read2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>line<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">turn</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb68-45">    u_0j,</span>
<span id="cb68-46">    i12read2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>line<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">turn</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb68-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(</span>
<span id="cb68-48">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*~00~"</span>)</span>
<span id="cb68-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(u_0j, b_0j) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_error_variance_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> e_var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midpoint</span>()) </span>
<span id="cb68-52"></span>
<span id="cb68-53">p_read2L1</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read2L1-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Reading Time 2 Random Intercepts Model + Level 1 Covariate
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B1j%7D"> could have been random, but it is equal to the constant <img src="https://latex.codecogs.com/png.latex?%5Cgamma_%7B10%7D"> in this model.</p>
<section id="exploratory-plot-for-reading1-predicting-reading2" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-plot-for-reading1-predicting-reading2">Exploratory Plot for Reading<sub>1</sub> predicting Reading<sub>2</sub></h3>
<p>It helps to get an exploratory plot to see what is happening. This is not the model 1 plot. I am letting the data speak.</p>
<p>The schools with the lighter (yellower) regression lines have higher SES.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb69-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(reading_1, reading_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> school_ses)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb69-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb69-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(</span>
<span id="cb69-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> school_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> school_id),</span>
<span id="cb69-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,</span>
<span id="cb69-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> F,</span>
<span id="cb69-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb69-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb69-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb69-14">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,</span>
<span id="cb69-15">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SES"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading (Time 1)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading (Time 2)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/reading2plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Interesting…</p>
<p>To my eye, it looks like <code>reading_1</code> and <code>reading_2</code> are correlated, but less so in schools with high SES.</p>
<p>Let’s model it formally. First, we add the L1 covariate <code>reading_1</code> to our model.</p>
</section>
<section id="model-summary-1" class="level3">
<h3 class="anchored" data-anchor-id="model-summary-1">Model Summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1">m_read_2_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_read_2_0, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_1)</span>
<span id="cb70-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ (1 | school_id) + reading_1
   Data: d

REML criterion at convergence: 15765

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.959 -0.670  0.005  0.673  4.094 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.549    0.741   
 Residual              0.127    0.356   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.99108    0.04287    23.1
reading_1    0.42342    0.00456    92.8

Correlation of Fixed Effects:
          (Intr)
reading_1 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_2 with reading_1 (formula: reading_2 ~ reading_1). The model
included school_id as random effect (formula: ~1 | school_id). The model's
total explanatory power is substantial (conditional R2 = 0.85) and the part
related to the fixed effects alone (marginal R2) is of 0.21. The model's
intercept, corresponding to reading_1 = 0, is at 0.99 (95% CI [0.91, 1.08],
t(18253) = 23.12, p &lt; .001). Within this model:

  - The effect of reading 1 is statistically significant and positive (beta =
0.42, 95% CI [0.41, 0.43], t(18253) = 92.82, p &lt; .001; Std. beta = 0.42, 95% CI
[0.41, 0.43])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
15773.337 | 15773.339 | 15804.586 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI | t(18253) |      p
-----------------------------------------------------------------------
(Intercept) |        0.99 |     0.04 | [0.91, 1.08] |    23.12 | &lt; .001
reading 1   |        0.42 | 4.56e-03 | [0.41, 0.43] |    92.82 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.74
SD (Residual)             |        0.36</code></pre>
</div>
</div>
<p>Clearly, <code>reading_1</code> is a significant covariate.</p>
</section>
<section id="compare-model-fit-1" class="level3">
<h3 class="anchored" data-anchor-id="compare-model-fit-1">Compare model fit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_models</span>(m_read_2_0, m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_0 |        m_read_2_1
----------------------------------------------------
(Intercept)  | 0.99 (0.89, 1.09) | 0.99 (0.91, 1.08)
reading 1    |                   | 0.42 (0.41, 0.43)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_read_2_0, m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_0 | lmerMod | 22815.4 (&lt;.001) | 22815.4 (&lt;.001) | 22838.9 (&lt;.001)
m_read_2_1 | lmerMod | 15759.9 (&gt;.999) | 15759.9 (&gt;.999) | 15791.2 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_0 |      0.811 |      0.000 | 0.811 | 0.428 | 0.432
m_read_2_1 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_likelihoodratio</span>(m_read_2_0, m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)

Name       |   Model | df | df_diff |    Chi2 |      p
------------------------------------------------------
m_read_2_0 | lmerMod |  3 |         |         |       
m_read_2_1 | lmerMod |  4 |       1 | 7057.48 | &lt; .001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_performance</span>(m_read_2_0, m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_0 | lmerMod |       
m_read_2_1 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<p>Using reading_1 as an L1 covariate, the model fits significantly better.</p>
</section>
<section id="check-the-variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="check-the-variance-explained">Check the variance explained</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2</span>(m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.852
     Marginal R2: 0.210</code></pre>
</div>
</div>
<p>In this model, the <code>reading_1</code> covariate explained 0.21 of variance in <code>reading_2</code>.</p>
<p>We can also see how much variance was reduced in the levels 1 and 2 residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_read_2_0, m_read_2_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  level model_1_variance model_2_variance variance_reduction
  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;
1     1            0.432            0.356              0.176
2     2            0.800            0.549              0.314</code></pre>
</div>
</div>
<p>It looks like <code>reading_1</code> explained substantial amounts of variance in residuals at both levels.</p>
</section>
<section id="formal-plot-for-model-1" class="level3">
<h3 class="anchored" data-anchor-id="formal-plot-for-model-1">Formal plot for model 1</h3>
<p>Quick plot of fixed effects only:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_read_2_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_1"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/m21plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>To see all the data with the separate regression lines:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1">broom.mixed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(m_read_2_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb91-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(reading_1, reading_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> school_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb91-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb91-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .fitted), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb91-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .fixed), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb91-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb91-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/m21plotfull-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Note that all the regression lines are parallel. Why? Because we did not allow them to differ.</p>
</section>
</section>
<section id="reading-2-model-2-level-2-fixed-effects" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-2-level-2-fixed-effects">Reading 2 Model 2: Level-2 Fixed Effects</h2>
<p>Let’s add <code>school_ses</code> as a level-2 covariate. In essence, we are trying to explain why the L2 random intercept <img src="https://latex.codecogs.com/png.latex?(%5Cbeta_%7B0j%7D)"> differs from school to school: <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B0j%7D=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D"></p>
<p>Here is the complete model:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+%5Cbeta_%7B1j%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%5C%5C%0A%5Cbeta_%7B1j%7D&amp;=%5Cgamma_%7B10%7D%5C%5C%0Au_%7B0j%7D&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Ctau_%7B00%7D)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+%5Cunderbrace%7B%5Cgamma_%7B10%7D%7D_%7B%5Cbeta_%7B1j%7D%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+%5Cgamma_%7B10%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BFixed%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D%7D_%7B%5Ctext%7BRandom%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb92-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb92-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb92-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb92-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb92-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb92-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb92-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb92-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}$"</span>,</span>
<span id="cb92-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$"</span>,</span>
<span id="cb92-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb92-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span></span>
<span id="cb92-13">    </span>
<span id="cb92-14">  ),</span>
<span id="cb92-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb92-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb92-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when reading~1~ is 0."</span>,</span>
<span id="cb92-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope for reading~1~ for class $j$. In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j} = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$."</span>,</span>
<span id="cb92-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb92-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb92-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading~1~ is zero."</span>,</span>
<span id="cb92-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for SES. When SES increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb92-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for reading~1~. When reading~1~ increates by 1, reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb92-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$. It is the deviation of classroom $j$, from the overall fixed intercept *&amp;gamma;*~00~ when SES is zero."</span>,</span>
<span id="cb92-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>),</span>
<span id="cb92-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb92-27">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb92-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb92-29">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb92-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb92-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb92-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-33">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{aligned}</span></span>
<span id="cb92-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb92-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}SES_j+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb92-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb92-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  u_{0j}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00})</span></span>
<span id="cb92-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{aligned}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb92-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">begin{align*}</span></span>
<span id="cb92-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">textbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb92-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\\\</span></span>
<span id="cb92-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sim </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathcal{N}(0,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">end{align*}$$"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-45">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-46">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb92-47"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Combined:}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb92-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}}+\underbrace{\gamma_{10}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb92-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed vs. Random Effects}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb92-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed}}+\underbrace{u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{L2 Random}}+e_{ij}</span></span>
<span id="cb92-51"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb92-52">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read2L1L1" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="dcjefhlxhv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dcjefhlxhv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dcjefhlxhv thead, #dcjefhlxhv tbody, #dcjefhlxhv tfoot, #dcjefhlxhv tr, #dcjefhlxhv td, #dcjefhlxhv th {
  border-style: none;
}

#dcjefhlxhv p {
  margin: 0;
  padding: 0;
}

#dcjefhlxhv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dcjefhlxhv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dcjefhlxhv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dcjefhlxhv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dcjefhlxhv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dcjefhlxhv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dcjefhlxhv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dcjefhlxhv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dcjefhlxhv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dcjefhlxhv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dcjefhlxhv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dcjefhlxhv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dcjefhlxhv .gt_spanner_row {
  border-bottom-style: hidden;
}

#dcjefhlxhv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dcjefhlxhv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dcjefhlxhv .gt_from_md > :first-child {
  margin-top: 0;
}

#dcjefhlxhv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dcjefhlxhv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dcjefhlxhv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dcjefhlxhv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dcjefhlxhv .gt_row_group_first td {
  border-top-width: 2px;
}

#dcjefhlxhv .gt_row_group_first th {
  border-top-width: 2px;
}

#dcjefhlxhv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dcjefhlxhv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dcjefhlxhv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dcjefhlxhv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dcjefhlxhv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dcjefhlxhv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dcjefhlxhv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dcjefhlxhv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dcjefhlxhv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dcjefhlxhv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dcjefhlxhv .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dcjefhlxhv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dcjefhlxhv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dcjefhlxhv .gt_left {
  text-align: left;
}

#dcjefhlxhv .gt_center {
  text-align: center;
}

#dcjefhlxhv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dcjefhlxhv .gt_font_normal {
  font-weight: normal;
}

#dcjefhlxhv .gt_font_bold {
  font-weight: bold;
}

#dcjefhlxhv .gt_font_italic {
  font-style: italic;
}

#dcjefhlxhv .gt_super {
  font-size: 65%;
}

#dcjefhlxhv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dcjefhlxhv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dcjefhlxhv .gt_indent_1 {
  text-indent: 5px;
}

#dcjefhlxhv .gt_indent_2 {
  text-indent: 10px;
}

#dcjefhlxhv .gt_indent_3 {
  text-indent: 15px;
}

#dcjefhlxhv .gt_indent_4 {
  text-indent: 20px;
}

#dcjefhlxhv .gt_indent_5 {
  text-indent: 25px;
}

#dcjefhlxhv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dcjefhlxhv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLiBJbiB0aGlzIG1vZGVsLCBob3dldmVyLCB0aGVyZSBhcmUgbm8gcmFuZG9tIHNsb3Blcy4gVGh1cywgdGhlIHNsb3BlIGZvciBldmVyeSBjbGFzc3Jvb20gaXMgdGhlIHNhbWU6IFwoXGJldGFfezFqfSA9IFxnYW1tYV97MTB9XCku"><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\). In this model, however, there are no random slopes. Thus, the slope for every classroom is the same: \(\beta_{1j} = \gamma_{10}\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfVxcIHVfezBqfSZhbXA7XHNpbSBcbWF0aGNhbHtOfSgwLFx0YXVfezAwfSkgXGVuZHthbGlnbmVkfSQk"><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ u_{0j}&amp;\sim \mathcal{N}(0,\tau_{00}) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIHJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gcmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgcmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for reading<sub>1</sub>. When reading<sub>1</sub> increates by 1, reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLiBJdCBpcyB0aGUgZGV2aWF0aW9uIG9mIGNsYXNzcm9vbSBcKGpcKSwgZnJvbSB0aGUgb3ZlcmFsbCBmaXhlZCBpbnRlcmNlcHQgPGVtPs6zPC9lbT48c3ViPjAwPC9zdWI+IHdoZW4gU0VTIGlzIHplcm8u"><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\). It is the deviation of classroom \(j\), from the overall fixed intercept <em>γ</em><sub>00</sub> when SES is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19K1x1bmRlcmJyYWNle1xnYW1tYV97MTB9fV97XGJldGFfezFqfX1SZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWR9fStcdW5kZXJicmFjZXt1X3swan19X3tcdGV4dHtMMiBSYW5kb219fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+\underbrace{\gamma_{10}}_{\beta_{1j}}Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed}}+\underbrace{u_{0j}}_{\text{L2 Random}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Reading at Time 2 Model 1: Model 1 + L2 Covariate (SES)
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1">p_read2L1L2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_read2L1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb93-2">  {SES <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_l2</span>(</span>
<span id="cb93-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> b_0j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%-|%</span> read_2,</span>
<span id="cb93-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_observed_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*SES*~*j*~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb93-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(SES, b_0j, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~01~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb93-6"></span>
<span id="cb93-7">p_read2L1L2</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read2L1L2-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Reading Time 2 Model with Level 1 and Level 2 Covariates
</figcaption>
</figure>
</div>
</div>
</div>
<p>Creating the entire model from scratch:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1">m_read_2_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> school_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> school_id), d)</span></code></pre></div>
</div>
<p>However, updating from a previous model is generally safer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1">m_read_2_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_read_2_1, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> school_ses)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ (1 | school_id) + reading_1 + school_ses
   Data: d

REML criterion at convergence: 15496

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.933 -0.667  0.005  0.673  4.072 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_id (Intercept) 0.218    0.467   
 Residual              0.127    0.356   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.99104    0.02709    36.6
reading_1    0.41722    0.00456    91.6
school_ses   0.57772    0.02725    21.2

Correlation of Fixed Effects:
           (Intr) rdng_1
reading_1   0.001       
school_ses  0.000 -0.092</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
15506.071 | 15506.075 | 15545.133 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI | t(18252) |      p
-----------------------------------------------------------------------
(Intercept) |        0.99 |     0.03 | [0.94, 1.04] |    36.58 | &lt; .001
reading 1   |        0.42 | 4.56e-03 | [0.41, 0.43] |    91.58 | &lt; .001
school ses  |        0.58 |     0.03 | [0.52, 0.63] |    21.20 | &lt; .001

# Random Effects

Parameter                 | Coefficient
---------------------------------------
SD (Intercept: school_id) |        0.47
SD (Residual)             |        0.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_2 with reading_1 and school_ses (formula: reading_2 ~
reading_1 + school_ses). The model included school_id as random effect
(formula: ~1 | school_id). The model's total explanatory power is substantial
(conditional R2 = 0.89) and the part related to the fixed effects alone
(marginal R2) is of 0.70. The model's intercept, corresponding to reading_1 = 0
and school_ses = 0, is at 0.99 (95% CI [0.94, 1.04], t(18252) = 36.58, p &lt;
.001). Within this model:

  - The effect of reading 1 is statistically significant and positive (beta =
0.42, 95% CI [0.41, 0.43], t(18252) = 91.58, p &lt; .001; Std. beta = 0.42, 95% CI
[0.41, 0.43])
  - The effect of school ses is statistically significant and positive (beta =
0.58, 95% CI [0.52, 0.63], t(18252) = 21.20, p &lt; .001; Std. beta = 0.58, 95% CI
[0.53, 0.64])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Compare <code>m_read_2_1</code> and <code>m_read_2_2</code> with the <code>anova</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_models</span>(m_read_2_1, m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_1 |        m_read_2_2
----------------------------------------------------
(Intercept)  | 0.99 (0.91, 1.08) | 0.99 (0.94, 1.04)
reading 1    | 0.42 (0.41, 0.43) | 0.42 (0.41, 0.43)
school ses   |                   | 0.58 (0.52, 0.63)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_read_2_1, m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_2_1: reading_2 ~ (1 | school_id) + reading_1
m_read_2_2: reading_2 ~ (1 | school_id) + reading_1 + school_ses
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_2_1    4 15760 15791  -7876    15752                        
m_read_2_2    5 15486 15525  -7738    15476   276  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_read_2_1, m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_1 | lmerMod | 15759.9 (&lt;.001) | 15759.9 (&lt;.001) | 15791.2 (&lt;.001)
m_read_2_2 | lmerMod | 15486.4 (&gt;.999) | 15486.4 (&gt;.999) | 15525.4 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_1 |      0.852 |      0.210 | 0.812 | 0.353 | 0.356
m_read_2_2 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_performance</span>(m_read_2_1, m_read_2_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_1 | lmerMod |       
m_read_2_2 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<p>A quick plot of the model’s fixed effects form the <a href="http://www.strengejacke.de/sjPlot/index.html">sjPlot package</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_read_2_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school_ses"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/m22plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The first term (<code>reading_1</code>) is on the x-axis. The second term (<code>school_ses</code>) is plotted at its mean and plus or minus 1 standard deviation.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is <code>school_ses</code> a significant predictor?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Comparing Models 1 and 2, by how much did <code>school_ses</code> reduce L2 variability?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use the <code>variance_reduction</code> function defined earlier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">variance_reduction</span>(m_read_2_1, m_read_2_2)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-3-model-2-random-slopes-uncorrelated-with-random-intercepts">Reading 2 Model 3 = Model 2 + Random slopes uncorrelated with random intercepts</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+%5Cbeta_%7B1j%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%5C%5C%0A%5Cbeta_%7B1j%7D&amp;=%5Cgamma_%7B10%7D+u_%7B1j%7D%5C%5C%0A%5Cboldsymbol%7Bu%7D&amp;=%5Cbegin%7Bbmatrix%7D%0Au_%7B0j%7D%5C%5C%0Au_%7B1j%7D%0A%5Cend%7Bbmatrix%7D%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Cbegin%7Bbmatrix%7D%0A0%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bmatrix%7D%0A%5C%5C%0A,%0A%5Cend%7Bmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0A%5Ctau_%7B00%7D%20&amp;%5C%5C%0A0%20&amp;%20%5Ctau_%7B11%7D%0A%5Cend%7Bbmatrix%7D%5Cright)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+(%5Cunderbrace%7B%5Cgamma_%7B10%7D+u_%7B1j%7D%7D_%7B%5Cbeta_%7B1j%7D%7D)Reading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+%5Cgamma_%7B10%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BFixed%20Effects%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D+u_%7B1j%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BRandom%20Effects%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>In the equations above, how can you tell that the slopes and intercepts are uncorrelated? Look at the <em>tau</em> matrix:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cboldsymbol%7B%5Ctau%7D=%5Cbegin%7Bbmatrix%7D%5Ctau_%7B00%7D&amp;%5C%5C%200%20&amp;%20%5Ctau_%7B11%7D%5Cend%7Bbmatrix%7D%0A"></p>
<p>Here we see that the lower right corner, the covariance between <img src="https://latex.codecogs.com/png.latex?u_%7B0j%7D"> and <img src="https://latex.codecogs.com/png.latex?u_%7B1j%7D">, <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B10%7D">, is zero. Because the matrix is symmetric, I omitted the 0 in the upper right position.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb114-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb114-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb114-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb114-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb114-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb114-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb114-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb114-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}$"</span>,</span>
<span id="cb114-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$"</span>,</span>
<span id="cb114-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">boldsymbol{u}$"</span>,</span>
<span id="cb114-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb114-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{1j}$"</span>,</span>
<span id="cb114-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span>,</span>
<span id="cb114-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{11}$"</span></span>
<span id="cb114-16">  ),</span>
<span id="cb114-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb114-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb114-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb114-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb114-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb114-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb114-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb114-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb114-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb114-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vector of L2 residuals"</span>,</span>
<span id="cb114-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$."</span>,</span>
<span id="cb114-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random slope $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb114-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>,</span>
<span id="cb114-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{1j}$"</span>),</span>
<span id="cb114-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb114-32">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb114-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb114-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb114-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb114-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb114-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-38">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{aligned}</span></span>
<span id="cb114-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}&amp;=\gamma_{10}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">oldsymbol{u}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb114-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{1j}</span></span>
<span id="cb114-46"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb114-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb114-49"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span></span>
<span id="cb114-50"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{matrix}</span></span>
<span id="cb114-51"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb114-53"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{matrix}</span></span>
<span id="cb114-54"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb114-55"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{00} &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0 &amp; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{11}</span></span>
<span id="cb114-57"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\r</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ight)</span></span>
<span id="cb114-58"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{aligned}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb114-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb114-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-64">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-65">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb114-66"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Combined:}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed vs. Random Effects}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb114-69"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Random Effects}}+e_{ij}</span></span>
<span id="cb114-70"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb114-71">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read2L1L1uncorrelated" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="llehkphfrq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#llehkphfrq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#llehkphfrq thead, #llehkphfrq tbody, #llehkphfrq tfoot, #llehkphfrq tr, #llehkphfrq td, #llehkphfrq th {
  border-style: none;
}

#llehkphfrq p {
  margin: 0;
  padding: 0;
}

#llehkphfrq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#llehkphfrq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#llehkphfrq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#llehkphfrq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#llehkphfrq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#llehkphfrq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#llehkphfrq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#llehkphfrq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#llehkphfrq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#llehkphfrq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#llehkphfrq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#llehkphfrq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#llehkphfrq .gt_spanner_row {
  border-bottom-style: hidden;
}

#llehkphfrq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#llehkphfrq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#llehkphfrq .gt_from_md > :first-child {
  margin-top: 0;
}

#llehkphfrq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#llehkphfrq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#llehkphfrq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#llehkphfrq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#llehkphfrq .gt_row_group_first td {
  border-top-width: 2px;
}

#llehkphfrq .gt_row_group_first th {
  border-top-width: 2px;
}

#llehkphfrq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#llehkphfrq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#llehkphfrq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#llehkphfrq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#llehkphfrq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#llehkphfrq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#llehkphfrq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#llehkphfrq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#llehkphfrq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#llehkphfrq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#llehkphfrq .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#llehkphfrq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#llehkphfrq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#llehkphfrq .gt_left {
  text-align: left;
}

#llehkphfrq .gt_center {
  text-align: center;
}

#llehkphfrq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#llehkphfrq .gt_font_normal {
  font-weight: normal;
}

#llehkphfrq .gt_font_bold {
  font-weight: bold;
}

#llehkphfrq .gt_font_italic {
  font-style: italic;
}

#llehkphfrq .gt_super {
  font-size: 65%;
}

#llehkphfrq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#llehkphfrq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#llehkphfrq .gt_indent_1 {
  text-indent: 5px;
}

#llehkphfrq .gt_indent_2 {
  text-indent: 10px;
}

#llehkphfrq .gt_indent_3 {
  text-indent: 15px;
}

#llehkphfrq .gt_indent_4 {
  text-indent: 20px;
}

#llehkphfrq .gt_indent_5 {
  text-indent: 25px;
}

#llehkphfrq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#llehkphfrq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="8" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfVxcIFxib2xkc3ltYm9se3V9JmFtcDs9XGJlZ2lue2JtYXRyaXh9IHVfezBqfVxcIHVfezFqfSBcZW5ke2JtYXRyaXh9XHNpbSBcbWF0aGNhbHtOfVxsZWZ0KFxiZWdpbntibWF0cml4fSAwXFwgMCBcZW5ke2JtYXRyaXh9ClxiZWdpbnttYXRyaXh9IFxcICwgXGVuZHttYXRyaXh9ClxiZWdpbntibWF0cml4fSBcdGF1X3swMH0gJmFtcDtcXCAwICZhbXA7IFx0YXVfezExfSBcZW5ke2JtYXRyaXh9XHJpZ2h0KSBcZW5ke2FsaWduZWR9JCQ="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ 0 &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYm9sZHN5bWJvbHt1fVwp"><span class="gt_from_md">\(\boldsymbol{u}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmVjdG9yIG9mIEwyIHJlc2lkdWFscw=="><span class="gt_from_md">Vector of L2 residuals</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfSt1X3sxan19X3tcYmV0YV97MWp9fSlSZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7UmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Reading at Time 2 Model 1: Model 2 + Random Slopes for Reading<sub>1</sub>
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1">p_read2L1L2uncorrelated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_read2L1L2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb115-2">  {u_1j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*u*~1*j*~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb115-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">place</span>(b_1j, i12read2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>line<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">turn</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb115-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance</span>(</span>
<span id="cb115-5">    u_1j,</span>
<span id="cb115-6">    i12read2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>line<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">turn</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb115-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_residual_variance_label</span>(</span>
<span id="cb115-8">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;tau;*~11~"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb115-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(u_1j, b_1j) </span>
<span id="cb115-10"></span>
<span id="cb115-11">p_read2L1L2uncorrelated</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2uncorrelated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read2L1L2uncorrelated-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2uncorrelated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Reading Time 2 Model with Level 1 and Level 2 Covariates with Uncorrelated Random Intercepts and Random Slopes
</figcaption>
</figure>
</div>
</div>
</div>
<p>To specify a model in which <code>reading_1</code> has random slopes uncorrelated with random intercepts requires some knowledge of lme4’s formula syntax. If <img src="https://latex.codecogs.com/png.latex?X"> is L1, and <img src="https://latex.codecogs.com/png.latex?A"> is L2, <img src="https://latex.codecogs.com/png.latex?X"> has random slopes uncorrelated with random intercepts if</p>
<p><code>Y ~ 1 + X + A + (1 + X || cluster_id)</code></p>
<p>Note the double bar (<code>||</code>). It means uncorrelated slopes. A single bar would be correlated slopes.</p>
<p>Another way to specify uncorrelated slopes would be to add the intercept and the slopes separately:</p>
<p><code>Y ~ 1 + X + A + (1 | cluster_id) + (0 + X | cluster_id)</code></p>
<p>Note the use of the <code>0</code> to indicate no intercept.</p>
<p>Here we specify Model 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1">m_read_2_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> school_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reading_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> school_id), d)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read_2_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_2 ~ 1 + school_ses + reading_1 + ((1 | school_id) + (0 +  
    reading_1 | school_id))
   Data: d

REML criterion at convergence: 13910

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.922 -0.669  0.009  0.665  3.985 

Random effects:
 Groups      Name        Variance Std.Dev.
 school_id   (Intercept) 0.1845   0.430   
 school_id.1 reading_1   0.0433   0.208   
 Residual                0.1124   0.335   
Number of obs: 18257, groups:  school_id, 300

Fixed effects:
            Estimate Std. Error t value
(Intercept)   1.0122     0.0252    40.2
school_ses    0.5785     0.0254    22.8
reading_1     0.4212     0.0129    32.6

Correlation of Fixed Effects:
           (Intr) schl_s
school_ses  0.000       
reading_1   0.000 -0.034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_2_3)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96&nbsp;–&nbsp;1.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading 1</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.40&nbsp;–&nbsp;0.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.11</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.18</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>school_id.reading_1</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.62</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.728 / 0.897</td>
</tr>

</tbody></table>

</div>
</div>
<p>Let’s compare the models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_read_2_2, m_read_2_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_read_2_2: reading_2 ~ (1 | school_id) + reading_1 + school_ses
m_read_2_3: reading_2 ~ 1 + school_ses + reading_1 + ((1 | school_id) + (0 + reading_1 | school_id))
           npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_read_2_2    5 15486 15525  -7738    15476                        
m_read_2_3    6 13905 13951  -6946    13893  1584  1     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_models</span>(m_read_2_2, m_read_2_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    |        m_read_2_2 |        m_read_2_3
----------------------------------------------------
(Intercept)  | 0.99 (0.94, 1.04) | 1.01 (0.96, 1.06)
reading 1    | 0.42 (0.41, 0.43) | 0.42 (0.40, 0.45)
school ses   | 0.58 (0.52, 0.63) | 0.58 (0.53, 0.63)
----------------------------------------------------
Observations |             18257 |             18257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m_read_2_2, m_read_2_3)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">reading 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;1.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96&nbsp;–&nbsp;1.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">reading 1</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.41&nbsp;–&nbsp;0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.40&nbsp;–&nbsp;0.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">school ses</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="7" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.11</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.22 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.18 <sub>school_id</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.04 <sub>school_id.reading_1</sub></td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.62</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">300 <sub>school_id</sub></td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">18257</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.696 / 0.888</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.728 / 0.897</td>
</tr>

</tbody></table>

</div>
<div class="sourceCode cell-code" id="cb125" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_read_2_2, m_read_2_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       |   Model |   AIC (weights) |  AICc (weights) |   BIC (weights)
--------------------------------------------------------------------------
m_read_2_2 | lmerMod | 15486.4 (&lt;.001) | 15486.4 (&lt;.001) | 15525.4 (&lt;.001)
m_read_2_3 | lmerMod | 13904.5 (&gt;.999) | 13904.5 (&gt;.999) | 13951.4 (&gt;.999)

Name       | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
------------------------------------------------------------
m_read_2_2 |      0.888 |      0.696 | 0.632 | 0.353 | 0.356
m_read_2_3 |      0.897 |      0.728 | 0.621 | 0.330 | 0.335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_performance</span>(m_read_2_2, m_read_2_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name       |   Model |     BF
-----------------------------
m_read_2_2 | lmerMod |       
m_read_2_3 | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Does Model 3 fit better than Model 2?</p>
</div>
</div>
</section>
<section id="reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-4-model-3-random-slopes-correlated-with-random-intercepts">Reading 2 Model 4 = Model 3 + Random slopes correlated with random intercepts</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+%5Cbeta_%7B1j%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%5C%5C%0A%5Cbeta_%7B1j%7D&amp;=%5Cgamma_%7B10%7D+u_%7B1j%7D%5C%5C%0A%5Cboldsymbol%7Bu%7D&amp;=%5Cbegin%7Bbmatrix%7D%0Au_%7B0j%7D%5C%5C%0Au_%7B1j%7D%0A%5Cend%7Bbmatrix%7D%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Cbegin%7Bbmatrix%7D%0A0%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bmatrix%7D%0A%5C%5C%0A,%0A%5Cend%7Bmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0A%5Ctau_%7B00%7D%20&amp;%20%5C%5C%0A%5Ctau_%7B10%7D%20&amp;%20%5Ctau_%7B11%7D%0A%5Cend%7Bbmatrix%7D%5Cright)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+(%5Cunderbrace%7B%5Cgamma_%7B10%7D+u_%7B1j%7D%7D_%7B%5Cbeta_%7B1j%7D%7D)Reading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+%5Cgamma_%7B10%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BFixed%20Effects%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D+u_%7B1j%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BRandom%20Effects%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb129-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb129-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb129-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb129-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb129-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb129-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb129-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb129-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}$"</span>,</span>
<span id="cb129-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$"</span>,</span>
<span id="cb129-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb129-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{1j}$"</span>,</span>
<span id="cb129-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span>,</span>
<span id="cb129-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{11}$"</span>,</span>
<span id="cb129-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{10}$"</span></span>
<span id="cb129-16">  ),</span>
<span id="cb129-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb129-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb129-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb129-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb129-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb129-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb129-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb129-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb129-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb129-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$."</span>,</span>
<span id="cb129-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random slope $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb129-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>,</span>
<span id="cb129-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{1j}$"</span>,</span>
<span id="cb129-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of $u_{0j}$ and $u_{1j}$"</span>),</span>
<span id="cb129-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb129-32">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb129-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb129-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb129-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb129-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb129-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-38">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{aligned}</span></span>
<span id="cb129-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}&amp;=\gamma_{10}+u_{1j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">oldsymbol{u}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb129-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{1j}</span></span>
<span id="cb129-46"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb129-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb129-49"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span></span>
<span id="cb129-50"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{matrix}</span></span>
<span id="cb129-51"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb129-53"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{matrix}</span></span>
<span id="cb129-54"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb129-55"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{00} &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-56"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{10} &amp; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{11}</span></span>
<span id="cb129-57"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\r</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ight)</span></span>
<span id="cb129-58"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{aligned}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb129-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb129-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-64">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-65">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb129-66"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Combined:}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed vs. Random Effects}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb129-69"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Random Effects}}+e_{ij}</span></span>
<span id="cb129-70"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb129-71">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-read2L1L1correlated" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-read2L1L1correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rbmhchowzv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rbmhchowzv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rbmhchowzv thead, #rbmhchowzv tbody, #rbmhchowzv tfoot, #rbmhchowzv tr, #rbmhchowzv td, #rbmhchowzv th {
  border-style: none;
}

#rbmhchowzv p {
  margin: 0;
  padding: 0;
}

#rbmhchowzv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rbmhchowzv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rbmhchowzv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rbmhchowzv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rbmhchowzv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbmhchowzv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbmhchowzv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbmhchowzv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rbmhchowzv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rbmhchowzv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rbmhchowzv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rbmhchowzv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rbmhchowzv .gt_spanner_row {
  border-bottom-style: hidden;
}

#rbmhchowzv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rbmhchowzv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rbmhchowzv .gt_from_md > :first-child {
  margin-top: 0;
}

#rbmhchowzv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rbmhchowzv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rbmhchowzv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rbmhchowzv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rbmhchowzv .gt_row_group_first td {
  border-top-width: 2px;
}

#rbmhchowzv .gt_row_group_first th {
  border-top-width: 2px;
}

#rbmhchowzv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbmhchowzv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rbmhchowzv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rbmhchowzv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbmhchowzv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbmhchowzv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rbmhchowzv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rbmhchowzv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rbmhchowzv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbmhchowzv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbmhchowzv .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbmhchowzv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbmhchowzv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbmhchowzv .gt_left {
  text-align: left;
}

#rbmhchowzv .gt_center {
  text-align: center;
}

#rbmhchowzv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rbmhchowzv .gt_font_normal {
  font-weight: normal;
}

#rbmhchowzv .gt_font_bold {
  font-weight: bold;
}

#rbmhchowzv .gt_font_italic {
  font-style: italic;
}

#rbmhchowzv .gt_super {
  font-size: 65%;
}

#rbmhchowzv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rbmhchowzv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rbmhchowzv .gt_indent_1 {
  text-indent: 5px;
}

#rbmhchowzv .gt_indent_2 {
  text-indent: 10px;
}

#rbmhchowzv .gt_indent_3 {
  text-indent: 15px;
}

#rbmhchowzv .gt_indent_4 {
  text-indent: 20px;
}

#rbmhchowzv .gt_indent_5 {
  text-indent: 25px;
}

#rbmhchowzv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rbmhchowzv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="8" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfSt1X3sxan1cXCBcYm9sZHN5bWJvbHt1fSZhbXA7PVxiZWdpbntibWF0cml4fSB1X3swan1cXCB1X3sxan0gXGVuZHtibWF0cml4fVxzaW0gXG1hdGhjYWx7Tn1cbGVmdChcYmVnaW57Ym1hdHJpeH0gMFxcIDAgXGVuZHtibWF0cml4fQpcYmVnaW57bWF0cml4fSBcXCAsIFxlbmR7bWF0cml4fQpcYmVnaW57Ym1hdHJpeH0gXHRhdV97MDB9ICZhbXA7XFwgXHRhdV97MTB9ICZhbXA7IFx0YXVfezExfSBcZW5ke2JtYXRyaXh9XHJpZ2h0KSBcZW5ke2FsaWduZWR9JCQ="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}+u_{1j}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ \tau_{10} &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMH1cKQ=="><span class="gt_from_md">\(\tau_{10}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiBcKHVfezBqfVwpIGFuZCBcKHVfezFqfVwp"><span class="gt_from_md">Covariance of \(u_{0j}\) and \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfSt1X3sxan19X3tcYmV0YV97MWp9fSlSZWFkaW5nX3tpajF9K2Vfe2lqfVxcICZhbXA7XHRleHR7Rml4ZWQgdnMuIFJhbmRvbSBFZmZlY3RzfVxcIFJlYWRpbmdfe2lqMn0gJmFtcDs9IFx1bmRlcmJyYWNle1xnYW1tYV97MDB9K1xnYW1tYV97MDF9U0VTX2orXGdhbW1hX3sxMH1SZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7UmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+\gamma_{10}Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-read2L1L1correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Reading at Time 2 Model 1: Model 3 + correlation between random intercepts and random slopes
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1">p_read_2L1L2correlated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_read2L1L2uncorrelated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb130-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ob_covariance</span>(</span>
<span id="cb130-3">    u_0j<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>),</span>
<span id="cb130-4">    u_1j<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">point_at</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>),</span>
<span id="cb130-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;tau;~10~"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb130-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_head =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb130-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_fins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb130-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb130-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">looseness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb130-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb130-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resect =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb130-12">  ) </span>
<span id="cb130-13"></span>
<span id="cb130-14">p_read_2L1L2correlated</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-read2L1L2correlated" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-read2L1L2correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-read2L1L2correlated-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-read2L1L2correlated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Reading Time 2 Model with Level 1 and Level 2 Covariates with Correlated Random Intercepts and Random Slopes
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make a model in which <code>reading_1</code> has random slopes correlated with random intercepts.</p>
<p>Call your model <code>m_read_2_4</code>.</p>
<p>Does Model 4 fit better than Model 3?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If X is L1 and A is L2, X has random slopes correlated with random intercepts if</p>
<p><code>Y ~ 1 + X + A + (1 + X | cluster_id )</code></p>
<p>Note the single bar (<code>|</code>).</p>
</div>
</div>
</div>
</section>
<section id="reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reading-2-model-5-model-4-cross-level-interaction-of-reading1-and-school-ses">Reading 2 Model 5 = Model 4 + Cross-Level Interaction of Reading<sub>1</sub> and School SES</h2>
<p>An interaction effect (i.e., a moderator effect) is when the effect of one variable depends on the other variable. For example, impulsivity predicts a wide range of negative life outcomes, but its effect is worse when the person is violent. That is impulsive violent people have worse outcomes than non-impulsive violent people or non-violent impulsive people.</p>
<p>Interactions can occur within level (e.g,. between two level-1 variables) or across levels (e.g., between a level-1 variable and a level-2 variable). Here we want to test the cross-level interaction between Reading<sub>1</sub> and classroom SES.</p>
<p>Interaction effects involve multiplicative relationships among variables. Thus the interaction between A and B would be specified like so:</p>
<p><code>Y ~ A * B</code></p>
<p>Technically, the <code>*</code> operator in a formula includes all lower-order effects among the variables multiplied (i.e., the simple slopes for A and B in addition to the interaction of A and B). Expanded, <code>A * B</code> becomes <code>A + B + A:B</code>. In this context, the <code>:</code> is just the multiplicative term. With three variables, <code>A*B*C</code> becomes <code>A + B + C + A:B + A:C + B:C + A:B:C</code>. If we wanted just the simple slopes and two-way interactions, we could specify <code>A + B + C + A:B + A:C + B:C</code> or <code>A*B - A:B:C</code>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctextbf%7BLevel%201:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cbeta_%7B0j%7D+%5Cbeta_%7B1j%7DReading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0Ae&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%5Csigma_e%5E2)%5C%5C%0A%5Ctextbf%7BLevel%202:%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%5C%5C%0A%5Cbeta_%7B1j%7D&amp;=%5Cgamma_%7B10%7D+%5Cgamma_%7B11%7DSES_j+u_%7B1j%7D%5C%5C%0A%5Cboldsymbol%7Bu%7D&amp;=%5Cbegin%7Bbmatrix%7D%0Au_%7B0j%7D%5C%5C%0Au_%7B1j%7D%0A%5Cend%7Bbmatrix%7D%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Cbegin%7Bbmatrix%7D%0A0%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bmatrix%7D%0A%5C%5C%0A,%0A%5Cend%7Bmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0A%5Ctau_%7B00%7D%20&amp;%20%5C%5C%0A%5Ctau_%7B10%7D%20&amp;%20%5Ctau_%7B11%7D%0A%5Cend%7Bbmatrix%7D%5Cright)%5C%5C%0A%5Ctextbf%7BCombined:%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+(%5Cunderbrace%7B%5Cgamma_%7B10%7D+%5Cgamma_%7B11%7DSES_j+u_%7B1j%7D%7D_%7B%5Cbeta_%7B1j%7D%7D)Reading_%7Bij1%7D+e_%7Bij%7D%5C%5C%0A&amp;%5Ctext%7BFixed%20vs.%20Random%20Effects%7D%5C%5C%0AReading_%7Bij2%7D%20&amp;=%20%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DSES_j+(%5Cgamma_%7B10%7D+%5Cgamma_%7B11%7DSES_j)Reading_%7Bij1%7D%7D_%7B%5Ctext%7BFixed%20Effects%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D+u_%7B1j%7DReading_%7Bij1%7D%7D_%7B%5Ctext%7BL2%20Random%20Effects%7D%7D+e_%7Bij%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb131-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Symbol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb131-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$Reading_{ij2}$"</span>,</span>
<span id="cb131-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb131-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$"</span>,</span>
<span id="cb131-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$e_{ij}$"</span>,</span>
<span id="cb131-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sigma_e^2$"</span>,</span>
<span id="cb131-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{00}$"</span>,</span>
<span id="cb131-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{01}$"</span>,</span>
<span id="cb131-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{10}$"</span>,</span>
<span id="cb131-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gamma_{11}$"</span>,</span>
<span id="cb131-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{0j}$"</span>,</span>
<span id="cb131-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$u_{1j}$"</span>,</span>
<span id="cb131-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{00}$"</span>,</span>
<span id="cb131-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{11}$"</span>,</span>
<span id="cb131-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tau_{10}$"</span></span>
<span id="cb131-17">  ),</span>
<span id="cb131-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb131-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading score for person $i$ in class $j$ at time 2"</span>,</span>
<span id="cb131-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random intercept for class $j$. In this model, it represents the reading~2~ classroom mean for class $j$ when Reading~1~ is 0."</span>,</span>
<span id="cb131-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope for reading~1~ for class $j$."</span>,</span>
<span id="cb131-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1 prediction error for person $i$ in class $j$"</span>,</span>
<span id="cb131-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $e_{ij}$"</span>,</span>
<span id="cb131-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading~1~ is zero."</span>,</span>
<span id="cb131-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for SES. When SES increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb131-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed slope for Reading~1~. When Reading~1~ increates by 1, Reading~2~ is expected to increase by this amount."</span>,</span>
<span id="cb131-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fixed cross-level interaction effect of Reading~1~ and SES. When SES increases by 1, the fixed slope for Reading~1~ increates by this amount."</span>,</span>
<span id="cb131-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random intercept $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{0j}$."</span>,</span>
<span id="cb131-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"School-level (L2) residual for the random slope $</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">beta_{1j}$ for Reading~1~."</span>,</span>
<span id="cb131-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{0j}$"</span>,</span>
<span id="cb131-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance of $u_{1j}$"</span>,</span>
<span id="cb131-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of $u_{0j}$ and $u_{1j}$"</span>),</span>
<span id="cb131-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb131-34">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb131-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_group_as_column =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb131-36">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb131-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb131-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column_labels.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb131-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnotes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.border.bottom.color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-40">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_width</span>(Symbol <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pct</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{aligned}</span></span>
<span id="cb131-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 2}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}&amp;=\gamma_{10}+\gamma_{11}SES_j+u_{1j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">oldsymbol{u}&amp;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb131-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{0j}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">u_{1j}</span></span>
<span id="cb131-48"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}\sim \mathcal{N}\left(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb131-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb131-51"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span></span>
<span id="cb131-52"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{matrix}</span></span>
<span id="cb131-53"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb131-55"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{matrix}</span></span>
<span id="cb131-56"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{bmatrix}</span></span>
<span id="cb131-57"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{00} &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-58"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{10} &amp; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">au_{11}</span></span>
<span id="cb131-59"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{bmatrix}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\r</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ight)</span></span>
<span id="cb131-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{aligned}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb131-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_row_group</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb131-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Level 1}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-64"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> level <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level 1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-65">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_markdown</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-66">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-67">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">footnote =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(r<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">egin{align*}</span></span>
<span id="cb131-68"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extbf{Combined:}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-69"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{0j}}+(\underbrace{\gamma_{10}+\gamma_{11}SES_j+u_{1j}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eta_{1j}})Reading_{ij1}+e_{ij}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed vs. Random Effects}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span></span>
<span id="cb131-71"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+(\gamma_{10}+\gamma_{11}SES_j)Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ext{L2 Random Effects}}+e_{ij}</span></span>
<span id="cb131-72"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\e</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nd{align*}$$)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb131-73">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stubhead</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Level"</span>)</span></code></pre></div>
</details>
<div id="tbl-crosslevel" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="usadvccxst" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#usadvccxst table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#usadvccxst thead, #usadvccxst tbody, #usadvccxst tfoot, #usadvccxst tr, #usadvccxst td, #usadvccxst th {
  border-style: none;
}

#usadvccxst p {
  margin: 0;
  padding: 0;
}

#usadvccxst .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#usadvccxst .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#usadvccxst .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#usadvccxst .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#usadvccxst .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#usadvccxst .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#usadvccxst .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#usadvccxst .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#usadvccxst .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 20px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#usadvccxst .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#usadvccxst .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#usadvccxst .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#usadvccxst .gt_spanner_row {
  border-bottom-style: hidden;
}

#usadvccxst .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#usadvccxst .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#usadvccxst .gt_from_md > :first-child {
  margin-top: 0;
}

#usadvccxst .gt_from_md > :last-child {
  margin-bottom: 0;
}

#usadvccxst .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#usadvccxst .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#usadvccxst .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#usadvccxst .gt_row_group_first td {
  border-top-width: 2px;
}

#usadvccxst .gt_row_group_first th {
  border-top-width: 2px;
}

#usadvccxst .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#usadvccxst .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#usadvccxst .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#usadvccxst .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#usadvccxst .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#usadvccxst .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#usadvccxst .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#usadvccxst .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#usadvccxst .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#usadvccxst .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#usadvccxst .gt_footnote {
  margin: 0px;
  font-size: 16px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#usadvccxst .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#usadvccxst .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#usadvccxst .gt_left {
  text-align: left;
}

#usadvccxst .gt_center {
  text-align: center;
}

#usadvccxst .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#usadvccxst .gt_font_normal {
  font-weight: normal;
}

#usadvccxst .gt_font_bold {
  font-weight: bold;
}

#usadvccxst .gt_font_italic {
  font-style: italic;
}

#usadvccxst .gt_super {
  font-size: 65%;
}

#usadvccxst .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#usadvccxst .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#usadvccxst .gt_indent_1 {
  text-indent: 5px;
}

#usadvccxst .gt_indent_2 {
  text-indent: 10px;
}

#usadvccxst .gt_indent_3 {
  text-indent: 15px;
}

#usadvccxst .gt_indent_4 {
  text-indent: 20px;
}

#usadvccxst .gt_indent_5 {
  text-indent: 25px;
}

#usadvccxst .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#usadvccxst div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout:fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:23%;">
    <col style="width:15%;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">Level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Symbol">Symbol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Meaning">Meaning</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_row_group_first"><td headers="l1 stub_1_1 stub_1" rowspan="5" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0xldmVsIDF9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXGJldGFfezBqfStcYmV0YV97MWp9UmVhZGluZ197aWoxfStlX3tpan1cXCBlX3tpan0mYW1wO1xzaW0gXG1hdGhjYWx7Tn0oMCxcc2lnbWFfZV4yKVxlbmR7YWxpZ24qfSQk"><span class="gt_from_md">$$\begin{align*} \textbf{Level 1}\\ Reading_{ij2} &amp;= \beta_{0j}+\beta_{1j}Reading_{ij1}+e_{ij}\\ e_{ij}&amp;\sim \mathcal{N}(0,\sigma_e^2)\end{align*}$$</span></span></td>
<td headers="l1 stub_1_1 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChSZWFkaW5nX3tpajJ9XCk="><span class="gt_from_md">\(Reading_{ij2}\)</span></span></td>
<td headers="l1 stub_1_1 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmVhZGluZyBzY29yZSBmb3IgcGVyc29uIFwoaVwpIGluIGNsYXNzIFwoalwpIGF0IHRpbWUgMg=="><span class="gt_from_md">Reading score for person \(i\) in class \(j\) at time 2</span></span></td></tr>
    <tr><td headers="l1 Symbol_2 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_2 Meaning" class="gt_row gt_left"><span data-qmd-base64="UmFuZG9tIGludGVyY2VwdCBmb3IgY2xhc3MgXChqXCkuIEluIHRoaXMgbW9kZWwsIGl0IHJlcHJlc2VudHMgdGhlIHJlYWRpbmc8c3ViPjI8L3N1Yj4gY2xhc3Nyb29tIG1lYW4gZm9yIGNsYXNzIFwoalwpIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyAwLg=="><span class="gt_from_md">Random intercept for class \(j\). In this model, it represents the reading<sub>2</sub> classroom mean for class \(j\) when Reading<sub>1</sub> is 0.</span></span></td></tr>
    <tr><td headers="l1 Symbol_3 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcYmV0YV97MGp9XCk="><span class="gt_from_md">\(\beta_{0j}\)</span></span></td>
<td headers="l1 Symbol_3 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2xvcGUgZm9yIHJlYWRpbmc8c3ViPjE8L3N1Yj4gZm9yIGNsYXNzIFwoalwpLg=="><span class="gt_from_md">Slope for reading<sub>1</sub> for class \(j\).</span></span></td></tr>
    <tr><td headers="l1 Symbol_4 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChlX3tpan1cKQ=="><span class="gt_from_md">\(e_{ij}\)</span></span></td>
<td headers="l1 Symbol_4 Meaning" class="gt_row gt_left"><span data-qmd-base64="TGV2ZWwgMSBwcmVkaWN0aW9uIGVycm9yIGZvciBwZXJzb24gXChpXCkgaW4gY2xhc3MgXChqXCk="><span class="gt_from_md">Level 1 prediction error for person \(i\) in class \(j\)</span></span></td></tr>
    <tr><td headers="l1 Symbol_5 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcc2lnbWFfZV4yXCk="><span class="gt_from_md">\(\sigma_e^2\)</span></span></td>
<td headers="l1 Symbol_5 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXChlX3tpan1cKQ=="><span class="gt_from_md">Variance of \(e_{ij}\)</span></span></td></tr>
    <tr class="gt_row_group_first"><td headers="l2 stub_1_6 stub_1" rowspan="9" class="gt_row gt_left gt_stub_row_group"><span data-qmd-base64="JCRcYmVnaW57YWxpZ25lZH0gXHRleHRiZntMZXZlbCAyfVxcIFxiZXRhX3swan0mYW1wOz1cZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfVxcIFxiZXRhX3sxan0mYW1wOz1cZ2FtbWFfezEwfStcZ2FtbWFfezExfVNFU19qK3VfezFqfVxcIFxib2xkc3ltYm9se3V9JmFtcDs9XGJlZ2lue2JtYXRyaXh9IHVfezBqfVxcIHVfezFqfSBcZW5ke2JtYXRyaXh9XHNpbSBcbWF0aGNhbHtOfVxsZWZ0KFxiZWdpbntibWF0cml4fSAwXFwgMCBcZW5ke2JtYXRyaXh9ClxiZWdpbnttYXRyaXh9IFxcICwgXGVuZHttYXRyaXh9ClxiZWdpbntibWF0cml4fSBcdGF1X3swMH0gJmFtcDtcXCBcdGF1X3sxMH0gJmFtcDsgXHRhdV97MTF9IFxlbmR7Ym1hdHJpeH1ccmlnaHQpIFxlbmR7YWxpZ25lZH0kJA=="><span class="gt_from_md">$$\begin{aligned} \textbf{Level 2}\\ \beta_{0j}&amp;=\gamma_{00}+\gamma_{01}SES_j+u_{0j}\\ \beta_{1j}&amp;=\gamma_{10}+\gamma_{11}SES_j+u_{1j}\\ \boldsymbol{u}&amp;=\begin{bmatrix} u_{0j}\\ u_{1j} \end{bmatrix}\sim \mathcal{N}\left(\begin{bmatrix} 0\\ 0 \end{bmatrix}
\begin{matrix} \\ , \end{matrix}
\begin{bmatrix} \tau_{00} &amp;\\ \tau_{10} &amp; \tau_{11} \end{bmatrix}\right) \end{aligned}$$</span></span></td>
<td headers="l2 stub_1_6 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAwfVwp"><span class="gt_from_md">\(\gamma_{00}\)</span></span></td>
<td headers="l2 stub_1_6 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgSW50ZXJjZXB0LiBJbiB0aGlzIG1vZGVsLCBpdCBpcyB0aGUgcHJlZGljdGVkIFRpbWUgMiBSZWFkaW5nIHdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpcyB6ZXJvLg=="><span class="gt_from_md">Fixed Intercept. In this model, it is the predicted Time 2 Reading when Reading<sub>1</sub> is zero.</span></span></td></tr>
    <tr><td headers="l2 Symbol_7 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezAxfVwp"><span class="gt_from_md">\(\gamma_{01}\)</span></span></td>
<td headers="l2 Symbol_7 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFNFUy4gV2hlbiBTRVMgaW5jcmVhdGVzIGJ5IDEsIFJlYWRpbmc8c3ViPjI8L3N1Yj4gaXMgZXhwZWN0ZWQgdG8gaW5jcmVhc2UgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed slope for SES. When SES increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_8 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezEwfVwp"><span class="gt_from_md">\(\gamma_{10}\)</span></span></td>
<td headers="l2 Symbol_8 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgc2xvcGUgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4uIFdoZW4gUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgMSwgUmVhZGluZzxzdWI+Mjwvc3ViPiBpcyBleHBlY3RlZCB0byBpbmNyZWFzZSBieSB0aGlzIGFtb3VudC4="><span class="gt_from_md">Fixed slope for Reading<sub>1</sub>. When Reading<sub>1</sub> increates by 1, Reading<sub>2</sub> is expected to increase by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_9 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcZ2FtbWFfezExfVwp"><span class="gt_from_md">\(\gamma_{11}\)</span></span></td>
<td headers="l2 Symbol_9 Meaning" class="gt_row gt_left"><span data-qmd-base64="Rml4ZWQgY3Jvc3MtbGV2ZWwgaW50ZXJhY3Rpb24gZWZmZWN0IG9mIFJlYWRpbmc8c3ViPjE8L3N1Yj4gYW5kIFNFUy4gV2hlbiBTRVMgaW5jcmVhc2VzIGJ5IDEsIHRoZSBmaXhlZCBzbG9wZSBmb3IgUmVhZGluZzxzdWI+MTwvc3ViPiBpbmNyZWF0ZXMgYnkgdGhpcyBhbW91bnQu"><span class="gt_from_md">Fixed cross-level interaction effect of Reading<sub>1</sub> and SES. When SES increases by 1, the fixed slope for Reading<sub>1</sub> increates by this amount.</span></span></td></tr>
    <tr><td headers="l2 Symbol_10 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3swan1cKQ=="><span class="gt_from_md">\(u_{0j}\)</span></span></td>
<td headers="l2 Symbol_10 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gaW50ZXJjZXB0IFwoXGJldGFfezBqfVwpLg=="><span class="gt_from_md">School-level (L2) residual for the random intercept \(\beta_{0j}\).</span></span></td></tr>
    <tr><td headers="l2 Symbol_11 Symbol" class="gt_row gt_left"><span data-qmd-base64="XCh1X3sxan1cKQ=="><span class="gt_from_md">\(u_{1j}\)</span></span></td>
<td headers="l2 Symbol_11 Meaning" class="gt_row gt_left"><span data-qmd-base64="U2Nob29sLWxldmVsIChMMikgcmVzaWR1YWwgZm9yIHRoZSByYW5kb20gc2xvcGUgXChcYmV0YV97MWp9XCkgZm9yIFJlYWRpbmc8c3ViPjE8L3N1Yj4u"><span class="gt_from_md">School-level (L2) residual for the random slope \(\beta_{1j}\) for Reading<sub>1</sub>.</span></span></td></tr>
    <tr><td headers="l2 Symbol_12 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3swMH1cKQ=="><span class="gt_from_md">\(\tau_{00}\)</span></span></td>
<td headers="l2 Symbol_12 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3swan1cKQ=="><span class="gt_from_md">Variance of \(u_{0j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_13 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMX1cKQ=="><span class="gt_from_md">\(\tau_{11}\)</span></span></td>
<td headers="l2 Symbol_13 Meaning" class="gt_row gt_left"><span data-qmd-base64="VmFyaWFuY2Ugb2YgXCh1X3sxan1cKQ=="><span class="gt_from_md">Variance of \(u_{1j}\)</span></span></td></tr>
    <tr><td headers="l2 Symbol_14 Symbol" class="gt_row gt_left"><span data-qmd-base64="XChcdGF1X3sxMH1cKQ=="><span class="gt_from_md">\(\tau_{10}\)</span></span></td>
<td headers="l2 Symbol_14 Meaning" class="gt_row gt_left"><span data-qmd-base64="Q292YXJpYW5jZSBvZiBcKHVfezBqfVwpIGFuZCBcKHVfezFqfVwp"><span class="gt_from_md">Covariance of \(u_{0j}\) and \(u_{1j}\)</span></span></td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> <span data-qmd-base64="JCRcYmVnaW57YWxpZ24qfSBcdGV4dGJme0NvbWJpbmVkOn1cXCBSZWFkaW5nX3tpajJ9ICZhbXA7PSBcdW5kZXJicmFjZXtcZ2FtbWFfezAwfStcZ2FtbWFfezAxfVNFU19qK3VfezBqfX1fe1xiZXRhX3swan19KyhcdW5kZXJicmFjZXtcZ2FtbWFfezEwfStcZ2FtbWFfezExfVNFU19qK3VfezFqfX1fe1xiZXRhX3sxan19KVJlYWRpbmdfe2lqMX0rZV97aWp9XFwgJmFtcDtcdGV4dHtGaXhlZCB2cy4gUmFuZG9tIEVmZmVjdHN9XFwgUmVhZGluZ197aWoyfSAmYW1wOz0gXHVuZGVyYnJhY2V7XGdhbW1hX3swMH0rXGdhbW1hX3swMX1TRVNfaisoXGdhbW1hX3sxMH0rXGdhbW1hX3sxMX1TRVNfailSZWFkaW5nX3tpajF9fV97XHRleHR7Rml4ZWQgRWZmZWN0c319K1x1bmRlcmJyYWNle3VfezBqfSt1X3sxan1SZWFkaW5nX3tpajF9fV97XHRleHR7TDIgUmFuZG9tIEVmZmVjdHN9fStlX3tpan0gXGVuZHthbGlnbip9JCQ="><span class="gt_from_md">$$\begin{align*} \textbf{Combined:}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+u_{0j}}_{\beta_{0j}}+(\underbrace{\gamma_{10}+\gamma_{11}SES_j+u_{1j}}_{\beta_{1j}})Reading_{ij1}+e_{ij}\\ &amp;\text{Fixed vs. Random Effects}\\ Reading_{ij2} &amp;= \underbrace{\gamma_{00}+\gamma_{01}SES_j+(\gamma_{10}+\gamma_{11}SES_j)Reading_{ij1}}_{\text{Fixed Effects}}+\underbrace{u_{0j}+u_{1j}Reading_{ij1}}_{\text{L2 Random Effects}}+e_{ij} \end{align*}$$</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Reading at Time 2 Model 1: Model 4 + Cross-level Interaction of Reading_1 and School SES
</figcaption>
</figure>
</div>
</div>
<div class="cell preview-image page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1">p_read_2L1L2correlated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb132-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path</span>(SES, </span>
<span id="cb132-3">          b_1j, </span>
<span id="cb132-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_path_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*~*11*~"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-crosslevel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomSlopes/random_slopes_files/figure-html/fig-crosslevel-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-crosslevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Reading Time 2 Model with Cross-Level Interaction of SES and Reading<sub>1</sub>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 5
</div>
</div>
<div class="callout-body-container callout-body">
<p>Specify a model in which <code>reading_1</code> and <code>school_ses</code> interact.</p>
<p>Call your model <code>m_read_2_5</code></p>
<p>Does Model 5 fit better than Model 4?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If X is L1 and A is L2, the cross-level interaction is specified like so:</p>
<p><code>Y ~ 1 + X * A + (1 + X | cluster_id )</code></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compared to Model 0, by how much is level-2 variance reduced by model 5?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (click to see)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For this question and the next, use the <code>variance_reduction</code> function created earlier.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compared to Model 0, by how much is level-1 variance reduced by model 5?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question 8
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is your overall interpretation of these data?</p>
</div>
</div>
<p>Run this code to see some plots that might aid your interpretation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fixed effects only</span></span>
<span id="cb133-2">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(m_read_2_5,</span>
<span id="cb133-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,</span>
<span id="cb133-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reading_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school_ses [-2, -1, 0, 1, 2]"</span>)</span>
<span id="cb133-5">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb133-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb133-7"></span>
<span id="cb133-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Random effects only</span></span>
<span id="cb133-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(m_read_2_5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb133-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(reading_1, reading_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> school_ses)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb133-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb133-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .fitted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> school_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb133-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb133-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>()</span></code></pre></div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2">
<div id="ref-lme4" class="csl-entry">
Bates, D., Machler, M., Bolker, B., &amp; Walker, S. (2015). <em>Fitting linear mixed-effects models using <span></span>lme4<span></span></em>. <em>67</em>. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>
</div>
<div id="ref-curran2007" class="csl-entry">
Curran, P. J., &amp; Bauer, D. J. (2007). Building path diagrams for multilevel models. <em>Psychological Methods</em>, <em>12</em>(3), 283–297. <a href="https://doi.org/10.1037/1082-989x.12.3.283">https://doi.org/10.1037/1082-989x.12.3.283</a>
</div>
</div></section></div> ]]></description>
  <guid>https://wjschne.github.io/tutorials/RandomSlopes/random_slopes.html</guid>
  <pubDate>Thu, 06 Feb 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Random Intercept Models in R</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts.html</link>
  <description><![CDATA[ 





<section id="fixed-vs.-random-effects" class="level1">
<h1>Fixed vs.&nbsp;Random Effects</h1>
<p>In a one-way ANOVA, there is a fixed variable and a random variable. Usually, our focus is on the fixed variable—so much so that we might not realize that the random variable is a variable at all.</p>
<p>A <em>fixed effect</em> is used when the comparisons between groups of scores are meaningful. There is a small, defined number of groups, and all of them are sampled. A <em>random effect</em> is one where the number of groups is open-ended, and the differences between specific groups are not of theoretical interest.</p>
<p>For example, suppose that we compare an outcome variable collected from children who have been given no treatment, a short intervention, and a long-lasting intervention.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AOutcome_i=Treatment_i+e_i%0A"></p>
<ul>
<li>The fixed effect is the <em>treatment</em> variable with 3 group means for the control group, the short intervention group, and the long intervention group.</li>
<li>The random effect is the difference of each <em>child</em> <img src="https://latex.codecogs.com/png.latex?(e)">. It is a random effect because there is an open-ended number of children who could have been in our study, and we have no theoretical interest in comparing specific children with other specific children.</li>
</ul>
<p>The one-way ANOVA comparing the three groups of children will reveal something about the group mean differences on the outcome variable, but nothing substantive about individual children.</p>
</section>
<section id="random-variables-at-multiple-levels-of-analysis" class="level1">
<h1>Random variables at multiple levels of analysis</h1>
<p>In multilevel modeling (and in random-effects ANOVA), we can specify more than one random variable. For example, in educational research, we collect data from many classrooms. Thus, both <em>student</em> and <em>classroom</em> are random variables, because we have no theoretical interest in the differences among specific students or specific classrooms. We cannot collect data from every student or every classroom, so we collect data from a representative number of students and classrooms.</p>
<p>A variable is said to be <strong>nested</strong> if every unit belongs to exactly one group. In elementary school, each student belongs to one class only. Thus, the <em>student</em> random variable is nested in the <em>classroom</em> random variable.</p>
<p>Because there are many students in each classroom, the <em>student</em> variable is said to be a “level-1 random variable,” and <em>classroom</em> is said to be a “level-2 random variable.”</p>
<p>In middle school and beyond, student and classroom are not nested because each student belongs to multiple classes. In such data sets, <em>student</em> and <em>classroom</em> are said to be <strong>crossed</strong> random variables.</p>
<p>In longitudinal studies, we have multiple scores per person, one for each time period. Thus the two random variables are <em>time period</em> and <em>person</em>, and <em>time period</em> is nested in <em>person</em>. In this case, the <em>time period</em> is the level-1 random variable and <em>person</em> is the level-2 variable. If these people were arranged in different psychotherapy groups, then <em>therapy group</em> would be a level-3 random variable.</p>
<p>There is no theoretical limit to the number levels your analysis can have, but practical and computational difficulties often arise as the number of levels increases.</p>
</section>
<section id="a-reading-comprehension-intervention-study" class="level1">
<h1>A Reading Comprehension Intervention Study</h1>
<p>Suppose we study the effects of an intervention on second-grade students’ performance on reading comprehension tests. Some students receive the intervention and some are given treatment-as-usual. We use a <a href="https://www.wikiwand.com/en/Cluster_randomised_controlled_trial"><em>cluster-randomized controlled trial</em></a>, meaning that instead of assigning students to intervention groups individually, we assign whole <em>clusters</em> at a time. In the case, the clusters are classrooms. Thus, some classrooms are in the intervention condition, and some are in the control condition.</p>
</section>
<section id="install-and-load-packages" class="level1">
<h1>Install and Load packages</h1>
<section id="lme4" class="level2">
<h2 class="anchored" data-anchor-id="lme4">lme4</h2>
<p>The primary package for multilevel modeling we will use in this class is <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">lme4</a>.</p>
</section>
<section id="easystats" class="level2">
<h2 class="anchored" data-anchor-id="easystats">Easystats</h2>
<p>The <a href="https://easystats.github.io/easystats/">easystats</a> package, like the tidyverse package, loads a family of packages that can make many aspects of analysis much, much easier than they used to be. You should know that the packages are still very much in development.</p>
<ul>
<li><a href="https://easystats.github.io/parameters/"><img src="https://easystats.github.io/parameters/logo.png" class="img-fluid" width="100" alt="parameters"></a> <a href="https://easystats.github.io/parameters/">parameters</a> gets information about model parameters.</li>
<li><a href="https://github.com/easystats/performance"><img src="https://easystats.github.io/performance/logo.png" class="img-fluid" width="100" alt="performance"></a> <a href="https://github.com/easystats/performance">performance</a> helps you evaluate the performance of your models.</li>
<li><a href="https://easystats.github.io/modelbased/"><img src="https://easystats.github.io/modelbased/logo.png" class="img-fluid" width="100" alt="modelbased"></a> <a href="https://github.com/easystats/modelbased">modelbased</a> computes marginal means and model-based predictions.</li>
<li><a href="https://easystats.github.io/insight/"><img src="https://easystats.github.io/insight/logo.png" class="img-fluid" width="100" alt="insight"></a> <a href="https://github.com/easystats/insight">insight</a> extracts fundamental information about your model.</li>
<li><a href="https://easystats.github.io/effectsize/"><img src="https://easystats.github.io/effectsize/logo.png" class="img-fluid" width="100" alt="effectsize"></a> <a href="https://easystats.github.io/effectsize/">effectsize</a> computes model effect sizes.</li>
<li><a href="https://easystats.github.io/correlation/"><img src="https://easystats.github.io/correlation/logo.png" class="img-fluid" width="100" alt="correlation"></a> <a href="https://easystats.github.io/correlation/">correlation</a> makes working with correlations easier.</li>
<li><a href="https://easystats.github.io/datawizard/"><img src="https://easystats.github.io/datawizard/logo.png" class="img-fluid" width="100" alt="datawizard"></a> <a href="https://easystats.github.io/datawizard/">datawizard</a> makes transforming your data easier.</li>
<li><a href="https://easystats.github.io/see/"><img src="https://easystats.github.io/see/logo.png" class="img-fluid" width="100" alt="see"></a> <a href="https://easystats.github.io/see/">see</a> makes publication-ready data visualizations.</li>
<li><a href="https://easystats.github.io/report/"><img src="https://easystats.github.io/report/logo.png" class="img-fluid" width="100" alt="report"></a> <a href="https://easystats.github.io/report/">report</a> automates model interpretation.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install packages, if needed.</span></span>
<span id="cb1-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lme4"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lme4"</span>)</span>
<span id="cb1-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"easystats"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"easystats"</span>)</span>
<span id="cb1-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marginaleffects"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marginaleffects"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load packages</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Multilevel modeling</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># General data management and plotting</span></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># General modeling enhancements</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(marginaleffects) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predicted values </span></span></code></pre></div>
</div>
</section>
</section>
<section id="import-data-.csv-data" class="level1">
<h1>Import data .csv data</h1>
<p>Here I import the data frame, and I specify the nature of the variables.</p>
<p>I can just import the data with no fuss like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(</span>
<span id="cb3-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/random_intercept.csv"</span>)</span></code></pre></div>
</div>
<p>The .csv format (comma separated values) is widely used because it is straightforward and non-proprietary. Every statistics and spreadsheet program can open it. It will never die. You can count on it.</p>
<p>However, unlike SPSS’s .sav data format, the .csv format has very little <em>metadata</em> (data about data). By convention, a .csv file’s only metadata is that the first row contains the variable names. The rest of the file is just raw text separated by commas. Should a particular column be considered numeric? text? dates? If it is text, should the text be ordered in any way (e.g., <em>strongly disagree</em>, <em>disagree</em>, <em>agree</em>, <em>strongly agree</em>)?</p>
<p>The <code>readr::read_csv</code> function will make sensible guesses about each variable’s format, but it cannot possibly anticipate everything. We might need to tell it what is going on with each variable.</p>
<p>If we import a file with defaults, we can ask readr which guesses it made like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  student_id = col_double(),
  classroom_id = col_double(),
  treatment = col_character(),
  reading_comprehension = col_double()
)</code></pre>
</div>
</div>
<p>The console output of this function is nice because we can copy, paste, and modify it to just what we want.</p>
<p>The <code>read_csv</code> function looks at the first few thousand cases of each variable and guesses what kind of variable it is: numeric (integers or decimals), character (text), logical (TRUE/FALSE), or factors. A factor in R is a nominal or ordinal variable.</p>
<p>The <code>student_id</code> variable uses numbers (<code>col_double</code> means <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format"><em>double-precision floating-point decimal format</em></a>) to uniquely identify the students. Thus, it is not a quantity, but an identifier. In the same way, social security numbers and telephone numbers are identifiers, not quantities. Because <code>student_id</code> is just a sequence of integers, the <code>read_csv</code> will by default assume it is a numeric variable. We would like to override the default and specify it to be a factor (R’s term for categorical data). Likewise, the <code>classroom_id</code> variable would be an integer, but we want it to be a factor.</p>
<p>The <code>treatment</code> variable is imported as text, but we would like it to be an ordered factor with “Control” listed first and “Treatment” listed second. In this case, “Control” and “Treatment” are already in alphabetical order, but it is a good idea to set the order you want explicitly. An additional benefit of doing so is that your code will document what it expects to find.</p>
<p>Next I re-import the data according to more precise specifications. This might seem like a lot of extra work. It is. However, being clear and explicit about your variables’ format usually saves you time and prevents tedium and heartache at later stages of your analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(</span>
<span id="cb6-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/random_intercept.csv"</span>,</span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">student_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_factor</span>(),</span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classroom_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_factor</span>(),</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">treatment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_factor</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Control"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Treatment"</span>)),</span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_comprehension =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_double</span>())) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classroom_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.f =</span> classroom_id, </span>
<span id="cb6-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.x =</span> reading_comprehension, </span>
<span id="cb6-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fun =</span> mean))</span></code></pre></div>
</div>
<p>There is no inherent order to the <code>classroom_id</code>, so we can re-order it in any convenient fashion. Here I use the <code>mutate</code> function to update the <code>classroom_id</code> variable. I re-order it with the <code>fct_reorder</code> function, which re-orders according to each classroom’s mean on the <code>reading_comprhension</code> variable. That is, we want the low-scoring classrooms first and the high-scoring classrooms last.</p>
<p>To view the first few rows of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  student_id classroom_id treatment reading_comprehension
  &lt;fct&gt;      &lt;fct&gt;        &lt;fct&gt;                     &lt;dbl&gt;
1 1          1            Treatment                 89.6 
2 1          2            Treatment                105.  
3 1          3            Control                    7.42
4 1          4            Treatment                 60.7 
5 1          5            Control                   35.4 
6 1          6            Control                   35.6 </code></pre>
</div>
</div>
</section>
<section id="model-0-random-intercepts" class="level1">
<h1>Model 0: Random Intercepts</h1>
<p>We are going to run a model in which there are no predictors at all, other than that each classroom has its own mean:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7B%5Ctext%7BLevel%201:%7D%7D%5C%5C%0AReading_%7Bij%7D&amp;=%5Cbeta_%7B0j%7D+e_%7Bij%7D%5C%5C%5B1.5ex%5D%0A%5Cmathbf%7B%5Ctext%7BLevel%202:%7D%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+u_%7B0j%7D%5C%5C%5B1.5ex%5D%0A%5Cmathbf%7B%5Ctext%7BCombined:%7D%7D%5C%5C%0AReading_%7Bij%7D&amp;=%5Cunderbrace%7B%5Cgamma_%7B00%7D+u_%7B0j%7D%7D_%7B%5Cbeta_%7B0j%7D%7D+e_%7Bij%7D%5C%5C%0Au_%7B0j%7D%20&amp;%5Csim%20N(0,%5Ctau_%7B00%7D)%5C%5C%0Ae_%7Bij%7D%20&amp;%5Csim%20N(0,%5Csigma_e%5E2)%0A%5Cend%7Balign*%7D"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B0j%7D"> is the random intercept for classroom <img src="https://latex.codecogs.com/png.latex?j"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cgamma_%7B00%7D"> is the overall fixed intercept</li>
<li><img src="https://latex.codecogs.com/png.latex?u_%7B0j%7D"> is the level 2 cluster random variable for classroom <img src="https://latex.codecogs.com/png.latex?j"></li>
<li><img src="https://latex.codecogs.com/png.latex?e_%7Bij%7D"> is the random level 1 individual random variable for student <img src="https://latex.codecogs.com/png.latex?i"> in classroom <img src="https://latex.codecogs.com/png.latex?j">. It is the individual’s deviation from the classroom mean.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D"> is the variance of <img src="https://latex.codecogs.com/png.latex?u_%7B0j%7D">. It is each classroom mean’s deviation from the overall mean <img src="https://latex.codecogs.com/png.latex?%5Cgamma_%7B00%7D">.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma_e%5E2"> is the variance of <img src="https://latex.codecogs.com/png.latex?e_%7Bij%7D">.</li>
</ul>
<p>Why run a model with no predictors? We need a baseline model–a null hypothesis against which to run other models.</p>
<section id="lme4-formula-syntax" class="level2">
<h2 class="anchored" data-anchor-id="lme4-formula-syntax">lme4 Formula Syntax</h2>
<p>The <code>lmer</code> function from the lme4 package is our primary tool for estimating multilevel models. The same syntax for OLS regression applies to lmer formulas, with one addition.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomIntercepts/model_formula_0.svg" class="img-fluid figure-img"></p>
<figcaption>lme4 syntax for a random intercepts model</figcaption>
</figure>
</div>
<ul>
<li>The variable on the left is the outcome variable, <code>reading_comprehension</code>.</li>
<li>The <code>~</code> means “predicted by.”</li>
<li>The first <code>1</code> is the overall intercept. In this model it represents the weighted mean of all the classrooms on the outcome variable (<code>reading_comprehension</code>).</li>
<li>The parentheses are for specifying a random variable.</li>
<li>The <code>1</code> inside the parentheses represents the random intercepts for each classroom.</li>
<li>The <code>|</code> means “nested in.”</li>
</ul>
</section>
<section id="model-fit-object" class="level2">
<h2 class="anchored" data-anchor-id="model-fit-object">Model Fit Object</h2>
<p>You can assign the model’s fit object to a variable. I am calling mine <code>m_0</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">m_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> classroom_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<p>Thus far nothing appears to have happened. However, the <code>m_0</code> variable contains all the information we need to evaluate the model.</p>
</section>
<section id="checking-model-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="checking-model-assumptions">Checking Model Assumptions</h2>
<p>The performance package has a nice, overall check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_0)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/checkmodel-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Everything looks good. If we want, we can check things one at a time.</p>
<section id="normality-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="normality-assumptions">Normality Assumptions</h3>
<p>We want the level 1 and level 2 residuals to be normal. Here we check the level 1 residuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">norm_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_normality</span>(m_0)</span>
<span id="cb11-2">norm_check</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.663).</code></pre>
</div>
</div>
<p>The output says that the residuals are approximately normal. If the output says that the residuals are not normal, it might not be a major concern. Small departures from normality can trigger a significant test result. In general, we worry about large departures from normality, not statistically significant small ones. They best way to detect large departures from normality is to plot the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(norm_check)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-qqplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-qqplot-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qqplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Checking the normality assumption with a Q-Q plot
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure&nbsp;1 is called a Q-Q plot (Quantile-Quantile plot), which plots the standard normal distribution against the observed residuals. If the residuals are perfectly normal, the dots will be on a diagonal line. If a few points are outside the confidence interval in gray, there probably is nothing to worry about. However, if the points are not even close to the line or the gray confidence region, then maybe you need a generalized linear mixed model (<code>lme4::glmer</code>) instead of the linear mixed model (<code>lme4:lmer</code>). More on that later in the course.</p>
<p>The Level 1 residuals look approximately normal in Figure&nbsp;1.</p>
<p>We can also check the normality of the level-2 residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">norm_check_level2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_normality</span>(m_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>)</span>
<span id="cb14-2">norm_check_level2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Random effects 'classroom_id: (Intercept)' appear as normally distributed (p = 0.342).</code></pre>
</div>
</div>
<p>Figure&nbsp;2 suggests that the level-2 random effects are approximately normal. If the error bars did not straddle the regression line, then we would start to worry about the plausibility of the normality assumption at level 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(norm_check_level2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-norm2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-norm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-norm2-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-norm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The Q-Q plot of the level-2 random effects
</figcaption>
</figure>
</div>
</div>
</div>
<p>The performance package has an admittedly experimental function that uses machine learning to predict the distribution of your residuals and response variable (i.e., <em>Y</em>, the variable you are predicting):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_distribution</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Distribution of Model Family

Predicted Distribution of Residuals

 Distribution Probability
       cauchy         75%
       normal         19%
  exponential          3%

Predicted Distribution of Response

 Distribution Probability
       normal         44%
       cauchy         41%
    lognormal          6%</code></pre>
</div>
</div>
<p>Figure&nbsp;3 plots these estimates along with showing plots of the two residual distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_distribution</span>(m_0))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-checkdistribution" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" height="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-checkdistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-checkdistribution-1.png" id="fig-checkdistribution" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-checkdistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
</div>
</div>
<p>This function will become useful when we look at generalized linear mixed models and need to select a distribution family for our residuals.</p>
</section>
<section id="check-for-auto-correlation" class="level3">
<h3 class="anchored" data-anchor-id="check-for-auto-correlation">Check for auto-correlation</h3>
<p>If your data were gathered independently, the order of the cases should show no discernible trends. If adjacent cases are more similar to each other than to non-adjacent cases, then you have auto-correlation in your data. That might be a sign that the independence assumption has been violated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_autocorrelation</span>(m_0) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Residuals appear to be independent and not autocorrelated (p = 0.224).</code></pre>
</div>
</div>
<p>Fortunately, there is no evidence of autocorrelation here.</p>
</section>
<section id="check-for-non-constant-error-variance-heteroscedasticity" class="level3">
<h3 class="anchored" data-anchor-id="check-for-non-constant-error-variance-heteroscedasticity">Check for non-constant error variance (heteroscedasticity)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_heteroscedasticity</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).</code></pre>
</div>
</div>
<p>There is some of evidence of non-constant error variance. By itself, the warning that heteroscedasticity has been detected is not a big deal. In a large sample, statistically significant results sometimes can be triggered by trivially small departures from homoscedasticity. A plot can help us decide if this violation is worrisome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_heteroscedasticity</span>(m_0))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-checkhetero" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-checkhetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-checkhetero-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-checkhetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Checking the homoscedasticity assumption
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure&nbsp;4 shows a mostly flat line. If you see major departures from a flat line, we might need to worry about why the residuals have larger variances for some predicted values than for others. This plot suggests that there is little to worry about.</p>
</section>
<section id="check-for-outliers" class="level3">
<h3 class="anchored" data-anchor-id="check-for-outliers">Check for outliers</h3>
<p>When the sample size is small, outliers can distort your findings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_outliers</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: No outliers detected.
- Based on the following method and threshold: cook (0.5).
- For variable: (Whole model)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checking for outliers</span></span>
<span id="cb28-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_outliers</span>(m_0))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-checkoutlier" class="quarto-float quarto-figure quarto-figure-center anchored" width="100%" height="100%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-checkoutlier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-checkoutlier-1.png" id="fig-checkoutlier" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-checkoutlier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
<p>This plot looks squished because none of the points have extreme leverage. Observations with high leverage are not necessarily bad. What we do not want to see is the combination of extreme residuals with extreme leverage.</p>
<p>An extreme residual is, by definition, far from the regression line. An observation with extreme leverage, by definition, is an outlier in terms of the predictor variables (i.e., in multiple regression, it is a multivariate outlier in the <em>predictor space</em>).</p>
<p>In the plot below, the blue line is the estimated regression line before the red outlier is added. The red line hows how the estimated regression line changes in the presence of the red outlier point.</p>
<p><img src="https://wjschne.github.io/tutorials/RandomIntercepts/leverage.gif" class="img-fluid" alt="A point with high leverage and a large residual can cause large changes in the regession coefficients.">{fig-leverageplot}</p>
<p>Outliers in the predictor space are said to have <em>leverage</em> (the ability to influence coefficients). Notice that the red point barely changes the regression line when the predictor is near the mean of the predictor variable (i.e., when it has little leverage). When the red point is at either extreme of the predictor distribution, it has a lot of leverage to change the regression line. If the red point is near the original regression line, there is no harm done. However, if the red point has the combination of high leverage and a large residual (i.e., it is an outlier in terms of the predictors and also in terms of the residuals), the red regression line can become quite misleading.</p>
</section>
</section>
<section id="model-summary" class="level2">
<h2 class="anchored" data-anchor-id="model-summary">Model Summary</h2>
<p>As with OLS (ordinary least squares) models generated with the <code>lm</code> function, we can see the overall results with the <code>summary</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ 1 + (1 | classroom_id)
   Data: d

REML criterion at convergence: 8078

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.613 -0.676  0.037  0.651  2.971 

Random effects:
 Groups       Name        Variance Std.Dev.
 classroom_id (Intercept) 304      17.4    
 Residual                 420      20.5    
Number of obs: 900, groups:  classroom_id, 30

Fixed effects:
            Estimate Std. Error t value
(Intercept)    57.04       3.25    17.5</code></pre>
</div>
</div>
<p>Here we are given the method by which the parameters were estimated: REML (Restricted Maximum Likelihood). We are told the range and interquartile range of the residuals. We are told the variance and SD of the random effects. We are given the estimates, standard errors, and <img src="https://latex.codecogs.com/png.latex?t"> statistics for the fixed variables, though in this case the only fixed effect is the overall intercept.</p>
</section>
<section id="model-statistics" class="level2">
<h2 class="anchored" data-anchor-id="model-statistics">Model Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
----------------------------------------------------------------------------------
8084.290 | 8084.317 | 8098.697 |      0.420 |      0.000 | 0.420 | 20.159 | 20.488</code></pre>
</div>
</div>
<p>Here we see the <code>Sigma</code>, the individual-level variance. The root-mean squared error is also a measure of individual-level variance but does not correct for degrees of freedom. The <code>AIC</code> and <code>BIC</code> statistics are useful for comparing models that are non-nested (i.e., models that differ in ways other than merely adding predictors). The R2 (cond.) is the variance explained by all terms, including random effects. The R2 (marg.) is the variance explained by the fixed effect effects. Because there are no fixed effects, this statistic is 0. ICC is the proportion of variance explained by the random effects, which in this case is equal to the R2 (cond.)</p>
<p>The report package has an automated interpretation function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a constant (intercept-only) linear mixed model (estimated using REML
and nloptwrap optimizer) to predict reading_comprehension (formula:
reading_comprehension ~ 1). The model included classroom_id as random effect
(formula: ~1 | classroom_id). The model's intercept is at 57.04 (95% CI [50.66,
63.43], t(897) = 17.53, p &lt; .001).

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>If you do not want the entire report, it can be broken down into several components:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_info</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using a Wald t-distribution approximation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_model</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>constant (intercept-only) linear mixed model (estimated using REML and nloptwrap optimizer) to predict reading_comprehension (formula: reading_comprehension ~ 1). The model included classroom_id as random effect (formula: ~1 | classroom_id)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_effectsize</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations. 

very small (Std. beta = 1.27e-15, 95% CI [-0.24, 0.24])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_random</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The model included classroom_id as random effect (formula: ~1 | classroom_id)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_intercept</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The model's intercept is at 57.04 (95% CI [50.66, 63.43], t(897) = 17.53, p &lt; .001).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_parameters</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - The intercept is statistically significant and positive (beta = 57.04, 95% CI [50.66, 63.43], t(897) = 17.53, p &lt; .001; Std. beta = 1.27e-15, 95% CI [-0.24, 0.24])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_statistics</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>beta = 57.04, 95% CI [50.66, 63.43], t(897) = 17.53, p &lt; .001; Std. beta = 1.27e-15, 95% CI [-0.24, 0.24]</code></pre>
</div>
</div>
</section>
<section id="intraclass-correlation-coefficient-icc" class="level2">
<h2 class="anchored" data-anchor-id="intraclass-correlation-coefficient-icc">Intraclass Correlation Coefficient (ICC)</h2>
<p>If there is little variability in the level-2 intercepts, then a multilevel model might not be all that important. The intraclass correlation coefficient estimates how much variability in the outcome variable is explained by the level-2 intercepts:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BICC%7D=%5Cfrac%7B%5Ctau_%7B00%7D%7D%7B%5Ctau_%7B00%7D+%5Csigma%5E2%7D%20=%20%5Cfrac%7B%5Ctext%7BLevel%202%20Residual%20Variance%7D%7D%7B%5Ctext%7BLevel%202%20+%20Level%201%20Residual%20Variance%7D%7D"></p>
<p>The performance package extracts the intraclass correlation coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icc</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.420
  Unadjusted ICC: 0.420</code></pre>
</div>
</div>
<p>The <strong>ICC</strong> here means that letting each classroom have its own mean explained 42% of the residual variance. Had the value</p>
<p>The regular ICC (“adjusted”) takes into account all random effects. The unadjusted ICC takes both fixed and random effects into account. Because there are no fixed effects in this model, the adjusted and conditional ICC are the same.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BICC%7D_%7B%5Ctext%7BUnadjusted%7D%7D=%5Cfrac%7B%5Ctau_%7B00%7D%7D%7B%5Ctau_%7B00%7D+%5Csigma_e%5E2+%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%20=%20%5Cfrac%7B%5Ctext%7BLevel%202%20Residual%20Variance%7D%7D%7B%5Ctext%7BTotal%20Variance%7D%7D"></p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 88%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ICC</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adjusted</td>
<td style="text-align: left;">The proportion of random variance explained by the grouping structure.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unadjusted</td>
<td style="text-align: left;">The proportion of all variance (fixed and random) explained by the grouping structure.</td>
</tr>
</tbody>
</table>
<p>The performance package also gives us an alternate set of model statistics along with the ICC.</p>
</section>
<section id="variance-explained-r2" class="level2">
<h2 class="anchored" data-anchor-id="variance-explained-r2">Variance Explained (<em>R<sup>2</sup></em>)</h2>
<p>The variance explained by a model is one of the ways we evaluate its explanatory scope.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.420
     Marginal R2: 0.000</code></pre>
</div>
</div>
<p>The Conditional <em>R</em><sup>2</sup> is the variance explained by both the fixed and random variables. Note that in this model, because <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7B%5Ctext%7Bfixed%7D%7D%5E2=0">, <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BR%7D_%7B%5Ctext%7BConditional%7D%7D%5E2=%5Ctext%7BICC%7D">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BR%7D_%7B%5Ctext%7BConditional%7D%7D%5E2=%5Cfrac%7B%5Ctau_%7B00%7D+%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%7B%5Ctau_%7B00%7D+%5Csigma_e%5E2+%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%20=%20%5Cfrac%7B%5Ctext%7BLevel%202%20Residual%20Variance%20+%20Fixed%20Variance%7D%7D%7B%5Ctext%7BTotal%20Variance%7D%7D"></p>
<p>The Marginal <em>R</em><sup>2</sup> is the variance explained by just the fixed variables. In this case, there are no fixed variables. Thus, Marginal <em>R</em><sup>2</sup> = 0.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BR%7D_%7B%5Ctext%7BMarginal%7D%7D%5E2=%5Cfrac%7B%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%7B%5Ctau_%7B00%7D+%5Csigma_e%5E2+%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%20=%20%5Cfrac%7B%5Ctext%7BFixed%20Variance%7D%7D%7B%5Ctext%7BTotal%20Variance%7D%7D"></p>
</section>
<section id="fixed-and-random-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="fixed-and-random-coefficients">Fixed and Random Coefficients</h2>
<p>Coefficient-level statistics can be viewed with the <code>parameters</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |         95% CI | t(897) |      p
-------------------------------------------------------------------
(Intercept) |       57.04 | 3.25 | [50.66, 63.43] |  17.53 | &lt; .001

# Random Effects

Parameter                    | Coefficient
------------------------------------------
SD (Intercept: classroom_id) |       17.42
SD (Residual)                |       20.49</code></pre>
</div>
</div>
<p>The only fixed coefficient is the overall intercept, which is not usually of theoretical interest.</p>
<p>If you only want fixed effect printed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fixed"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |         95% CI | t(897) |      p
-------------------------------------------------------------------
(Intercept) |       57.04 | 3.25 | [50.66, 63.43] |  17.53 | &lt; .001</code></pre>
</div>
</div>
<p>If you only want random effect printed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Random Effects

Parameter                    | Coefficient | 95% CI
---------------------------------------------------
SD (Intercept: classroom_id) |       17.42 |       
SD (Residual)                |       20.49 |       </code></pre>
</div>
</div>
<p>The random parameters are standard deviations. Squaring the estimate for <code>sd__(Intercept)</code> will give <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D">. Squaring the estimate for <code>sd__Observation</code> will give <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2">.</p>
<p>If you want estimated parameters for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group_level =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Random Effects

Parameter        | Coefficient |   SE |           95% CI
--------------------------------------------------------
(Intercept) [11] |      -28.30 | 3.66 | [-35.46, -21.13]
(Intercept) [26] |      -25.27 | 3.66 | [-32.44, -18.11]
(Intercept) [7]  |      -23.33 | 3.66 | [-30.50, -16.17]
(Intercept) [13] |      -22.16 | 3.66 | [-29.32, -14.99]
(Intercept) [21] |      -21.82 | 3.66 | [-28.99, -14.65]
(Intercept) [3]  |      -21.29 | 3.66 | [-28.46, -14.12]
(Intercept) [15] |      -13.16 | 3.66 | [-20.33,  -5.99]
(Intercept) [23] |      -11.85 | 3.66 | [-19.02,  -4.69]
(Intercept) [29] |       -9.81 | 3.66 | [-16.98,  -2.64]
(Intercept) [30] |       -8.60 | 3.66 | [-15.77,  -1.43]
(Intercept) [5]  |       -7.86 | 3.66 | [-15.02,  -0.69]
(Intercept) [9]  |       -7.08 | 3.66 | [-14.24,   0.09]
(Intercept) [28] |       -6.95 | 3.66 | [-14.12,   0.22]
(Intercept) [6]  |       -5.40 | 3.66 | [-12.57,   1.77]
(Intercept) [27] |       -3.05 | 3.66 | [-10.22,   4.12]
(Intercept) [12] |        1.61 | 3.66 | [ -5.56,   8.78]
(Intercept) [18] |        1.83 | 3.66 | [ -5.34,   9.00]
(Intercept) [17] |        4.50 | 3.66 | [ -2.66,  11.67]
(Intercept) [10] |        7.02 | 3.66 | [ -0.14,  14.19]
(Intercept) [4]  |        7.55 | 3.66 | [  0.38,  14.72]
(Intercept) [24] |        8.07 | 3.66 | [  0.91,  15.24]
(Intercept) [14] |       10.14 | 3.66 | [  2.97,  17.30]
(Intercept) [25] |       17.51 | 3.66 | [ 10.34,  24.68]
(Intercept) [8]  |       17.86 | 3.66 | [ 10.69,  25.03]
(Intercept) [16] |       18.11 | 3.66 | [ 10.94,  25.28]
(Intercept) [20] |       18.43 | 3.66 | [ 11.26,  25.60]
(Intercept) [19] |       21.06 | 3.66 | [ 13.89,  28.22]
(Intercept) [22] |       23.32 | 3.66 | [ 16.15,  30.49]
(Intercept) [1]  |       27.11 | 3.66 | [ 19.94,  34.28]
(Intercept) [2]  |       31.81 | 3.66 | [ 24.64,  38.98]</code></pre>
</div>
</div>
<p>Why would you want the estimated values? Maybe you want to make a plot of the random intercepts like in Figure&nbsp;6.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group_level =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb61-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Level =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(Level)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reorder classroom id</span></span>
<span id="cb61-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Level, Coefficient)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb61-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> CI_low,</span>
<span id="cb61-5">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> CI_high )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb61-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classroom ID"</span>, </span>
<span id="cb61-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Intercepts"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-plotgroupcoef" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotgroupcoef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-plotgroupcoef-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotgroupcoef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Group coefficients
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="basic-plot" class="level2">
<h2 class="anchored" data-anchor-id="basic-plot">Basic Plot</h2>
<p>Suppose we want the predicted value for each classroom. There are a variety of ways to do this. We are going to get case-level predictions from the marginaleffects package’s <code>predictions</code> function. A nice feature of his function is that it will average the predictions over any variable. In this case, the prediction is the same for all 30 groups, so instead of 900 predictions (one for each person), we only need 30 predictions (one for each classroom).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">d_predicted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marginaleffects<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predictions</span>(</span>
<span id="cb62-2">  m_0, </span>
<span id="cb62-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"classroom_id"</span>) </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot distributions and predicted values</span></span>
<span id="cb63-2">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb63-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> classroom_id,</span>
<span id="cb63-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> reading_comprehension)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_predicted,</span>
<span id="cb63-7">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> estimate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_intercept</span>(m_0)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/m0plot-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here a fancier version of the same plot.</p>
<div class="cell preview-image">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggtext displays rich text</span></span>
<span id="cb64-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb64-3"></span>
<span id="cb64-4">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb64-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> classroom_id,</span>
<span id="cb64-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> reading_comprehension)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb64-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Within-group variability</span></span>
<span id="cb64-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display raw data</span></span>
<span id="cb64-10">  ggbeeswarm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_quasirandom</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group means as horizontal segments</span></span>
<span id="cb64-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb64-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_predicted,</span>
<span id="cb64-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb64-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(classroom_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb64-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(classroom_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb64-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> estimate ,</span>
<span id="cb64-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> estimate ),</span>
<span id="cb64-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span>  .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group means as text</span></span>
<span id="cb64-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb64-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> estimate, </span>
<span id="cb64-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(estimate,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb64-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_predicted,</span>
<span id="cb64-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> tinter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dodgerblue'</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb64-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb64-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.8</span>, </span>
<span id="cb64-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>, </span>
<span id="cb64-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display Overall intercept coefficient as text</span></span>
<span id="cb64-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb64-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classroom_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb64-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reading_comprehension =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_intercept</span>(m_0),</span>
<span id="cb64-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span>  glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*&amp;gamma;*&lt;sub&gt;00&lt;/sub&gt; = {round(fixef(m_0), 2)}"</span>)</span>
<span id="cb64-35">    ),</span>
<span id="cb64-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb64-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb64-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb64-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb64-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), </span>
<span id="cb64-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb64-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb64-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display Overall intercept as horizontal line</span></span>
<span id="cb64-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_intercept</span>(m_0)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axis labels</span></span>
<span id="cb64-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classrooms"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Comprehension"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-model0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-model0-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Model 0 Group intercepts
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-1-effect-of-treatment" class="level1">
<h1>Model 1: Effect of Treatment</h1>
<div class="sidenote">
<p>Had students been individually assigned to treatment, in every class there would be treated and untreated students. In this case, <code>treatment</code> would be individually randomized and therefore would have been a Level-1 effect.</p>
</div>
<p>Now we add an effect of treatment to the model. This study has a “cluster-randomized” design, meaning that whole classes were randomly assigned to treatment groups. Thus, with this design, <code>treatment</code> is a Level-2 effect.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbf%7B%5Ctext%7BLevel%201:%7D%7D%5C%5C%0AReading_%7Bij%7D&amp;=%5Cbeta_%7B0j%7D+%20e_%7Bij%7D%5C%5C%5B1.5ex%5D%0A%5Cmathbf%7B%5Ctext%7BLevel%202:%7D%7D%5C%5C%0A%5Cbeta_%7B0j%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7D%20Treatment_%7Bj%7D+u_%7B0j%7D%5C%5C%5B1.5ex%5D%0A%5Cmathbf%7B%5Ctext%7BCombined:%7D%7D%5C%5C%0AReading_%7Bij%7D&amp;=%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DTreatment_%7Bj%7D+u_%7B0j%7D+e_%7Bij%7D%5C%5C%0Au_%7B0j%7D%20&amp;%5Csim%20N(0,%5Ctau_%7B00%7D)%5C%5C%0Ae_%7Bij%7D%20&amp;%5Csim%20N(0,%5Csigma_e%5E2)%0A%5Cend%7Balign*%7D%0A"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?Reading_%7Bij%7D"> is the reading comprehension score for person <img src="https://latex.codecogs.com/png.latex?i"> in classroom <img src="https://latex.codecogs.com/png.latex?j">.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B0j%7D"> is the random intercept for classroom <img src="https://latex.codecogs.com/png.latex?j">.</li>
<li><img src="https://latex.codecogs.com/png.latex?e_%7Bij%7D"> is the random level 1 individual random variable for student <img src="https://latex.codecogs.com/png.latex?i"> in classroom <img src="https://latex.codecogs.com/png.latex?j">. It is each individual’s deviation from the classroom mean.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cgamma_%7B00%7D"> is the fixed intercept. In this model, it represents the predicted value of reading when Treatment = 0 (i.e., the control group).</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cgamma_%7B01%7D"> is the treatment effect—the difference between the overall control group mean and the treatment group mean.</li>
<li><img src="https://latex.codecogs.com/png.latex?Treatment_%7Bj%7D"> is value of treatment (Control = 0, Intervention = 1) for classroom <img src="https://latex.codecogs.com/png.latex?j">.</li>
<li><img src="https://latex.codecogs.com/png.latex?u_%7B0j%7D"> is the level 2 cluster random variable for classroom <img src="https://latex.codecogs.com/png.latex?j">. It is each classroom mean’s deviation from its respective treatment group mean.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D"> is the variance of <img src="https://latex.codecogs.com/png.latex?u_%7B0j%7D">.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma_e%5E2"> is the variance of <img src="https://latex.codecogs.com/png.latex?e_%7Bij%7D">.</li>
</ul>
<section id="fit-object" class="level2">
<h2 class="anchored" data-anchor-id="fit-object">Fit object</h2>
<p>Representing the fixed intercept, the initial <code>1</code> is optional. I included it to be explicit, but most of the time it is omitted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">m_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(reading_comprehension <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> classroom_id), </span>
<span id="cb65-2">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<p>Sometimes these models can become large and unwieldy, making you vulnerable to coding errors. A safer way to create a nested model is to use the <code>update</code> function that only changes the part you specify. In this syntax, a <code>.</code> means that everything is the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">m_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(m_0, . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> treatment)</span></code></pre></div>
</div>
<p>The formula above means “Make a new model based on the <code>m_0</code> model. On the left-hand side, the outcome variable is the same. On the right-hand side, everything is the same except that we want to add the <code>treatment</code> variable as a predictor. Also, use the same data.”</p>
<p>It is best practice to use the <code>update</code> function wherever possible, because it reduces errors by making you explicitly state which part of the model will change.</p>
</section>
<section id="assumption-checks" class="level2">
<h2 class="anchored" data-anchor-id="assumption-checks">Assumption Checks</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m_1)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/m1checkmodel-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Still no problems.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: reading_comprehension ~ (1 | classroom_id) + treatment
   Data: d

REML criterion at convergence: 8053

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.580 -0.679  0.042  0.649  3.003 

Random effects:
 Groups       Name        Variance Std.Dev.
 classroom_id (Intercept) 149      12.2    
 Residual                 420      20.5    
Number of obs: 900, groups:  classroom_id, 30

Fixed effects:
                   Estimate Std. Error t value
(Intercept)           45.42       3.20   14.21
treatmentTreatment    24.91       4.68    5.32

Correlation of Fixed Effects:
            (Intr)
trtmntTrtmn -0.683</code></pre>
</div>
</div>
<p>With a <em>t</em> value of 5.32, the effect of <code>treatment</code> is surely significant.</p>
<p>Note that <code>lmer</code> displays the <code>treatment</code> variable as <code>treatmentTreatment</code>. This means that it is how much the Treatment group differs from the reference group, which in this case the control group. R is not smart enough to know in advance that the control group is the reference group. Instead, it assumes that the first factor level listed is the reference group. In this case, the control group is listed first. If you want a different reference group, you need to change the order of the factor levels. The base R way is to use the <code>relevel</code> function, but see the <a href="https://forcats.tidyverse.org/">forcats package</a> for other useful ways to do this.</p>
<p>The report package has an automated interpretation function. Note that unlike the <code>summary</code> function, the <code>report</code> function includes <em>p</em>-values for the fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall report</span></span>
<span id="cb70-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict reading_comprehension with treatment (formula: reading_comprehension
~ treatment). The model included classroom_id as random effect (formula: ~1 |
classroom_id). The model's total explanatory power is substantial (conditional
R2 = 0.42) and the part related to the fixed effects alone (marginal R2) is of
0.21. The model's intercept, corresponding to treatment = Control, is at 45.42
(95% CI [39.14, 51.69], t(896) = 14.21, p &lt; .001). Within this model:

  - The effect of treatment [Treatment] is statistically significant and positive
(beta = 24.91, 95% CI [15.73, 34.09], t(896) = 5.32, p &lt; .001; Std. beta =
0.93, 95% CI [0.59, 1.28])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="plot-model" class="level2">
<h2 class="anchored" data-anchor-id="plot-model">Plot Model</h2>
<p>From Figure&nbsp;8, it is easy to see that the treatment group has higher reading comprehension, on average, than the control group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1">modelbased<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_relation</span>(m_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb72-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb72-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading Comprehension"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-plot2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-plot2-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Model-based estimate of the relationship between treatment and reading comprehension
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fixed-and-random-coefficients-1" class="level2">
<h2 class="anchored" data-anchor-id="fixed-and-random-coefficients-1">Fixed and Random Coefficients</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter             | Coefficient |   SE |         95% CI | t(896) |      p
-----------------------------------------------------------------------------
(Intercept)           |       45.42 | 3.20 | [39.14, 51.69] |  14.21 | &lt; .001
treatment [Treatment] |       24.91 | 4.68 | [15.73, 34.09] |   5.32 | &lt; .001

# Random Effects

Parameter                    | Coefficient
------------------------------------------
SD (Intercept: classroom_id) |       12.22
SD (Residual)                |       20.49</code></pre>
</div>
</div>
<p>Here we see that the <code>treatment</code> variable’s estimate is statistically significant.</p>
<p>If we want to see what the estimated means are for the 2 treatment groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1">modelbased<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_means</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Marginal Means

treatment |  Mean |   SE |         95% CI | t(896)
--------------------------------------------------
Control   | 45.42 | 3.20 | [39.14, 51.69] |  14.21
Treatment | 70.32 | 3.42 | [63.62, 77.03] |  20.58

Variable predicted: reading_comprehension
Predictors modulated: treatment
Predictors averaged: classroom_id</code></pre>
</div>
</div>
</section>
<section id="intraclass-correlation-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="intraclass-correlation-coefficient">Intraclass Correlation Coefficient</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icc</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.262
  Unadjusted ICC: 0.206</code></pre>
</div>
</div>
<p>Compare these values to Model 0’s ICC</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icc</span>(m_0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.420
  Unadjusted ICC: 0.420</code></pre>
</div>
</div>
<p>Here we see that the ICC’s are reduced—because treatment explained some of the between-group variability.</p>
</section>
<section id="variance-explained-r2-1" class="level2">
<h2 class="anchored" data-anchor-id="variance-explained-r2-1">Variance Explained (<em>R<sup>2</sup></em>)</h2>
<p>In OLS regression, the variance explained is fairly straightforward because there is only one random residual. Its size changes with each new predictor added to the model. With multilevel models, variance explained is more complicated because there are multiple residuals to worry about.</p>
<p>Our model consists of fixed effects (intercept and predictors) and random effects at level 1 and level 1:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AReading_%7Bij%7D=%5Cunderbrace%7B%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DTreatment_%7Bj%7D%7D_%7B%5Ctext%7BFixed%7D%7D+%5Cunderbrace%7Bu_%7B0j%7D%7D_%7B%5Ctext%7BRandom%7D_2%7D+%5Cunderbrace%7Be_%7Bij%7D%7D_%7B%5Ctext%7BRandom%7D_1%7D%0A"></p>
<p>We can calculate the variance of the fixed effects, and the 2 random effects.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2&amp;=%5Ctext%7BVar%7D(%5Cgamma_%7B00%7D+%5Cgamma_%7B01%7DTreatment_%7Bj%7D)%5C%5C%0A%5Csigma_%7B1%7D%5E2&amp;=%5Ctext%7BVar%7D(e_%7Bij%7D)=%5Csigma_e%5E2%5C%5C%0A%5Csigma_%7B2%7D%5E2&amp;=%5Ctext%7BVar%7D(u_%7B0j%7D)=%5Ctau_%7B00%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>The <em>marginal</em> <img src="https://latex.codecogs.com/png.latex?R%5E2"> is the ratio of the variance of the fixed effects and the total variance (fixed, level 1, and level 2). That is, what percentage of variance is explained by the fixed effects.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR%5E2_%7B%5Ctext%7BMarginal%7D%7D=%5Cfrac%7B%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2%7D%7B%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2+%5Csigma_%7B2%7D%5E2+%5Csigma_%7B1%7D%5E2%7D%0A"></p>
<p>The <em>conditional</em> <img src="https://latex.codecogs.com/png.latex?R%5E2"> compares the fixed and level 2 variances to the total variance (fixed, level 1, and level 2). In this context, what percentage of variance is explained by the fixed effects and the random intercepts.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR%5E2_%7B%5Ctext%7BConditional%7D%7D=%5Cfrac%7B%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2+%5Csigma_%7B2%7D%5E2%7D%7B%5Csigma_%7B%5Ctext%7BFixed%7D%7D%5E2+%5Csigma_%7B2%7D%5E2+%5Csigma_%7B1%7D%5E2%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1">performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2</span>(m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.420
     Marginal R2: 0.214</code></pre>
</div>
</div>
<p>Here we see that Marginal <em>R<sup>2</sup></em> increased from 0 to 0.21, meaning that a substantial portion of the between-group variability is accounted for by <code>treatment</code>.</p>
<p>The Conditional <em>R<sup>2</sup></em> is the same as it was in model 0, because <code>treatment</code> cannot account for additional variability beyond <code>classroom_id</code> (which “accounts” for 100% of the between-group variability).</p>
</section>
<section id="compare-models" class="level2">
<h2 class="anchored" data-anchor-id="compare-models">Compare Models</h2>
<p>To compare model coefficients, use the <code>parameters::compare_models</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_models</span>(m_0, m_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">effects =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter             |                  m_0 |                  m_1
-------------------------------------------------------------------
(Intercept)           | 57.04 (50.66, 63.43) | 45.42 (39.14, 51.69)
treatment [Treatment] |                      | 24.91 (15.73, 34.09)

# Random Effects

Parameter                    |   m_0 |   m_1
--------------------------------------------
SD (Intercept: classroom_id) | 17.42 | 12.22
SD (Residual)                | 20.49 | 20.49</code></pre>
</div>
</div>
<p>To test the whether one variable explains more variance than a different nested variable, use the <code>anova</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m_0, m_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: d
Models:
m_0: reading_comprehension ~ 1 + (1 | classroom_id)
m_1: reading_comprehension ~ (1 | classroom_id) + treatment
    npar  AIC  BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
m_0    3 8088 8103  -4041     8082                        
m_1    4 8069 8089  -4031     8061    21  1    4.6e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The <em>p</em>-value is in <code>Pr(&gt;Chisq)</code> column. It means that <code>m_1</code>’s deviance statistic is significantly smaller than that of <code>m_0</code>.</p>
<p>The performance function <code>compare_peformance</code> gives many metrics of change. The Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC) can be used to compare non-nested models. The <code>AIC_wt</code> and <code>BIC_wt</code> columns tell you the conditional probabilities in favor of each model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m_0, m_1) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name |   Model |  AIC (weights) | AICc (weights) |  BIC (weights) | R2 (cond.)
------------------------------------------------------------------------------
m_0  | lmerMod | 8088.5 (&lt;.001) | 8088.5 (&lt;.001) | 8102.9 (&lt;.001) |      0.420
m_1  | lmerMod | 8069.6 (&gt;.999) | 8069.6 (&gt;.999) | 8088.8 (0.999) |      0.420

Name | R2 (marg.) |   ICC |   RMSE |  Sigma
-------------------------------------------
m_0  |      0.000 | 0.420 | 20.159 | 20.488
m_1  |      0.214 | 0.262 | 20.172 | 20.488</code></pre>
</div>
</div>
<p>In this case, it is clear that model <code>m_1</code> is preferred compared to <code>m_0</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_performance</span>(m_0, m_1) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name |   Model |     BF
-----------------------
m_0  | lmerMod |       
m_1  | lmerMod | &gt; 1000
Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
</div>
</div>
<p>We can also compare the models with a Bayes Factor (<code>BF</code>). If <code>BF</code> &gt; 1, there is more evidence for the second model. If <code>BF</code> &lt; 1, there is greater evidence for the first model.</p>
<p>Here are some guidelines for interpreting <code>BF</code> Raftery (1995):</p>
<ul>
<li><em>bf</em> = 1–3: Weak</li>
<li><em>bf</em> = 3–20: Positive</li>
<li><em>bf</em> = 20–150: Strong</li>
<li><em>bf</em> &gt; 150: Very strong</li>
</ul>
<p>Raftery, A. E. (1995). Bayesian model selection in social research. <em>Sociological Methodology 25</em>, 111–64.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_bf</span>(m_0, m_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb91-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factors were computed using the BIC approximation, by which BF10 =
exp((BIC0 - BIC1)/2). Compared to the 1 + (1 | classroom_id) model, we found
extreme evidence (BF = 1.17e+03) in favour of the treatment + (1 |
classroom_id) model (the least supported model).</code></pre>
</div>
</div>
<p>Thus we see that there is strong evidence that <code>m_1</code> is a better model than <code>m_0</code>.</p>
</section>
<section id="reduction-in-random-variable-variance" class="level2">
<h2 class="anchored" data-anchor-id="reduction-in-random-variable-variance">Reduction in random variable variance</h2>
<p>Although the Model 0 <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D"> has the same symbol as the Model 1 <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D">, they are not the same. I therefore will distinguish the Model 0 and Model1 <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00%7D"> with second-level subscripts: <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00_0%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B00_1%7D">, respectively.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CDelta%20R_2%5E2(%5Ctext%7Bapprox%7D)=%5Cfrac%7B%5Ctau_%7B00_0%7D-%5Ctau_%7B00_1%7D%7D%7B%5Ctau_%7B00_0%7D%7D"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1">tau_00_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_random</span>(m_0)</span>
<span id="cb93-2">tau_00_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_random</span>(m_1)</span>
<span id="cb93-3"></span>
<span id="cb93-4">(tau_00_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau_00_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_00_0</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>var.random 
    0.5077 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((tau_00_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau_00_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_00_0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>var.random 
      50.8 </code></pre>
</div>
</div>
<p>This means that <em>τ</em><sub>00/1</sub> = 149.41 is 50.8% smaller than <em>τ</em><sub>00/0</sub> = 303.51.</p>
<p>We can likewise see if there is any reduction in level-1 variance by comparing the residual variance of both models:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CDelta%20R_1%5E2(%5Ctext%7Bapprox%7D)=%5Cfrac%7B%5Csigma_%7B0%7D%5E2-%5Csigma_%7B1%7D%5E2%7D%7B%5Csigma_%7B0%7D%5E2%7D"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1">sigma_e_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_residual</span>(m_0)</span>
<span id="cb97-2">sigma_e_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_variance_residual</span>(m_1)</span>
<span id="cb97-3"></span>
<span id="cb97-4">(sigma_e_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> sigma_e_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma_e_0</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>var.residual 
    2.37e-09 </code></pre>
</div>
</div>
<p>You can see that the reduction is very close to 0. Why? Because treatment was cluster-randomized. As a level-2 variable, it would be hard to see how it could influence individual variability. That is, everyone in the same classroom has the same treatment. The level-1 residuals (<em>e<sub>ij</sub></em>) are created by subtracting from the classroom means. Thus, the <code>treatment</code> variable cannot distinguish between anyone in the same class and cannot explain any individual variability.</p>
<p>Later we will see that treatment might interact with an individual difference variable such that the treatment works for some students better than for others. In such a model, a level-2 predictor could influence individual variability.</p>
</section>
<section id="not-so-basic-plot" class="level2">
<h2 class="anchored" data-anchor-id="not-so-basic-plot">Not-So Basic Plot</h2>
<p>Figure&nbsp;9 makes it quite clear that the treatment is associated with higher overall scores.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1">d_augmented_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(m_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.int =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb99-2"></span>
<span id="cb99-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get unique values of the fitted responses</span></span>
<span id="cb99-4">d_classroom_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_augmented_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb99-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(classroom_id, .fitted, treatment) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb99-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb99-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb99-8"></span>
<span id="cb99-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the mean values (.fixed) for each treatment condition</span></span>
<span id="cb99-10">d_treatment_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_augmented_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb99-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(.fixed, treatment) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb99-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb99-13"></span>
<span id="cb99-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot distributions and predicted values</span></span>
<span id="cb99-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(m_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb99-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">treatment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(treatment)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb99-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> classroom_id,</span>
<span id="cb99-18">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> reading_comprehension)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb99-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb99-20">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> treatment), </span>
<span id="cb99-21">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb99-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_classroom_1,</span>
<span id="cb99-23">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .fitted)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb99-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_treatment_1, </span>
<span id="cb99-25">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> .fixed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb99-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(treatment), </span>
<span id="cb99-27">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb99-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-notbasic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-notbasic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts_files/figure-html/fig-notbasic-1.png" style="width:100.0%;height:100.0%" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-notbasic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Treatment effects for Model 1
</figcaption>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/RandomIntercepts/random_intercepts.html</guid>
  <pubDate>Mon, 27 Jan 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploratory Factor Analysis with R</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/EFA/</link>
  <description><![CDATA[ 





<section id="load-packages" class="level1">
<h1>Load Packages</h1>
<p>The following code will install the tidyverse, GPArotation, and psych packages if they are not installed already.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span>
<span id="cb1-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPArotation"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPArotation"</span>)</span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"psych"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"psych"</span>)</span>
<span id="cb1-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"psych"</span>)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"easystats"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GPArotation)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats)</span></code></pre></div>
</div>
</section>
<section id="data-import" class="level1 page-columns page-full">
<h1>Data Import</h1>
<p>Let’s import a version of a data set from the psych package altered to make it suitable for an assignment like this. It consists of personality test items from the International Personality Item Pool <span class="citation" data-cites="goldbergBroadbandwidthPublicDomain1999">(Goldberg, 1999)</span>. The data were collected as a part of the SAPA project <span class="citation" data-cites="revellePsychProceduresPsychological2015">(Revelle, 2015)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-goldbergBroadbandwidthPublicDomain1999" class="csl-entry">
Goldberg, L. R. (1999). A broad-bandwidth, public domain, personality inventory measuring the lower-level facets of several five-factor models. <em>Personality Psychology in Europe</em>, <em>7</em>(1), 7–28.
</div><div id="ref-revellePsychProceduresPsychological2015" class="csl-entry">
Revelle, W. (2015). <em>Psych: <span>Procedures</span> for psychological, psychometric, and personality research</em>. Northwestern University. <a href="http://CRAN.R-project.org/package=psych">http://CRAN.R-project.org/package=psych</a>
</div></div><div class="cell" data-messsage="false">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">d_bfi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/HW4_BFI.csv"</span>)</span></code></pre></div>
</div>
<p>Here are the personality items:</p>
<div class="cell">
<div id="tbl-bfi" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Big Five Inventory Personality Items
</figcaption>
<div aria-describedby="tbl-bfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<caption>Big Five Inventory Personality Items</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Items</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Am indifferent to the feelings of others.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inquire about others' well-being.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Know how to comfort others.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Love children.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Make people feel at ease.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Am exacting in my work.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Continue until everything is perfect.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Do things according to a plan.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Do things in a half-way manner.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Waste my time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't talk a lot.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Find it difficult to approach others.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Know how to captivate people.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Make friends easily.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Take charge.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Get angry easily.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Get irritated easily.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Have frequent mood swings.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Often feel blue.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Panic easily.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Am full of ideas.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carry the conversation to a higher level.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spend time reflecting on things.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Will not probe deeply into a subject.</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
</section>
<section id="how-many-factors-to-extract" class="level1">
<h1>How many factors to extract?</h1>
<p>In one line of code, we can get information we need to apply the Kaiser-Guttman rule, the scree plot rule, and parallel analysis. For the personality data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa.parallel</span>(d_bfi)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/EFA/index_files/figure-html/showparallel-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  6  and the number of components =  5 </code></pre>
</div>
</div>
<ul>
<li>There are 6 eigenvalues above 1 (from the PC series with the Xs), so the Kaiser-Guttman rule says that we should select 6 factors.</li>
<li>There are 6 eigenvalues above the scree in the PC series. So the scree plot rule says to extract 6 factors.</li>
<li>The principal components version of parallel analysis says to extract 5 factors. This method works best if the factors have weak correlations. Thus, if the factors are weakly correlated (&lt; 0.3 or so), we should extract 5 factors.</li>
<li>The factor analysis version of parallel analysis says to extract 6 factors (the FA series with the triangles). If the factors are strongly correlated (&gt; 0.3 or so), we should extract 6 factors.</li>
</ul>
<p>Here is the same plot, but rendered to be more easily interpreted:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/EFA/index_files/figure-html/polishedparallel-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conducting-exploratory-factor-analysis" class="level1">
<h1>Conducting Exploratory Factor Analysis</h1>
<p>There are many variants of factor analysis and each has its advantages and disadvantages. Remember, EFA is called “exploratory” for a reason. With EFA, there are no firm answers that we can stand behind forever and always and in every situation.</p>
<p>Let’s extract 5 factors and then 6 factors. We are going to use the most traditional method of EFA by setting the factor method <code>fm</code> to “pa” (principal-axis factor analysis). By default, the most common method of rotation is used: oblimin rotation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>() </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Rotated loadings from Factor Analysis (oblimin-rotation)

Variable                                  |       PA2 |   PA1 |       PA3
-------------------------------------------------------------------------
Am indifferent to the feelings of others. |      0.19 | -0.16 |      0.07
Inquire about others' well-being.         | -7.83e-03 |  0.01 |      0.07
Know how to comfort others.               |     -0.01 | -0.10 |      0.02
Love children.                            |     -0.03 | -0.07 |      0.19
Make people feel at ease.                 |     -0.11 | -0.21 | -1.65e-03
Am exacting in my work.                   |      0.05 |  0.04 |      0.55
Continue until everything is perfect.     |      0.13 |  0.10 |      0.66
Do things according to a plan.            |      0.04 |  0.06 |      0.56
Do things in a half-way manner.           |      0.16 |  0.01 |     -0.61
Waste my time.                            |      0.17 |  0.16 |     -0.55
Don't talk a lot.                         |     -0.07 |  0.55 |      0.10
Find it difficult to approach others.     |      0.09 |  0.67 |     -0.02
Know how to captivate people.             |      0.06 | -0.38 | -4.09e-03
Make friends easily.                      |      0.03 | -0.57 |      0.02
Take charge.                              |      0.13 | -0.40 |      0.27
Get angry easily.                         |      0.83 | -0.11 |  6.26e-03
Get irritated easily.                     |      0.78 | -0.04 |      0.01
Have frequent mood swings.                |      0.71 |  0.10 |     -0.04
Often feel blue.                          |      0.46 |  0.39 |     -0.14
Panic easily.                             |      0.49 |  0.20 |     -0.01
Am full of ideas.                         |     -0.04 | -0.06 |      0.08
Carry the conversation to a higher level. |     -0.03 | -0.10 |      0.02
Spend time reflecting on things.          |      0.08 |  0.36 |     -0.02
Will not probe deeply into a subject.     |      0.16 | -0.11 |     -0.04

Variable                                  |       PA5 |       PA4 | Complexity | Uniqueness
-------------------------------------------------------------------------------------------
Am indifferent to the feelings of others. |     -0.43 | -9.00e-03 |       1.78 |       0.81
Inquire about others' well-being.         |      0.65 |      0.03 |       1.03 |       0.55
Know how to comfort others.               |      0.67 |      0.03 |       1.05 |       0.47
Love children.                            |      0.45 |     -0.15 |       1.63 |       0.72
Make people feel at ease.                 |      0.53 |      0.07 |       1.45 |       0.54
Am exacting in my work.                   |     -0.04 |      0.17 |       1.24 |       0.66
Continue until everything is perfect.     |      0.07 |      0.07 |       1.17 |       0.55
Do things according to a plan.            |      0.09 |     -0.06 |       1.11 |       0.68
Do things in a half-way manner.           |      0.02 | -1.44e-03 |       1.14 |       0.56
Waste my time.                            | -8.28e-03 |      0.12 |       1.46 |       0.57
Don't talk a lot.                         |     -0.10 |     -0.11 |       1.26 |       0.65
Find it difficult to approach others.     |     -0.07 |     -0.07 |       1.08 |       0.45
Know how to captivate people.             |      0.23 |      0.34 |       2.68 |       0.55
Make friends easily.                      |      0.30 |     -0.03 |       1.54 |       0.48
Take charge.                              |      0.04 |      0.25 |       2.85 |       0.59
Get angry easily.                         |     -0.09 |     -0.05 |       1.07 |       0.33
Get irritated easily.                     |     -0.09 |      0.02 |       1.03 |       0.40
Have frequent mood swings.                |      0.08 |      0.02 |       1.08 |       0.45
Often feel blue.                          |      0.08 |      0.08 |       2.28 |       0.51
Panic easily.                             |      0.21 |     -0.13 |       1.87 |       0.66
Am full of ideas.                         |     -0.03 |      0.55 |       1.08 |       0.66
Carry the conversation to a higher level. |      0.04 |      0.64 |       1.06 |       0.53
Spend time reflecting on things.          |      0.13 |      0.40 |       2.29 |       0.73
Will not probe deeply into a subject.     |      0.06 |     -0.47 |       1.39 |       0.77

The 5 latent factors (oblimin rotation) accounted for 42.19% of the total variance of the original data (PA2 = 10.50%, PA1 = 8.76%, PA3 = 8.38%, PA5 = 8.32%, PA4 = 6.22%).</code></pre>
</div>
</div>
<p>The amount of output can be overwhelming. Let’s simplify it by sorting the output by the strongest loadings in each factor and removing all loadings smaller than .2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># WJSmisc::plot_loading()</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Rotated loadings from Factor Analysis (oblimin-rotation)

Variable                                  |  PA2 |   PA1 |   PA3 |   PA5
------------------------------------------------------------------------
Get angry easily.                         | 0.83 |       |       |      
Get irritated easily.                     | 0.78 |       |       |      
Have frequent mood swings.                | 0.71 |       |       |      
Panic easily.                             | 0.49 |       |       |  0.21
Often feel blue.                          | 0.46 |  0.39 |       |      
Find it difficult to approach others.     |      |  0.67 |       |      
Make friends easily.                      |      | -0.57 |       |  0.30
Don't talk a lot.                         |      |  0.55 |       |      
Take charge.                              |      | -0.40 |  0.27 |      
Know how to captivate people.             |      | -0.38 |       |  0.23
Continue until everything is perfect.     |      |       |  0.66 |      
Do things in a half-way manner.           |      |       | -0.61 |      
Do things according to a plan.            |      |       |  0.56 |      
Waste my time.                            |      |       | -0.55 |      
Am exacting in my work.                   |      |       |  0.55 |      
Know how to comfort others.               |      |       |       |  0.67
Inquire about others' well-being.         |      |       |       |  0.65
Make people feel at ease.                 |      | -0.21 |       |  0.53
Love children.                            |      |       |       |  0.45
Am indifferent to the feelings of others. |      |       |       | -0.43
Carry the conversation to a higher level. |      |       |       |      
Am full of ideas.                         |      |       |       |      
Will not probe deeply into a subject.     |      |       |       |      
Spend time reflecting on things.          |      |  0.36 |       |      

Variable                                  |   PA4 | Complexity | Uniqueness
---------------------------------------------------------------------------
Get angry easily.                         |       |       1.07 |       0.33
Get irritated easily.                     |       |       1.03 |       0.40
Have frequent mood swings.                |       |       1.08 |       0.45
Panic easily.                             |       |       1.87 |       0.66
Often feel blue.                          |       |       2.28 |       0.51
Find it difficult to approach others.     |       |       1.08 |       0.45
Make friends easily.                      |       |       1.54 |       0.48
Don't talk a lot.                         |       |       1.26 |       0.65
Take charge.                              |  0.25 |       2.85 |       0.59
Know how to captivate people.             |  0.34 |       2.68 |       0.55
Continue until everything is perfect.     |       |       1.17 |       0.55
Do things in a half-way manner.           |       |       1.14 |       0.56
Do things according to a plan.            |       |       1.11 |       0.68
Waste my time.                            |       |       1.46 |       0.57
Am exacting in my work.                   |       |       1.24 |       0.66
Know how to comfort others.               |       |       1.05 |       0.47
Inquire about others' well-being.         |       |       1.03 |       0.55
Make people feel at ease.                 |       |       1.45 |       0.54
Love children.                            |       |       1.63 |       0.72
Am indifferent to the feelings of others. |       |       1.78 |       0.81
Carry the conversation to a higher level. |  0.64 |       1.06 |       0.53
Am full of ideas.                         |  0.55 |       1.08 |       0.66
Will not probe deeply into a subject.     | -0.47 |       1.39 |       0.77
Spend time reflecting on things.          |  0.40 |       2.29 |       0.73

The 5 latent factors (oblimin rotation) accounted for 42.19% of the total variance of the original data (PA2 = 10.50%, PA1 = 8.76%, PA3 = 8.38%, PA5 = 8.32%, PA4 = 6.22%).</code></pre>
</div>
</div>
<p>Also, we can see the patterns more easily in the data if we color table so that small loadings have faint colors.</p>
<div class="cell preview-image">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(Variable) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-4">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Complexity, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Uniqueness) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Variable) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(value)), </span>
<span id="cb10-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> Variable) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sortfactor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> maxrow, </span>
<span id="cb10-10">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true =</span> name, </span>
<span id="cb10-11">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">false =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(sortfactor, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(maxrow)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(Variable) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-14">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(name, Variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> WJSmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prob_label</span>(value)),</span>
<span id="cb10-18">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb10-19">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">06</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb10-21">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradient2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb10-24">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb10-25">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> WJSmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>prob_label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(), </span>
<span id="cb10-27">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_discrete</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/EFA/index_files/figure-html/displayloadings-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="junk-factors" class="level2">
<h2 class="anchored" data-anchor-id="junk-factors">Junk Factors</h2>
<p>We want to make sure that each factor makes sense theoretically and that there are no “junk” factors. Junk factors group unrelated items that have no underlying theoretical construct that unites them. EFA is “exploratory” and sometimes it groups items together because of chance fluctuations in the correlations. Junk factors typically have low loadings on all items (&lt; 0.4 or so).</p>
<p>If you find a junk factor, you can leave it in and not interpret it or you can extract 1 factor fewer.</p>
<p>In this case, all the factors are interpretable:</p>
<ul>
<li>PA1 = Extraversion</li>
<li>PA2 = Neuroticism</li>
<li>PA3 = Conscientiousness</li>
<li>PA4 = Openness</li>
<li>PA5 = Agreeableness</li>
</ul>
</section>
<section id="singleton-factors" class="level2">
<h2 class="anchored" data-anchor-id="singleton-factors">Singleton Factors</h2>
<p>We also worry about “singleton” factors. These have a high loading (&gt;0.5 or so) on a single item and all other loadings are small (&lt;0.3 or so). EFA is for finding factors that explain variability across items. Singleton factors do not do this. When your solution has a singleton factor, it is generally best to extract 1 factor fewer. However, doing so does not always get rid of the singleton factor. It might collapse two legitimate factors into one factor. In this case, you probably want to return to the previous solution with the singleton (or exclude the problematic item from the analysis).</p>
</section>
<section id="factor-correlations" class="level2">
<h2 class="anchored" data-anchor-id="factor-correlations">Factor correlations</h2>
<p>The correlation matrrix of the latent factors in a an EFA is sometimes referred to as the Φ (Phi) matrix. To extract the factor correlations from the <code>fa</code> function’s output, we can do like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Phi</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         PA2     PA1     PA3     PA5      PA4
PA2  1.00000  0.2282 -0.1897 -0.0733  0.03735
PA1  0.22822  1.0000 -0.2204 -0.3185 -0.18808
PA3 -0.18967 -0.2204  1.0000  0.2160  0.18971
PA5 -0.07330 -0.3185  0.2160  1.0000  0.26729
PA4  0.03735 -0.1881  0.1897  0.2673  1.00000</code></pre>
</div>
</div>
<p>Plotted, the Φ matrix look like this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">factor_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Extraversion"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Neuroticism"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Conscientiousness"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Openness"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Agreeableness"</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-4">  corrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_cordf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diagonal =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-5">  corrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stretch</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> factor_labels),</span>
<span id="cb13-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> factor_labels)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x,y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> r)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> WJSmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prob_label</span>(r)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size.unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradient2</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> \(x) WJSmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prob_label</span>(x, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb13-14">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"null"</span>), </span>
<span id="cb13-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_discrete</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/EFA/index_files/figure-html/showphi-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The correlations among these factors are generally low (&lt; 0.3 or so). Thus, the principal components method of parallel analysis is likely more accurate than the factor analysis version of parallel analysis. Thus, we should probably stick with 5 factors.</p>
<p>However, we should probably extract 6 factors and see what we get. After all, this is exploratory work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa</span>(d_bfi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nfactors =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fm =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fa.sort</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cut =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = d_bfi, nfactors = 6, fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
                                            PA2   PA1   PA3   PA5   PA4   PA6
Get angry easily.                          0.84                              
Get irritated easily.                      0.83                              
Have frequent mood swings.                 0.67                              
Panic easily.                              0.45  0.24                        
Often feel blue.                           0.43  0.42                        
Find it difficult to approach others.            0.69                        
Don't talk a lot.                                0.59                        
Make friends easily.                            -0.52        0.21        0.30
Take charge.                                    -0.40  0.27        0.25      
Continue until everything is perfect.                  0.67                  
Do things in a half-way manner.                       -0.65              0.28
Do things according to a plan.                         0.55                  
Waste my time.                                        -0.55                  
Am exacting in my work.                                0.54                  
Inquire about others' well-being.                            0.68            
Know how to comfort others.                                  0.62            
Am indifferent to the feelings of others.                   -0.56        0.29
Make people feel at ease.                                    0.45        0.23
Love children.                                               0.40            
Carry the conversation to a higher level.                          0.65      
Am full of ideas.                                                  0.57      
Will not probe deeply into a subject.                             -0.45  0.38
Know how to captivate people.                   -0.33              0.39  0.22
Spend time reflecting on things.                 0.35              0.39      
                                            h2   u2 com
Get angry easily.                         0.68 0.32 1.0
Get irritated easily.                     0.66 0.34 1.0
Have frequent mood swings.                0.55 0.45 1.2
Panic easily.                             0.34 0.66 2.3
Often feel blue.                          0.49 0.51 2.4
Find it difficult to approach others.     0.56 0.44 1.1
Don't talk a lot.                         0.39 0.61 1.3
Make friends easily.                      0.55 0.45 2.0
Take charge.                              0.40 0.60 2.9
Continue until everything is perfect.     0.49 0.51 1.3
Do things in a half-way manner.           0.55 0.45 1.5
Do things according to a plan.            0.31 0.69 1.1
Waste my time.                            0.43 0.57 1.5
Am exacting in my work.                   0.34 0.66 1.3
Inquire about others' well-being.         0.50 0.50 1.1
Know how to comfort others.               0.51 0.49 1.2
Am indifferent to the feelings of others. 0.34 0.66 1.7
Make people feel at ease.                 0.48 0.52 2.3
Love children.                            0.28 0.72 2.2
Carry the conversation to a higher level. 0.47 0.53 1.0
Am full of ideas.                         0.35 0.65 1.1
Will not probe deeply into a subject.     0.34 0.66 2.0
Know how to captivate people.             0.48 0.52 2.9
Spend time reflecting on things.          0.27 0.73 2.4

                       PA2  PA1  PA3  PA5  PA4  PA6
SS loadings           2.46 2.14 2.04 1.88 1.57 0.69
Proportion Var        0.10 0.09 0.08 0.08 0.07 0.03
Cumulative Var        0.10 0.19 0.28 0.35 0.42 0.45
Proportion Explained  0.23 0.20 0.19 0.17 0.15 0.06
Cumulative Proportion 0.23 0.43 0.62 0.79 0.94 1.00

 With factor correlations of 
      PA2   PA1   PA3   PA5   PA4   PA6
PA2  1.00  0.25 -0.19 -0.11  0.03  0.12
PA1  0.25  1.00 -0.21 -0.29 -0.20 -0.10
PA3 -0.19 -0.21  1.00  0.19  0.19  0.01
PA5 -0.11 -0.29  0.19  1.00  0.26  0.15
PA4  0.03 -0.20  0.19  0.26  1.00  0.08
PA6  0.12 -0.10  0.01  0.15  0.08  1.00

Mean item complexity =  1.7
Test of the hypothesis that 6 factors are sufficient.

df null model =  276  with the objective function =  6.99 with Chi Square =  19512
df of  the model are 147  and the objective function was  0.34 

The root mean square of the residuals (RMSR) is  0.02 
The df corrected root mean square of the residuals is  0.03 

The harmonic n.obs is  2760 with the empirical chi square  579.3  with prob &lt;  1.2e-52 
The total n.obs was  2800  with Likelihood Chi Square =  960.3  with prob &lt;  1.7e-119 

Tucker Lewis Index of factoring reliability =  0.921
RMSEA index =  0.044  and the 90 % confidence intervals are  0.042 0.047
BIC =  -206.5
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   PA2  PA1  PA3  PA5  PA4  PA6
Correlation of (regression) scores with factors   0.93 0.89 0.88 0.87 0.85 0.74
Multiple R square of scores with factors          0.86 0.79 0.78 0.76 0.72 0.55
Minimum correlation of possible factor scores     0.72 0.58 0.56 0.53 0.44 0.10</code></pre>
</div>
</div>
<p>The output does not all fit so the loadings for PA6 are below the loadings of the other factors.</p>
<p>Notice that all the PA6 loadings are small. Also notice that they do not really make sense to group together. For example, what construct causes people to be “indifferent to the feelings of others” and at the same time “Make people feel at ease”?</p>
<p>Two hypotheses:</p>
<ul>
<li>Read in the right manner, all of the items are consistent with a person who uses charm and guile to manipulate others.</li>
<li>Four of the six items have words or phrases that require a higher reading level (indifferent, probe, captivate, half-way manner). Perhaps the factor emerged because of differences in literacy.</li>
</ul>
<p>Both these hypotheses might be true. They are not mutually exclusive.</p>
<p>However, given that PA6 has no strong loadings, it is a weak factor and possibly a junk factor. Furthermore, our parallel analyses suggested we retain 5 factors, not 6.</p>
</section>
</section>
<section id="exercise-questions" class="level1">
<h1>Exercise questions</h1>
<p>The second data file is a questionnaire generated to capture the kinds of responses that beginning elementary school teachers give when asked what they do when the class’s attention starts to wander and the teacher needs to redirect the class to get back on task or pay attention to the teacher.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">d_redirect <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/HW4_Redirect.csv"</span>)</span></code></pre></div>
</div>
<p>Here are the questionnaire items for teacher redirection strategies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Items =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(d_redirect)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table 2. Teacher redirection strategies"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-3">  kableExtra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kable_input =</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"striped"</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 2. Teacher redirection strategies</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Items</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I make my lessons extremely organized.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I look at the students sternly.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I point out the children who are disruptive.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I remind the class about the rules on the wall.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I raise my voice.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I express my disappointment in the children.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I change the subject to something more interesting.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I act more enthusiastic.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I engage distracted children with questions.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I insist on silence.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I wait until the children are quiet.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I use a ritual the children know to get the children's attention.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I let the class get out of hand.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I talk about why the activity is more interesting than they think.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I become visibly distressed.</td>
</tr>
<tr class="even">
<td style="text-align: left;">I chat with students about things they are interested instead.</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="instruction">
<p>Run a parallel analysis on the <code>d_redirect</code> data with the <code>fa.parallel</code> function and answer the next 4 questions.</p>
</div>
<div class="question">
<p><strong>Question 1</strong>: How many factors should be retained according to the Kaiser-Guttman rule (i.e., the number of eigenvalues from the PC Actual Data greater than 1)?</p>
</div>
<div class="question">
<p><strong>Question 2</strong>: According to the scree plot rule, how many factors should be retained? (This one is a little subjective, and there are several candidates that people might see as above the scree. Thus, I’ll offer 3 wildly unlikely answers and one choice with all the places I perceive might be places above the scree.)</p>
</div>
<div class="question">
<p><strong>Question 3</strong>: According to the factor analysis version of parallel analysis, how many factors should be retained? (Go by what the text output says. Sometimes the plot can appear a bit off.)</p>
</div>
<div class="question">
<p><strong>Question 4</strong>: According to the principal components analysis version of parallel analysis, how many factors should be retained? (Go by what the text output says. Sometimes the plot can appear a bit off.)</p>
</div>
<div class="instruction">
<p>Run an EFA on the <code>d_redirect</code> data extracting 4 factors using the <code>fm</code>= “pa” method.</p>
</div>
<div class="question">
<p><strong>Question 5</strong>: When you extract 4 factors, are there any singleton factors (i.e,. factors with only one loading with an absolute value higher than 0.5 or so and all other loadings are low (&lt; .3 or so)?</p>
</div>
<div class="question">
<p><strong>Question 6</strong>: When you extract 4 factors, are there any of the factors strongly correlated (&gt;0.3 or so)?</p>
</div>
<div class="instruction">
<p>Run an EFA on the <code>d_redirect</code> data extracting 5 factors using the <code>fm</code>= “pa” method.</p>
</div>
<div class="question">
<p><strong>Question 7</strong>: When you extract 5 factors, are there any singleton factors (i.e,. factors with only one loading with an absolute value higher than 0.5 or so and all other loadings are low (&lt; .3 or so)?</p>
</div>
<div class="question">
<p><strong>Question 8</strong>: When you extract 5 factors, are there any of the factors strongly correlated (&gt;0.3 or so)?</p>
</div>
<div class="question">
<p><strong>Question 9</strong>: According to the guidelines given in this tutorial, should you extract 4 or 5 factors?</p>
</div>
<div class="question">
<p><strong>Question 10</strong>: What do you think each factor might be measuring? Feel free to speculate.</p>
</div>



</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/EFA/</guid>
  <pubDate>Tue, 12 Mar 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Regression in R</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/Regression/regression.html</link>
  <description><![CDATA[ 





<p>Here we are going to use a small data set to predict people’s height using the height of their parents.</p>
<section id="install-packages" class="level1">
<h1>Install packages</h1>
<p>An <strong>R package</strong> is software that extends the capabilities of R. To use a package, you must first install it on your machine. You only need to install it once.</p>
<section id="install-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="install-tidyverse">Install tidyverse</h2>
<p>Some packages are designed to work with several other packages as a system. The <a href="https://www.tidyverse.org/">tidyverse package</a> is a “meta-package” that installs and loads a coherent set of packages designed to help you import, manipulate, visualize, and interpret data. If you do not have a recent version of tidyverse already installed, you can install it with this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span></code></pre></div>
</div>
</section>
<section id="install-easystats" class="level2">
<h2 class="anchored" data-anchor-id="install-easystats">Install easystats</h2>
<p>The <a href="https://easystats.github.io/easystats/">easystats</a> package is another “meta-package” that installs a set of packages designed to work together to make data analysis easier.</p>
<p>If you do not have a recent version of easystats already installed, you can install it with this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"easystats"</span>)</span></code></pre></div>
</div>
</section>
</section>
<section id="load-packages" class="level1">
<h1>Load packages</h1>
<p>A package that is installed on your machine has additional functions that you can use. Each session, you can “load” a package with the <code>library</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads primary packages for data wrangling and plotting</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads packages that make extracting data from model fit objects easier</span></span></code></pre></div>
</div>
</section>
<section id="import-data" class="level1 page-columns page-full">
<h1>Import data</h1>

<div class="no-row-height column-margin column-container"><div class="">
<p>If I use only one data set in an analysis, I call it <code>d</code>. If I need multiple data sets, I use a <code>d_</code> prefix to differentiate them. For example, if I have separate data sets for juniors and seniors, I might call them, <code>d_juniors</code> and <code>d_seniors</code>, respectively. This kind of consistency seems like extra work, but it pays off in making it easy for <em>future-you</em> to read and understand your own code.</p>
</div></div><p>You can import the <code>height.csv</code> data set directly from my github repository for this course. There is no need to save the data anywhere.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5325/raw/master/height.csv"</span>)</span></code></pre></div>
</div>
<p>This code reaches across the web to the file in quotes, “reads” it into our session, and holds the data in a new variable we called <code>d</code>. Every time we need the data, we will get it from the <code>d</code> variable.</p>
<p>The <code>head</code> function, by default, displays the first 6 rows of a <code>data.frame</code> (a collection of variables in which all columns have the same number of rows) or <code>tibble</code> (a <code>data.frame</code> with various enhancements for printing and data creation).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(d)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">idnum</th>
<th style="text-align: right;">avgphgt</th>
<th style="text-align: right;">income</th>
<th style="text-align: right;">calcium</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">height</th>
<th style="text-align: right;">smoke15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">36000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">4.35</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">45000</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">1.76</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">32000</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">55000</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">3.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">56000</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">100000</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><em>Dataset variables</em></p>
<ul>
<li><code>idnum</code> An identifying variable for each student</li>
<li><code>avgphgt</code> Average of parent height</li>
<li><code>income</code> Parental income</li>
<li><code>calcium</code> Calcium intake</li>
<li><code>age</code> Student age</li>
<li><code>gender</code> Student gender</li>
<li><code>weight</code> Student weight (in pounds)</li>
<li><code>height</code> Student height (in inches)</li>
<li><code>smoke15</code> Number of cigarettes smoked per week</li>
</ul>
</section>
<section id="make-a-plot" class="level1">
<h1>Make a plot</h1>
<p>Let’s predict student height (<code>height</code>) from the average of their parents’ height (<code>avgphgt</code>).</p>
<p>Use the <a href="https://ggplot2.tidyverse.org/reference/ggplot.html"><code>ggplot</code></a> function from the <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package to make a scatterplot with points and a regression line in Figure&nbsp;1.</p>
<div class="cell preview-image">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(avgphgt, height)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-regressionplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regressionplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-regressionplot-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regressionplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Regression line with its 95% confidence region
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure&nbsp;2 gives an annotated explanation of what the code does.</p>
<div id="fig-annotated" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/ggplotcode.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-annotated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Annotated ggplot2 code
</figcaption>
</figure>
</div>
<p>Note that this plot is not quite presentation worthy. For example, Figure&nbsp;3 improves upon Figure&nbsp;1 by having proper axis labels, spacing the axis ticks, setting the aspect ratio to 1:1, and setting the font and font size to make .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(avgphgt, height)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Parent Height (inches)"</span>, </span>
<span id="cb7-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Student Height (inches)"</span>, </span>
<span id="cb7-7">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gray</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, </span>
<span id="cb7-10">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-presentationworthy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-presentationworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-presentationworthy-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-presentationworthy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Regression line with its 95% confidence region
</figcaption>
</figure>
</div>
</div>
</div>
<section id="save-the-plot" class="level2">
<h2 class="anchored" data-anchor-id="save-the-plot">Save the plot!</h2>
<p>You can save to your hard drive a high-quality plot with the <a href="https://ggplot2.tidyverse.org/reference/ggsave.html"><code>ggsave</code></a> function. It will save whatever the last plot you created with <a href="https://ggplot2.tidyverse.org/reference/ggplot.html"><code>ggplot</code></a>. It will guess the file format from the file extension.</p>
<p>Here I save a .pdf file of the plot to the working directory:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_plot.pdf"</span>)</span></code></pre></div>
</div>
<p>What is the working directory? Is the folder on your machine that R thinks it should look first if it needs to find files or save files. If you are ever curious about which directory is the working directory, you can see the current working directory with the <code>getwd</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getwd</span>()</span></code></pre></div>
</div>
<p>If you saved the plot above as <code>"my_plot.pdf"</code>, you will find the file in the working directory returned by <code>getwd</code>.</p>
<p>If you need to set the working working directly to something different from what it is, use the <code>setwd</code> function. In the <code>Session</code> menu in RStudio, you can also set the working directory with a point-an-click dialog box.</p>
</section>
<section id="vector-based-images" class="level2">
<h2 class="anchored" data-anchor-id="vector-based-images">Vector-based images</h2>
<p>The .pdf format gives the best image quality but can only be viewed in a .pdf reader. The .svg format is almost as good and can be incorporated into webpages and Office documents. One downside of their near-perfect image quality is that .pdf and .svg image file sizes can become quite large.</p>
</section>
<section id="raster-images" class="level2">
<h2 class="anchored" data-anchor-id="raster-images">Raster images</h2>
<p>The .png format gives good image quality and renders small file sizes. I prefer using the <code>ragg::agg_png</code> device to render a .png because it allows me to use any system font with no extra fuss.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_plot.png"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">device =</span> ragg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>agg_png)</span></code></pre></div>
</div>
<p>The primary use of the .gif format is to create animated plots. Otherwise stick with .png.</p>
<p>Although the .jpg format is good for photos, it is terrible for plots—it often renders text and sharp corners with pixelated smudges.</p>
</section>
</section>
<section id="creating-the-regression-model" class="level1">
<h1>Creating the regression model</h1>
<p>To run regression models, use the <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm"><code>lm</code></a> function. The <code>lm</code> stands for “linear model.” The general pattern is <code>lm(Y~X, data = d)</code>, which means “<code>Y</code> is predicted by <code>X</code>, using the data set <code>d</code>.”</p>
<p>Here we predict height from Average of Parent Height (<code>avgphgt</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">m1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(height<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>avgphgt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<p>Notice that we did not get any results. Instead, we created the model fit object <code>m1</code>, which contains information about the model. There are a variety of functions we can use to extract information from <code>m1</code>.</p>
</section>
<section id="checking-assumptions" class="level1">
<h1>Checking assumptions</h1>
<p>Regression assumes that the observations should independent, and the residuals should be normal and homoscedastic. The <a href="https://easystats.github.io/performance/index.html">performance package</a> has a great function for checking model assumptions: <a href="https://easystats.github.io/performance/reference/check_model.html"><code>check_model</code></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-checkmodel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-checkmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-checkmodel-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-checkmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Regression diagnostic plots
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;4 we see that none of the assumptions have been severely violated. Normally, we would stop here. If needed, we can look at each plot one at a time.</p>
<section id="posterier-predictions" class="level2">
<h2 class="anchored" data-anchor-id="posterier-predictions">Posterier Predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">diagnostic_plots <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))</span>
<span id="cb13-2">diagnostic_plots[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-posterior" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-posterior-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Posterior Predictive Check
</figcaption>
</figure>
</div>
</div>
</div>
<p>The Figure&nbsp;5 generates several sets of random “simulated” data based on the model and plots the distributions as the thin blue lines. Each simulated data set is of the same size as the original data. The thicker green line is based on the observed data. If the blue lines have roughly the same shape as the green line, then the model is likely of the right form.</p>
<p>The green line is not that far off from the blue lines, but the green line appears to have 2 peaks, and most of the blue lines have one peak. Because we know that males and females have different mean heights, there is a good chance that we need to model their heights separately. We will do so later in the tutorial.</p>
<p>The <a href="https://easystats.github.io/performance/articles/check_model.html">tutorial for the <code>check_model</code> function</a> gives an example of a posterior prediction check that signals that something is awry.</p>
</section>
<section id="linearity-assumption" class="level2">
<h2 class="anchored" data-anchor-id="linearity-assumption">Linearity Assumption</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">diagnostic_plots[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Linearity assumption
</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure&nbsp;6, we see that the fitted values (i.e., <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D"> or predicted values) plotted against the residuals is roughly flat and horizontal. If the green line were clearly not flat, we would consider non-linear models.</p>
</section>
<section id="homogeneity-of-variance-assumption" class="level2">
<h2 class="anchored" data-anchor-id="homogeneity-of-variance-assumption">Homogeneity of Variance Assumption</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">diagnostic_plots[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-homogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-homogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-homogeneity-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-homogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Homogeneity of variance assumption
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure&nbsp;7 is similar to Figure&nbsp;6 except that the fitted values are standardized (i.e., converted to z-scores) and then square root of their absolute values are plotted on the <em>Y</em>-axis. The homogeneity of variance assumption requires that variability of the residuals should be roughly the same across the entire distribution of fitted values. Thus, the line in Figure&nbsp;7 should be roughly flat and horizontal, which it is. Indeed, we can draw a horizontal line entirely within the gray confidence region around the green line.</p>
</section>
<section id="influential-observations-and-outlier-detection" class="level2">
<h2 class="anchored" data-anchor-id="influential-observations-and-outlier-detection">Influential Observations and Outlier Detection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">diagnostic_plots[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-influential" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-influential-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-influential-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-influential-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Influential observations
</figcaption>
</figure>
</div>
</div>
</div>
<p>Sometimes a single outlier can radically alter a regression model. The plot in Figure&nbsp;8 shows how influential each point is in creating the regression model. If any point is outside the green dotted lines, we might worry that the point has had undue influence on the model.</p>
<p>Many additional outlier detection methods are available via the <code>check_outliers</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_outliers</span>(m1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: No outliers detected.
- Based on the following methods and thresholds: zscore_robust (3.291), iqr (2), ci (1), cook (0.706), mahalanobis (13.816), mahalanobis_robust (13.816), mcd (13.816), ics (0.001), optics (4), lof (0.001).
- For variable: (Whole model)</code></pre>
</div>
</div>
</section>
<section id="normality-assumption" class="level2">
<h2 class="anchored" data-anchor-id="normality-assumption">Normality Assumption</h2>
<p>The normality assumption does not require that all variables be normal. It requires that the prediction residuals be approximately normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">diagnostic_plots[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-normality" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normality-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-normality-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normality-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Normality assumption
</figcaption>
</figure>
</div>
</div>
</div>
<p>If the residuals were perfectly normal, the blue dots would fall exactly on the green line in Figure&nbsp;9. The blue dots are not that far from the green line. Because ordinary least squares is robust to minor violations of the normality assumption, nothing in Figure&nbsp;9 should make us worry about needing to model the data with some other kind of residuals.</p>
<p>If we suspect that the residuals are generated from a different distribution, the <code>check_distribution</code> function will estimate the probability that the residuals (and response/outcome variable) come from 12 major distribution families:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_distribution</span>(m1) </span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Distribution</th>
<th style="text-align: right;">p_Residuals</th>
<th style="text-align: right;">p_Response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bernoulli</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta-binomial</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.406</td>
</tr>
<tr class="even">
<td style="text-align: left;">binomial</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.406</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cauchy</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="even">
<td style="text-align: left;">chi</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exponential</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gamma</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">half-cauchy</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inverse-gamma</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">lognormal</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">neg. binomial (zero-infl.)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative binomial</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">normal</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="even">
<td style="text-align: left;">pareto</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">poisson</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">poisson (zero-infl.)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tweedie</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">uniform</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weibull</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.031</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_distribution</span>(m1))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/m1checkdistribution-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here we see that of the 12 major distribution families tested, the residuals are more likely normal than any of the others. After we control for gender, this probability will increase. If the results had strongly suggested the residuals were generated from one of the other distributions, we might consider switching from a linear model to a <a href="https://en.wikipedia.org/wiki/Generalized_linear_model">generalized linear model</a>.</p>
</section>
</section>
<section id="summarising-results" class="level1">
<h1>Summarising results</h1>
<p>Base R gives you most of what you would want to know about the regression results with the <code>summary</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ avgphgt, data = d)

Residuals:
   Min     1Q Median     3Q    Max 
-5.241 -1.649 -0.539  1.224  6.163 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -12.878      9.779   -1.32      0.2    
avgphgt        1.193      0.145    8.23  5.7e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.68 on 38 degrees of freedom
Multiple R-squared:  0.641, Adjusted R-squared:  0.631 
F-statistic: 67.7 on 1 and 38 DF,  p-value: 5.7e-10</code></pre>
</div>
</div>
<p>This output is not pretty, nor was it intended to be. It is designed for you, the analyst. The <code>summary</code> function’s print method is optimized for reading results in the console, not in a document. Presentation-worthy results need a lot more care and attention.</p>
<p>An automated report from the <a href="https://easystats.github.io/report/articles/report.html">report</a> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">report<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict height with avgphgt
(formula: height ~ avgphgt). The model explains a statistically significant and
substantial proportion of variance (R2 = 0.64, F(1, 38) = 67.73, p &lt; .001, adj.
R2 = 0.63). The model's intercept, corresponding to avgphgt = 0, is at -12.88
(95% CI [-32.67, 6.92], t(38) = -1.32, p = 0.196). Within this model:

  - The effect of avgphgt is statistically significant and positive (beta = 1.19,
95% CI [0.90, 1.49], t(38) = 8.23, p &lt; .001; Std. beta = 0.80, 95% CI [0.60,
1.00])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<section id="model-level-statistics" class="level2">
<h2 class="anchored" data-anchor-id="model-level-statistics">Model-level statistics</h2>
<p>Some statistics like the <em>coefficient of determination</em> (<em>R</em><sup>2</sup>) or the <em>standard error of the estimate</em> (<em>σ<sub>e</sub></em>) describe the model as a whole.</p>
<section id="r2" class="level3">
<h3 class="anchored" data-anchor-id="r2"><em>R</em><sup>2</sup></h3>
<p>The <em>R</em><sup>2</sup> statistic measures the percentage of variance in the outcome explained by the predictors.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR%5E2=%5Cfrac%7B%5Csigma_%7B%5Chat%7BY%7D%7D%5E2%7D%7B%5Csigma_%7BY%7D%5E2%7D=1-%5Cfrac%7B%5Csigma_e%5E2%7D%7B%5Csigma_Y%5E2%7D%0A"></p>
<p>The model-level statistics can be extracted with the performance package’s <a href="https://easystats.github.io/performance/reference/model_performance.lm.html"><code>model_performance</code></a> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">R2_adjusted</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">196</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">201</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.631</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">2.68</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><em>R</em><sup>2</sup> is the percentage of variance in the outcome variable (i.e., Height) explained by the predictor variables (i.e., Average Parent Height). In Figure&nbsp;10, the black line toggles between the best fitting regression line and the horizontal line running through the outcome variable’s mean. The vertical line segments running from each point to the black line are, on average, smaller for the best fitting regression line. Their squared distances shrink, on average, by 64%. Thus, we say that the predictor variance “explains” 64% of the variance in the outcome variable.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(avgphgt, height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-2">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(avgphgt, height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colMeans</span>()</span>
<span id="cb27-3">s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(avgphgt, height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(sd)</span>
<span id="cb27-4">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb27-5">d_slope <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.00"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(r<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb27-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, r, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb27-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb27-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb27-10">anim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(idnum, avgphgt, height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(d_slope) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yhat =</span> b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> avgphgt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i, </span>
<span id="cb27-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Error =</span> height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> yhat) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(idnum, Error) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(avgphgt, height)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> i)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> avgphgt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yhat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Error)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_states</span>(id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state_length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transition_length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradient2</span>(</span>
<span id="cb27-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"royalblue4"</span>,</span>
<span id="cb27-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>,</span>
<span id="cb27-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick4"</span>,</span>
<span id="cb27-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb27-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> signs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>signs</span>
<span id="cb27-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Parent Height (inches)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Student Height (inches)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Explained = {closest_state}"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb27-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>,</span>
<span id="cb27-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb27-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>)</span>
<span id="cb27-36">  )</span>
<span id="cb27-37">gganimate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">animate</span>(</span>
<span id="cb27-38">  anim,</span>
<span id="cb27-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nframes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb27-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">device =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ragg_png"</span>,</span>
<span id="cb27-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb27-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb27-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb27-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">res =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">144</span></span>
<span id="cb27-45">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-r2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-r2-1.gif" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Percentage of Variance Explained
</figcaption>
</figure>
</div>
</div>
</div>
<p>If all you wanted was the <em>R</em><sup>2</sup>, you could do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m1)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>R2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.641</code></pre>
</div>
</div>
<p>Why would you want just one number instead of reading it from a table? In reproducible research, we intermingle text and code so that it is clear where every number came from. Thus, “hard-coding” your results like this is considered poor practice:</p>
<pre><code>The model explains 64% of the variance.</code></pre>
<p>Using rmarkdown, instead of typing the numeric results, we type pull the results using an <a href="https://rmarkdown.rstudio.com/lesson-4.html">inline code chunk</a>:</p>
<pre><code>The model explains `{r} round(100 * r2(m1)$R2, 0)`% of the variance.</code></pre>
<p>Which, when rendered, produces the correct output:</p>
<blockquote class="blockquote">
<p>The model explains 64% of the variance.</p>
</blockquote>
<p>That seems like a lot of extra work, right? Yes, it is—unless there is a possibility that your underlying data might change or that you might copy your numbers incorrectly. If you are imperfect, the extra time and effort is worth it. It makes it easy for other scholars to see exactly where each number came from. Hard-coded results are harder to trust.</p>
<p>Regression errors are the vertical distances of the outcome variable and regression line. That is, errors are the difference between the outcome and the predicted outcome:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ae=Y-%5Chat%7BY%7D%0A"></p>
</section>
<section id="standard-error-of-the-estimate-σe" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-of-the-estimate-σe">Standard Error of the Estimate (<em>σ<sub>e</sub></em>)</h3>
<p>The <em>standard error of the estimate</em> (i.e., Sigma in the <code>performance</code> output table) is the standard deviation of the regression errors <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Be%7D">. It represents the typical size of the prediction error. That is, when we make a prediction, how far off is that prediction likely to be?</p>
<p>The standard error of the estimate can be extracted from a regression fit object with the <code>sigma</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sigma</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.68</code></pre>
</div>
</div>
<p>Alternately, it can be extracted from the <code>performance</code> function’s output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m1)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sigma</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.68</code></pre>
</div>
</div>
</section>
</section>
<section id="coefficient-level-statistics" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-level-statistics">Coefficient-level statistics</h2>
<p>The regression coefficients—the intercept (<em>b</em><sub>0</sub>) and the slope (<em>b</em><sub>1</sub>)—have a number of statistics associated with them, which we will discuss later in the course.</p>
<p>If you just wanted the intercept and the slope coefficients, use the <code>coef</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(m1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     avgphgt 
     -12.88        1.19 </code></pre>
</div>
</div>
<p>Thus, the intercept is -12.88 and the slope is 1.19.</p>
<p>To get the model parameters (intercept and slope coefficients) along with their standard errors, confidence intervals, <em>t</em> statistics, and <em>p</em>-values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m1) </span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-12.88</td>
<td style="text-align: right;">9.779</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-32.675</td>
<td style="text-align: right;">6.92</td>
<td style="text-align: right;">-1.32</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.196</td>
</tr>
<tr class="even">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.899</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">8.23</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Standardized parameters are the regression coefficients if all variables in the analysis were standardized (i.e., convernted to <em>z</em>-scores). Standardized coefficients have a straightforward interpretation: They represent the predicted change in the outcome associated with a change of 1 standard deviation in the predictor variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">standardize_parameters</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Std_Coefficient</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.194</td>
<td style="text-align: right;">0.194</td>
</tr>
<tr class="even">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.603</td>
<td style="text-align: right;">0.997</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-regression" class="level1">
<h1>Multiple regression</h1>
<p>In this data set, all participants self-identified as either male or female on the traditional gender binary. We would predict that males are, on average, taller than females.</p>
<p>By default, the first category in a factor or character (text) variable is the “reference level” that all other categories are compared to. In R, a factor can list categories in any order. In character variables, the categories are listed in alphabetical order. The <code>gender</code> variable consists of text, so the <code>lm</code> function puts the “female” category first and the “male” category second. Thus, the regression coefficient for <code>gender</code> will refer to how much “Males” differ from “Females,” on average. If want to do it the other way around, you can reverse the order of the levels and labels in the <code>factor</code> function. See also the <a href="https://forcats.tidyverse.org/reference/fct_rev.html"><code>fct_rev</code></a> or <a href="https://forcats.tidyverse.org/reference/fct_relevel.html"><code>fct_relevel</code></a> function for other ways to do this.</p>
<p>We run the regression model with 2 predictors like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">m2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> avgphgt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<section id="checking-assumptions-1" class="level2">
<h2 class="anchored" data-anchor-id="checking-assumptions-1">Checking assumptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m2)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-checkmodelm2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-checkmodelm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/fig-checkmodelm2-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-checkmodelm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Assumption check for model 2
</figcaption>
</figure>
</div>
</div>
</div>
<p>The diagnostic plots in Figure&nbsp;11 looks good. It has one additional plot checking the collinearity of the predictors. If any predictor is strongly predictable from the other predictors, it is difficult for ordinary least squares regression to locate the regression coefficients with precision. Why? Because the regression coefficients represent the independent effect of each variable controlling for all the other variables. If a predictor has little variability left after controlling for the other variables, estimating its independent effect is difficult, which is manifest in “inflated” standardized errors around the coefficient. The VIF (variance inflation factor) statistic estimates how much the standard errors are made large due to collinearity. If the VIF is larger than 10 or so, it is likely that the estimate of the coefficient is not precise.</p>
</section>
<section id="summarizing-results" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-results">Summarizing results</h2>
<p>To summarize the results, use the <code>summary</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ avgphgt + gender, data = d)

Residuals:
   Min     1Q Median     3Q    Max 
-3.826 -1.094 -0.347  1.656  4.503 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   20.099     10.304    1.95  0.05870 .  
avgphgt        0.671      0.157    4.26  0.00013 ***
gendermale     4.468      0.920    4.85  2.2e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.12 on 37 degrees of freedom
Multiple R-squared:  0.78,  Adjusted R-squared:  0.769 
F-statistic: 65.7 on 2 and 37 DF,  p-value: 6.6e-13</code></pre>
</div>
</div>
<p>Model-level statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">R2_adjusted</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">179</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">2.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Coefficient-level statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">20.099</td>
<td style="text-align: right;">10.304</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.778</td>
<td style="text-align: right;">40.976</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">0.059</td>
</tr>
<tr class="even">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.352</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">4.26</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gendermale</td>
<td style="text-align: right;">4.468</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.603</td>
<td style="text-align: right;">6.333</td>
<td style="text-align: right;">4.85</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Standardized coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">standardize_parameters</span>(m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Std_Coefficient</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.506</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.768</td>
<td style="text-align: right;">-0.245</td>
</tr>
<tr class="even">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;">0.450</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.664</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gendermale</td>
<td style="text-align: right;">1.012</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.590</td>
<td style="text-align: right;">1.435</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>An automated report:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict height with avgphgt
and gender (formula: height ~ avgphgt + gender). The model explains a
statistically significant and substantial proportion of variance (R2 = 0.78,
F(2, 37) = 65.75, p &lt; .001, adj. R2 = 0.77). The model's intercept,
corresponding to avgphgt = 0 and gender = female, is at 20.10 (95% CI [-0.78,
40.98], t(37) = 1.95, p = 0.059). Within this model:

  - The effect of avgphgt is statistically significant and positive (beta = 0.67,
95% CI [0.35, 0.99], t(37) = 4.26, p &lt; .001; Std. beta = 0.45, 95% CI [0.24,
0.66])
  - The effect of gender [male] is statistically significant and positive (beta =
4.47, 95% CI [2.60, 6.33], t(37) = 4.85, p &lt; .001; Std. beta = 1.01, 95% CI
[0.59, 1.43])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing models</h2>
<p>In the first model, there was only one predictor. The second model had an additional predictor. To test whether the second predictor has <em>incremental validity</em> (predicts variance in the outcome beyond what is predicted by other predictors), we can compare the two models using the Wald test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_wald</span>(m1, m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">df_diff</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">m1</td>
<td style="text-align: left;">lm</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">m2</td>
<td style="text-align: left;">lm</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The Wald test can also be conducted in base R with the <code>anova</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(m1, m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Res.Df</th>
<th style="text-align: right;">RSS</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum of Sq</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">38</td>
<td style="text-align: right;">273</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">37</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">23.6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Either way, the p-value is significant, meaning that <code>m2</code> explains more variance than <code>m1</code>.</p>
<p>The semi-partial correlation coefficient squared tells us how much incremental variance each predictor has over the other:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r2_semipartial</span>(m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">r2_semipartial</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Thus, <code>gender</code> explains 14% variance beyond <code>avgphgt</code>. Likewise, <code>avgphgt</code> explains 11% variance beyond <code>gender</code>.</p>
<section id="bayes-factors" class="level3">
<h3 class="anchored" data-anchor-id="bayes-factors">Bayes Factors</h3>
<p>An alternate method of comparing two models uses the Bayes factor. It tells us under which model the observed data are more probable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_bf</span>(m1, m2)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">log_BF</th>
<th style="text-align: right;">BF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">avgphgt</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">avgphgt + gender</td>
<td style="text-align: right;">8.01</td>
<td style="text-align: right;">3010</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A BF &gt; 1 means that <code>m2</code> is more strongly supported than <code>m1</code>. A BF &lt; 1 means that <code>m1</code> is more strongly supported than <code>m2</code>. If you are not sure how to interpret the output of <code>test_bf</code>, you can get an automated interpretation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_bf</span>(m1, m2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb53-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factors were computed using the BIC approximation, by which BF10 =
exp((BIC0 - BIC1)/2). Compared to the avgphgt model, we found extreme evidence
(BF = 3.01e+03) in favour of the avgphgt + gender model (the least supported
model).</code></pre>
</div>
</div>
<p>To compare many performance statistics at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m1, m2) </span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AIC_wt</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">AICc_wt</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">BIC_wt</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">R2_adjusted</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">m1</td>
<td style="text-align: left;">lm</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">201</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.631</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">2.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">m2</td>
<td style="text-align: left;">lm</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.780</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">2.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="pretty-regression-tables" class="level1">
<h1>Pretty Regression Tables</h1>
<p>There are several packages that automate the production of pretty regression tables. There is a trade-off here between ease of use and getting exactly what you want. If you are okay with a function’s defaults and the programmer’s choices, then there is no problem. If you want full control of the display, you are best off creating your own functions or adapting existing functions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">sjPlot</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">gtsummary</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">rempsych</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" aria-controls="tabset-1-4" aria-selected="false">flextable</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<p>The <a href="https://strengejacke.github.io/sjPlot/articles/tab_model_estimates.html"><code>tab_model</code> function in sjPlot</a> looks great as is, but if it gives you too much or not enough, check out <a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">its options</a> to see if it can do what you want.</p>
<p>Show a single model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-12.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-32.67&nbsp;–&nbsp;6.92</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.196</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avgphgt</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.90&nbsp;–&nbsp;1.49</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">40</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.641 / 0.631</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Compare nested models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1">sjPlot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(m1, m2)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">height</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-12.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-32.67&nbsp;–&nbsp;6.92</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.196</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">20.10</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.78&nbsp;–&nbsp;40.98</td>
<td style="text-align: center;">0.059</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avgphgt</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.90&nbsp;–&nbsp;1.49</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.67</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.35&nbsp;–&nbsp;0.99</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">gender [male]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.47</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.60&nbsp;–&nbsp;6.33</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">40</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.641 / 0.631</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.780 / 0.769</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtsummary)</span>
<span id="cb58-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plain table</span></span>
<span id="cb58-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div id="kbijrjsuep" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kbijrjsuep table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kbijrjsuep thead, #kbijrjsuep tbody, #kbijrjsuep tfoot, #kbijrjsuep tr, #kbijrjsuep td, #kbijrjsuep th {
  border-style: none;
}

#kbijrjsuep p {
  margin: 0;
  padding: 0;
}

#kbijrjsuep .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kbijrjsuep .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kbijrjsuep .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kbijrjsuep .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kbijrjsuep .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbijrjsuep .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbijrjsuep .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbijrjsuep .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kbijrjsuep .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kbijrjsuep .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kbijrjsuep .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kbijrjsuep .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kbijrjsuep .gt_spanner_row {
  border-bottom-style: hidden;
}

#kbijrjsuep .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kbijrjsuep .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kbijrjsuep .gt_from_md > :first-child {
  margin-top: 0;
}

#kbijrjsuep .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kbijrjsuep .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kbijrjsuep .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kbijrjsuep .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kbijrjsuep .gt_row_group_first td {
  border-top-width: 2px;
}

#kbijrjsuep .gt_row_group_first th {
  border-top-width: 2px;
}

#kbijrjsuep .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbijrjsuep .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kbijrjsuep .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kbijrjsuep .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbijrjsuep .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbijrjsuep .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kbijrjsuep .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kbijrjsuep .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kbijrjsuep .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbijrjsuep .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbijrjsuep .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbijrjsuep .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbijrjsuep .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbijrjsuep .gt_left {
  text-align: left;
}

#kbijrjsuep .gt_center {
  text-align: center;
}

#kbijrjsuep .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kbijrjsuep .gt_font_normal {
  font-weight: normal;
}

#kbijrjsuep .gt_font_bold {
  font-weight: bold;
}

#kbijrjsuep .gt_font_italic {
  font-style: italic;
}

#kbijrjsuep .gt_super {
  font-size: 65%;
}

#kbijrjsuep .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kbijrjsuep .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kbijrjsuep .gt_indent_1 {
  text-indent: 5px;
}

#kbijrjsuep .gt_indent_2 {
  text-indent: 10px;
}

#kbijrjsuep .gt_indent_3 {
  text-indent: 15px;
}

#kbijrjsuep .gt_indent_4 {
  text-indent: 20px;
}

#kbijrjsuep .gt_indent_5 {
  text-indent: 25px;
}

#kbijrjsuep .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kbijrjsuep div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">avgphgt</td>
<td class="gt_row gt_center" headers="estimate">1.2</td>
<td class="gt_row gt_center" headers="conf.low">0.90, 1.5</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Merging tables</span></span>
<span id="cb59-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_merge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tbls =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(m1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_glance_table</span>(),</span>
<span id="cb59-3">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(m2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_glance_table</span>()),</span>
<span id="cb59-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tab_spanner =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parent Height"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parent Height + Gender"</span>)) </span></code></pre></div>
<div class="cell-output-display">
<div id="asmxbwnfon" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#asmxbwnfon table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#asmxbwnfon thead, #asmxbwnfon tbody, #asmxbwnfon tfoot, #asmxbwnfon tr, #asmxbwnfon td, #asmxbwnfon th {
  border-style: none;
}

#asmxbwnfon p {
  margin: 0;
  padding: 0;
}

#asmxbwnfon .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#asmxbwnfon .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#asmxbwnfon .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#asmxbwnfon .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#asmxbwnfon .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#asmxbwnfon .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#asmxbwnfon .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#asmxbwnfon .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#asmxbwnfon .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#asmxbwnfon .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#asmxbwnfon .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#asmxbwnfon .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#asmxbwnfon .gt_spanner_row {
  border-bottom-style: hidden;
}

#asmxbwnfon .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#asmxbwnfon .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#asmxbwnfon .gt_from_md > :first-child {
  margin-top: 0;
}

#asmxbwnfon .gt_from_md > :last-child {
  margin-bottom: 0;
}

#asmxbwnfon .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#asmxbwnfon .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#asmxbwnfon .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#asmxbwnfon .gt_row_group_first td {
  border-top-width: 2px;
}

#asmxbwnfon .gt_row_group_first th {
  border-top-width: 2px;
}

#asmxbwnfon .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#asmxbwnfon .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#asmxbwnfon .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#asmxbwnfon .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#asmxbwnfon .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#asmxbwnfon .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#asmxbwnfon .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#asmxbwnfon .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#asmxbwnfon .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#asmxbwnfon .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#asmxbwnfon .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#asmxbwnfon .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#asmxbwnfon .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#asmxbwnfon .gt_left {
  text-align: left;
}

#asmxbwnfon .gt_center {
  text-align: center;
}

#asmxbwnfon .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#asmxbwnfon .gt_font_normal {
  font-weight: normal;
}

#asmxbwnfon .gt_font_bold {
  font-weight: bold;
}

#asmxbwnfon .gt_font_italic {
  font-style: italic;
}

#asmxbwnfon .gt_super {
  font-size: 65%;
}

#asmxbwnfon .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#asmxbwnfon .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#asmxbwnfon .gt_indent_1 {
  text-indent: 5px;
}

#asmxbwnfon .gt_indent_2 {
  text-indent: 10px;
}

#asmxbwnfon .gt_indent_3 {
  text-indent: 15px;
}

#asmxbwnfon .gt_indent_4 {
  text-indent: 20px;
}

#asmxbwnfon .gt_indent_5 {
  text-indent: 25px;
}

#asmxbwnfon .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#asmxbwnfon div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="3" id="Parent Height" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Parent Height
</div></th>
<th colspan="3" id="Parent Height + Gender" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Parent Height + Gender
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="estimate_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="estimate_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">avgphgt</td>
<td class="gt_row gt_center" headers="estimate_1">1.2</td>
<td class="gt_row gt_center" headers="conf.low_1">0.90, 1.5</td>
<td class="gt_row gt_center" headers="p.value_1">&lt;0.001</td>
<td class="gt_row gt_center" headers="estimate_2">0.67</td>
<td class="gt_row gt_center" headers="conf.low_2">0.35, 0.99</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">R²</td>
<td class="gt_row gt_center" headers="estimate_1" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">0.641</td>
<td class="gt_row gt_center" headers="conf.low_1" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">0.780</td>
<td class="gt_row gt_center" headers="conf.low_2" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Adjusted R²</td>
<td class="gt_row gt_center" headers="estimate_1">0.631</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">0.769</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Sigma</td>
<td class="gt_row gt_center" headers="estimate_1">2.68</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">2.12</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Statistic</td>
<td class="gt_row gt_center" headers="estimate_1">67.7</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">65.7</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">p-value</td>
<td class="gt_row gt_center" headers="estimate_1">&lt;0.001</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">&lt;0.001</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">df</td>
<td class="gt_row gt_center" headers="estimate_1">1</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">2</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Log-likelihood</td>
<td class="gt_row gt_center" headers="estimate_1">-95.2</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">-85.3</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">AIC</td>
<td class="gt_row gt_center" headers="estimate_1">196</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">179</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">BIC</td>
<td class="gt_row gt_center" headers="estimate_1">201</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">185</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Deviance</td>
<td class="gt_row gt_center" headers="estimate_1">273</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">167</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Residual df</td>
<td class="gt_row gt_center" headers="estimate_1">38</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">37</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">No. Obs.</td>
<td class="gt_row gt_center" headers="estimate_1">40</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">40</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;female</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">—</td>
<td class="gt_row gt_center" headers="conf.low_2">—</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;male</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">4.5</td>
<td class="gt_row gt_center" headers="conf.low_2">2.6, 6.3</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stacking tables</span></span>
<span id="cb60-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_stack</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(m1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(m2)),</span>
<span id="cb60-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group_header =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parent Height"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parent Height + Gender"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div id="djvyygqmrr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#djvyygqmrr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#djvyygqmrr thead, #djvyygqmrr tbody, #djvyygqmrr tfoot, #djvyygqmrr tr, #djvyygqmrr td, #djvyygqmrr th {
  border-style: none;
}

#djvyygqmrr p {
  margin: 0;
  padding: 0;
}

#djvyygqmrr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#djvyygqmrr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#djvyygqmrr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#djvyygqmrr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#djvyygqmrr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djvyygqmrr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djvyygqmrr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djvyygqmrr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#djvyygqmrr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#djvyygqmrr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#djvyygqmrr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#djvyygqmrr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#djvyygqmrr .gt_spanner_row {
  border-bottom-style: hidden;
}

#djvyygqmrr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#djvyygqmrr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#djvyygqmrr .gt_from_md > :first-child {
  margin-top: 0;
}

#djvyygqmrr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#djvyygqmrr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#djvyygqmrr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#djvyygqmrr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#djvyygqmrr .gt_row_group_first td {
  border-top-width: 2px;
}

#djvyygqmrr .gt_row_group_first th {
  border-top-width: 2px;
}

#djvyygqmrr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djvyygqmrr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#djvyygqmrr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#djvyygqmrr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djvyygqmrr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djvyygqmrr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#djvyygqmrr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#djvyygqmrr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#djvyygqmrr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djvyygqmrr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djvyygqmrr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djvyygqmrr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djvyygqmrr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djvyygqmrr .gt_left {
  text-align: left;
}

#djvyygqmrr .gt_center {
  text-align: center;
}

#djvyygqmrr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#djvyygqmrr .gt_font_normal {
  font-weight: normal;
}

#djvyygqmrr .gt_font_bold {
  font-weight: bold;
}

#djvyygqmrr .gt_font_italic {
  font-style: italic;
}

#djvyygqmrr .gt_super {
  font-size: 65%;
}

#djvyygqmrr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#djvyygqmrr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#djvyygqmrr .gt_indent_1 {
  text-indent: 5px;
}

#djvyygqmrr .gt_indent_2 {
  text-indent: 10px;
}

#djvyygqmrr .gt_indent_3 {
  text-indent: 15px;
}

#djvyygqmrr .gt_indent_4 {
  text-indent: 20px;
}

#djvyygqmrr .gt_indent_5 {
  text-indent: 25px;
}

#djvyygqmrr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#djvyygqmrr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="Parent Height" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Parent Height</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Parent Height  label">avgphgt</td>
<td class="gt_row gt_center" headers="Parent Height  estimate">1.2</td>
<td class="gt_row gt_center" headers="Parent Height  conf.low">0.90, 1.5</td>
<td class="gt_row gt_center" headers="Parent Height  p.value">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="Parent Height + Gender" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Parent Height + Gender</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Parent Height + Gender  label">avgphgt</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  estimate">0.67</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  conf.low">0.35, 0.99</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Parent Height + Gender  label">gender</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  estimate"><br>
</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Parent Height + Gender  label">&nbsp;&nbsp;&nbsp;&nbsp;female</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  estimate">—</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  conf.low">—</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Parent Height + Gender  label">&nbsp;&nbsp;&nbsp;&nbsp;male</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  estimate">4.5</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  conf.low">2.6, 6.3</td>
<td class="gt_row gt_center" headers="Parent Height + Gender  p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb61-2">  rempsyc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nice_table</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-b5f1f772{table-layout:auto;}.cl-b5ea5b70{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5ea5b7a{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5ed7440{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-b5ed744a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-b5ed8b42{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed8b43{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed8b4c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed8b4d{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed8b56{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b5f1f772"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">Parameter</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b7a">b</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b7a">SE</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">CI</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b7a">t</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b7a">df</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b7a">p</span></p></th><th class="cl-b5ed8b42"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">95% CI</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5ed8b43"><p class="cl-b5ed744a"><span class="cl-b5ea5b70">(Intercept)</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">20.10</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">10.30</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.95</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">1.95</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">37</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">.059</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">[-0.78, 40.98]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed8b43"><p class="cl-b5ed744a"><span class="cl-b5ea5b70">avgphgt</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.67</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.16</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.95</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">4.26</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">37</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">&lt; .001***</span></p></td><td class="cl-b5ed8b4c"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">[0.35, 0.99]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed8b4d"><p class="cl-b5ed744a"><span class="cl-b5ea5b70">gendermale</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">4.47</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.92</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">0.95</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">4.85</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">37</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">&lt; .001***</span></p></td><td class="cl-b5ed8b56"><p class="cl-b5ed7440"><span class="cl-b5ea5b70">[2.60, 6.33]</span></p></td></tr></tbody></table></div>
</div>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">m2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb62-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report_table</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb62-3">  rempsyc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nice_table</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-b634cec6{table-layout:auto;}.cl-b62e7e7c{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b62e7e86{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b630c1c8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-b630c1d2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-b630d3e8{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b630d3f2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b630d3f3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b630d3f4{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b630d3fc{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b634cec6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">Parameter</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e86">b</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">CI</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e86">t</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e86">df</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e86">p</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e86">b</span><span class="cl-b62e7e7c">*</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">Std_Coefficient_CI_low</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">Std_Coefficient_CI_high</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">Fit</span></p></th><th class="cl-b630d3e8"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">95% CI</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">(Intercept)</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">20.10</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.95</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">1.95</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">37</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">.059</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">-0.51</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">-0.77</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">-0.24</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">[-0.78, 40.98]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">avgphgt</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.67</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.95</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">4.26</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">37</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">&lt; .001***</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.45</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.24</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.66</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">[0.35, 0.99]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">gender [male]</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">4.47</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.95</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">4.85</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">37</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">&lt; .001***</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">1.01</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.59</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">1.43</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">[2.60, 6.33]</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">AIC</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">178.65</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">AICc</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">179.79</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">BIC</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">185.41</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">R2</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.78</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f2"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">R2 (adj.)</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">0.77</span></p></td><td class="cl-b630d3f3"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b630d3f4"><p class="cl-b630c1d2"><span class="cl-b62e7e7c">Sigma</span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c">2.12</span></p></td><td class="cl-b630d3fc"><p class="cl-b630c1c8"><span class="cl-b62e7e7c"></span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" aria-labelledby="tabset-1-4-tab">
<p>A primary advantage of the flextable package is that it is compatible with MS Word’s .docx format as well as .html and .pdf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1">m2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb63-2">  flextable<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_flextable</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-b660a564{}.cl-b65a76ee{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b65a76f8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b65ccaac{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b65ccab6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b65cde02{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde0c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde0d{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde16{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde17{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde18{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde20{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde21{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde22{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde2a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde2b{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde2c{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde34{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde35{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde3e{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde3f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde40{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde48{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde49{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde52{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde53{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde54{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde5c{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde5d{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde5e{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde66{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde70{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde71{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde7a{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde7b{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde7c{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde7d{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde84{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde85{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde8e{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b65cde8f{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b660a564"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b65cde02"><p class="cl-b65ccaac"><span class="cl-b65a76ee"></span></p></th><th class="cl-b65cde0c"><p class="cl-b65ccab6"><span class="cl-b65a76ee">Estimate</span></p></th><th class="cl-b65cde0d"><p class="cl-b65ccab6"><span class="cl-b65a76ee">Standard Error</span></p></th><th class="cl-b65cde16"><p class="cl-b65ccab6"><span class="cl-b65a76ee">t value</span></p></th><th class="cl-b65cde17"><p class="cl-b65ccab6"><span class="cl-b65a76ee">Pr(&gt;|t|)</span></p></th><th class="cl-b65cde18"><p class="cl-b65ccaac"><span class="cl-b65a76ee"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b65cde20"><p class="cl-b65ccaac"><span class="cl-b65a76ee">(Intercept)</span></p></td><td class="cl-b65cde21"><p class="cl-b65ccab6"><span class="cl-b65a76ee">20.099</span></p></td><td class="cl-b65cde22"><p class="cl-b65ccab6"><span class="cl-b65a76ee">10.304</span></p></td><td class="cl-b65cde2a"><p class="cl-b65ccab6"><span class="cl-b65a76ee">1.951</span></p></td><td class="cl-b65cde2b"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.0587</span></p></td><td class="cl-b65cde2c"><p class="cl-b65ccaac"><span class="cl-b65a76ee">  .</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b65cde34"><p class="cl-b65ccaac"><span class="cl-b65a76ee">avgphgt</span></p></td><td class="cl-b65cde35"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.671</span></p></td><td class="cl-b65cde3e"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.157</span></p></td><td class="cl-b65cde3f"><p class="cl-b65ccab6"><span class="cl-b65a76ee">4.260</span></p></td><td class="cl-b65cde40"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.0001</span></p></td><td class="cl-b65cde48"><p class="cl-b65ccaac"><span class="cl-b65a76ee">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b65cde49"><p class="cl-b65ccaac"><span class="cl-b65a76ee">gendermale</span></p></td><td class="cl-b65cde52"><p class="cl-b65ccab6"><span class="cl-b65a76ee">4.468</span></p></td><td class="cl-b65cde53"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.920</span></p></td><td class="cl-b65cde54"><p class="cl-b65ccab6"><span class="cl-b65a76ee">4.854</span></p></td><td class="cl-b65cde5c"><p class="cl-b65ccab6"><span class="cl-b65a76ee">0.0000</span></p></td><td class="cl-b65cde5d"><p class="cl-b65ccaac"><span class="cl-b65a76ee">***</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-b65cde5e"><p class="cl-b65ccab6"><span class="cl-b65a76f8">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-b65cde7c"><p class="cl-b65ccaac"><span class="cl-b65a76ee"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-b65cde7c"><p class="cl-b65ccaac"><span class="cl-b65a76ee">Residual standard error: 2.124 on 37 degrees of freedom</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-b65cde7c"><p class="cl-b65ccaac"><span class="cl-b65a76ee">Multiple R-squared: 0.7804, Adjusted R-squared: 0.7685</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-b65cde7c"><p class="cl-b65ccaac"><span class="cl-b65a76ee">F-statistic: 65.75 on 37 and 2 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="case-level-statistics" class="level1">
<h1>Case-level Statistics</h1>
<p>A great deal of information can be extracted about each row in your data. Perhaps the most important among these are the predicted value of the outcome variable and the error/residual. The <code>estimate_prediction</code> function gives these values, as well as the standard error around the prediction and the 95% confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_prediction</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">avgphgt</th>
<th style="text-align: right;">Predicted</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">Residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">62.1</td>
<td style="text-align: right;">73.1</td>
<td style="text-align: right;">-1.644</td>
</tr>
<tr class="even">
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">65.1</td>
<td style="text-align: right;">76.2</td>
<td style="text-align: right;">0.373</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">73.6</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">67.9</td>
<td style="text-align: right;">79.3</td>
<td style="text-align: right;">0.391</td>
</tr>
<tr class="even">
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">61.0</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">2.549</td>
</tr>
<tr class="odd">
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">59.1</td>
<td style="text-align: right;">70.2</td>
<td style="text-align: right;">5.338</td>
</tr>
<tr class="even">
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">67.4</td>
<td style="text-align: right;">78.7</td>
<td style="text-align: right;">0.988</td>
</tr>
<tr class="odd">
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">66.2</td>
<td style="text-align: right;">77.4</td>
<td style="text-align: right;">1.180</td>
</tr>
<tr class="even">
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">65.1</td>
<td style="text-align: right;">76.2</td>
<td style="text-align: right;">-1.627</td>
</tr>
<tr class="odd">
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">66.2</td>
<td style="text-align: right;">77.4</td>
<td style="text-align: right;">-2.820</td>
</tr>
<tr class="even">
<td style="text-align: right;">69.5</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">2.73</td>
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">75.6</td>
<td style="text-align: right;">4.970</td>
</tr>
<tr class="odd">
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">69.4</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">63.9</td>
<td style="text-align: right;">74.9</td>
<td style="text-align: right;">-0.434</td>
</tr>
<tr class="even">
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">62.1</td>
<td style="text-align: right;">73.1</td>
<td style="text-align: right;">-0.644</td>
</tr>
<tr class="odd">
<td style="text-align: right;">71.5</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">66.8</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">0.584</td>
</tr>
<tr class="even">
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">65.1</td>
<td style="text-align: right;">76.2</td>
<td style="text-align: right;">3.373</td>
</tr>
<tr class="odd">
<td style="text-align: right;">61.5</td>
<td style="text-align: right;">60.5</td>
<td style="text-align: right;">2.85</td>
<td style="text-align: right;">54.7</td>
<td style="text-align: right;">66.2</td>
<td style="text-align: right;">2.513</td>
</tr>
<tr class="even">
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">62.7</td>
<td style="text-align: right;">73.7</td>
<td style="text-align: right;">-1.241</td>
</tr>
<tr class="odd">
<td style="text-align: right;">62.5</td>
<td style="text-align: right;">61.7</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">56.0</td>
<td style="text-align: right;">67.4</td>
<td style="text-align: right;">2.320</td>
</tr>
<tr class="even">
<td style="text-align: right;">63.0</td>
<td style="text-align: right;">62.3</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">56.6</td>
<td style="text-align: right;">67.9</td>
<td style="text-align: right;">-1.276</td>
</tr>
<tr class="odd">
<td style="text-align: right;">65.5</td>
<td style="text-align: right;">65.3</td>
<td style="text-align: right;">2.73</td>
<td style="text-align: right;">59.7</td>
<td style="text-align: right;">70.8</td>
<td style="text-align: right;">4.742</td>
</tr>
<tr class="even">
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">62.7</td>
<td style="text-align: right;">73.7</td>
<td style="text-align: right;">-2.241</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">67.4</td>
<td style="text-align: right;">78.7</td>
<td style="text-align: right;">-3.012</td>
</tr>
<tr class="even">
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">59.1</td>
<td style="text-align: right;">70.2</td>
<td style="text-align: right;">-4.662</td>
</tr>
<tr class="odd">
<td style="text-align: right;">68.5</td>
<td style="text-align: right;">68.8</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">63.3</td>
<td style="text-align: right;">74.3</td>
<td style="text-align: right;">6.163</td>
</tr>
<tr class="even">
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">69.4</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">63.9</td>
<td style="text-align: right;">74.9</td>
<td style="text-align: right;">3.566</td>
</tr>
<tr class="odd">
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">62.7</td>
<td style="text-align: right;">73.7</td>
<td style="text-align: right;">-5.241</td>
</tr>
<tr class="even">
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">59.1</td>
<td style="text-align: right;">70.2</td>
<td style="text-align: right;">-1.662</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">62.1</td>
<td style="text-align: right;">73.1</td>
<td style="text-align: right;">1.356</td>
</tr>
<tr class="even">
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">58.5</td>
<td style="text-align: right;">69.6</td>
<td style="text-align: right;">0.934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">66.0</td>
<td style="text-align: right;">65.9</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">60.3</td>
<td style="text-align: right;">71.4</td>
<td style="text-align: right;">-1.855</td>
</tr>
<tr class="even">
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">65.1</td>
<td style="text-align: right;">76.2</td>
<td style="text-align: right;">-1.627</td>
</tr>
<tr class="odd">
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">62.7</td>
<td style="text-align: right;">73.7</td>
<td style="text-align: right;">-3.241</td>
</tr>
<tr class="even">
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">59.1</td>
<td style="text-align: right;">70.2</td>
<td style="text-align: right;">-1.662</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">62.1</td>
<td style="text-align: right;">73.1</td>
<td style="text-align: right;">0.356</td>
</tr>
<tr class="even">
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">58.5</td>
<td style="text-align: right;">69.6</td>
<td style="text-align: right;">-1.066</td>
</tr>
<tr class="odd">
<td style="text-align: right;">64.0</td>
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">57.9</td>
<td style="text-align: right;">69.1</td>
<td style="text-align: right;">-1.469</td>
</tr>
<tr class="even">
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">62.9</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">57.3</td>
<td style="text-align: right;">68.5</td>
<td style="text-align: right;">-1.873</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67.0</td>
<td style="text-align: right;">67.0</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">61.6</td>
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">-0.048</td>
</tr>
<tr class="even">
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">58.5</td>
<td style="text-align: right;">69.6</td>
<td style="text-align: right;">-1.066</td>
</tr>
<tr class="odd">
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">62.9</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">57.3</td>
<td style="text-align: right;">68.5</td>
<td style="text-align: right;">-0.873</td>
</tr>
<tr class="even">
<td style="text-align: right;">71.5</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">66.8</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">-0.416</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>augment</code> function from the broom package gives the predicted value (<code>.fitted</code>), the residual (<code>.resid</code>), the residual converted to a standardized z-score (<code>.std.resid</code>), Cook’s distance (.cooksd) to identify influential cases, hat values (<code>.hat</code>) to identify cases that have leverage (i.e., the potential to be influential), and <code>.sigma</code> (the estimated residual standard deviation when the corresponding observation is dropped from the model).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(m1)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">height</th>
<th style="text-align: right;">avgphgt</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">66</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">-1.644</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">-0.621</td>
</tr>
<tr class="even">
<td style="text-align: right;">71</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.142</td>
</tr>
<tr class="odd">
<td style="text-align: right;">74</td>
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">73.6</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.154</td>
</tr>
<tr class="even">
<td style="text-align: right;">69</td>
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">2.549</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.964</td>
</tr>
<tr class="odd">
<td style="text-align: right;">70</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">5.338</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">2.034</td>
</tr>
<tr class="even">
<td style="text-align: right;">74</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.385</td>
</tr>
<tr class="odd">
<td style="text-align: right;">73</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">1.180</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.455</td>
</tr>
<tr class="even">
<td style="text-align: right;">69</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">-1.627</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.621</td>
</tr>
<tr class="odd">
<td style="text-align: right;">69</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">-2.820</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">-1.086</td>
</tr>
<tr class="even">
<td style="text-align: right;">75</td>
<td style="text-align: right;">69.5</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">4.970</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">1.890</td>
</tr>
<tr class="odd">
<td style="text-align: right;">69</td>
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">69.4</td>
<td style="text-align: right;">-0.434</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.164</td>
</tr>
<tr class="even">
<td style="text-align: right;">67</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">-0.644</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">-0.243</td>
</tr>
<tr class="odd">
<td style="text-align: right;">73</td>
<td style="text-align: right;">71.5</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.226</td>
</tr>
<tr class="even">
<td style="text-align: right;">74</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">3.373</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">1.287</td>
</tr>
<tr class="odd">
<td style="text-align: right;">63</td>
<td style="text-align: right;">61.5</td>
<td style="text-align: right;">60.5</td>
<td style="text-align: right;">2.513</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">1.003</td>
</tr>
<tr class="even">
<td style="text-align: right;">67</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">-1.241</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">-0.469</td>
</tr>
<tr class="odd">
<td style="text-align: right;">64</td>
<td style="text-align: right;">62.5</td>
<td style="text-align: right;">61.7</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.910</td>
</tr>
<tr class="even">
<td style="text-align: right;">61</td>
<td style="text-align: right;">63.0</td>
<td style="text-align: right;">62.3</td>
<td style="text-align: right;">-1.276</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-0.497</td>
</tr>
<tr class="odd">
<td style="text-align: right;">70</td>
<td style="text-align: right;">65.5</td>
<td style="text-align: right;">65.3</td>
<td style="text-align: right;">4.742</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">1.801</td>
</tr>
<tr class="even">
<td style="text-align: right;">66</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">-2.241</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-0.847</td>
</tr>
<tr class="odd">
<td style="text-align: right;">70</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">73.0</td>
<td style="text-align: right;">-3.012</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">-1.176</td>
</tr>
<tr class="even">
<td style="text-align: right;">60</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">-4.662</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-1.776</td>
</tr>
<tr class="odd">
<td style="text-align: right;">75</td>
<td style="text-align: right;">68.5</td>
<td style="text-align: right;">68.8</td>
<td style="text-align: right;">6.163</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">2.332</td>
</tr>
<tr class="even">
<td style="text-align: right;">73</td>
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">69.4</td>
<td style="text-align: right;">3.566</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">1.352</td>
</tr>
<tr class="odd">
<td style="text-align: right;">63</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">-5.241</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">-1.981</td>
</tr>
<tr class="even">
<td style="text-align: right;">63</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">-1.662</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.633</td>
</tr>
<tr class="odd">
<td style="text-align: right;">69</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">1.356</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.512</td>
</tr>
<tr class="even">
<td style="text-align: right;">65</td>
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.358</td>
</tr>
<tr class="odd">
<td style="text-align: right;">64</td>
<td style="text-align: right;">66.0</td>
<td style="text-align: right;">65.9</td>
<td style="text-align: right;">-1.855</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">-0.703</td>
</tr>
<tr class="even">
<td style="text-align: right;">69</td>
<td style="text-align: right;">70.0</td>
<td style="text-align: right;">70.6</td>
<td style="text-align: right;">-1.627</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.621</td>
</tr>
<tr class="odd">
<td style="text-align: right;">65</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">68.2</td>
<td style="text-align: right;">-3.241</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">-1.225</td>
</tr>
<tr class="even">
<td style="text-align: right;">63</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">64.7</td>
<td style="text-align: right;">-1.662</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.633</td>
</tr>
<tr class="odd">
<td style="text-align: right;">68</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">67.6</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="even">
<td style="text-align: right;">63</td>
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">-1.066</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.408</td>
</tr>
<tr class="odd">
<td style="text-align: right;">62</td>
<td style="text-align: right;">64.0</td>
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">-1.469</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-0.565</td>
</tr>
<tr class="even">
<td style="text-align: right;">61</td>
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">62.9</td>
<td style="text-align: right;">-1.873</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">-0.724</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67</td>
<td style="text-align: right;">67.0</td>
<td style="text-align: right;">67.0</td>
<td style="text-align: right;">-0.048</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.018</td>
</tr>
<tr class="even">
<td style="text-align: right;">63</td>
<td style="text-align: right;">64.5</td>
<td style="text-align: right;">64.1</td>
<td style="text-align: right;">-1.066</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.408</td>
</tr>
<tr class="odd">
<td style="text-align: right;">62</td>
<td style="text-align: right;">63.5</td>
<td style="text-align: right;">62.9</td>
<td style="text-align: right;">-0.873</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.337</td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td style="text-align: right;">71.5</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">-0.416</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">-0.161</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The idea of leverage can be found in Figure&nbsp;12. When the red dot has an extreme value of <em>x</em>, it can easily alter where the regression line will be, depending on the value of <em>y</em>. That is, extreme values of <em>x</em> have <em>leverage</em>. When the red dot has a value of <em>x</em> in the middle, the value of <em>y</em> will have little effect on the location of the regression line. Thus, values of <em>x</em> near the mean have little leverage. When there are multiple predictors, the hat values help spot cases with leverage even though a visualization is not always possible.</p>
<div id="fig-leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/Regression/leverage.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Animation showing preditor values with high and low leverage
</figcaption>
</figure>
</div>
</section>
<section id="all-the-code-in-one-place" class="level1">
<h1>All the code in one place:</h1>
<p>The preceding analyses might seem like a lot, but it is not really so much when you see it all in just a few lines of code. Here are all the main analyses:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load packages</span></span>
<span id="cb66-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb66-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats)</span>
<span id="cb66-4"></span>
<span id="cb66-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import data</span></span>
<span id="cb66-6">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5325/raw/master/height.csv"</span>)</span>
<span id="cb66-7"></span>
<span id="cb66-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot data</span></span>
<span id="cb66-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(weight,height)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)</span>
<span id="cb66-12"></span>
<span id="cb66-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save plot</span></span>
<span id="cb66-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_plot.pdf"</span>)</span>
<span id="cb66-15"></span>
<span id="cb66-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create regression model</span></span>
<span id="cb66-17">m1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(height<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>avgphgt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb66-18"></span>
<span id="cb66-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check model assumptions</span></span>
<span id="cb66-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(m1)</span>
<span id="cb66-21"></span>
<span id="cb66-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display results</span></span>
<span id="cb66-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m1)</span>
<span id="cb66-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model fit</span></span>
<span id="cb66-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m1)</span>
<span id="cb66-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model parameters</span></span>
<span id="cb66-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m1)</span>
<span id="cb66-28"></span>
<span id="cb66-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Multiple regression</span></span>
<span id="cb66-30">m2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> avgphgt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span>
<span id="cb66-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m2)</span>
<span id="cb66-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standardize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"refit"</span>)</span>
<span id="cb66-33"></span>
<span id="cb66-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare model m1 and model m2</span></span>
<span id="cb66-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_wald</span>(m1, m2)</span>
<span id="cb66-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">test_bf</span>(m1, m2)</span>
<span id="cb66-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compare_performance</span>(m1, m2)</span></code></pre></div>
</div>
</section>
<section id="questions" class="level1">
<h1>Questions</h1>
<p>Use the Transfer of Learning data set. A set of 38 inmates participated in a study that tested the Transfer of Learning Hypothesis. Some people believe that studying Latin is particularly beneficial for progress in other academic disciplines. Each inmate was given a reading test and a math test before the study began. Some inmates were randomly assigned to participate in a 48-week Latin course. The control group studied the lives of famous athletes for the same time period. Each inmate took the reading and math test again to see if studying Latin improved their academic skills. Personal information was also collected about each inmate including their annual income before going to prison, whether or not the inmate had a documented learning disorder, and whether or not the inmate had been convicted of a violent offense. Here are the variable names:</p>
<ul>
<li><code>read_1</code> = Reading before study</li>
<li><code>read_2</code> = Reading after study</li>
<li><code>math_1</code> = Math before study</li>
<li><code>math_2</code> = Math after study</li>
<li><code>latin</code> = 1 (Studied Latin), 0 (Studied sports history)</li>
<li><code>violent</code> = 1 (convicted of a violent offense), 0 (convicted of a non-violent offense)</li>
<li><code>learning</code> = 1 (Learning disabled), 0 (Not learning disabled)</li>
<li><code>income</code> = Annual income before incarceration</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1">d_learn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/transfer_of_learning.csv"</span>) </span></code></pre></div>
</div>
<p>Assume α = 0.05 for all hypothesis tests.</p>
<p>Create a regression model in which you predict reading at time 2 (<code>read_2</code>) using reading at time 1 (<code>read_1</code>). Call the model fit object <code>m_read</code>.</p>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Is <code>read_1</code> a significant predictor of <code>read_2</code>?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Make model fit object called <code>m_read</code> using the <code>lm</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">m_read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(read_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> read_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_learn)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>View coefficient-level statistics with the <code>parameters</code> function.</p>
<p>You could also use Base R’s <code>summary</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read)</span>
<span id="cb69-2"></span>
<span id="cb69-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or</span></span>
<span id="cb69-4"></span>
<span id="cb69-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the read_1 row, is the p.value column less than 0.05?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(m_read)</span></code></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">CI</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">df_error</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">83.591</td>
<td style="text-align: right;">10.922</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">61.44</td>
<td style="text-align: right;">105.741</td>
<td style="text-align: right;">7.65</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">read_1</td>
<td style="text-align: right;">0.251</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.021</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>What is the <em>R</em><sup>2</sup> for the <code>m_read</code> model?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>View model-level statistics with the <code>performance</code> function.</p>
<p>You could also use Base R’s <code>summary</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(m_read)</span>
<span id="cb71-2"></span>
<span id="cb71-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or</span></span>
<span id="cb71-4"></span>
<span id="cb71-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_read)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>What does the scatter plot look like when <code>read_1</code> is on the <em>x</em>-axis and <code>read_2</code> is on the <em>y</em>-axis? Also plot the regression line. Save your plot using the <code>ggsave</code> function.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint for Getting Started
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This will get you started</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_learn, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(read_1, read_2))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint for Adding Points
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is how you add points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_learn, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(read_1, read_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() </span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint for Adding a Regression Line
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is how you add a regression line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_learn, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(read_1, read_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb74-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) </span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Plot Polishing
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is overkill for now. But someday you might want to be able to make your plots as polished as possible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I want to put the equation at x = 130</span></span>
<span id="cb75-2">equation_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">130</span></span>
<span id="cb75-3">equation_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(m_read, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">read_1 =</span> equation_x))</span>
<span id="cb75-4"></span>
<span id="cb75-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting the coefficients</span></span>
<span id="cb75-6">b_read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(m_read),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb75-7"></span>
<span id="cb75-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The angle of the regression line is the inverse tangent of the slope (converted to degrees)</span></span>
<span id="cb75-9">eq_angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan</span>(b_read[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pi</span>
<span id="cb75-10"></span>
<span id="cb75-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Equation</span></span>
<span id="cb75-12">eq_read <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic(Y) == "</span>, </span>
<span id="cb75-13">                  b_read[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb75-14">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" + "</span>, </span>
<span id="cb75-15">                  b_read[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb75-16">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" *  italic(X) + italic(e)"</span>)</span>
<span id="cb75-17"></span>
<span id="cb75-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_learn, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(read_1, read_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading at Time 1"</span>,</span>
<span id="cb75-22">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading at Time 2"</span>,</span>
<span id="cb75-23">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using Reading at Time 1 to Predict Reading at Time 2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb75-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb75-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb75-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> equation_x,</span>
<span id="cb75-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> equation_y,</span>
<span id="cb75-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> eq_angle,</span>
<span id="cb75-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> eq_read,</span>
<span id="cb75-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb75-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/Regression/regression_files/figure-html/q3polishing-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Create a regression model in which you predict math at time 2 (<code>math_2</code>) using reading at time 1 (<code>math_1</code>). Call the model fit object <code>m_math1</code>.</p>
<p>Does <code>math_1</code> predict <code>math_2</code>?.</p>
<p>Does <code>math_1</code> still predict <code>math_2</code> after controlling for <code>read_1</code>?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1">m_math <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(math_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> math_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> read_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_learn)</span>
<span id="cb76-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(m_math)</span></code></pre></div>
</div>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/Regression/regression.html</guid>
  <pubDate>Thu, 07 Mar 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>ANOVA in R</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/ANOVA/ANOVA.html</link>
  <description><![CDATA[ 





<section id="load-packages" class="level1">
<h1>Load Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(easystats)</span></code></pre></div>
</div>
</section>
<section id="import-data-and-create-labelled-factors" class="level1 page-columns page-full">
<h1>Import Data and Create Labelled Factors</h1>

<div class="no-row-height column-margin column-container"><div class="">
<p>The haven package will import data as a “tibble.” A tibble is a container for tabular data. It is an enhancement of the base R’s data.frame.</p>
<p>Hadley Wickham, the programmer who started the tidyverse, enjoys naming things precisely but with a touch of humor. “Tibble” is what people in the U.S. sometimes hear when New Zealanders like Hadley say the word “table.”</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File location</span></span>
<span id="cb2-2">file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5325/raw/master/Attachment.sav"</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import SPSS data file using haven</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Also, change the Attachment variable to a factor</span></span>
<span id="cb2-7">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haven<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_spss</span>(file) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Attachment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(Attachment))</span></code></pre></div>
</div>
</section>
<section id="descriptives" class="level1">
<h1>Descriptives</h1>
<p>The variables in <code>d</code> are:</p>
<ul>
<li><code>Attachment</code>: Classifies each person’s attachment type: Secure, Avoidant, or Ambivalent</li>
<li><code>Anxiety_Questionnaire</code>: A summary score from a questionnaire measure of anxiety</li>
<li><code>Anxiety_Physiological</code>: A summary score from various physiological measures of anxiety</li>
</ul>
<p>There are 300 rows (cases) and 3 columns (variables).</p>
<p>Let’s get a sense of what is in the data frame.</p>
<p>We can look at the first 6 rows of the data using the <code>head</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Attachment Anxiety_Physiological Anxiety_Questionnaire
  &lt;fct&gt;                      &lt;dbl&gt;                 &lt;dbl&gt;
1 Secure                      59.8                  57.9
2 Ambivalent                  63.3                  63.4
3 Avoidant                    72.2                  51.5
4 Secure                      41.6                  38.6
5 Ambivalent                  77.8                  82.5
6 Ambivalent                  51.6                  50.8</code></pre>
</div>
</div>
<p>A nice summary of what the variables are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_codebook</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d (300 rows and 3 variables, 3 shown)

ID | Name                  | Type        | Missings |         Values |           N
---+-----------------------+-------------+----------+----------------+------------
1  | Attachment            | categorical | 0 (0.0%) |         Secure | 110 (36.7%)
   |                       |             |          |       Avoidant |  85 (28.3%)
   |                       |             |          |     Ambivalent | 105 (35.0%)
---+-----------------------+-------------+----------+----------------+------------
2  | Anxiety_Physiological | numeric     | 0 (0.0%) | [22.78, 93.88] |         300
---+-----------------------+-------------+----------+----------------+------------
3  | Anxiety_Questionnaire | numeric     | 0 (0.0%) | [21.79, 92.38] |         300
----------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="selecting-specific-variables" class="level1">
<h1>Selecting specific variables</h1>
<p>Data sets in tutorials like this one are often unrealistically small. If there are only three variables, we are happy to describe all the variables in a single table.</p>
<p>Real data sets can have dozens, hundreds, or even thousands of variables. Describing hundreds of variables in a single table is usually impractical. We need a way to select from the data just the variables we want.</p>
<p>There are many ways to select variables in R, but I am going to keep things simple and consistent. I will use the <code>select</code> function from the tidyverse any time I select a variable. The <code>select</code> function is rarely used by itself. We use it as a preliminary step before doing something else (i.e., to specify which variables to describe, analyze, or plot). For this reason, it is often used in the middle sequence of commands linked with the “pipe” operator: <code>%&gt;%</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Anxiety_Questionnaire, Anxiety_Physiological) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Anxiety_Questionnaire Anxiety_Physiological
Anxiety_Questionnaire                  1.00                  0.75
Anxiety_Physiological                  0.75                  1.00</code></pre>
</div>
</div>
<p>The pipe operator inserts the output of the previous command into the next function. You can think of it as meaning “and then…”</p>
<p>The code above can be interpreted as a series of steps: 1. Start with the data in <code>d</code>AND THEN 2. Select the variables <code>Anxiety_Questionnaire</code> and <code>Anxiety_Physiological</code> AND THEN 3. Create a correlation matrix.</p>
<p>It makes it convenient to link a series of commands in a readable format.</p>
<p>You can select as many variables as you wish, separated by commas. You do not need to put variable names in quotes.</p>
<p>The <code>select</code> function allows for selecting as many variables from the data as you wish:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Attachment, Anxiety_Physiological)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 2
   Attachment Anxiety_Physiological
   &lt;fct&gt;                      &lt;dbl&gt;
 1 Secure                      59.8
 2 Ambivalent                  63.3
 3 Avoidant                    72.2
 4 Secure                      41.6
 5 Ambivalent                  77.8
 6 Ambivalent                  51.6
 7 Secure                      57.7
 8 Ambivalent                  69.6
 9 Avoidant                    67.7
10 Avoidant                    71.7
# ℹ 290 more rows</code></pre>
</div>
</div>
<p>Use the <code>-</code> sign to exclude a variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Attachment)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 2
   Anxiety_Physiological Anxiety_Questionnaire
                   &lt;dbl&gt;                 &lt;dbl&gt;
 1                  59.8                  57.9
 2                  63.3                  63.4
 3                  72.2                  51.5
 4                  41.6                  38.6
 5                  77.8                  82.5
 6                  51.6                  50.8
 7                  57.7                  56.1
 8                  69.6                  75.9
 9                  67.7                  49.7
10                  71.7                  52.3
# ℹ 290 more rows</code></pre>
</div>
</div>
<p>Select variables that contain “Anxiety”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anxiety"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 2
   Anxiety_Physiological Anxiety_Questionnaire
                   &lt;dbl&gt;                 &lt;dbl&gt;
 1                  59.8                  57.9
 2                  63.3                  63.4
 3                  72.2                  51.5
 4                  41.6                  38.6
 5                  77.8                  82.5
 6                  51.6                  50.8
 7                  57.7                  56.1
 8                  69.6                  75.9
 9                  67.7                  49.7
10                  71.7                  52.3
# ℹ 290 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative Selection Methods
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>R’s delightful flexibility makes for a bewildering array of options! Here just a few of the many ways we could select the <code>Attachment</code> variable from data.frame <code>d</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># By name</span></span>
<span id="cb15-2">d[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attachment"</span>] </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 1
   Attachment
   &lt;fct&gt;     
 1 Secure    
 2 Ambivalent
 3 Avoidant  
 4 Secure    
 5 Ambivalent
 6 Ambivalent
 7 Secure    
 8 Ambivalent
 9 Avoidant  
10 Avoidant  
# ℹ 290 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># By position</span></span>
<span id="cb17-2">d[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 1
   Attachment
   &lt;fct&gt;     
 1 Secure    
 2 Ambivalent
 3 Avoidant  
 4 Secure    
 5 Ambivalent
 6 Ambivalent
 7 Secure    
 8 Ambivalent
 9 Avoidant  
10 Avoidant  
# ℹ 290 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Selecting always returns a data.frame or tibble</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(d, Attachment)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 1
   Attachment
   &lt;fct&gt;     
 1 Secure    
 2 Ambivalent
 3 Avoidant  
 4 Secure    
 5 Ambivalent
 6 Ambivalent
 7 Secure    
 8 Ambivalent
 9 Avoidant  
10 Avoidant  
# ℹ 290 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting a vector from the data</span></span>
<span id="cb21-2">d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Attachment</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Secure     Ambivalent Avoidant   Secure     Ambivalent Ambivalent
  [7] Secure     Ambivalent Avoidant   Avoidant   Avoidant   Secure    
 [13] Ambivalent Secure     Avoidant   Ambivalent Ambivalent Secure    
 [19] Avoidant   Secure     Avoidant   Avoidant   Ambivalent Secure    
 [25] Avoidant   Avoidant   Secure     Avoidant   Ambivalent Secure    
 [31] Secure     Secure     Ambivalent Ambivalent Avoidant   Avoidant  
 [37] Ambivalent Secure     Ambivalent Secure     Ambivalent Secure    
 [43] Secure     Secure     Ambivalent Ambivalent Ambivalent Avoidant  
 [49] Avoidant   Ambivalent Secure     Secure     Ambivalent Ambivalent
 [55] Secure     Ambivalent Ambivalent Ambivalent Avoidant   Ambivalent
 [61] Ambivalent Ambivalent Avoidant   Secure     Ambivalent Avoidant  
 [67] Avoidant   Avoidant   Secure     Secure     Secure     Secure    
 [73] Secure     Secure     Secure     Ambivalent Secure     Ambivalent
 [79] Avoidant   Avoidant   Avoidant   Ambivalent Secure     Avoidant  
 [85] Secure     Ambivalent Ambivalent Secure     Ambivalent Avoidant  
 [91] Ambivalent Avoidant   Avoidant   Avoidant   Avoidant   Secure    
 [97] Avoidant   Secure     Secure     Avoidant   Secure     Avoidant  
[103] Ambivalent Ambivalent Secure     Avoidant   Ambivalent Avoidant  
[109] Secure     Secure     Secure     Ambivalent Avoidant   Avoidant  
[115] Ambivalent Ambivalent Ambivalent Secure     Ambivalent Avoidant  
[121] Secure     Secure     Ambivalent Ambivalent Secure     Ambivalent
[127] Avoidant   Secure     Ambivalent Avoidant   Secure     Ambivalent
[133] Secure     Ambivalent Secure     Avoidant   Avoidant   Ambivalent
[139] Secure     Avoidant   Secure     Secure     Avoidant   Secure    
[145] Avoidant   Ambivalent Ambivalent Secure     Avoidant   Secure    
[151] Secure     Avoidant   Ambivalent Avoidant   Ambivalent Secure    
[157] Ambivalent Secure     Secure     Secure     Ambivalent Ambivalent
[163] Secure     Ambivalent Secure     Avoidant   Secure     Ambivalent
[169] Secure     Avoidant   Ambivalent Secure     Secure     Ambivalent
[175] Avoidant   Ambivalent Avoidant   Secure     Avoidant   Avoidant  
[181] Ambivalent Avoidant   Ambivalent Ambivalent Secure     Ambivalent
[187] Secure     Ambivalent Secure     Secure     Secure     Avoidant  
[193] Ambivalent Secure     Avoidant   Secure     Secure     Secure    
[199] Secure     Secure     Ambivalent Avoidant   Avoidant   Ambivalent
[205] Avoidant   Ambivalent Secure     Secure     Secure     Secure    
[211] Ambivalent Avoidant   Ambivalent Ambivalent Ambivalent Secure    
[217] Avoidant   Secure     Avoidant   Secure     Secure     Ambivalent
[223] Avoidant   Avoidant   Ambivalent Ambivalent Ambivalent Avoidant  
[229] Ambivalent Ambivalent Ambivalent Avoidant   Ambivalent Avoidant  
[235] Ambivalent Secure     Avoidant   Secure     Secure     Avoidant  
[241] Ambivalent Secure     Avoidant   Ambivalent Ambivalent Ambivalent
[247] Avoidant   Avoidant   Secure     Avoidant   Ambivalent Secure    
[253] Secure     Secure     Ambivalent Secure     Secure     Secure    
[259] Secure     Avoidant   Ambivalent Secure     Avoidant   Avoidant  
[265] Ambivalent Ambivalent Secure     Ambivalent Ambivalent Avoidant  
[271] Ambivalent Ambivalent Ambivalent Secure     Ambivalent Avoidant  
[277] Ambivalent Secure     Secure     Secure     Secure     Ambivalent
[283] Avoidant   Ambivalent Secure     Ambivalent Avoidant   Avoidant  
[289] Ambivalent Avoidant   Secure     Secure     Ambivalent Avoidant  
[295] Ambivalent Avoidant   Secure     Secure     Secure     Avoidant  
Levels: Secure Avoidant Ambivalent</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pulling a vector frome the data (a pipe-friendly version of `$`)</span></span>
<span id="cb23-2">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb23-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(Attachment)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Secure     Ambivalent Avoidant   Secure     Ambivalent Ambivalent
  [7] Secure     Ambivalent Avoidant   Avoidant   Avoidant   Secure    
 [13] Ambivalent Secure     Avoidant   Ambivalent Ambivalent Secure    
 [19] Avoidant   Secure     Avoidant   Avoidant   Ambivalent Secure    
 [25] Avoidant   Avoidant   Secure     Avoidant   Ambivalent Secure    
 [31] Secure     Secure     Ambivalent Ambivalent Avoidant   Avoidant  
 [37] Ambivalent Secure     Ambivalent Secure     Ambivalent Secure    
 [43] Secure     Secure     Ambivalent Ambivalent Ambivalent Avoidant  
 [49] Avoidant   Ambivalent Secure     Secure     Ambivalent Ambivalent
 [55] Secure     Ambivalent Ambivalent Ambivalent Avoidant   Ambivalent
 [61] Ambivalent Ambivalent Avoidant   Secure     Ambivalent Avoidant  
 [67] Avoidant   Avoidant   Secure     Secure     Secure     Secure    
 [73] Secure     Secure     Secure     Ambivalent Secure     Ambivalent
 [79] Avoidant   Avoidant   Avoidant   Ambivalent Secure     Avoidant  
 [85] Secure     Ambivalent Ambivalent Secure     Ambivalent Avoidant  
 [91] Ambivalent Avoidant   Avoidant   Avoidant   Avoidant   Secure    
 [97] Avoidant   Secure     Secure     Avoidant   Secure     Avoidant  
[103] Ambivalent Ambivalent Secure     Avoidant   Ambivalent Avoidant  
[109] Secure     Secure     Secure     Ambivalent Avoidant   Avoidant  
[115] Ambivalent Ambivalent Ambivalent Secure     Ambivalent Avoidant  
[121] Secure     Secure     Ambivalent Ambivalent Secure     Ambivalent
[127] Avoidant   Secure     Ambivalent Avoidant   Secure     Ambivalent
[133] Secure     Ambivalent Secure     Avoidant   Avoidant   Ambivalent
[139] Secure     Avoidant   Secure     Secure     Avoidant   Secure    
[145] Avoidant   Ambivalent Ambivalent Secure     Avoidant   Secure    
[151] Secure     Avoidant   Ambivalent Avoidant   Ambivalent Secure    
[157] Ambivalent Secure     Secure     Secure     Ambivalent Ambivalent
[163] Secure     Ambivalent Secure     Avoidant   Secure     Ambivalent
[169] Secure     Avoidant   Ambivalent Secure     Secure     Ambivalent
[175] Avoidant   Ambivalent Avoidant   Secure     Avoidant   Avoidant  
[181] Ambivalent Avoidant   Ambivalent Ambivalent Secure     Ambivalent
[187] Secure     Ambivalent Secure     Secure     Secure     Avoidant  
[193] Ambivalent Secure     Avoidant   Secure     Secure     Secure    
[199] Secure     Secure     Ambivalent Avoidant   Avoidant   Ambivalent
[205] Avoidant   Ambivalent Secure     Secure     Secure     Secure    
[211] Ambivalent Avoidant   Ambivalent Ambivalent Ambivalent Secure    
[217] Avoidant   Secure     Avoidant   Secure     Secure     Ambivalent
[223] Avoidant   Avoidant   Ambivalent Ambivalent Ambivalent Avoidant  
[229] Ambivalent Ambivalent Ambivalent Avoidant   Ambivalent Avoidant  
[235] Ambivalent Secure     Avoidant   Secure     Secure     Avoidant  
[241] Ambivalent Secure     Avoidant   Ambivalent Ambivalent Ambivalent
[247] Avoidant   Avoidant   Secure     Avoidant   Ambivalent Secure    
[253] Secure     Secure     Ambivalent Secure     Secure     Secure    
[259] Secure     Avoidant   Ambivalent Secure     Avoidant   Avoidant  
[265] Ambivalent Ambivalent Secure     Ambivalent Ambivalent Avoidant  
[271] Ambivalent Ambivalent Ambivalent Secure     Ambivalent Avoidant  
[277] Ambivalent Secure     Secure     Secure     Secure     Ambivalent
[283] Avoidant   Ambivalent Secure     Ambivalent Avoidant   Avoidant  
[289] Ambivalent Avoidant   Secure     Secure     Ambivalent Avoidant  
[295] Ambivalent Avoidant   Secure     Secure     Secure     Avoidant  
Levels: Secure Avoidant Ambivalent</code></pre>
</div>
</div>
<p>In this case, there is no strong reason to prefer one method over the other. As you gain experience with R, you might find reasons to use different methods of selection. For now, we will stick to <code>select</code></p>
</div>
</div>
</div>
<section id="basic-descriptives" class="level2">
<h2 class="anchored" data-anchor-id="basic-descriptives">Basic descriptives</h2>
<p>Numeric variables can be described in terms of means, standard deviations (SD), interquartile ranges (IQR), skewness, and kurtosis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe_distribution</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable              |  Mean |    SD |   IQR |          Range | Skewness
-------------------------------------------------------------------------
Anxiety_Physiological | 60.49 | 12.79 | 16.43 | [22.78, 93.88] |    -0.29
Anxiety_Questionnaire | 55.11 | 13.30 | 18.24 | [21.79, 92.38] |     0.05

Variable              | Kurtosis |   n | n_Missing
--------------------------------------------------
Anxiety_Physiological |     0.24 | 300 |         0
Anxiety_Questionnaire |    -0.16 | 300 |         0</code></pre>
</div>
</div>
<p>Categorical variables are often described in terms of frequencies tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Attachment) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_tabulate</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Attachment (Attachment) &lt;categorical&gt;
# total N=300 valid N=300

Value      |   N | Raw % | Valid % | Cumulative %
-----------+-----+-------+---------+-------------
Secure     | 110 | 36.67 |   36.67 |        36.67
Avoidant   |  85 | 28.33 |   28.33 |        65.00
Ambivalent | 105 | 35.00 |   35.00 |       100.00
&lt;NA&gt;       |   0 |  0.00 |    &lt;NA&gt; |         &lt;NA&gt;</code></pre>
</div>
</div>
<p>We can get descriptives statistics of our numeric variables separated by group. There are many ways to do this, but the simplest is the <code>describeBy</code> function from the psych package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describeBy</span>(d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attachment"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Attachment: 1
                      vars   n mean sd median trimmed mad min max range  skew
Attachment               1 110    1  0      1       1   0   1   1     0   NaN
Anxiety_Physiological    2 110   50 11     51      51  12  23  70    48 -0.44
Anxiety_Questionnaire    3 110   50 11     51      51  12  23  70    46 -0.36
                      kurtosis se
Attachment                 NaN  0
Anxiety_Physiological    -0.41  1
Anxiety_Questionnaire    -0.61  1
------------------------------------------------------------ 
Attachment: 2
                      vars  n mean   sd median trimmed mad min max range skew
Attachment               1 85    2  0.0      2       2 0.0   2   2     0  NaN
Anxiety_Physiological    2 85   67  9.8     67      67 9.5  46  94    48 0.27
Anxiety_Questionnaire    3 85   48 10.6     48      48 9.9  22  74    52 0.11
                      kurtosis  se
Attachment                 NaN 0.0
Anxiety_Physiological    -0.13 1.1
Anxiety_Questionnaire    -0.10 1.1
------------------------------------------------------------ 
Attachment: 3
                      vars   n mean  sd median trimmed mad min max range skew
Attachment               1 105    3 0.0      3       3 0.0   3   3     0  NaN
Anxiety_Physiological    2 105   66 9.3     65      66 7.8  45  94    48 0.19
Anxiety_Questionnaire    3 105   66 9.9     66      66 9.3  44  92    48 0.31
                      kurtosis   se
Attachment                 NaN 0.00
Anxiety_Physiological     0.08 0.91
Anxiety_Questionnaire    -0.10 0.97</code></pre>
</div>
</div>
<p>The datawizard package has some really nice functions for descriptives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-2">  datawizard<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">means_by_group</span>(</span>
<span id="cb31-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">select =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anxiety"</span>) , </span>
<span id="cb31-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attachment"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Mean of Anxiety_Physiological by Attachment

Category   |  Mean |   N |    SD |         95% CI |      p
----------------------------------------------------------
Secure     | 49.95 | 110 | 10.67 | [48.08, 51.83] | &lt; .001
Avoidant   | 67.20 |  85 |  9.84 | [65.07, 69.33] | &lt; .001
Ambivalent | 66.09 | 105 |  9.33 | [64.17, 68.00] | &lt; .001
Total      | 60.49 | 300 | 12.79 |                |       

Anova: R2=0.395; adj.R2=0.391; F=96.988; p&lt;.001

# Mean of Anxiety_Questionnaire by Attachment

Category   |  Mean |   N |    SD |         95% CI |      p
----------------------------------------------------------
Secure     | 50.09 | 110 | 10.90 | [48.13, 52.05] | &lt; .001
Avoidant   | 47.82 |  85 | 10.57 | [45.59, 50.06] | &lt; .001
Ambivalent | 66.27 | 105 |  9.90 | [64.26, 68.28] | &lt; .001
Total      | 55.11 | 300 | 13.30 |                |       

Anova: R2=0.385; adj.R2=0.381; F=92.975; p&lt;.001</code></pre>
</div>
</div>
<p>The skimr package is also quite nice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(skimr)</span>
<span id="cb33-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall summary</span></span>
<span id="cb33-3">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb33-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">Piped data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attachment</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Sec: 110, Amb: 105, Avo: 85</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Anxiety_Physiological</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">94</td>
<td style="text-align: left;">▁▃▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anxiety_Questionnaire</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">92</td>
<td style="text-align: left;">▂▆▇▅▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grouped summaries</span></span>
<span id="cb34-2">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Attachment) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb34-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">Piped data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">Attachment</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: left;">Attachment</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Anxiety_Physiological</td>
<td style="text-align: left;">Secure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▂▅▆▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anxiety_Physiological</td>
<td style="text-align: left;">Avoidant</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">9.8</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">94</td>
<td style="text-align: left;">▂▇▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anxiety_Physiological</td>
<td style="text-align: left;">Ambivalent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">9.3</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">94</td>
<td style="text-align: left;">▃▆▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anxiety_Questionnaire</td>
<td style="text-align: left;">Secure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">10.9</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▂▅▇▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anxiety_Questionnaire</td>
<td style="text-align: left;">Avoidant</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">10.6</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">74</td>
<td style="text-align: left;">▁▅▇▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anxiety_Questionnaire</td>
<td style="text-align: left;">Ambivalent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">92</td>
<td style="text-align: left;">▂▆▇▃▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These are convenience functions. If they do exactly what you want, great! However, I often need statistics in a data frame in a format optimal for further processing (e.g., for publication-worthy tables or plots).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">d_descriptives <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anxiety"</span>), </span>
<span id="cb35-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Measure"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value),</span>
<span id="cb35-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(value),</span>
<span id="cb35-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb35-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Attachment, Measure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Measure =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_title_case</span>(Measure))</span>
<span id="cb35-9"></span>
<span id="cb35-10">d_descriptives</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Attachment Measure                Mean    SD     n
  &lt;fct&gt;      &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 Secure     Anxiety Physiological  50.0 10.7    110
2 Secure     Anxiety Questionnaire  50.1 10.9    110
3 Ambivalent Anxiety Physiological  66.1  9.33   105
4 Ambivalent Anxiety Questionnaire  66.3  9.90   105
5 Avoidant   Anxiety Physiological  67.2  9.84    85
6 Avoidant   Anxiety Questionnaire  47.8 10.6     85</code></pre>
</div>
</div>
<p>This output is not pretty, but it was not intended to be. It is in a format that is easy to adapt for other things. For example, I can use the gt (“Great Tables”) package to get exactly what I want to display:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb37-2">d_descriptives <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Measure"</span>, </span>
<span id="cb37-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rowname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attachment"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb37-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_stub_indent</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indent =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="nkmemdonqh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nkmemdonqh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nkmemdonqh thead, #nkmemdonqh tbody, #nkmemdonqh tfoot, #nkmemdonqh tr, #nkmemdonqh td, #nkmemdonqh th {
  border-style: none;
}

#nkmemdonqh p {
  margin: 0;
  padding: 0;
}

#nkmemdonqh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nkmemdonqh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nkmemdonqh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nkmemdonqh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nkmemdonqh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nkmemdonqh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nkmemdonqh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nkmemdonqh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nkmemdonqh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nkmemdonqh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nkmemdonqh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nkmemdonqh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nkmemdonqh .gt_spanner_row {
  border-bottom-style: hidden;
}

#nkmemdonqh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nkmemdonqh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nkmemdonqh .gt_from_md > :first-child {
  margin-top: 0;
}

#nkmemdonqh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nkmemdonqh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nkmemdonqh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nkmemdonqh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nkmemdonqh .gt_row_group_first td {
  border-top-width: 2px;
}

#nkmemdonqh .gt_row_group_first th {
  border-top-width: 2px;
}

#nkmemdonqh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nkmemdonqh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nkmemdonqh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nkmemdonqh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nkmemdonqh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nkmemdonqh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nkmemdonqh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nkmemdonqh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nkmemdonqh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nkmemdonqh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nkmemdonqh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nkmemdonqh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nkmemdonqh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nkmemdonqh .gt_left {
  text-align: left;
}

#nkmemdonqh .gt_center {
  text-align: center;
}

#nkmemdonqh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nkmemdonqh .gt_font_normal {
  font-weight: normal;
}

#nkmemdonqh .gt_font_bold {
  font-weight: bold;
}

#nkmemdonqh .gt_font_italic {
  font-style: italic;
}

#nkmemdonqh .gt_super {
  font-size: 65%;
}

#nkmemdonqh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nkmemdonqh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nkmemdonqh .gt_indent_1 {
  text-indent: 5px;
}

#nkmemdonqh .gt_indent_2 {
  text-indent: 10px;
}

#nkmemdonqh .gt_indent_3 {
  text-indent: 15px;
}

#nkmemdonqh .gt_indent_4 {
  text-indent: 20px;
}

#nkmemdonqh .gt_indent_5 {
  text-indent: 25px;
}

#nkmemdonqh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nkmemdonqh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a::stub" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="Anxiety Physiological" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Anxiety Physiological</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Physiological stub_1_1 stub_1">Secure</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_1 Mean">50</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_1 SD">10.7</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_1 n">110</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Physiological stub_1_2 stub_1">Ambivalent</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_2 Mean">66</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_2 SD">9.3</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_2 n">105</td>
</tr>
<tr class="even">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Physiological stub_1_3 stub_1">Avoidant</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_3 Mean">67</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_3 SD">9.8</td>
<td class="gt_row gt_right" headers="Anxiety Physiological stub_1_3 n">85</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="Anxiety Questionnaire" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Anxiety Questionnaire</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Questionnaire stub_1_4 stub_1">Secure</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_4 Mean">50</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_4 SD">10.9</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_4 n">110</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Questionnaire stub_1_5 stub_1">Ambivalent</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_5 Mean">66</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_5 SD">9.9</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_5 n">105</td>
</tr>
<tr class="even">
<td class="gt_row gt_center gt_stub gt_indent_5" headers="Anxiety Questionnaire stub_1_6 stub_1">Avoidant</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_6 Mean">48</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_6 SD">10.6</td>
<td class="gt_row gt_right" headers="Anxiety Questionnaire stub_1_6 n">85</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Or I can use ggplot2 to display means and standard deviations graphically:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">d_descriptives <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_label =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(Mean, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Attachment, Mean)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(Measure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> Mean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> SD,</span>
<span id="cb38-6">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> Mean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SD)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(</span>
<span id="cb38-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> mean_label), </span>
<span id="cb38-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/ggplotmeans-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="plot" class="level1">
<h1>Plot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb39-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Attachment,</span>
<span id="cb39-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Anxiety_Questionnaire)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>() </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Just looking at the plot, we can see that the Ambivalent group has a higher mean anxiety than the other two groups. However, let’s conduct a formal test of the difference of the group means.</p>
</section>
<section id="create-one-way-anova" class="level1">
<h1>Create One-Way ANOVA</h1>
<p>The <code>aov</code> (Analysis of Variance) function is what you want to use. The <code>anova</code> function is better used for comparing models. The dependent variable goes on the left, and any predictor variables are on the right hand side of the ~.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aov</span>(Anxiety_Questionnaire <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Attachment, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d)</span></code></pre></div>
</div>
<section id="diagnostic-plots" class="level2">
<h2 class="anchored" data-anchor-id="diagnostic-plots">Diagnostic Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_model</span>(fit)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/ANOVA/ANOVA_files/figure-html/assumptions-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>None of the diagnostic checks raise any alarms. Specifically, the residuals are reasonably normal and have consistent variance acrross groups (i.e., the homogeneeity of variance assumption is reasonable).</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>The base R function <code>summary</code> gives us most of what we might want to know.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Attachment    2  20359   10179      93 &lt;2e-16 ***
Residuals   297  32517     109                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We can see that overall model is significant, meaning that at least two groups have reliably different means. At this point we do not know which means differ, but from the plot we have a good guess that the Ambivalent group scores higher on the Anxiety Questionnaire than the other two groups.</p>
<p>A similar, but tidier display can be found with the <code>parameters</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parameters</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter  | Sum_Squares |  df | Mean_Square |     F |      p
-------------------------------------------------------------
Attachment |    20358.60 |   2 |    10179.30 | 92.98 | &lt; .001
Residuals  |    32516.83 | 297 |      109.48 |       |       

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
</section>
<section id="other-summary-functions" class="level2">
<h2 class="anchored" data-anchor-id="other-summary-functions">Other Summary Functions</h2>
<p>The overall “fit” or “performance” of the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC |    R2 | R2 (adj.) |   RMSE |  Sigma
--------------------------------------------------------------------
2265.082 | 2265.218 | 2279.897 | 0.385 |     0.381 | 10.411 | 10.463</code></pre>
</div>
</div>
<ul>
<li><code>AIC</code>: <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">Akaike’s Information Criterion</a></li>
<li><code>AICc</code>: AIC with a correction for small sample sizes</li>
<li><code>BIC</code>: <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayesian Information Criterion</a></li>
<li><code>R2</code>: R-squared: <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">Coefficient of Determination</a></li>
<li><code>R2_adj</code>: <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination#Adjusted_R2">Adjusted r-squared</a></li>
<li><code>RMSE</code>: Root mean squared error <img src="https://latex.codecogs.com/png.latex?=%5Csqrt%7B%5Cfrac%7B%5Csum_%7Bi%20=%201%7D%5E%7Bn%7D%7Be_i%7D%7D%7Bn%7D%7D"></li>
<li><code>SIGMA</code>: Residual standard deviation (The SD of the residuals <img src="https://latex.codecogs.com/png.latex?=%5Csqrt%7B%5Cfrac%7B%5Csum_%7Bi%20=%201%7D%5E%7Bn%7D%7Be_i%7D%7D%7Bn-k-1%7D%7D">)</li>
</ul>
</section>
<section id="automated-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="automated-interpretation">Automated Interpretation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA (formula: Anxiety_Questionnaire ~ Attachment) suggests that:

  - The main effect of Attachment is statistically significant and large (F(2,
297) = 92.98, p &lt; .001; Eta2 = 0.39, 95% CI [0.32, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
</section>
<section id="post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-tests">Post-hoc Tests</h2>
<p>We would like to compare all means but control for family-wise error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">fit_contrast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_contrasts</span>(fit, </span>
<span id="cb50-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">contrast =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attachment"</span>, </span>
<span id="cb50-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">backend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"emmeans"</span>)</span>
<span id="cb50-4">fit_contrast </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marginal Contrasts Analysis

Level1   | Level2     | Difference |           95% CI |   SE | t(297) |      p
------------------------------------------------------------------------------
Avoidant | Ambivalent |     -18.44 | [-21.45, -15.44] | 1.53 | -12.08 | &lt; .001
Secure   | Ambivalent |     -16.18 | [-18.99, -13.37] | 1.43 | -11.33 | &lt; .001
Secure   | Avoidant   |       2.27 | [ -0.71,   5.24] | 1.51 |   1.50 |  0.135

Variable predicted: Anxiety_Questionnaire
Predictors contrasted: Attachment
p-values are uncorrected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">report</span>(fit_contrast)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The marginal contrasts analysis suggests the following. The difference between
Avoidant and Ambivalent is negative and statistically significant (difference =
-18.44, 95% CI [-21.45, -15.44], t(297) = -12.08, p &lt; .001). The difference
between Secure and Ambivalent is negative and statistically significant
(difference = -16.18, 95% CI [-18.99, -13.37], t(297) = -11.33, p &lt; .001). The
difference between Secure and Avoidant is positive and statistically
non-significant (difference = 2.27, 95% CI [ -0.71, 5.24], t(297) = 1.50, p =
0.135)</code></pre>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/ANOVA/ANOVA.html</guid>
  <pubDate>Tue, 05 Mar 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Wrangling</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/DataWrangling/data_wrangling.html</link>
  <description><![CDATA[ 





<section id="getting-used-to-working-with-data-in-r" class="level1">
<h1>Getting Used to Working with Data in R</h1>
<p>In programs like SPSS, the data seem to live in a spreadsheet that is always open and available to you. In R, you can see the data whenever you want, but usually it sits unseen inside a variable. It can be disconcerting at first, but think of your data as living in a file somewhere on your hard drive (or online!), and then the data just come for a short visit in R.</p>
<p>The major benefit of working with data in R is that all of the changes, transformations, and restructuring happens in code—which can be recreated at any time. There is usually no need to “save” the data after you have transformed it. The next time you work with the data, you just run your code and all the calculations will transform the data exactly the same way as before.</p>
<p>Why does this matter? If you feel the need to save your data all the time, you end up having multiple copies of it: <code>data.sav</code>, <code>data_restructured.sav</code>, <code>data_new.sav</code>, <code>data_new_final.sav</code>, <code>fixed_data_new_final.sav</code>, <code>restructued_final_with_missing_cases_removed.sav</code>, and so forth and so on. It can be hard to figure out where to start the next time you work with your data. You might not remember which version has errors and which version has what you need.</p>
<p>In general, start with a completely raw data file (one that is exactly the way you started). Resist the temptation to make any changes to it directly. If you must, save a pristine copy somewhere and only then change it. Import your data and make all changes to it with code. One benefit of doing so is that the code documents any changes you would otherwise need to record in your lab notebook.</p>
</section>
<section id="all-the-code-in-one-place" class="level1">
<h1>All the code in one place:</h1>
<p>I am going to walk through these steps. You can run this all at once to make sure it works. Then I will explain it step by step.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View All the Code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load packages</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import data</span></span>
<span id="cb1-5">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/on_task_multiple_baseline.csv"</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View data</span></span>
<span id="cb1-8">d</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(d)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(d)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtering</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Cases with fewer than 8 baseline sessions</span></span>
<span id="cb1-15">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>baseline_sessions_n)</span>
<span id="cb1-18"></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Students with `id` equal to 7</span></span>
<span id="cb1-21">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Students with scores above 10 on `time_1` AND `time_2`:</span></span>
<span id="cb1-25">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> time_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Students with scores above 10 on `time_1` OR `time_2`:</span></span>
<span id="cb1-29">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> time_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Selecting columns</span></span>
<span id="cb1-33"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Select the id and time_1 variables</span></span>
<span id="cb1-34">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id, time_1)</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Select 5 adjacent variables: time_1 throught time_5</span></span>
<span id="cb1-38">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_5)</span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Remove the id variable</span></span>
<span id="cb1-42">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id)</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Select all variables that start with "time" </span></span>
<span id="cb1-46">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>))</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select all variables end with 0:</span></span>
<span id="cb1-50"></span>
<span id="cb1-51">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>))</span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select all variables that contain "_2"</span></span>
<span id="cb1-55">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_2"</span>))</span>
<span id="cb1-57"></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Renaming variables</span></span>
<span id="cb1-59"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Rename id to become student_id, rename baseline_sessions_n to baseline</span></span>
<span id="cb1-60">d_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">student_id =</span> id, </span>
<span id="cb1-62">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">baseline =</span> baseline_sessions_n) </span>
<span id="cb1-63"></span>
<span id="cb1-64"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Rename rename all variables that start with "time_" </span></span>
<span id="cb1-65"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## so that they start with "T_" instead</span></span>
<span id="cb1-66">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(str_replace, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_"</span>)</span>
<span id="cb1-68"></span>
<span id="cb1-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make small data</span></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select variables from id to time_3 and filter rows so that </span></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># id is less than 3 (not inclusive)</span></span>
<span id="cb1-72">d_small <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb1-75"></span>
<span id="cb1-76">d_small</span>
<span id="cb1-77"></span>
<span id="cb1-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restructuring from wide to long format:</span></span>
<span id="cb1-79">d_small_longer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb1-81">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb1-82">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb1-83">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, </span>
<span id="cb1-84">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_transform =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> as.integer)) </span>
<span id="cb1-85"></span>
<span id="cb1-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restructing from long to wide format:</span></span>
<span id="cb1-87">d_small_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> time, </span>
<span id="cb1-89">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> on_task, </span>
<span id="cb1-90">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>)</span>
<span id="cb1-91"></span>
<span id="cb1-92"></span>
<span id="cb1-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restructure whole data from wide to long and create new variables</span></span>
<span id="cb1-94">d_longer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_60,</span>
<span id="cb1-96">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb1-97">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb1-98">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, </span>
<span id="cb1-99">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_transform =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> as.integer)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-100">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phase =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb1-101">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pre-Intervention"</span>,</span>
<span id="cb1-102">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> intervention_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intervention"</span>,</span>
<span id="cb1-103">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> intervention_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Post-Intervention"</span> </span>
<span id="cb1-104">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phase =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(phase))</span>
<span id="cb1-106"></span>
<span id="cb1-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot</span></span>
<span id="cb1-108">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(baseline_sessions_n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, on_task)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(id))</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="importing-data-from-a-file" class="level1">
<h1>Importing Data from a file</h1>
<p>For this task we will use a file that lives here on the web:</p>
<p><a href="https://github.com/wjschne/EDUC5529/raw/master/on_task_multiple_baseline.csv">on_task_multiple_baseline.csv</a></p>
<p>You can download it if you want, but you do not need to. You can import it over the web right into R.</p>
<p>We have a .csv file, so we will use the tidyverse function <code>read_csv</code>, from the readr package, which can be loaded with the tidyverse package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://github.com/wjschne/EDUC5529/raw/master/on_task_multiple_baseline.csv"</span>)</span></code></pre></div>
</div>
<p>Note that we have to assign the data to a variable—<code>d</code> in this case. Otherwise, the data will spill into the console, but R will not remember the data.</p>
</section>
<section id="inspecting-data" class="level1 page-columns page-full">
<h1>Inspecting Data</h1>
<p>The <code>read_csv</code> function imports a special data structure called a <code>tibble</code> which is a variation on the traditional <code>data.frame</code> structure. It has some useful defaults that make working with it more predictable and practical.</p>
<p>If the data is too big to print in your console, the tibble will just show the first few rows, the first few columns, and then the remaining column names. The output also says which kind of data is in each column and how many rows and columns are in the data.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Whoa! That dataset has a lot of variables! When the there are more variables than rows, we say that the data is “wide.”</p>
<p>An alternate way to view the data is to use the <code>glimpse</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(d)</span></code></pre></div>
</div>
<p>If you really need to see all the data, use the <code>View</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(d)</span></code></pre></div>
</div>
</div></div><div class="cell" data-df-print="tibble">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">d</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 63
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1                  22                      20  11.5   14.4    6.15   9.25
2     2                  18                      19   9.11   8.59  11.0    9.36
3     3                   5                      18   7.24  14.3    7.98  11.2 
4     4                  32                      20  11.3   14.3   14.8    8.68
5     5                  19                      20  10.7    6.80   8.30  14.5 
6     6                  24                      20  13.0    7.47  13.7    5.77
7     7                  10                      19   9.70   9.17  10.6    9.14
8     8                  13                      20  10.6   11.7   10.9   11.4 
# ℹ 56 more variables: time_5 &lt;dbl&gt;, time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;,
#   time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;,
#   time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;,
#   time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;,
#   time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;,
#   time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;,
#   time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="study-design" class="level1">
<h1>Study Design</h1>
<p>This dataset has 8 children, one in each row. Each child was given an intervention designed to increase “time on task” in the classroom so that the child will stay focused and complete his or her work. The study has a <a href="https://www.wikiwand.com/en/Multiple_baseline_design">multiple baseline design</a>. That is, each child was observed for a “baseline” period for a number days before the intervention was implemented. Each child’s baseline lasted a different length of time. Some children were observed for a short time before the intervention, and some were observed much longer. After the intervention ended, each child was observed for a number of days to see if the intervention’s effect diminished.</p>
<p>The <code>id</code> column is just a number to identify each child. The <code>baseline_sessions_n</code> variable indicates how many days the child was observed before the intervention began. The <code>intervention_sessions_n</code> variable indications the number days the intervention lasted. The remainding variables <code>time_1</code>–<code>time_60</code> are the number of minutes the child stayed on task during the observation period each day for 60 days.</p>
</section>
<section id="tidy-data" class="level1">
<h1>Tidy Data</h1>
<p>You might think that the data is ready to be analyzed, but it isn’t. The data might be perfectly structured for data entry, but it is not quite “tidy” yet.</p>
<p>The phrase <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1"><em>tidy data</em></a> was popularized by Hadley Wickham, but it mostly refers to something a little less catchy called <a href="https://www.wikiwand.com/en/Database_normalization"><em>database normalization</em></a>. In data analysis, we want:</p>
<blockquote class="blockquote">
<ol type="1">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
</blockquote>
<p>—From <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">Wickham &amp; Grolemund (2017)</a>:</p>
<p>This is how R likes its data. Whenever you find yourself fighting with confusing or tedious tasks in R, there is a good chance your data has violated one of these rules. Converting your data to this “tidy” format will likely simplify your task.</p>
<p>In the current data, there are two primary sources of untidiness.</p>
<ul>
<li>We need a single variable to indicate <em>“<em>time on task.</em>”</em> Unfortunately, the <code>time on task</code> variable we would like to have is currently spread across 60 variables, <code>time_1</code>–<code>time_60</code>.</li>
<li>We also would like a variable called “time” to indicate which day the observation took place. Right now, the time variable is lurking in the column names <code>time_1</code>–<code>time_60</code></li>
</ul>
<p>Later we need to identify which treatment phase the observation was conducted in, “pre-intervention,” “intervention,” or “post-intervention.” That information is sitting in an unusual form right right now in the <code>baseline_sessions_n</code> and <code>intervention_session_n</code> variables.</p>
</section>
<section id="data-filtering" class="level1 page-columns page-full">
<h1>Data Filtering</h1>
<p>The <code>filter</code> function selects rows that meet certain conditions. For example, suppose we want to see rows with <code>baseline_sessions_n</code> less than 8:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The <code>%&gt;%</code> is the “pipe” function. It means “and then.” It inserts the output of the previous function into the next function. If we did not use the pipe, we would type <code>filter(d, baseline_sessions_n &lt; 8)</code> instead.</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 63
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     3                   5                      18   7.24   14.3   7.98   11.2
# ℹ 56 more variables: time_5 &lt;dbl&gt;, time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;,
#   time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;,
#   time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;,
#   time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;,
#   time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;,
#   time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;,
#   time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>In this example, there is little advantage to using the pipe because there is only one step. However, when many steps are strung together, the pipe makes the code much easier to understand.</p>
<p>The double equal sign <code>==</code> performs a test to see if two things are the same. Forgetting that you need two equal signs is a really common error.</p>
<p>Students with <code>id</code> equal to 7:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 63
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     7                  10                      19   9.70   9.17   10.6   9.14
# ℹ 56 more variables: time_5 &lt;dbl&gt;, time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;,
#   time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;,
#   time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;,
#   time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;,
#   time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;,
#   time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;,
#   time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>You can filter for more than one condition.</p>
<p>Students with scores above 10 on <code>time_1</code> AND <code>time_2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> time_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 63
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1                  22                      20   11.5   14.4   6.15   9.25
2     4                  32                      20   11.3   14.3  14.8    8.68
3     8                  13                      20   10.6   11.7  10.9   11.4 
# ℹ 56 more variables: time_5 &lt;dbl&gt;, time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;,
#   time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;,
#   time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;,
#   time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;,
#   time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;,
#   time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;,
#   time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Students with scores above 10 on <code>time_1</code> OR <code>time_2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> time_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 63
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1                  22                      20  11.5   14.4    6.15   9.25
2     3                   5                      18   7.24  14.3    7.98  11.2 
3     4                  32                      20  11.3   14.3   14.8    8.68
4     5                  19                      20  10.7    6.80   8.30  14.5 
5     6                  24                      20  13.0    7.47  13.7    5.77
6     8                  13                      20  10.6   11.7   10.9   11.4 
# ℹ 56 more variables: time_5 &lt;dbl&gt;, time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;,
#   time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;,
#   time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;,
#   time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;,
#   time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;,
#   time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;,
#   time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="column-selection" class="level1">
<h1>Column selection</h1>
<p>We can select columns by naming just the columns we want:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id, time_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
     id time_1
  &lt;dbl&gt;  &lt;dbl&gt;
1     1  11.5 
2     2   9.11
3     3   7.24
4     4  11.3 
5     5  10.7 
6     6  13.0 
7     7   9.70
8     8  10.6 </code></pre>
</div>
</div>
<p>If the columns we want are adjacent, we can use the <code>:</code> operator to select a sequence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_5)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  time_1 time_2 time_3 time_4 time_5
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1  11.5   14.4    6.15   9.25   9.58
2   9.11   8.59  11.0    9.36   8.09
3   7.24  14.3    7.98  11.2   12.3 
4  11.3   14.3   14.8    8.68   9.53
5  10.7    6.80   8.30  14.5    6.87
6  13.0    7.47  13.7    5.77  10.8 
7   9.70   9.17  10.6    9.14   7.36
8  10.6   11.7   10.9   11.4    8.26</code></pre>
</div>
</div>
<p>If want everything but a particular column (or columns), use the <code>-</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 62
  baseline_sessions_n intervention_sessions_n time_1 time_2 time_3 time_4 time_5
                &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1                  22                      20  11.5   14.4    6.15   9.25   9.58
2                  18                      19   9.11   8.59  11.0    9.36   8.09
3                   5                      18   7.24  14.3    7.98  11.2   12.3 
4                  32                      20  11.3   14.3   14.8    8.68   9.53
5                  19                      20  10.7    6.80   8.30  14.5    6.87
6                  24                      20  13.0    7.47  13.7    5.77  10.8 
7                  10                      19   9.70   9.17  10.6    9.14   7.36
8                  13                      20  10.6   11.7   10.9   11.4    8.26
# ℹ 55 more variables: time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;, time_9 &lt;dbl&gt;,
#   time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;, time_14 &lt;dbl&gt;,
#   time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;, time_19 &lt;dbl&gt;,
#   time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;, time_24 &lt;dbl&gt;,
#   time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;, time_29 &lt;dbl&gt;,
#   time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;, time_34 &lt;dbl&gt;,
#   time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, time_38 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>If columns have similar names, we can use the <code>starts_with</code>, <code>ends_width</code>, or <code>contains</code> functions.</p>
<p>Select all variables that start with the phrase <code>time</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 60
  time_1 time_2 time_3 time_4 time_5 time_6 time_7 time_8 time_9 time_10 time_11
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  11.5   14.4    6.15   9.25   9.58   8.16  10.1   11.1    9.20   10.8     9.18
2   9.11   8.59  11.0    9.36   8.09   8.77   8.95   7.44  11.1     7.59   11.1 
3   7.24  14.3    7.98  11.2   12.3   13.1   11.7   19.0   16.1    20.3    21.9 
4  11.3   14.3   14.8    8.68   9.53   7.82   9.56   8.21  12.9     8.24    8.55
5  10.7    6.80   8.30  14.5    6.87  12.4    9.41   9.44   8.74   14.3    11.0 
6  13.0    7.47  13.7    5.77  10.8    8.70   9.32   8.31  12.9     9.97    6.93
7   9.70   9.17  10.6    9.14   7.36  14.3    9.45  12.4    6.09    5.85    9.54
8  10.6   11.7   10.9   11.4    8.26   7.59   8.23   7.29  10.0    10.1     9.80
# ℹ 49 more variables: time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;, time_14 &lt;dbl&gt;,
#   time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;, time_19 &lt;dbl&gt;,
#   time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;, time_24 &lt;dbl&gt;,
#   time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;, time_29 &lt;dbl&gt;,
#   time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;, time_34 &lt;dbl&gt;,
#   time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, time_38 &lt;dbl&gt;, time_39 &lt;dbl&gt;,
#   time_40 &lt;dbl&gt;, time_41 &lt;dbl&gt;, time_42 &lt;dbl&gt;, time_43 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Select all variables end with <code>0</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  time_10 time_20 time_30 time_40 time_50 time_60
    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1   10.8    11.5    30.2     44.6    48.7    50.0
2    7.59   14.8    34.8     47.5    43.7    50.3
3   20.3    43.8    43.6     47.1    47.1    44.9
4    8.24   10.5     8.55    27.1    45.5    50.3
5   14.3    14.4    31.4     50.3    47.0    50.8
6    9.97    9.09   21.5     41.4    48.1    48.7
7    5.85   30.8    48.8     49.1    45.4    52.8
8   10.1    26.0    42.5     48.4    45.6    50.3</code></pre>
</div>
</div>
<p>Select all variables that contain the phrase “_2”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_2"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 11
  time_2 time_20 time_21 time_22 time_23 time_24 time_25 time_26 time_27 time_28
   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  14.4    11.5     8.57   10.6     11.0    13.1    18.0   13.0    23.8     21.4
2   8.59   14.8    13.1    18.2     21.7    22.8    24.8   25.2    29.2     31.5
3  14.3    43.8    44.8    43.4     46.3    47.0    44.5   46.5    44.0     47.0
4  14.3    10.5     9.03    7.85    12.3    10.1    12.2    7.87    8.83    10.4
5   6.80   14.4    13.0    16.1     18.2    17.9    23.9   22.6    23.1     25.6
6   7.47    9.09    9.93   10.5     12.3    11.8    10.4   13.4    16.2     17.0
7   9.17   30.8    31.6    34.4     36.1    40.9    39.4   41.1    43.0     46.8
8  11.7    26.0    26.9    30.1     29.6    31.2    34.3   36.2    38.3     42.6
# ℹ 1 more variable: time_29 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The <code>-</code> operator works with these selection functions to exclude variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
     id baseline_sessions_n intervention_sessions_n
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;
1     1                  22                      20
2     2                  18                      19
3     3                   5                      18
4     4                  32                      20
5     5                  19                      20
6     6                  24                      20
7     7                  10                      19
8     8                  13                      20</code></pre>
</div>
</div>
</section>
<section id="renaming-variables" class="level1">
<h1>Renaming variables</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">student_id =</span> id, </span>
<span id="cb29-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">baseline =</span> baseline_sessions_n)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 63
  student_id baseline intervention_sessions_n time_1 time_2 time_3 time_4 time_5
       &lt;dbl&gt;    &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1          1       22                      20  11.5   14.4    6.15   9.25   9.58
2          2       18                      19   9.11   8.59  11.0    9.36   8.09
3          3        5                      18   7.24  14.3    7.98  11.2   12.3 
4          4       32                      20  11.3   14.3   14.8    8.68   9.53
5          5       19                      20  10.7    6.80   8.30  14.5    6.87
6          6       24                      20  13.0    7.47  13.7    5.77  10.8 
7          7       10                      19   9.70   9.17  10.6    9.14   7.36
8          8       13                      20  10.6   11.7   10.9   11.4    8.26
# ℹ 55 more variables: time_6 &lt;dbl&gt;, time_7 &lt;dbl&gt;, time_8 &lt;dbl&gt;, time_9 &lt;dbl&gt;,
#   time_10 &lt;dbl&gt;, time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;, time_14 &lt;dbl&gt;,
#   time_15 &lt;dbl&gt;, time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;, time_19 &lt;dbl&gt;,
#   time_20 &lt;dbl&gt;, time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;, time_24 &lt;dbl&gt;,
#   time_25 &lt;dbl&gt;, time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;, time_29 &lt;dbl&gt;,
#   time_30 &lt;dbl&gt;, time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;, time_34 &lt;dbl&gt;,
#   time_35 &lt;dbl&gt;, time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, time_38 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>We can rename many columns at once with a function. The <code>str_replace</code> function usually works like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_1"</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time "</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Time 1"</code></pre>
</div>
</div>
<p>The <code>rename_with</code> is a function that applies a function to all variable names at once. It can take that function’s arguments, too. For example,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(str_replace, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time "</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 63
     id baseline_sessions_n intervention_sessions_n `Time 1` `Time 2` `Time 3`
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     1                  22                      20    11.5     14.4      6.15
2     2                  18                      19     9.11     8.59    11.0 
3     3                   5                      18     7.24    14.3      7.98
4     4                  32                      20    11.3     14.3     14.8 
5     5                  19                      20    10.7      6.80     8.30
6     6                  24                      20    13.0      7.47    13.7 
7     7                  10                      19     9.70     9.17    10.6 
8     8                  13                      20    10.6     11.7     10.9 
# ℹ 57 more variables: `Time 4` &lt;dbl&gt;, `Time 5` &lt;dbl&gt;, `Time 6` &lt;dbl&gt;,
#   `Time 7` &lt;dbl&gt;, `Time 8` &lt;dbl&gt;, `Time 9` &lt;dbl&gt;, `Time 10` &lt;dbl&gt;,
#   `Time 11` &lt;dbl&gt;, `Time 12` &lt;dbl&gt;, `Time 13` &lt;dbl&gt;, `Time 14` &lt;dbl&gt;,
#   `Time 15` &lt;dbl&gt;, `Time 16` &lt;dbl&gt;, `Time 17` &lt;dbl&gt;, `Time 18` &lt;dbl&gt;,
#   `Time 19` &lt;dbl&gt;, `Time 20` &lt;dbl&gt;, `Time 21` &lt;dbl&gt;, `Time 22` &lt;dbl&gt;,
#   `Time 23` &lt;dbl&gt;, `Time 24` &lt;dbl&gt;, `Time 25` &lt;dbl&gt;, `Time 26` &lt;dbl&gt;,
#   `Time 27` &lt;dbl&gt;, `Time 28` &lt;dbl&gt;, `Time 29` &lt;dbl&gt;, `Time 30` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>If you have a vector with names in it, you can rename many variables at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">v_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, </span>
<span id="cb35-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Baseline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseline_sessions_n"</span>,</span>
<span id="cb35-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Intervention =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intervention_sessions_n"</span>)</span>
<span id="cb35-4"></span>
<span id="cb35-5">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any_of</span>(v_names))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 63
     ID Baseline Intervention time_1 time_2 time_3 time_4 time_5 time_6 time_7
  &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1       22           20  11.5   14.4    6.15   9.25   9.58   8.16  10.1 
2     2       18           19   9.11   8.59  11.0    9.36   8.09   8.77   8.95
3     3        5           18   7.24  14.3    7.98  11.2   12.3   13.1   11.7 
4     4       32           20  11.3   14.3   14.8    8.68   9.53   7.82   9.56
5     5       19           20  10.7    6.80   8.30  14.5    6.87  12.4    9.41
6     6       24           20  13.0    7.47  13.7    5.77  10.8    8.70   9.32
7     7       10           19   9.70   9.17  10.6    9.14   7.36  14.3    9.45
8     8       13           20  10.6   11.7   10.9   11.4    8.26   7.59   8.23
# ℹ 53 more variables: time_8 &lt;dbl&gt;, time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;,
#   time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;, time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;,
#   time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;, time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;,
#   time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;, time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;,
#   time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;, time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;,
#   time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;, time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;,
#   time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, time_38 &lt;dbl&gt;, time_39 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>In this example, there is no advantage over just applying the transformations directly in <code>rename</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, </span>
<span id="cb37-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Baseline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseline_sessions_n"</span>,</span>
<span id="cb37-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Intervention =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intervention_sessions_n"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 63
     ID Baseline Intervention time_1 time_2 time_3 time_4 time_5 time_6 time_7
  &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1       22           20  11.5   14.4    6.15   9.25   9.58   8.16  10.1 
2     2       18           19   9.11   8.59  11.0    9.36   8.09   8.77   8.95
3     3        5           18   7.24  14.3    7.98  11.2   12.3   13.1   11.7 
4     4       32           20  11.3   14.3   14.8    8.68   9.53   7.82   9.56
5     5       19           20  10.7    6.80   8.30  14.5    6.87  12.4    9.41
6     6       24           20  13.0    7.47  13.7    5.77  10.8    8.70   9.32
7     7       10           19   9.70   9.17  10.6    9.14   7.36  14.3    9.45
8     8       13           20  10.6   11.7   10.9   11.4    8.26   7.59   8.23
# ℹ 53 more variables: time_8 &lt;dbl&gt;, time_9 &lt;dbl&gt;, time_10 &lt;dbl&gt;,
#   time_11 &lt;dbl&gt;, time_12 &lt;dbl&gt;, time_13 &lt;dbl&gt;, time_14 &lt;dbl&gt;, time_15 &lt;dbl&gt;,
#   time_16 &lt;dbl&gt;, time_17 &lt;dbl&gt;, time_18 &lt;dbl&gt;, time_19 &lt;dbl&gt;, time_20 &lt;dbl&gt;,
#   time_21 &lt;dbl&gt;, time_22 &lt;dbl&gt;, time_23 &lt;dbl&gt;, time_24 &lt;dbl&gt;, time_25 &lt;dbl&gt;,
#   time_26 &lt;dbl&gt;, time_27 &lt;dbl&gt;, time_28 &lt;dbl&gt;, time_29 &lt;dbl&gt;, time_30 &lt;dbl&gt;,
#   time_31 &lt;dbl&gt;, time_32 &lt;dbl&gt;, time_33 &lt;dbl&gt;, time_34 &lt;dbl&gt;, time_35 &lt;dbl&gt;,
#   time_36 &lt;dbl&gt;, time_37 &lt;dbl&gt;, time_38 &lt;dbl&gt;, time_39 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>The reason one might use the named-vector method is that one already has the named vector handy, and retyping it would be an error-prone waste of time.</p>
</section>
<section id="data-restructuring" class="level1">
<h1>Data Restructuring</h1>
<p>We need to make our wide data long. To make the illustration simple to see, let’s make a smaller version of the data. We will select just times 1–3 for the first 2 children:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">d_small <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</div>
<p>Breaking down each step, the code above does these three things:</p>
<ol type="1">
<li>Create a new tibble called <code>d_small</code> starting with the tibble <code>d</code> “and then” (i..e, <code>%&gt;%</code>)…</li>
<li><code>select</code> variables <code>id</code> through <code>time_3</code> “and then”…</li>
<li><code>filter</code> the rows to find only the cases in which id is less than 3.</li>
</ol>
<p>Let’s display <code>d_small</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">d_small</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "| id| baseline_sessions_n| intervention_sessions_n| time_1| time_2| time_3|"
[2] "|--:|-------------------:|-----------------------:|------:|------:|------:|"
[3] "|  1|                  22|                      20| 11.481| 14.402|  6.151|"
[4] "|  2|                  18|                      19|  9.114|  8.586| 11.010|"</code></pre>
</div>
</div>
<p>What we need is:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n  time on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1     1                  22                      20     1   11.5 
2     1                  22                      20     2   14.4 
3     1                  22                      20     3    6.15
4     2                  18                      19     1    9.11
5     2                  18                      19     2    8.59
6     2                  18                      19     3   11.0 </code></pre>
</div>
</div>
<section id="restructuring-from-wide-to-long-format-with-pivot_longer" class="level2">
<h2 class="anchored" data-anchor-id="restructuring-from-wide-to-long-format-with-pivot_longer">Restructuring from wide to long format with <code>pivot_longer</code></h2>
<p>Use the <code>pivot_longer</code> function to pivot the three time variables to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n name   value
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1     1                  22                      20 time_1 11.5 
2     1                  22                      20 time_2 14.4 
3     1                  22                      20 time_3  6.15
4     2                  18                      19 time_1  9.11
5     2                  18                      19 time_2  8.59
6     2                  18                      19 time_3 11.0 </code></pre>
</div>
</div>
<p>To avoid the hassle of renaming our columns, we can specify what the <code>name</code> and <code>value</code> columns should be called:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb45-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb45-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n time   on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
1     1                  22                      20 time_1   11.5 
2     1                  22                      20 time_2   14.4 
3     1                  22                      20 time_3    6.15
4     2                  18                      19 time_1    9.11
5     2                  18                      19 time_2    8.59
6     2                  18                      19 time_3   11.0 </code></pre>
</div>
</div>
<p>Notice that the <code>time</code> variable is text, not a number, like we want. There are many ways to get rid of the prefix. The simplest is to tell <code>pivot_longer</code> to strip away the prefix “time_”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb47-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb47-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb47-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n time  on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
1     1                  22                      20 1       11.5 
2     1                  22                      20 2       14.4 
3     1                  22                      20 3        6.15
4     2                  18                      19 1        9.11
5     2                  18                      19 2        8.59
6     2                  18                      19 3       11.0 </code></pre>
</div>
</div>
<p>Unfortunately, R thinks that <code>time</code> is a text variable. We want it to be an integer, so we transform it using the <code>as.integer</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1">d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb49-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb49-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb49-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb49-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>, </span>
<span id="cb49-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_transform =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> as.integer)) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n  time on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1     1                  22                      20     1   11.5 
2     1                  22                      20     2   14.4 
3     1                  22                      20     3    6.15
4     2                  18                      19     1    9.11
5     2                  18                      19     2    8.59
6     2                  18                      19     3   11.0 </code></pre>
</div>
</div>
<p>Alternatively, we can do all these transformations after pivoting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1">d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb51-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb51-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(time, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb51-6">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n  time on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1     1                  22                      20     1   11.5 
2     1                  22                      20     2   14.4 
3     1                  22                      20     3    6.15
4     2                  18                      19     1    9.11
5     2                  18                      19     2    8.59
6     2                  18                      19     3   11.0 </code></pre>
</div>
</div>
</section>
<section id="restructuring-from-long-to-wide-format-with-pivot_wider" class="level2">
<h2 class="anchored" data-anchor-id="restructuring-from-long-to-wide-format-with-pivot_wider">Restructuring from long to wide format with <code>pivot_wider</code></h2>
<p>Let’s pivot the data from long format to wide. First let’s assign the restructured <code>d_small</code> data as <code>d_small_longer</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">d_small_longer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_small <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb53-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_3,</span>
<span id="cb53-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb53-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb53-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>,</span>
<span id="cb53-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_transform =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> as.integer))</span></code></pre></div>
</div>
<p>Now let’s move it back to where it was with <code>pivot_wider</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">d_small_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb54-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> time, </span>
<span id="cb54-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> on_task, </span>
<span id="cb54-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
     id baseline_sessions_n intervention_sessions_n time_1 time_2 time_3
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1                  22                      20  11.5   14.4    6.15
2     2                  18                      19   9.11   8.59  11.0 </code></pre>
</div>
</div>
<p>Perfect! Now lets move back to the the original large tibble <code>d</code>.</p>
</section>
</section>
<section id="create-new-variables-with-mutate-and-case_when" class="level1">
<h1>Create new variables with <code>mutate</code> and <code>case_when</code></h1>
<p>First, let’s pivot the entire data and assign it to <code>d_longer</code>. We need to select <code>time_1</code>–<code>time_60</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">d_longer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb56-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> time_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>time_60,</span>
<span id="cb56-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>,</span>
<span id="cb56-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_task"</span>,</span>
<span id="cb56-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_"</span>,</span>
<span id="cb56-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_transform =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> as.integer))</span></code></pre></div>
</div>
<p>To create a new variable in <code>d_longer</code>, we “mutate” the tibble. For example, if we want to add 1 to <code>on_task</code>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb57-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ontask_plus_1 =</span> on_task <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb57-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id baseline_sessions_n intervention_sessions_n  time on_task ontask_plus_1
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt;
1     1                  22                      20     1   11.5          12.5 
2     1                  22                      20     2   14.4          15.4 
3     1                  22                      20     3    6.15          7.15
4     1                  22                      20     4    9.25         10.3 
5     1                  22                      20     5    9.58         10.6 
6     1                  22                      20     6    8.16          9.16</code></pre>
</div>
</div>
<p>Notice that the variable is not saved anywhere because we did not assign the output to a variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb59-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id baseline_sessions_n intervention_sessions_n  time on_task
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1     1                  22                      20     1   11.5 
2     1                  22                      20     2   14.4 
3     1                  22                      20     3    6.15
4     1                  22                      20     4    9.25
5     1                  22                      20     5    9.58
6     1                  22                      20     6    8.16</code></pre>
</div>
</div>
<p>We need to identify which rows are part of the pre-intervention phase, which are in the intervention phase, and which are in the post-intervention phase. Let’s use the <code>case_when</code> function, which is like a series of “if-then” statements followed by the desired result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1">d_longer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb61-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phase =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb61-3">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pre-Intervention"</span>,</span>
<span id="cb61-4">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> intervention_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intervention"</span>,</span>
<span id="cb61-5">    time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> baseline_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> intervention_sessions_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Post-Intervention"</span> </span>
<span id="cb61-6">  ))</span>
<span id="cb61-7"></span>
<span id="cb61-8">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb61-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id baseline_sessions_n intervention_sessions_n  time on_task phase         
  &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;         
1     1                  22                      20     1   11.5  Pre-Intervent…
2     1                  22                      20     2   14.4  Pre-Intervent…
3     1                  22                      20     3    6.15 Pre-Intervent…
4     1                  22                      20     4    9.25 Pre-Intervent…
5     1                  22                      20     5    9.58 Pre-Intervent…
6     1                  22                      20     6    8.16 Pre-Intervent…</code></pre>
</div>
</div>
</section>
<section id="plot-the-results" class="level1 page-columns page-full">
<h1>Plot the results:</h1>
<p>Plotting is rarely done all at once. We usually build it step-by-step and layer-by-layer. Figure&nbsp;1 is the first attempt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb63-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, on_task)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-firstattempt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-firstattempt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="data_wrangling_files/figure-html/fig-firstattempt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: First attempt at plotting. Messy, messy, messy!"><img src="https://wjschne.github.io/tutorials/DataWrangling/data_wrangling_files/figure-html/fig-firstattempt-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-firstattempt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: First attempt at plotting. Messy, messy, messy!
</figcaption>
</figure>
</div>
</div>
</div>
<p>That was not so great! Let’s make a separate plot for each person in Figure&nbsp;2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb64-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, on_task)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb64-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(id))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-plotfacet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotfacet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="data_wrangling_files/figure-html/fig-plotfacet-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Plot each person’s data on separate facet plots"><img src="https://wjschne.github.io/tutorials/DataWrangling/data_wrangling_files/figure-html/fig-plotfacet-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotfacet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Plot each person’s data on separate facet plots
</figcaption>
</figure>
</div>
</div>
</div>
<p>Better!</p>
<p>Let’s reorder the cases by the order in which the intervention is first implemented. The <code>fct_reorder</code> function is incredibly useful for creating plots. Because the <code>id</code> variable is just a number, we need to change it to a <code>factor</code> variable first. A <code>factor</code> is R’s way of grouping categorical data in any order we wish.</p>
<p>We need to reorder the <code>id</code> variable so that people with shorter baselines come before people with longer baselines. The first slot in the <code>fct_reorder</code> function is the variable we want to transform into a reordered factor. The second slot is another variable we want to order the factor factor by. Thus, the <code>fct_reorder</code> function usually takes this form: <code>fct_reorder(variable_to_be_reordered, variable_to_sort_by)</code></p>
<p>In this case, we are assigning the reordered variable back to the same variable <code>id</code> that we started with. Putting it all together, we get Figure&nbsp;3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb65-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id), baseline_sessions_n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb65-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, on_task)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb65-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(id))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-plotreorder" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotreorder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="data_wrangling_files/figure-html/fig-plotreorder-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Reordered facet plots"><img src="https://wjschne.github.io/tutorials/DataWrangling/data_wrangling_files/figure-html/fig-plotreorder-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotreorder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Reordered facet plots
</figcaption>
</figure>
</div>
</div>
</div>
<p>Looks even better!</p>
<p>If I wanted a more polished plot for publication, I might create something like Figure&nbsp;4. My priorities for a plot in a publication are quite different than a plot I am making just for my own use. I want the plot to be nearly self-explanatory. I want reader to understand the plot without needing to work hard. Thus, I prefer direct labels rather than plot legends that require looking things up. I also want my plot to be inclusive, so I choose a large font size from a legible font family. I also choose colors that are distinguishable by people different kinds of color blindness.</p>
<div class="cell preview-image page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66" data-cap-location="margin" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some pre-processing for easier plotting</span></span>
<span id="cb66-2">d_longer_processed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_longer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb66-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(baseline_sessions_n),</span>
<span id="cb66-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phase =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(phase)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb66-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(phase) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb66-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Child "</span>, LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>])))</span>
<span id="cb66-7"></span>
<span id="cb66-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data for phase rectangles</span></span>
<span id="cb66-9">d_phases <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_longer_processed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb66-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(id, phase),</span>
<span id="cb66-11">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(time),</span>
<span id="cb66-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(time)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb66-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(begin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, begin),</span>
<span id="cb66-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb66-15"></span>
<span id="cb66-16">d_longer_processed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb66-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, on_task)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-19">  ggtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb66-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Child E"</span>, time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)),</span>
<span id="cb66-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> phase, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase),</span>
<span id="cb66-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb66-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb66-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb66-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb66-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb66-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb66-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>,</span>
<span id="cb66-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span></span>
<span id="cb66-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb66-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d_phases,</span>
<span id="cb66-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb66-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> begin,</span>
<span id="cb66-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> end,</span>
<span id="cb66-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb66-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb66-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> phase</span>
<span id="cb66-39">    ),</span>
<span id="cb66-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb66-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> phase), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb66-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Day"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time on Task"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb66-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb66-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb66-51">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb66-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>),</span>
<span id="cb66-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb66-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb66-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-60">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb66-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_axis</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor.ticks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb66-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y = guide_axis(minor.ticks = TRUE)</span></span>
<span id="cb66-63">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb66-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-polished" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-polished-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="data_wrangling_files/figure-html/fig-polished-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Effect on Intervention on Time on Task for Eight Children"><img src="https://wjschne.github.io/tutorials/DataWrangling/data_wrangling_files/figure-html/fig-polished-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-polished-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Effect on Intervention on Time on Task for Eight Children
</figcaption>
</figure>
</div>
</div>
</div>
<p>For practice data wrangling, download <a href="https://raw.githubusercontent.com/wjschne/EDUC8825/master/data_wrangling_exercise.qmd">this quarto document</a> and complete the data-wrangling exercises therein.</p>


</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/DataWrangling/data_wrangling.html</guid>
  <pubDate>Fri, 01 Mar 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting Ready to Use R and RStudio</title>
  <dc:creator>W. Joel Schneider</dc:creator>
  <link>https://wjschne.github.io/tutorials/GettingReady/getting_ready_to_use_RStudio.html</link>
  <description><![CDATA[ 





<section id="get-ready-for-a-challenge" class="level1 page-columns page-full">
<h1>Get Ready for a Challenge</h1>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/9/9c/William_James_b1842c.jpg" class="img-fluid figure-img"></p>
<figcaption>“<em>Blooming, buzzing confusion</em>?” I see what you did there. —WJ</figcaption>
</figure>
</div></div><p>For R to pay off, you have to buy in. Learning challenging material does not have to be “fun” at every moment to be worthwhile. The beginning data analyst, assailed by statistical concepts, coding conventions, and baffling error messages, <em>feels it all as one great blooming, buzzing confusion</em>.</p>
<p>The challenge of learning R is indeed going to be challenging at times, but just there will also be many little <em>a-ha</em> moments, several larger check-out-what-I-can-do celebrations, and a few peak experiences of eudaemonic reverie.</p>
</section>
<section id="what-is-r" class="level1 page-columns page-full">
<h1>What is R?</h1>
<p>R is the eighteenth letter of the alphabet, of course, but for data analysts, it has several specialized meanings.</p>
<section id="r-is-a-programming-language-built-for-statistics." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="r-is-a-programming-language-built-for-statistics.">R is a programming language built for statistics.</h2>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/John_Chambers.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.wikiwand.com/en/John_Chambers_(statistician)">John Chambers</a></figcaption>
</figure>
</div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/r_gentleman.jpg" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.wikiwand.com/en/Robert_Gentleman_(statistician)">Robert Gentleman</a></figcaption>
</figure>
</div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/Ihaka.jpg" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.wikiwand.com/en/Ross_Ihaka">Ross Ihaka</a></figcaption>
</figure>
</div></div>

<p>In 1976, <a href="https://www.wikiwand.com/en/John_Chambers_(statistician)">John Chambers</a> and colleagues at Bell Labs developed <a href="https://www.wikiwand.com/en/S_(programming_language)" target="_blank">S</a>, a programming language specifically designed to facilitate statistical analyses and data visualization.</p>
<p>In 1995, <a href="https://www.wikiwand.com/en/Robert_Gentleman_(statistician)">Robert Gentleman</a> and <a href="https://www.wikiwand.com/en/Ross_Ihaka">Ross Ihaka</a> released an open-source variant of S and named it “R” after their shared first initial.</p>
<p>Most S code looks identical to R code, but R has a number of subtle enhancements such as better memory management.</p>
<p><a href="https://www.stat.auckland.ac.nz/~ihaka/downloads/Interface98.pdf" target="_blank">More about the origins of R</a></p>
</section>
<section id="r-is-a-computer-program-that-runs-code-in-the-programming-language-r." class="level2">
<h2 class="anchored" data-anchor-id="r-is-a-computer-program-that-runs-code-in-the-programming-language-r.">R is a computer program that runs code in the programming language R.</h2>
<p>The primary way that the R language is used is to perform analyses in the R software environment for statistical computing and graphics. This program is free and open source, meaning that not only can anyone download it for free, but its source code can be reused by anyone for any purpose.</p>
</section>
<section id="r-is-a-data-science-ecosystem-in-which-the-r-community-flourishes" class="level2">
<h2 class="anchored" data-anchor-id="r-is-a-data-science-ecosystem-in-which-the-r-community-flourishes">R is a data science ecosystem in which the R community flourishes</h2>
<p>Strictly speaking, R is just one program. However, people use R in startlingly creative ways, often in combination with other programs and in coordination with other people. I like to think of R as the entire ecosystem of software, services, standards, and cultural practices shared by the entire community of R users.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/welcome_to_rstats_twitter.png" class="img-fluid figure-img"></p>
<figcaption>Artwork by <a href="https://github.com/allisonhorst/stats-illustrations" target="_blank"><span class="citation" data-cites="allison_horst">[@allison_horst]</span></a></figcaption>
</figure>
</div>
<p>The technical merits of the R language and software do matter, but the success of R has more to do with the inclusive, welcoming, diverse, and expanding culture of the R community. When an individual R user has a great idea, the R community has as integrated set of technical standards, web services, and cultural practices such that innovations spread quickly to everyone in the community—often with multiple tutorials aimed at users of all levels of expertise. With the support of the R community, ordinary people can leverage R to accomplish far more than anyone would have thought possible not so very long ago.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/code_hero_rstats.png" class="img-fluid figure-img"></p>
<figcaption>Artwork by <a href="https://github.com/allisonhorst/stats-illustrations" target="_blank"><span class="citation" data-cites="allison_horst">[@allison_horst]</span></a></figcaption>
</figure>
</div>
</section>
</section>
<section id="what-can-you-do-with-r" class="level1">
<h1>What can you do with R?</h1>
<p>What <em>can’t</em> be done with R is an ever-contracting list. If you let it, R will help you in ways you did not know you needed it. You can (and should) use R for tasks that extend well beyond analyzing data. Because R plays well with many other programs, you can leverage its capacities to do all sorts of things:</p>
<ul>
<li>Manage data</li>
<li>Analyze data</li>
<li>Visualize data</li>
<li>Control and run other programs</li>
<li>Write and publish books, papers, and posters</li>
<li>Create presentations, tutorials, websites, web apps, and digital a<strong>R</strong>t</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/environmental-data-science-r4ds-general.png" class="img-fluid figure-img"></p>
<figcaption>Artwork by <a href="https://github.com/allisonhorst/stats-illustrations" target="_blank"><span class="citation" data-cites="allison_horst">[@allison_horst]</span></a> based on <a href="https://r4ds.had.co.nz/" target="_blank">Grolemund &amp; Wickham, 2017</a></figcaption>
</figure>
</div>
<p>For example, this Tutorial was “created in R.” That is, I wrote the text in a simple format and then let R (and RStudio) handle all the complex and tedious coordination of many other programs to make this webpage. It does most of its work under the hood without my awareness.</p>
</section>
<section id="what-is-rstudio" class="level1">
<h1>What is RStudio?</h1>
<p>Although R comes with a text editor you can open, few R users every use it. R’s text editor works well for what it does, but it has limited functionality compared to other ways of interacting with R. Instead, we will run R code in an integrated development environment (IDE) called <a href="https://posit.co/products/open-source/rstudio/" target="_blank">RStudio</a>. An IDE is a program that makes programming easier. RStudio has many features that automates tasks what would otherwise be confusing, difficult, or tedious.</p>
</section>
<section id="code-clicks" class="level1">
<h1>Code &gt; Clicks</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/r_first_then.png" class="img-fluid figure-img"></p>
<figcaption>Artwork by <a href="https://github.com/allisonhorst/stats-illustrations" target="_blank"><span class="citation" data-cites="allison_horst">[@allison_horst]</span></a></figcaption>
</figure>
</div>
<p>Though R will be frustrating at times, stick with it—the dividends on your invested efforts are huge. Nothing beats the flexibility, freedom, and power of using code. Not only can I do things much faster than I could with point-and-click programs, I can do things I never would have considered doing. If there are no functions that do exactly what you want, you can adapt or make one that fits your needs perfectly. If you need to to re-run your analysis with a point-and-click menu interface, you need a perfect memory of what you did before. With code, every step is perfectly preserved.</p>
</section>
<section id="a-point-and-click-alternative-to-rstudio" class="level1">
<h1>A point-and-click alternative to RStudio</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.jamovi.org"><img src="https://www.jamovi.org/assets/header-logo.svg" class="img-fluid figure-img"></a></p>
<figcaption>jamovi</figcaption>
</figure>
</div>
<p>That said, if you need to complete a simple data-analysis task quickly, and you have no time to learn R, I recommend using <a href="https://www.jamovi.org/">jamovi</a>. Jamovi has a beautiful point-and-click interface that you can learn to use in just a few minutes. Jamovi uses R under the hood, and like R, it is free.</p>
<p>The ease of use of a point-and-click interface has a trade-off. If you never learn to code, you will be stuck with a limited set of skills and many tasks will be prohibitively complicated or dauntingly tedious.</p>
<p>In Figure&nbsp;1, I recreate a plot made by many others before me.</p>
<div class="cell preview-image">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Complexity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Code =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Complexity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1</span>),</span>
<span id="cb1-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Point-and-Click</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0002</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Complexity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1</span></span>
<span id="cb1-5">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Complexity, </span>
<span id="cb1-7">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Approach"</span>, </span>
<span id="cb1-8">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Difficulty"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(Approach) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Approach =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_inorder</span>(Approach),</span>
<span id="cb1-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rotation =</span>  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan</span>((Difficulty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(Difficulty)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Difficulty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Complexity, Difficulty, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Approach)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15">  ggarrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow_head =</span> arrowheadr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow_head_deltoid</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-16">  ggtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb1-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Complexity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">62.5</span>),</span>
<span id="cb1-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> Approach, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> rotation),</span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>,</span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb1-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb1-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb1-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">102</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">102</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_axis</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cap =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_axis</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cap =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point-and-Click Programs Do Simple Tasks Well"</span>,</span>
<span id="cb1-31">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"But Complex Tasks Are Best Done With Code"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, </span>
<span id="cb1-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>),</span>
<span id="cb1-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> ggarrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_arrow</span>(</span>
<span id="cb1-36">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow_head =</span> arrowheadr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow_head_deltoid</span>(), </span>
<span id="cb1-37">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_paletteer_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dutchmasters::milkmaid"</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-learningcurve" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-learningcurve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://wjschne.github.io/tutorials/GettingReady/getting_ready_to_use_RStudio_files/figure-html/fig-learningcurve-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-learningcurve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Different Learning Curves for Different Tasks
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="installing-r" class="level1">
<h1>Installing R</h1>
<p>Installation depends on your operating system. If you have already installed R, make sure you have the latest version.</p>
<section id="windows" class="level2">
<h2 class="anchored" data-anchor-id="windows">Windows</h2>
<p><span class="instruction">Click <a href="https://cloud.r-project.org/bin/windows/base/" target="_blank">here</a> and download the latest version of R for Windows. Open the file and follow installation instructions.</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://cloud.r-project.org/bin/windows/base/"><img src="https://wjschne.github.io/tutorials/GettingReady/WindowsInstall.png" class="img-fluid figure-img"></a></p>
<figcaption>Screenshot of Windows Installation Link</figcaption>
</figure>
</div>
</section>
<section id="mac" class="level2">
<h2 class="anchored" data-anchor-id="mac">Mac</h2>
<p><span class="instruction">Click <a href="https://cloud.r-project.org/bin/macosx/">here</a> and download the latest version of R for Mac. Double-click the file and follow installation instructions.</span></p>
<p>The instructions can be overwhelming to newcomers so I have included a picture with the download link highlighted:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://cloud.r-project.org/bin/macosx/"><img src="https://wjschne.github.io/tutorials/GettingReady/MacInstall.png" class="img-fluid figure-img"></a></p>
<figcaption>Screenshot of Mac Installation Link</figcaption>
</figure>
</div>
</section>
<section id="linux" class="level2">
<h2 class="anchored" data-anchor-id="linux">Linux</h2>
<p><span class="instruction">Install R on Ubuntu with this Bash script:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt-get install r-base </span></code></pre></div>
</div>
<p>If you are a Linux user, you probably know what this means. If not, you probably do not. More detailed instructions <a href="https://cran.r-project.org/bin/linux/ubuntu/README" target="_blank">here</a>.</p>
</section>
</section>
<section id="installing-rstudio" class="level1">
<h1>Installing RStudio</h1>
<section id="rstudio-desktop" class="level2">
<h2 class="anchored" data-anchor-id="rstudio-desktop">RStudio Desktop</h2>
<p>RStudio is free. <strong>Please do not pay for anything.</strong> The paid versions of RStudio have nothing you will need for this course. They are not better than the free version. They simply have features tailored to businesses and developers.</p>
<p><span class="instructions">Install the free version of RStudio Desktop <a href="https://rstudio.com/products/rstudio/download/#download" target="_blank">here</a>.</span></p>
<p>The version recommended for your operation system (I’m using Windows) will appear here:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://rstudio.com/products/rstudio/download/#download"><img src="https://wjschne.github.io/tutorials/GettingReady/RStudioInstall.png" class="img-fluid figure-img"></a></p>
<figcaption>Screenshot of RStudio Installation Link</figcaption>
</figure>
</div>
</section>
<section id="rstudio-cloud" class="level2">
<h2 class="anchored" data-anchor-id="rstudio-cloud">RStudio Cloud</h2>
<p>One alternative to installing R and RStudio on your machine is to use RStudio in a web browser in <a href="https://rstudio.cloud/">RStudio Cloud</a>. After signing up for a free account, you can use RStudio online. As the internet speeds up, I imagine that this option will become increasingly attractive.</p>
</section>
</section>
<section id="recommended-rstudio-customization" class="level1">
<h1>Recommended RStudio Customization</h1>
<p>To customize RStudio, click the <em>Tools</em> menu, then <em>Global Options</em>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/GlobalOptions.png" class="img-fluid figure-img"></p>
<figcaption>Global Options Menu</figcaption>
</figure>
</div>
<p>I strongly recommend changing the default data saving behavior to never restoring old sessions and never saving data in memory. Old variables lurking unnoticed in memory cause mystifying errors and baffling behavior. Starting each session fresh will prevent hours and hours of frustrating debugging.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/workspace_options.png" class="img-fluid figure-img"></p>
<figcaption>General Options</figcaption>
</figure>
</div>
<p>If you use a dark theme, you might have less eye strain. Up to you, though.</p>
<p>I change my code theme from time to time but for some reason I always return to the Tomorrow Night 80s theme.</p>
<p>For teaching, I use Consolas. For myself, I use Fira Code. It uses font ligatures to combine symbols in a pleasing manner.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/appearance_options.png" class="img-fluid figure-img"></p>
<figcaption>Appearance Options</figcaption>
</figure>
</div>
<p>A complete list of options explained <a href="https://support.rstudio.com/hc/en-us/articles/200549016-Customizing-RStudio" target="_blank">here</a>.</p>
</section>
<section id="using-rstudio" class="level1">
<h1>Using RStudio</h1>
<p><span class="instructions">Open RStudio the same way you would any other program in your operating system.</span></p>
</section>
<section id="a-quick-tour-of-rstudios-4-panes" class="level1">
<h1>A Quick Tour of RStudio’s 4 Panes</h1>
<p>RStudio may appear overwhelming at first. That feeling will fade quickly with use. By default, RStudio has 4 panes where you can interact with R in different ways.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/RStudioTour.gif" class="img-fluid figure-img"></p>
<figcaption>Quick Tour of RStudio</figcaption>
</figure>
</div>
<section id="the-console" class="level2">
<h2 class="anchored" data-anchor-id="the-console">The Console</h2>
<p>The console (lower left) is where you submit quick temporary calculations and run code you have no intention of saving. Hit <code>Enter</code> to submit code to R. R is interactive in the sense that it will display the result of the code in the console where you typed.</p>
</section>
<section id="scripts" class="level2">
<h2 class="anchored" data-anchor-id="scripts">Scripts</h2>
<p>The script pane (upper left) is for writing code you want to preserve in a script file (.R) or RMarkdown file (.Rmd). More on RMarkdown later. Save your script files frequently.</p>
<p>You can submit code to the console by hitting Ctrl+Enter (or ⌘+Enter on Macs). You can also submit code by hitting the Run button. If you have code selected, only the selected part will be submitted. If you have no code selected, the current line (wherever the cursor is) will be submitted.</p>
</section>
<section id="environment-variables" class="level2">
<h2 class="anchored" data-anchor-id="environment-variables">Environment Variables</h2>
<p>In the Environment tab in the upper right pane, you can see which variables have been created and a preview of what they contain.</p>
</section>
<section id="viewer" class="level2">
<h2 class="anchored" data-anchor-id="viewer">Viewer</h2>
<p>The lower right pane has several tabs:</p>
<ul>
<li><strong>Files</strong>: Interact with project files</li>
<li><strong>Plots</strong>: Preview plots</li>
<li><strong>Packages</strong>: Install and update packages</li>
<li><strong>Help:</strong> Search for help</li>
<li><strong>Viewer</strong>: View documents created by RStudio</li>
</ul>
</section>
</section>
<section id="installing-and-updating-packages" class="level1">
<h1>Installing and Updating Packages</h1>
<p>What comes installed with R is called “Base R,” which by itself is quite powerful. However, what makes R especially great is the fact that tens of thousands of free “packages” are available in a central repository called CRAN. These packages extend what R can do far beyond what any one person could have imagined.</p>
<p>In the bottom right pane, click the <code>Packages</code> tab.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://wjschne.github.io/tutorials/GettingReady/package_install.png" class="img-fluid figure-img"></p>
<figcaption>R Packages</figcaption>
</figure>
</div>
<p>Any new package you need but do not have, you can click the <code>Install</code> button and type the name of a new package. For example, click <code>Install</code> button, type <code>tidyverse</code> in the Packages textbox, and click <code>Install</code>.</p>
<p>You might have to wait a while, but now many new packages have been installed on your machine.</p>
<p>You do not need to install packages again. However, I update all my packages each time I use RStudio to make sure I have the best and most up-to-date versions of the packages available.</p>
</section>
<section id="create-a-new-project" class="level1">
<h1>Create a New Project</h1>
<p>When you take on a new data-analysis task, you will want to keep your files organized in a particular folder. You want to make sure that this folder is the first place that R will look when you specify a file name. Otherwise we will have to write out the entire file name, which will be likely different if we need to run the same analysis on a different computer.</p>
<p>RStudio’s “projects” are useful for making sure that all your analyses are in the same folder and that your analyses will work no matter which machine runs it.</p>
<p>Without projects, we would need to write out the entire file name like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># read_csv("C:/Users/my_user_name/Research/My_Project/my_data.csv")</span></span></code></pre></div>
</div>
<p>With projects, we can import data with just the bare file name, like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_data.csv"</span>)</span></code></pre></div>
</div>
<p>Much better!</p>
<p>Okay, let’s get to it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Steps to create a project
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>In your operating system, create a folder for this course on your computer (e.g., “EDUC8825” or “Longitudinal Data Analysis”).</p></li>
<li><p>Open RStudio.</p></li>
<li><p>Create a new project in the folder for this class.</p>
<ul>
<li>Click <strong>File-&gt;New Project</strong></li>
<li>Select <strong>Existing Directory</strong></li>
<li>Click <strong>Browse</strong></li>
<li>Navigate to the new folder.</li>
<li>Click <strong>Open</strong></li>
<li>Click <strong>Create Project</strong></li>
</ul></li>
</ol>
</div>
</div>
</section>
<section id="be-kind-to-future-you" class="level1">
<h1>Be Kind to Future-You</h1>
<p>Hadley Wickham reminds us that the most important person to write code for is <em>future-you</em>.</p>
<p>At all times, work with the assumption that 10 minutes from now, you will suffer catastrophic <em>datamnesia</em>—memory failure for everything related to your analysis.</p>
<div data-align="center">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media.giphy.com/media/RSTWNZcvvdDOw/giphy.gif" class="img-fluid figure-img"></p>
<figcaption><em>Datamnesia</em> happens all the time.</figcaption>
</figure>
</div>
</div>
<p>Present-you thinks future-you has god-like memory capacity. Future-you has very human and very fallible memory. Predicting is hard, especially about the future and what future-you will remember.</p>
<p>Future-you spends an inordinate amount of time recreating what present-you thought future-you would understand and remember—so much time that future-you neglects to take care of future–future-you. <em>Future-you won’t take care of anything unless present-you learns to take care of future-you.</em></p>
</section>
<section id="folder-organization" class="level1">
<h1>Folder Organization</h1>
<ul>
<li>Bad: All files on your desktop</li>
<li>Also Bad: All files in the default folder (e.g., My Documents)</li>
<li>Worse: Important files scattered in various folders with no organization.</li>
<li>Even worse: Important files are in your Downloads folder where they are likely to be overwritten or deleted.</li>
<li>Good: Use a file synchronization service like Dropbox, Box, OneDrive, GoogleDrive, etc.</li>
<li>Also Good: Within your file synchronization service, have a well-organized hierarchical structure to your folders.</li>
<li>Even Better: Use version control software like <a href="https://git-scm.com/">Git</a>, and save the code in an online repository like <a href="https://github.com/">GitHub</a>.</li>
</ul>
</section>
<section id="file-name-guidance" class="level1">
<h1>File Name Guidance</h1>
<p>Giving convenient, easily understood names to files, whether data files, image files, or script files can have far-reaching consequences for both present-you and future-you.</p>
<p>Detailed advice on naming things from Jenny Bryan found <a href="http://www2.stat.duke.edu/~rcs46/lectures_2015/01-markdown-git/slides/naming-slides/naming-slides.pdf">here</a>. My shortened presentation draws from her ideas.</p>
<section id="give-your-files-long-descriptive-names." class="level2">
<h2 class="anchored" data-anchor-id="give-your-files-long-descriptive-names.">Give your files long, descriptive names.</h2>
<p>Make it clear to future-you exactly what is in the file.</p>
<ul>
<li><strong>Bad</strong>: <code>data.xlsx</code></li>
<li><strong>Better</strong>: <code>dissertation_data.csv</code></li>
<li><strong>Even Better</strong>: <code>student_questionnaire_time_1.csv</code></li>
</ul>
</section>
<section id="separate-words-with-underscores-not-spaces." class="level2">
<h2 class="anchored" data-anchor-id="separate-words-with-underscores-not-spaces.">Separate words with underscores, not spaces.</h2>
<p>Replace spaces with underscores (<code>_</code>). Spaces often work fine, but sometimes they do not, which can result in hours and hours of debugging. Play it safe and don’t use spaces in file names.</p>
<p><code>student scores.xlsx</code> → <code>student_scores.xlsx</code></p>
</section>
<section id="no-special-characters-in-file-names" class="level2">
<h2 class="anchored" data-anchor-id="no-special-characters-in-file-names">No special characters in file names:</h2>
<p>Avoid including in file names characters that have special meanings in many programming languages such as <code>*@^$!</code> and many others. Otherwise unexpected results can make your life complicated.</p>
<p><code>parent@emotion*survey.csv</code> → <code>parent_emotion_survey.csv</code></p>
</section>
<section id="separate-dates-with-hyphens-using-iso-format" class="level2">
<h2 class="anchored" data-anchor-id="separate-dates-with-hyphens-using-iso-format">Separate dates with hyphens using ISO format</h2>
<div data-align="center">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://imgs.xkcd.com/comics/iso_8601.png" class="img-fluid figure-img"></p>
<figcaption>from <a href="https://xkcd.com/1179/">XKCD</a></figcaption>
</figure>
</div>
</div>
<p><a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO format</a> for dates is YYYY-MM-DD, meaning that a four-digit year comes first, followed by a two-digit month, followed by a two-digit day. This format makes sorting order much easier than the formats used in the U.S.</p>
<p>Here is a data file name that begins with a date, followed by the school district from from the data were collected:</p>
<p><code>2020-01-12_district_A.csv</code></p>
<p>One of the benefits of using dates in the ISO format is that they sort chronologically. Which file names would you prefer to deal with?</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Sorted Traditional Dates</th>
<th style="text-align: left;">Sorted ISO Dates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">April 01, 2012_District_I.csv</td>
<td style="text-align: left;">2008-02-24_District_K.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">August 11, 2013_District_M.csv</td>
<td style="text-align: left;">2009-10-10_District_B.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">December 05, 2013_District_T.csv</td>
<td style="text-align: left;">2012-01-12_District_J.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">February 06, 2013_District_G.csv</td>
<td style="text-align: left;">2012-04-01_District_I.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">February 24, 2008_District_K.csv</td>
<td style="text-align: left;">2012-07-11_District_S.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">January 12, 2012_District_J.csv</td>
<td style="text-align: left;">2013-02-06_District_G.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">July 11, 2012_District_S.csv</td>
<td style="text-align: left;">2013-08-11_District_M.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">October 10, 2009_District_B.csv</td>
<td style="text-align: left;">2013-12-05_District_T.csv</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://wjschne.github.io/tutorials/GettingReady/getting_ready_to_use_RStudio.html</guid>
  <pubDate>Sat, 20 Jan 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Untitled</title>
  <link>https://wjschne.github.io/tutorials/GeneralizedMixed/asdf.html</link>
  <description><![CDATA[ 





<p>My variable is <img src="https://latex.codecogs.com/png.latex?x%5E2"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az=%5Cfrac%7Bx-%5Cmu%7D%7B%5Csigma%7D%0A"></p>



 ]]></description>
  <guid>https://wjschne.github.io/tutorials/GeneralizedMixed/asdf.html</guid>
  <pubDate>Sun, 09 Mar 2025 15:03:19 GMT</pubDate>
</item>
</channel>
</rss>
